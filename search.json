[{"title":"JavaScript实现一个排序算法的演示动画","url":"/2023/04/28/algorithm/JavaScript%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84%E6%BC%94%E7%A4%BA%E5%8A%A8%E7%94%BB/","content":"<blockquote>\n<p>在学习排序算法的时候，单纯的文字或者代码无法直观地表示出算法的具体排序过程，而自己手动画出示意图也比较麻烦，所以作者使用 JavaScript 实现了一个简单的排序算法的演示动画页面。</p>\n</blockquote>\n<span id=\"more\"></span>\n<h1 id=\"项目地址\"><a href=\"#项目地址\" class=\"headerlink\" title=\"项目地址\"></a>项目地址</h1><ul>\n<li>Github: <a href=\"https://github.com/herenpeng/sort-animation\">https://github.com/herenpeng/sort-animation</a></li>\n<li>Gitee: <a href=\"https://gitee.com/herenpeng/sort-animation\">https://gitee.com/herenpeng/sort-animation</a></li>\n</ul>\n<h1 id=\"项目介绍\"><a href=\"#项目介绍\" class=\"headerlink\" title=\"项目介绍\"></a>项目介绍</h1><p>项目的名称非常直观明了，就叫做 <code>sort-animation</code>。</p>\n<p>项目结构非常简单，目录下面只有一个 <code>.html</code> 的静态文件，可以直接使用浏览器打开，即可浏览项目。</p>\n<p>我们可以先看一下项目的页面展示效果图：</p>\n<p><img src=\"/images/2023/04/7a29d489aa6d456cb7bb045591ae3221.png\" alt=\"在这里插入图片描述\"></p>\n<h1 id=\"项目效果\"><a href=\"#项目效果\" class=\"headerlink\" title=\"项目效果\"></a>项目效果</h1><h2 id=\"参数选择\"><a href=\"#参数选择\" class=\"headerlink\" title=\"参数选择\"></a>参数选择</h2><p><img src=\"/images/2023/04/7d4cf5d083f34a5fa766c9a969cbccaf.gif\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"生成策略\"><a href=\"#生成策略\" class=\"headerlink\" title=\"生成策略\"></a>生成策略</h2><p><img src=\"/images/2023/04/93fc47eef02446d1ad674f69d41e376d.gif\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"算法选择\"><a href=\"#算法选择\" class=\"headerlink\" title=\"算法选择\"></a>算法选择</h2><p><img src=\"/images/2023/04/37a0633091424ca3b5fb42b603422423.gif\" alt=\"在这里插入图片描述\"></p>\n<h1 id=\"项目特点\"><a href=\"#项目特点\" class=\"headerlink\" title=\"项目特点\"></a>项目特点</h1><ul>\n<li>原生JS，极致性能</li>\n<li>静态项目，开箱即用</li>\n<li>无第三方依赖</li>\n<li>动画参数的可定制化</li>\n<li>排序算法逻辑自定义</li>\n</ul>\n<h1 id=\"结尾\"><a href=\"#结尾\" class=\"headerlink\" title=\"结尾\"></a>结尾</h1><p>对项目有兴趣的同学可以从 <code>Github</code> 或者 <code>Gitee</code> 上进行下载，也欢迎其他同学为项目提供 <code>PR</code>。<br>如果你喜欢这个项目，欢迎 <code>Star</code>。</p>\n","categories":["数据结构与算法"],"tags":["JavaScript","排序算法"]},{"title":"LeetCode：两数之和","url":"/2020/08/11/algorithm/LeetCode%EF%BC%9A%E4%B8%A4%E6%95%B0%E4%B9%8B%E5%92%8C/","content":"<h1 id=\"两数之和\"><a href=\"#两数之和\" class=\"headerlink\" title=\"两数之和\"></a>两数之和</h1><ul>\n<li><strong>题目描述</strong></li>\n</ul>\n<p>给定一个整数数组 nums 和一个目标值 target，请你在该数组中找出和为目标值的那 两个 整数，并返回他们的数组下标。</p>\n<p>你可以假设每种输入只会对应一个答案。但是，数组中同一个元素不能使用两遍。</p>\n<span id=\"more\"></span>\n<ul>\n<li><strong>示例</strong><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">给定 nums = [<span class=\"number\">2</span>, <span class=\"number\">7</span>, <span class=\"number\">11</span>, <span class=\"number\">15</span>], target = <span class=\"number\">9</span></span><br><span class=\"line\"></span><br><span class=\"line\">因为 nums[<span class=\"number\">0</span>] + nums[<span class=\"number\">1</span>] = <span class=\"number\">2</span> + <span class=\"number\">7</span> = <span class=\"number\">9</span></span><br><span class=\"line\">所以返回 [<span class=\"number\">0</span>, <span class=\"number\">1</span>]</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>来源：力扣（LeetCode）<br>链接：<a href=\"https://leetcode-cn.com/problems/two-sum\">https://leetcode-cn.com/problems/two-sum</a><br>著作权归领扣网络所有。商业转载请联系官方授权，非商业转载请注明出处。</p>\n</blockquote>\n</li>\n</ul>\n<h1 id=\"我的答案\"><a href=\"#我的答案\" class=\"headerlink\" title=\"我的答案\"></a>我的答案</h1><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span>[] twoSum(<span class=\"type\">int</span>[] nums, <span class=\"type\">int</span> target) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> i + <span class=\"number\">1</span>; j &lt; nums.length; j++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (nums[i] + nums[j] == target) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[]&#123;i, j&#125;;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","categories":["数据结构与算法"],"tags":["LeetCode"]},{"title":"LeetCode：两数相加","url":"/2021/03/22/algorithm/LeetCode%EF%BC%9A%E4%B8%A4%E6%95%B0%E7%9B%B8%E5%8A%A0/","content":"<h1 id=\"两数相加\"><a href=\"#两数相加\" class=\"headerlink\" title=\"两数相加\"></a>两数相加</h1><h3 id=\"题目描述\"><a href=\"#题目描述\" class=\"headerlink\" title=\"题目描述\"></a>题目描述</h3><p>给你两个非空的链表，表示两个非负的整数。它们每位数字都是按照逆序 的方式存储的，并且每个节点只能存储一位数字。</p>\n<span id=\"more\"></span>\n<h3 id=\"链表结构\"><a href=\"#链表结构\" class=\"headerlink\" title=\"链表结构\"></a>链表结构</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ListNode</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> val;</span><br><span class=\"line\">    ListNode next;</span><br><span class=\"line\">    ListNode() &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ListNode(<span class=\"type\">int</span> val) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.val = val;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ListNode(<span class=\"type\">int</span> val, ListNode next) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.val = val;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.next = next;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"解题思路\"><a href=\"#解题思路\" class=\"headerlink\" title=\"解题思路\"></a>解题思路</h3><p>两个链表分为存储了两个数，存储方式为按照逆序存储。</p>\n<p>即每个链表的头部节点，即为每个数的个位数。</p>\n<p>而两个数相加，正好是从个位数开始相加。</p>\n<p>所以我们可以遍历两个链表，对每个链表节点的数进行相加操作，将相加出来的结果存储在一个链表中即可。</p>\n<p> <strong>注意点</strong></p>\n<ul>\n<li><p>进位：两个数相加，相加结果可能会发生进位，可以通过 <code>/</code> 运算符获取进位值，通过 <code>%</code> 运算符获取当前位值。</p>\n</li>\n<li><p>高位不足：两个数相加，如果两个数的位数不一致，位数小的可能会发生高位不足的情况，这时可以使用 <code>0</code> 补足。</p>\n</li>\n<li><p>值为<code>null</code>：如果两个相加的数链表中有一个值为 <code>null</code> ，则需要注意。</p>\n</li>\n</ul>\n<h3 id=\"解题代码\"><a href=\"#解题代码\" class=\"headerlink\" title=\"解题代码\"></a>解题代码</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> ListNode <span class=\"title function_\">addTwoNumbers</span><span class=\"params\">(ListNode l1, ListNode l2)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">ListNode</span> <span class=\"variable\">dummyHead</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ListNode</span>(<span class=\"number\">0</span>);<span class=\"comment\">//虚拟头部</span></span><br><span class=\"line\">    <span class=\"type\">ListNode</span> <span class=\"variable\">p</span> <span class=\"operator\">=</span> dummyHead;</span><br><span class=\"line\">    <span class=\"type\">ListNode</span> <span class=\"variable\">p1</span> <span class=\"operator\">=</span> l1, p2 = l2;</span><br><span class=\"line\">    <span class=\"comment\">// 进位</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">carry</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"comment\">// 两个节点相加的值</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">sum</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"comment\">// l1,l2任一链表未到尾部，或者进位不为0都要继续</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (p1 != <span class=\"literal\">null</span> || p2 != <span class=\"literal\">null</span> || carry &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 如果一个列表已经到尾部，则值用0代替</span></span><br><span class=\"line\">        sum = (p1 == <span class=\"literal\">null</span> ? <span class=\"number\">0</span> : p1.val) + (p2 == <span class=\"literal\">null</span> ? <span class=\"number\">0</span> : p2.val) + carry;</span><br><span class=\"line\">        <span class=\"comment\">// 判断sum是否有进位</span></span><br><span class=\"line\">        carry = sum / <span class=\"number\">10</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 创建新节点，并将头结点指向该节点</span></span><br><span class=\"line\">        p.next = <span class=\"keyword\">new</span> <span class=\"title class_\">ListNode</span>(sum % <span class=\"number\">10</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 移动两个链表</span></span><br><span class=\"line\">        p1 = p1 == <span class=\"literal\">null</span> ? <span class=\"literal\">null</span> : p1.next;</span><br><span class=\"line\">        p2 = p2 == <span class=\"literal\">null</span> ? <span class=\"literal\">null</span> : p2.next;</span><br><span class=\"line\">        <span class=\"comment\">// 移动头节点</span></span><br><span class=\"line\">        p = p.next;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 返回除去头部节点之外的链表结构</span></span><br><span class=\"line\">    <span class=\"comment\">// 这样返回还直接避免了相加的两个参数值为null的情况</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> dummyHead.next;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","categories":["数据结构与算法"],"tags":["LeetCode"]},{"title":"LeetCode：删除有序数组中的重复项","url":"/2021/06/17/algorithm/LeetCode%EF%BC%9A%E5%88%A0%E9%99%A4%E6%9C%89%E5%BA%8F%E6%95%B0%E7%BB%84%E4%B8%AD%E7%9A%84%E9%87%8D%E5%A4%8D%E9%A1%B9/","content":"<h2 id=\"题目\"><a href=\"#题目\" class=\"headerlink\" title=\"题目\"></a>题目</h2><blockquote>\n<p>给你一个有序数组 nums ，请你 原地 删除重复出现的元素，使每个元素 只出现一次 ，返回删除后数组的新长度。<br>不要使用额外的数组空间，你必须在 原地 修改输入数组 并在使用 O(1) 额外空间的条件下完成。 </p>\n</blockquote>\n<span id=\"more\"></span>\n<h2 id=\"审题\"><a href=\"#审题\" class=\"headerlink\" title=\"审题\"></a>审题</h2><p>这道题的重点有两个：</p>\n<p><strong>1、nums 是一个有序数组。</strong></p>\n<p>基于第一点，我们可以明白，一个指针从数组一侧移动到另一侧，一旦指针所指向的元素的值和上一个指针指向的元素的值不相等，那么该指针后面的所有元素都不会与该指针前面的元素相等，因为该数组是一个<code>有序</code>数组。</p>\n<p><strong>2、不能使用额外的内存空间，原地删除元素。</strong></p>\n<p>基于第二点，我们明白我们不能真正的删除元素，或者将元素移动到其他数组中，这也就意味着，我们只能在原数组中进行元素的移动，所以题目中的原地删除，本质上就是对数组元素的移动，从而达到一种“伪删除”的目的。</p>\n<h2 id=\"思路\"><a href=\"#思路\" class=\"headerlink\" title=\"思路\"></a>思路</h2><p>1、在数组上设置两个指针，指针 <code>i</code> 初始指向 <code>0</code> 位索引，指针 <code>j</code> 初始指向 <code>1</code> 位索引。</p>\n<p>2、我们向后移动 <code>j</code> 指针，如果 <code>j</code> 指向的元素不等于 <code>i</code> 指向的元素，我们就将 <code>j</code> 指针指向的元素复制到 <code>i + 1</code> 的索引位置上去。</p>\n<p>3、向后移动 <code>j</code> 指针，直到 <code>j</code> 指针指向数组最后一位元素。</p>\n<p>4、返回 <code>i</code> 指针指向的元素的索引 + 1，即为不重复元素的长度。</p>\n<h2 id=\"实现\"><a href=\"#实现\" class=\"headerlink\" title=\"实现\"></a>实现</h2><h4 id=\"实现一\"><a href=\"#实现一\" class=\"headerlink\" title=\"实现一\"></a>实现一</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\">   <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">removeDuplicates</span><span class=\"params\">(<span class=\"type\">int</span>[] nums)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>, j = <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (j &lt; nums.length) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (nums[i] != nums[j]) &#123;</span><br><span class=\"line\">                swap(nums, ++i, j);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            j++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> i + <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">swap</span><span class=\"params\">(<span class=\"type\">int</span>[] nums, <span class=\"type\">int</span> i, <span class=\"type\">int</span> j)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">temp</span> <span class=\"operator\">=</span> nums[i];</span><br><span class=\"line\">        nums[i] = nums[j];</span><br><span class=\"line\">        nums[j] = temp;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"实现二\"><a href=\"#实现二\" class=\"headerlink\" title=\"实现二\"></a>实现二</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">removeDuplicates</span><span class=\"params\">(<span class=\"type\">int</span>[] nums)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> <span class=\"number\">1</span>; j &lt; nums.length; j++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (nums[i] != nums[j]) &#123;</span><br><span class=\"line\">                swap(nums, ++i, j);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> i + <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">swap</span><span class=\"params\">(<span class=\"type\">int</span>[] nums, <span class=\"type\">int</span> i, <span class=\"type\">int</span> j)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">temp</span> <span class=\"operator\">=</span> nums[i];</span><br><span class=\"line\">        nums[i] = nums[j];</span><br><span class=\"line\">        nums[j] = temp;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"结果\"><a href=\"#结果\" class=\"headerlink\" title=\"结果\"></a>结果</h2><blockquote>\n<p>解答成功:<br>执行耗时:1 ms,击败了82.38% 的Java用户<br>内存消耗:39.9 MB,击败了95.36% 的Java用户</p>\n</blockquote>\n","categories":["数据结构与算法"],"tags":["LeetCode"]},{"title":"LeetCode：最接近的三数之和","url":"/2021/07/06/algorithm/LeetCode%EF%BC%9A%E6%9C%80%E6%8E%A5%E8%BF%91%E7%9A%84%E4%B8%89%E6%95%B0%E4%B9%8B%E5%92%8C/","content":"<h2 id=\"题目\"><a href=\"#题目\" class=\"headerlink\" title=\"题目\"></a>题目</h2><blockquote>\n<p>给定一个包括 n 个整数的数组 nums 和 一个目标值 target。找出 nums 中的三个整数，使得它们的和与 target 最接近。返回这三个数的和。假定每组输入只存在唯一答案。 </p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h2 id=\"审题\"><a href=\"#审题\" class=\"headerlink\" title=\"审题\"></a>审题</h2><p>从一个数组中拿出三个数，使得这三个数的和与目标值的差值最小，这三个数具有唯一解的性质。<br>该题如果使用暴力破解法，时间复杂度为 O(n^3)，这是一个比较糟糕的破解方式。</p>\n<h2 id=\"思路\"><a href=\"#思路\" class=\"headerlink\" title=\"思路\"></a>思路</h2><p>找出每个数组元素的另外两个最优解，使得这三个元素之和与目标值的差值达到最小。</p>\n<p>为了能够把握数组三个元素之和与目标值的大小，从而找到比当前三个元素更加合适的元素值，我们可以先对数组进行一次有序排序，这样就可以准确把握三个元素之和与目标值的大小关系。</p>\n<p>如果三数之和比目标值小，我们可以尝试往数组的右边找更大的元素来找寻更优解。<br>如果三数之和比目标值大，我们可以尝试往数组的左边找更小的元素来找寻更优解。</p>\n<h2 id=\"实现\"><a href=\"#实现\" class=\"headerlink\" title=\"实现\"></a>实现</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">threeSumClosest</span><span class=\"params\">(<span class=\"type\">int</span>[] nums, <span class=\"type\">int</span> target)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 首先对数组进行一次有序排序</span></span><br><span class=\"line\">        Arrays.sort(nums);</span><br><span class=\"line\">        <span class=\"type\">int</span> i, l, r, sum, n = nums.length;</span><br><span class=\"line\">        <span class=\"comment\">// 随便获取目标值和三位数的差绝对值</span></span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">result</span> <span class=\"operator\">=</span> nums[<span class=\"number\">0</span>] + nums[<span class=\"number\">1</span>] + nums[<span class=\"number\">2</span>];</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">cha</span> <span class=\"operator\">=</span> Math.abs(target - result), temCha;</span><br><span class=\"line\">        <span class=\"comment\">// 循环的最后一位是 [n-3], 最后三位相加 [n-3] + [n-2] + [n-1]</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; n - <span class=\"number\">2</span>; i++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 在循环过程中，如果当前循环的值和前一位值相等，就可以不用循环，因为值都是一样的，结果也就是一样的</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (i &gt; <span class=\"number\">0</span> &amp;&amp; nums[i] == nums[i - <span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// 获取当前循环的下一位元素</span></span><br><span class=\"line\">            l = i + <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"comment\">// 获取数组最后一位元素</span></span><br><span class=\"line\">            r = n - <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (l &lt; r) &#123;</span><br><span class=\"line\">                sum = nums[i] + nums[l] + nums[r];</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (sum == target) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> sum;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                temCha = Math.abs(target - sum);</span><br><span class=\"line\">                <span class=\"comment\">// 如果差值更小，将差值更小的和赋值给 result，并保存更小的差值</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (temCha &lt; cha) &#123;</span><br><span class=\"line\">                    result = sum;</span><br><span class=\"line\">                    cha = temCha;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"comment\">// 因为是有序数组，如果值太小，则尝试增加左边的值</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (sum &lt; target) &#123;</span><br><span class=\"line\">                    l++;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"comment\">// 因为是有序数组，如果值太小，则尝试减小右边的值</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (sum &gt; target) &#123;</span><br><span class=\"line\">                    r--;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"结果\"><a href=\"#结果\" class=\"headerlink\" title=\"结果\"></a>结果</h2><blockquote>\n<p>解答成功:<br>执行耗时:4 ms,击败了97.88% 的Java用户<br>内存消耗:38 MB,击败了64.64% 的Java用户</p>\n</blockquote>\n","categories":["数据结构与算法"],"tags":["LeetCode","链表","面试"]},{"title":"LeetCode：盛最多水的容器","url":"/2021/06/19/algorithm/LeetCode%EF%BC%9A%E7%9B%9B%E6%9C%80%E5%A4%9A%E6%B0%B4%E7%9A%84%E5%AE%B9%E5%99%A8/","content":"<h2 id=\"题目\"><a href=\"#题目\" class=\"headerlink\" title=\"题目\"></a>题目</h2><blockquote>\n<p>给你 n 个非负整数 a1，a2，…，an，每个数代表坐标中的一个点 (i, ai) 。在坐标内画 n 条垂直线，垂直线 i 的两个端点分别为 (i, ai) 和 (i, 0) 。找出其中的两条线，使得它们与 x 轴共同构成的容器可以容纳最多的水。<br>说明：你不能倾斜容器。 </p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h2 id=\"审题\"><a href=\"#审题\" class=\"headerlink\" title=\"审题\"></a>审题</h2><p>这道题目比较抽象，如果不结合手动绘图理解，还是比较难以读懂题目的。</p>\n<p><strong>将该题目转换为一道数学题，题目的大致含义是：</strong></p>\n<p>给出一个数组，该数组的索引是一个二维坐标的 x 轴坐标，该数组索引位置数组的具体值则为该二维坐标的 y 轴坐标，在二维坐标上找到该点后，经过该点作一条垂直于 x 轴的直线。<br>根据数组的元素个数 n ，一共可以作出 n 条垂直于 x 轴的直线，根据这些直线，找出这些直线中的任意两条直线所围成的最大的面积（也就是所谓的盛水最多的容器）。</p>\n<p><strong>补充</strong>：两条直线所围成的最大的面积和普通数学意义上的面积不同，因为这道题目中的本质是盛水，而水必须是水平的，所以在两条垂直直线中，我们必须选 y 轴坐标最小的那条为长度，作出一个正四方形。（题目中有说明，不能倾斜容器）</p>\n<p>也就是所谓的木桶效应，一个木桶所能盛的最多的水，取决于木桶最短的那块木板。</p>\n<h2 id=\"思路\"><a href=\"#思路\" class=\"headerlink\" title=\"思路\"></a>思路</h2><h4 id=\"双重循环\"><a href=\"#双重循环\" class=\"headerlink\" title=\"双重循环\"></a>双重循环</h4><p>在理解清楚本题的题意的时候，我第一时间想到的就是双重循环的解法，计算出每两条直线直接的面积取最大值，该两条直线所围成的木桶，即能够盛最多的水。</p>\n<p>从解题思路来说，双重循环的解法完全没有问题，但是当我按照该思路写出代码并提交之后，发现返回解法时间超出。</p>\n<p>从时间复杂度来说，双重循环的解法时间复杂度为 <code>O(n^2)</code> 级别的，很明显 <code>O(n^2)</code> 时间复杂度的解法并不能解出该题。</p>\n<h4 id=\"每条直线的最大面积\"><a href=\"#每条直线的最大面积\" class=\"headerlink\" title=\"每条直线的最大面积\"></a>每条直线的最大面积</h4><p>换一种思路，如果我们可以计算出每条直线理论上可以围成的最大面积，从这些面积中取最大值，就可以得到盛最多水的木桶。</p>\n<p>对于任意一条直线来说，它与另外一条直线能够围成的最大面积有两种情况：</p>\n<p>1、另外一条直线的 y 轴坐标大于该直线，这时当 x 轴坐标达到最大，即为该直线能够围成的最大面积。</p>\n<p>2、另外一条直线的 y 轴坐标小于该直线，因为无法确定另外一条直线的 y 轴高度，所以无法确定这两条直线所围成的面积是否即为最大面积。</p>\n<p>基于上面两点，我们可以先使两条直线在 x 轴上达到最大值，即一条直线在最左，一条直线在最右。因为两条直线的 y 轴高度总是相对的，即总是有一条直线的 y 轴高度大于等于另外一条直线的 y 轴高度，而对于 y 轴高度较小的那条直线而言，基于第一点推论，此时它的最大面积就已经得到了。</p>\n<h2 id=\"实现\"><a href=\"#实现\" class=\"headerlink\" title=\"实现\"></a>实现</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Solution</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">maxArea</span><span class=\"params\">(<span class=\"type\">int</span>[] height)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">max</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">l</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>, r = height.length - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (l &lt; r) &#123;</span><br><span class=\"line\">            max = Math.max(max, (r - l) * Math.min(height[l], height[r]));</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (height[l] &lt; height[r]) &#123;</span><br><span class=\"line\">                l++;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                r--;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> max;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"结果\"><a href=\"#结果\" class=\"headerlink\" title=\"结果\"></a>结果</h2><blockquote>\n<p>解答成功:<br>执行耗时:5 ms,击败了59.34% 的Java用户<br>内存消耗:51.8 MB,击败了68.37% 的Java用户</p>\n</blockquote>\n","categories":["数据结构与算法"],"tags":["LeetCode"]},{"title":"LeetCode：移除元素","url":"/2021/05/12/algorithm/LeetCode%EF%BC%9A%E7%A7%BB%E9%99%A4%E5%85%83%E7%B4%A0/","content":"<h2 id=\"题目\"><a href=\"#题目\" class=\"headerlink\" title=\"题目\"></a>题目</h2><blockquote>\n<p>给你一个数组 nums 和一个值 val，你需要 原地 移除所有数值等于 val 的元素，并返回移除后数组的新长度。<br>不要使用额外的数组空间，你必须仅使用 O(1) 额外空间并 原地 修改输入数组。<br>元素的顺序可以改变。你不需要考虑数组中超出新长度后面的元素。 </p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h2 id=\"示例\"><a href=\"#示例\" class=\"headerlink\" title=\"示例\"></a>示例</h2><blockquote>\n<p>示例 1：<br>输入：nums = [3,2,2,3], val = 3<br>输出：2, nums = [2,2]<br>解释：函数应该返回新的长度 2, 并且 nums 中的前两个元素均为 2。你不需要考虑数组中超出新长度后面的元素。例如，函数返回的新长度为 2 ，而 num<br>s = [2,2,3,3] 或 nums = [2,2,0,0]，也会被视作正确答案。</p>\n</blockquote>\n<h2 id=\"解答方案\"><a href=\"#解答方案\" class=\"headerlink\" title=\"解答方案\"></a>解答方案</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">removeElement</span><span class=\"params\">(<span class=\"type\">int</span>[] nums, <span class=\"type\">int</span> val)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">size</span> <span class=\"operator\">=</span> nums.length - <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt;= size; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (nums[i] == val) &#123;</span><br><span class=\"line\">            swap(nums, i, size);</span><br><span class=\"line\">            size--;</span><br><span class=\"line\">            i--;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> size + <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">swap</span><span class=\"params\">(<span class=\"type\">int</span>[] nums, <span class=\"type\">int</span> i, <span class=\"type\">int</span> j)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">temp</span> <span class=\"operator\">=</span> nums[i];</span><br><span class=\"line\">    nums[i] = nums[j];</span><br><span class=\"line\">    nums[j] = temp;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"运行结果\"><a href=\"#运行结果\" class=\"headerlink\" title=\"运行结果\"></a>运行结果</h2><blockquote>\n<p>解答成功: 执行耗时:0 ms,击败了100.00% 的Java用户 内存消耗:37 MB,击败了62.39% 的Java用户</p>\n</blockquote>\n","categories":["数据结构与算法"],"tags":["LeetCode"]},{"title":"七大排序算法的Python实现","url":"/2023/05/10/algorithm/%E4%B8%83%E5%A4%A7%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E7%9A%84Python%E5%AE%9E%E7%8E%B0/","content":"<p>今天使用 <code>Python</code> 实现了一遍七种常见的排序算法。</p>\n<span id=\"more\"></span>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> random, time</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 生成随机数组</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">generate_random_array</span>(<span class=\"params\">size, lrange, rrange</span>):</span><br><span class=\"line\">    <span class=\"keyword\">return</span> [random.randint(lrange, rrange) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(size)]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 判断数组是否顺序有序</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">is_order_asc</span>(<span class=\"params\">arr</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(arr) - <span class=\"number\">1</span>):</span><br><span class=\"line\">        <span class=\"keyword\">if</span> arr[i] &gt; arr[i + <span class=\"number\">1</span>]:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">False</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">True</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 排序算法装饰器</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">sort</span>(<span class=\"params\">name</span>):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">decoration</span>(<span class=\"params\">sort_func</span>):</span><br><span class=\"line\">        <span class=\"keyword\">def</span> <span class=\"title function_\">wrapper</span>(<span class=\"params\">*dargs, **dkw</span>):</span><br><span class=\"line\">            start_time = time.time()</span><br><span class=\"line\">            sort_func(*dargs, **dkw)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> is_order_asc(*dargs):</span><br><span class=\"line\">                <span class=\"built_in\">print</span>(name + <span class=\"string\">&#x27;：数组排序所需时间为:&#x27;</span> + <span class=\"built_in\">str</span>((time.time() - start_time) * <span class=\"number\">1000</span>) + <span class=\"string\">&#x27;毫秒&#x27;</span>)</span><br><span class=\"line\">            <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                <span class=\"built_in\">print</span>(name + <span class=\"string\">&#x27;：数组排序失败&#x27;</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> wrapper</span><br><span class=\"line\">    <span class=\"keyword\">return</span> decoration</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@sort(<span class=\"params\"><span class=\"string\">&#x27;冒泡排序&#x27;</span></span>)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">bubble_sort</span>(<span class=\"params\">arr</span>):</span><br><span class=\"line\">    length = <span class=\"built_in\">len</span>(arr)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(length - <span class=\"number\">1</span>):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(length - <span class=\"number\">1</span>):</span><br><span class=\"line\">            <span class=\"keyword\">if</span> arr[j + <span class=\"number\">1</span>] &lt; arr[j]:</span><br><span class=\"line\">                arr[j], arr[j + <span class=\"number\">1</span>] = arr[j + <span class=\"number\">1</span>], arr[j]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@sort(<span class=\"params\"><span class=\"string\">&#x27;选择排序&#x27;</span></span>)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">select_sort</span>(<span class=\"params\">arr</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(arr) - <span class=\"number\">1</span>):</span><br><span class=\"line\">        <span class=\"built_in\">min</span> = i</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(i + <span class=\"number\">1</span>,<span class=\"built_in\">len</span>(arr)):</span><br><span class=\"line\">            <span class=\"keyword\">if</span> arr[j] &lt; arr[<span class=\"built_in\">min</span>]:</span><br><span class=\"line\">                <span class=\"built_in\">min</span> = j</span><br><span class=\"line\">        arr[<span class=\"built_in\">min</span>], arr[i] = arr[i], arr[<span class=\"built_in\">min</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@sort(<span class=\"params\"><span class=\"string\">&#x27;插入排序&#x27;</span></span>)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">insert_sort</span>(<span class=\"params\">arr</span>):</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>, <span class=\"built_in\">len</span>(arr)):</span><br><span class=\"line\">        insert_value = arr[i]</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(i, -<span class=\"number\">1</span>, -<span class=\"number\">1</span>):</span><br><span class=\"line\">            <span class=\"keyword\">if</span> arr[j - <span class=\"number\">1</span>] &lt;= insert_value:</span><br><span class=\"line\">                <span class=\"keyword\">break</span></span><br><span class=\"line\">            arr[j] = arr[j - <span class=\"number\">1</span>]</span><br><span class=\"line\">        arr[j] = insert_value</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@sort(<span class=\"params\"><span class=\"string\">&#x27;希尔排序&#x27;</span></span>)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">shell_sort</span>(<span class=\"params\">arr</span>):</span><br><span class=\"line\">    h = <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> h * <span class=\"number\">3</span> + <span class=\"number\">1</span> &lt; <span class=\"built_in\">len</span>(arr):</span><br><span class=\"line\">        h = h * <span class=\"number\">3</span> + <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> h &gt; <span class=\"number\">0</span>:</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(h, <span class=\"built_in\">len</span>(arr)):</span><br><span class=\"line\">            insert_value = arr[i]</span><br><span class=\"line\">            <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(i, -<span class=\"number\">1</span>, -h):</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (arr[j - h] &lt;= insert_value):</span><br><span class=\"line\">                    <span class=\"keyword\">break</span></span><br><span class=\"line\">                arr[j] = arr[j - h]</span><br><span class=\"line\">            arr[j] = insert_value</span><br><span class=\"line\">        h = <span class=\"built_in\">int</span>((h - <span class=\"number\">1</span>) / <span class=\"number\">3</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@sort(<span class=\"params\"><span class=\"string\">&#x27;统计排序&#x27;</span></span>)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">count_sort</span>(<span class=\"params\">arr</span>):</span><br><span class=\"line\">    min_value = arr[<span class=\"number\">0</span>]</span><br><span class=\"line\">    max_value = arr[<span class=\"number\">0</span>]</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>, <span class=\"built_in\">len</span>(arr)):</span><br><span class=\"line\">        <span class=\"keyword\">if</span> arr[i] &gt; max_value:</span><br><span class=\"line\">            max_value = arr[i]</span><br><span class=\"line\">        <span class=\"keyword\">elif</span> arr[i] &lt; min_value:</span><br><span class=\"line\">            min_value = arr[i]</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            <span class=\"keyword\">pass</span></span><br><span class=\"line\">    count = [<span class=\"number\">0</span> <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(max_value - min_value + <span class=\"number\">1</span>)]</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> arr:</span><br><span class=\"line\">        count[i - min_value] += <span class=\"number\">1</span></span><br><span class=\"line\">    index = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(count)):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(count[i]):</span><br><span class=\"line\">            arr[index] = i + min_value</span><br><span class=\"line\">            index += <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@sort(<span class=\"params\"><span class=\"string\">&#x27;快速排序&#x27;</span></span>)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">quick_sort</span>(<span class=\"params\">arr</span>):</span><br><span class=\"line\">    quick(arr, <span class=\"number\">0</span>, <span class=\"built_in\">len</span>(arr) - <span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">quick</span>(<span class=\"params\">arr, start, end</span>):</span><br><span class=\"line\">    <span class=\"keyword\">if</span> start &gt;= end:</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    pivot_index = partition(arr, start, end)</span><br><span class=\"line\">    quick(arr, start, pivot_index - <span class=\"number\">1</span>)</span><br><span class=\"line\">    quick(arr, pivot_index + <span class=\"number\">1</span>, end)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">partition</span>(<span class=\"params\">arr, start, end</span>):</span><br><span class=\"line\">    pivot = arr[start]</span><br><span class=\"line\">    mark = start</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(start + <span class=\"number\">1</span>, end + <span class=\"number\">1</span>):</span><br><span class=\"line\">        <span class=\"keyword\">if</span> arr[i] &lt;= pivot:</span><br><span class=\"line\">            mark += <span class=\"number\">1</span></span><br><span class=\"line\">            arr[i], arr[mark] = arr[mark], arr[i]</span><br><span class=\"line\">    arr[start], arr[mark] = arr[mark], arr[start]</span><br><span class=\"line\">    <span class=\"keyword\">return</span> mark</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@sort(<span class=\"params\"><span class=\"string\">&#x27;归并排序&#x27;</span></span>)</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">merge_sort</span>(<span class=\"params\">arr</span>):</span><br><span class=\"line\">    merge_sort2(arr, <span class=\"number\">0</span>, <span class=\"built_in\">len</span>(arr) - <span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">merge_sort2</span>(<span class=\"params\">arr, start, end</span>):</span><br><span class=\"line\">    <span class=\"keyword\">if</span> start &gt;= end:</span><br><span class=\"line\">        <span class=\"keyword\">return</span></span><br><span class=\"line\">    middle = <span class=\"built_in\">int</span>((end - start) / <span class=\"number\">2</span>) + start</span><br><span class=\"line\">    merge_sort2(arr, start, middle)</span><br><span class=\"line\">    merge_sort2(arr, middle + <span class=\"number\">1</span>, end)</span><br><span class=\"line\">    merge(arr, start, middle, end)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">merge</span>(<span class=\"params\">arr, start, middle, end</span>):</span><br><span class=\"line\">    copy = [arr[i] <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(start, end + <span class=\"number\">1</span>)]</span><br><span class=\"line\">    left = start</span><br><span class=\"line\">    right = middle + <span class=\"number\">1</span></span><br><span class=\"line\">    index = start</span><br><span class=\"line\">    <span class=\"keyword\">while</span> left &lt;= middle <span class=\"keyword\">and</span> right &lt;= end:</span><br><span class=\"line\">        <span class=\"keyword\">if</span> copy[left - start] &lt;= copy[right - start]:</span><br><span class=\"line\">            arr[index] = copy[left - start]</span><br><span class=\"line\">            left+=<span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            arr[index] = copy[right - start]</span><br><span class=\"line\">            right+=<span class=\"number\">1</span></span><br><span class=\"line\">        index+=<span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> left &lt;= middle:</span><br><span class=\"line\">        arr[index] = copy[left - start]</span><br><span class=\"line\">        left+=<span class=\"number\">1</span></span><br><span class=\"line\">        index+=<span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> right &lt;= end:</span><br><span class=\"line\">        arr[index] = copy[right - start]</span><br><span class=\"line\">        right+=<span class=\"number\">1</span></span><br><span class=\"line\">        index+=<span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&#x27;__main__&#x27;</span>:</span><br><span class=\"line\">    bubble_sort(generate_random_array(<span class=\"number\">10000</span>, <span class=\"number\">0</span>, <span class=\"number\">1000000</span>))</span><br><span class=\"line\">    select_sort(generate_random_array(<span class=\"number\">10000</span>, <span class=\"number\">0</span>, <span class=\"number\">1000000</span>))</span><br><span class=\"line\">    insert_sort(generate_random_array(<span class=\"number\">10000</span>, <span class=\"number\">0</span>, <span class=\"number\">1000000</span>))</span><br><span class=\"line\">    shell_sort(generate_random_array(<span class=\"number\">10000</span>, <span class=\"number\">0</span>, <span class=\"number\">1000000</span>))</span><br><span class=\"line\">    count_sort(generate_random_array(<span class=\"number\">10000</span>, <span class=\"number\">50</span>, <span class=\"number\">100</span>))</span><br><span class=\"line\">    quick_sort(generate_random_array(<span class=\"number\">10000</span>, <span class=\"number\">0</span>, <span class=\"number\">1000000</span>))</span><br><span class=\"line\">    merge_sort(generate_random_array(<span class=\"number\">10000</span>, <span class=\"number\">0</span>, <span class=\"number\">1000000</span>))</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p>最后附上一份 <code>Java</code> 和 <code>Python</code> 执行同样的排序逻辑的消耗时间对比。</p>\n<ul>\n<li>数据规模为 <code>10000</code> </li>\n<li>时间单位为毫秒</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>算法</th>\n<th>Java</th>\n<th>Python</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>冒泡排序</td>\n<td>179</td>\n<td>13996</td>\n</tr>\n<tr>\n<td>选择排序</td>\n<td>46</td>\n<td>3955</td>\n</tr>\n<tr>\n<td>插入排序</td>\n<td>15</td>\n<td>4074</td>\n</tr>\n<tr>\n<td>希尔排序</td>\n<td>3</td>\n<td>63</td>\n</tr>\n<tr>\n<td>统计排序</td>\n<td>1</td>\n<td>2</td>\n</tr>\n<tr>\n<td>快速排序</td>\n<td>3</td>\n<td>23</td>\n</tr>\n<tr>\n<td>归并排序</td>\n<td>3</td>\n<td>52</td>\n</tr>\n</tbody></table>\n","categories":["数据结构与算法"],"tags":["排序算法","Python"]},{"title":"排序算法之快速排序","url":"/2021/04/17/algorithm/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E4%B9%8B%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F/","content":"<h1 id=\"什么是快速排序\"><a href=\"#什么是快速排序\" class=\"headerlink\" title=\"什么是快速排序\"></a>什么是快速排序</h1><p>和冒泡排序一样，快速排序也属于交换排序，通过元素直接的比较和交换位置来达到排序的目的。</p>\n<span id=\"more\"></span>\n<p>快速排序的思想是：<strong>在每一轮挑选一个基准元素，并让其他比它大的元素移动到数的一边，比它小的元素移动到数列的另一边，从而把数列拆解成两个部分。</strong></p>\n<p>这种思想就叫做<strong>分治法</strong>。</p>\n<h2 id=\"基准元素的选择\"><a href=\"#基准元素的选择\" class=\"headerlink\" title=\"基准元素的选择\"></a>基准元素的选择</h2><p>基准元素（pivot），在分治过程中，以基准元素为中心，要把其他元素移动到它的左右两边。</p>\n<p>那么如何选择基准元素呢？</p>\n<h3 id=\"选择数组的第一个元素\"><a href=\"#选择数组的第一个元素\" class=\"headerlink\" title=\"选择数组的第一个元素\"></a>选择数组的第一个元素</h3><p>这种方法是最简单，而且在绝大多数的情况都不会出现问题。但是如果有一个逆序的数列，期望排成顺序的数列，使用快速排序的时候，会出现一种最坏的情况。</p>\n<p>由于这个数组原本是逆序的，在选择基准元素之后，由于确定的基准元素都是在数组的边界位置，永远都是比其他元素大，或者比其他元素小，这样一来，快速排序就会退化为一种 O(n^2) 级别的排序。</p>\n<h3 id=\"随机选择一个元素\"><a href=\"#随机选择一个元素\" class=\"headerlink\" title=\"随机选择一个元素\"></a>随机选择一个元素</h3><p>为了解决上述情况可能出现的最坏情况，可以使用随机选择一个数组元素最为基准元素，并让选中的基准元素和数组的第一个元素进行位置交换即可。</p>\n<p>当然，随机选择一个元素的方法可以尽量避免快速排序出现最坏的情况，但是仍然有可能会出现极端的情况。</p>\n<p>所以快速排序的平均时间复杂度为 O(nlogn)，但最坏情况下的时间复杂度为 O(n^2)。</p>\n<h2 id=\"算法实现\"><a href=\"#算法实现\" class=\"headerlink\" title=\"算法实现\"></a>算法实现</h2><p>选中基准元素之后，就可以进行数组的元素交换操作了，就是将比基准元素小的元素放在基准元素左边，比基准元素大的元素放在基准元素右边。</p>\n<h3 id=\"双边循坏法\"><a href=\"#双边循坏法\" class=\"headerlink\" title=\"双边循坏法\"></a>双边循坏法</h3><p>1、选中基准元素（pivot），并将排序的数组最左边和最右边的元素索引设为 left 和 right。</p>\n<p>2、从 right 指针开始向左索引，如果指针指向的元素大于等于基准元素，则继续向左边移动，如果元素比基准元素小，则 right 指针停止移动。</p>\n<p>3、从 left 指针开始向右索引，如果指针指向的元素小于等于基准元素，则继续向右边移动，如果元素比基准元素大，则 left 指针停止移动。</p>\n<p>4、交换 left 和 right 索引位置的元素。</p>\n<p>5、从之前停止的 left 和 right 指针的位置，继续重复 2、3 步骤，直到 left 指针等于 right 指针，停止索引。</p>\n<p>6、交换 left 和 pivot 指针的元素。</p>\n<p>7、根据基准元素的位置，将数组一分为二，并继续从第一步开始执行，直到所有元素有序。</p>\n<ul>\n<li>代码实现</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">    SortRunner.run(SortUtils.generateRandomArray(<span class=\"number\">10000</span>, <span class=\"number\">100</span>, <span class=\"number\">100000</span>),</span><br><span class=\"line\">            (arr) -&gt; &#123;</span><br><span class=\"line\">                quickSort(arr, <span class=\"number\">0</span>, arr.length - <span class=\"number\">1</span>);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">quickSort</span><span class=\"params\">(<span class=\"type\">int</span>[] arr, <span class=\"type\">int</span> startIndex, <span class=\"type\">int</span> endIndex)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (startIndex &gt;= endIndex) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">pivotIndex</span> <span class=\"operator\">=</span> partition(arr, startIndex, endIndex);</span><br><span class=\"line\">    <span class=\"comment\">// 7、根据基准元素的位置，将数组一分为二，并继续从第一步开始执行，直到所有元素有序。</span></span><br><span class=\"line\">    quickSort(arr, startIndex, pivotIndex - <span class=\"number\">1</span>);</span><br><span class=\"line\">    quickSort(arr, pivotIndex + <span class=\"number\">1</span>, endIndex);</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">partition</span><span class=\"params\">(<span class=\"type\">int</span>[] arr, <span class=\"type\">int</span> startIndex, <span class=\"type\">int</span> endIndex)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 1、选中基准元素（pivot），并将排序的数组最左边和最右边的元素索引设为 left 和 right。</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">pivot</span> <span class=\"operator\">=</span> arr[startIndex];</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">left</span> <span class=\"operator\">=</span> startIndex;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">right</span> <span class=\"operator\">=</span> endIndex;</span><br><span class=\"line\">    <span class=\"comment\">// 5、从之前停止的 left 和 right 指针的位置，继续重复 2、3 步骤，直到 left 指针等于 right 指针，停止索引。</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (left != right) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 2、从 right 指针开始向左索引，如果指针指向的元素大于等于基准元素，则继续向左边移动，如果元素比基准元素小，则 right 指针停止移动。</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (left &lt; right &amp;&amp; arr[right] &gt; pivot) &#123;</span><br><span class=\"line\">            right--;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 3、从 left 指针开始向右索引，如果指针指向的元素小于等于基准元素，则继续向右边移动，如果元素比基准元素大，则 left 指针停止移动。</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (left &lt; right &amp;&amp; arr[left] &lt;= pivot) &#123;</span><br><span class=\"line\">            left++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">//  4、交换 left 和 right 索引位置的元素。</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (left &lt; right) &#123;</span><br><span class=\"line\">            SortUtils.swap(arr, left, right);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 6、交换 left 和 pivot 指针的元素。</span></span><br><span class=\"line\">    SortUtils.swap(arr, startIndex, left);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> left;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h3 id=\"单边循环法\"><a href=\"#单边循环法\" class=\"headerlink\" title=\"单边循环法\"></a>单边循环法</h3><p>1、选中基准元素（pivot），并将数组的第一个元素索引设为 mark，mark 指针代表小于基准元素的边界。</p>\n<p>2、从基准元素的下一个位置开始遍历数组，如果遍历到的元素大于基准元素，则继续向后遍历。</p>\n<p>3、如果遍历到的元素小于基准元素，将 mark 指针的位置向后移动一位，并交换 mark 指针指向的元素和当前遍历到的元素的位置。</p>\n<p>4、遍历结束后，交换 pivot 和 mark 指针的位置。</p>\n<p>5、根据基准元素的位置，将数组一分为二，并继续从第一步开始执行，直到所有元素有序。</p>\n<ul>\n<li>代码实现</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">    SortRunner.run(SortUtils.generateRandomArray(<span class=\"number\">10000</span>, <span class=\"number\">100</span>, <span class=\"number\">100000</span>),</span><br><span class=\"line\">            (arr) -&gt; &#123;</span><br><span class=\"line\">                quickSort(arr, <span class=\"number\">0</span>, arr.length - <span class=\"number\">1</span>);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">quickSort</span><span class=\"params\">(<span class=\"type\">int</span>[] arr, <span class=\"type\">int</span> startIndex, <span class=\"type\">int</span> endIndex)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (startIndex &gt;= endIndex) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">pivotIndex</span> <span class=\"operator\">=</span> partition(arr, startIndex, endIndex);</span><br><span class=\"line\">    <span class=\"comment\">// 5、根据基准元素的位置，将数组一分为二，并继续从第一步开始执行，直到所有元素有序。</span></span><br><span class=\"line\">    quickSort(arr, startIndex, pivotIndex - <span class=\"number\">1</span>);</span><br><span class=\"line\">    quickSort(arr, pivotIndex + <span class=\"number\">1</span>, endIndex);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">partition</span><span class=\"params\">(<span class=\"type\">int</span>[] arr, <span class=\"type\">int</span> startIndex, <span class=\"type\">int</span> endIndex)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 1、选中基准元素（pivot），并将数组的第一个元素索引设为 mark，mark 指针代表小于基准元素的边界。</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">pivot</span> <span class=\"operator\">=</span> arr[startIndex];</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">mark</span> <span class=\"operator\">=</span> startIndex;</span><br><span class=\"line\">    <span class=\"comment\">// 2、从基准元素的下一个位置开始遍历数组，如果遍历到的元素大于基准元素，则继续向后遍历。</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> startIndex + <span class=\"number\">1</span>; i &lt;= endIndex; i++) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 3、如果遍历到的元素小于基准元素，将 mark 指针的位置向后移动一位，并交换 mark 指针指向的元素和当前遍历到的元素的位置。</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (arr[i] &lt; pivot) &#123;</span><br><span class=\"line\">            mark++;</span><br><span class=\"line\">            SortUtils.swap(arr, mark, i);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 4、遍历结束后，交换 pivot 和 mark 指针的位置。</span></span><br><span class=\"line\">    SortUtils.swap(arr, startIndex, mark);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> mark;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"非递归实现\"><a href=\"#非递归实现\" class=\"headerlink\" title=\"非递归实现\"></a>非递归实现</h3><p>递归的本质就是一个方法通过不同参数调用自身，在 Java 虚拟机的表现本质上就是将方法进行压栈，执行完成之后进行出栈操作。</p>\n<p>所以快速排序的非递归实现可以使用一个栈来进行代替。</p>\n<p>1、创建一个栈，将数组的开始索引和结束索引压入栈中。</p>\n<p>2、取出栈顶的元素，通过数组的开始索引和结束索引，对该范围内的数组元素进行排序，获取基准元素。</p>\n<p>3、根据基准元素的位置，将数组一分为二，并将切分的数组的开始索引和结束索引压入栈中。</p>\n<p>4、轮询栈，只要栈内元素不为空，继续执行，否则停止程序。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">    SortRunner.run(SortUtils.generateRandomArray(<span class=\"number\">10000</span>, <span class=\"number\">100</span>, <span class=\"number\">100000</span>),</span><br><span class=\"line\">            (arr) -&gt; &#123;</span><br><span class=\"line\">                quickSort(arr, <span class=\"number\">0</span>, arr.length - <span class=\"number\">1</span>);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">quickSort</span><span class=\"params\">(<span class=\"type\">int</span>[] arr, <span class=\"type\">int</span> startIndex, <span class=\"type\">int</span> endIndex)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 1、创建一个栈，将数组的开始索引和结束索引压入栈中。</span></span><br><span class=\"line\">    Stack&lt;Map&lt;String, Integer&gt;&gt; stack = <span class=\"keyword\">new</span> <span class=\"title class_\">Stack</span>&lt;&gt;();</span><br><span class=\"line\">    Map&lt;String, Integer&gt; map = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;();</span><br><span class=\"line\">    map.put(<span class=\"string\">&quot;start&quot;</span>, startIndex);</span><br><span class=\"line\">    map.put(<span class=\"string\">&quot;end&quot;</span>, endIndex);</span><br><span class=\"line\">    stack.push(map);</span><br><span class=\"line\">    <span class=\"comment\">// 4、轮询栈，只要栈内元素不为空，继续执行，否则停止程序。</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (!stack.isEmpty()) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 2、取出栈顶的元素，通过数组的开始索引和结束索引，对该范围内的数组元素进行排序，获取基准元素。</span></span><br><span class=\"line\">        Map&lt;String, Integer&gt; pop = stack.pop();</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">start</span> <span class=\"operator\">=</span> pop.get(<span class=\"string\">&quot;start&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">end</span> <span class=\"operator\">=</span> pop.get(<span class=\"string\">&quot;end&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">pivotIndex</span> <span class=\"operator\">=</span> partition(arr, start, end);</span><br><span class=\"line\">        <span class=\"comment\">// 3、根据基准元素的位置，将数组一分为二，并将切分的数组的开始索引和结束索引压入栈中。</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (start &lt; pivotIndex - <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            Map&lt;String, Integer&gt; leftParam = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;();</span><br><span class=\"line\">            leftParam.put(<span class=\"string\">&quot;start&quot;</span>, start);</span><br><span class=\"line\">            leftParam.put(<span class=\"string\">&quot;end&quot;</span>, pivotIndex - <span class=\"number\">1</span>);</span><br><span class=\"line\">            stack.push(leftParam);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (end &gt; pivotIndex + <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            Map&lt;String, Integer&gt; rightParam = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;();</span><br><span class=\"line\">            rightParam.put(<span class=\"string\">&quot;start&quot;</span>, pivotIndex + <span class=\"number\">1</span>);</span><br><span class=\"line\">            rightParam.put(<span class=\"string\">&quot;end&quot;</span>, end);</span><br><span class=\"line\">            stack.push(rightParam);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">partition</span><span class=\"params\">(<span class=\"type\">int</span>[] arr, <span class=\"type\">int</span> startIndex, <span class=\"type\">int</span> endIndex)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">pivot</span> <span class=\"operator\">=</span> arr[startIndex];</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">left</span> <span class=\"operator\">=</span> startIndex;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">right</span> <span class=\"operator\">=</span> endIndex;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (left != right) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (left &lt; right &amp;&amp; arr[right] &gt; pivot) &#123;</span><br><span class=\"line\">            right--;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (left &lt; right &amp;&amp; arr[left] &lt;= pivot) &#123;</span><br><span class=\"line\">            left++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (left &lt; right) &#123;</span><br><span class=\"line\">            SortUtils.swap(arr, left, right);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    SortUtils.swap(arr, startIndex, left);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> left;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h1><blockquote>\n<p>本文<strong>Github</strong> <a href=\"https://github.com/herenpeng/code-learn\">https://github.com/herenpeng/code-learn</a> 已收录，欢迎<strong>Star</strong>。</p>\n</blockquote>\n","categories":["数据结构与算法"],"tags":["排序算法"]},{"title":"排序算法之聊聊你所不知道的冒泡排序","url":"/2021/03/27/algorithm/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E4%B9%8B%E8%81%8A%E8%81%8A%E4%BD%A0%E6%89%80%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F/","content":"<h1 id=\"什么是冒泡排序\"><a href=\"#什么是冒泡排序\" class=\"headerlink\" title=\"什么是冒泡排序\"></a>什么是冒泡排序</h1><p>冒泡排序是一种基础的交换排序，其思想是，把相邻的元素两两比较，当一个元素大于右侧相邻的元素时，交换它们的位置：当一个元素小于或等于右侧的元素时，位置不变。</p>\n<span id=\"more\"></span>\n\n<p>冒泡排序是一种稳定排序，值相等的元素并不会打乱原有的顺序，由于该排序算法的每一轮都要遍历元素，总共遍历（元素数量 - 1）轮，所以平均时间复杂度是O(n^2)。</p>\n<h1 id=\"工欲善其事，必先利其器\"><a href=\"#工欲善其事，必先利其器\" class=\"headerlink\" title=\"工欲善其事，必先利其器\"></a>工欲善其事，必先利其器</h1><p>在讲述冒泡排序之前，我们先来搭建一个简单的排序算法编写的环境，这个环境可以帮助我们更加方便地编写和测试排序算法。</p>\n<h2 id=\"SortUtils\"><a href=\"#SortUtils\" class=\"headerlink\" title=\"SortUtils\"></a>SortUtils</h2><blockquote>\n<p>一个排序算法的工具类，其中包含了排序算法编写和测试的一些基本操作。</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">SortUtils</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 随机生成一个整形数组</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> size   数组大小</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> rangeL 数组左边范围（包含）</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> rangeR 数组右边范围（包含）</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 一个整形数组</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span>[] generateRandomArray(<span class=\"type\">int</span> size, <span class=\"type\">int</span> rangeL, <span class=\"type\">int</span> rangeR) &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span>[] arr = <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[size];</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; size; i++) &#123;</span><br><span class=\"line\">            arr[i] = (<span class=\"type\">int</span>) (Math.random() * (rangeR - rangeL + <span class=\"number\">1</span>)) + rangeL;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> arr;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 生成一个近乎有序的整形数组</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> size      数组大小</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> swapTimes 将有序数组打乱次数</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 一个近乎有序的整形数组</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span>[] generateAlmostOrderlyArray(<span class=\"type\">int</span> size, <span class=\"type\">int</span> swapTimes) &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span>[] arr = <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[size];</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; size; i++) &#123;</span><br><span class=\"line\">            arr[i] = i;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; swapTimes; i++) &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">index1</span> <span class=\"operator\">=</span> (<span class=\"type\">int</span>) (Math.random() * size);</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">index2</span> <span class=\"operator\">=</span> (<span class=\"type\">int</span>) (Math.random() * size);</span><br><span class=\"line\">            swap(arr, index1, index2);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> arr;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 判断一个数组是否有序，有序返回true，无序返回false</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> arr 数组</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 是否有序</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">boolean</span> <span class=\"title function_\">isOrderly</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> isOrderAsc(arr) || isOrderDesc(arr);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 判断一个数组是否顺序有序，有序返回true，无序返回false</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> arr 数组</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 是否有序</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">boolean</span> <span class=\"title function_\">isOrderAsc</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; arr.length - <span class=\"number\">1</span>; i++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (arr[i] &gt; arr[i + <span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 判断一个数组是否倒序有序，有序返回true，无序返回false</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> arr 数组</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 是否有序</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">boolean</span> <span class=\"title function_\">isOrderDesc</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> arr.length - <span class=\"number\">1</span>; i &gt; <span class=\"number\">0</span>; i--) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (arr[i] &gt; arr[i - <span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 拷贝一个整形数组</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> arr 整形数组</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 新的整形数组</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span>[] copyIntArray(<span class=\"type\">int</span>[] arr) &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span>[] copyArr = <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[arr.length];</span><br><span class=\"line\">        System.arraycopy(arr, <span class=\"number\">0</span>, copyArr, <span class=\"number\">0</span>, arr.length);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> copyArr;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 交换数组中的两个索引的位置</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> arr 整形数组</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> i   第一个索引</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> j   第二个索引</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">swap</span><span class=\"params\">(<span class=\"type\">int</span>[] arr, <span class=\"type\">int</span> i, <span class=\"type\">int</span> j)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">temp</span> <span class=\"operator\">=</span> arr[i];</span><br><span class=\"line\">        arr[i] = arr[j];</span><br><span class=\"line\">        arr[j] = temp;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 打印数组</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> arr 整形数组</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">printArray</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i : arr) &#123;</span><br><span class=\"line\">            System.out.print(i + <span class=\"string\">&quot;\\t&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Sort函数式接口\"><a href=\"#Sort函数式接口\" class=\"headerlink\" title=\"Sort函数式接口\"></a>Sort函数式接口</h2><blockquote>\n<p>一个基于 JDK8 Lambda 特性的函数式接口，所以该排序算法环境的搭建基于 JDK8+ 的版本。</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@FunctionalInterface</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">Sort</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 排序方法</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> arr 数组</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">sort</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"SortRunner\"><a href=\"#SortRunner\" class=\"headerlink\" title=\"SortRunner\"></a>SortRunner</h2><blockquote>\n<p>SortRunner 中有用于运行 Sort 函数式接口的方法，可以在该类的方法下编写一些特定的操作，用于辅助排序算法编写和测试。</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">SortRunner</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 运行排序算法的方法</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> arr  一个数组</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> sort Sort函数式接口</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">(<span class=\"type\">int</span>[] arr, Sort sort)</span> &#123;</span><br><span class=\"line\">        System.out.print(<span class=\"string\">&quot;数组排序前：&quot;</span>);</span><br><span class=\"line\">        SortUtils.printArray(arr);</span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">startTime</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        sort.sort(arr);</span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">endTime</span> <span class=\"operator\">=</span> System.currentTimeMillis();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (SortUtils.isOrderly(arr)) &#123;</span><br><span class=\"line\">            System.out.print(<span class=\"string\">&quot;数组排序后：&quot;</span>);</span><br><span class=\"line\">            SortUtils.printArray(arr);</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;数组排序所需时间为：&quot;</span> + (endTime - startTime) + <span class=\"string\">&quot;毫秒&quot;</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;数组排序失败&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"冒泡排序\"><a href=\"#冒泡排序\" class=\"headerlink\" title=\"冒泡排序\"></a>冒泡排序</h1><h2 id=\"普通冒泡排序\"><a href=\"#普通冒泡排序\" class=\"headerlink\" title=\"普通冒泡排序\"></a>普通冒泡排序</h2><p>普通的冒泡排序是把相邻的元素两两比较，直到所有元素都比较结束为止</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">System.out.println(<span class=\"string\">&quot;普通冒泡排序&quot;</span>);</span><br><span class=\"line\">SortRunner.run(SortUtils.generateRandomArray(<span class=\"number\">10000</span>, <span class=\"number\">100</span>, <span class=\"number\">100000</span>),</span><br><span class=\"line\">        (arr) -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; arr.length - <span class=\"number\">1</span>; i++) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; j &lt; arr.length - i - <span class=\"number\">1</span>; j++) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (arr[j] &gt; arr[j + <span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">                        SortUtils.swap(arr, j, j + <span class=\"number\">1</span>);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br></pre></td></tr></table></figure>\n\n<p>这是最为常见的冒泡排序，编写简单，易于理解，但是在一些特殊情况下，可能会浪费一些性能。</p>\n<p>比如排序到 n - i 轮的时候，这是遍历数组，发现数组已经有序了，剩下的 i -1 轮其实已经可以不进行遍历了。</p>\n<p>所以我们可以对冒泡排序进行一些优化。</p>\n<h2 id=\"布尔类型变量判断有序\"><a href=\"#布尔类型变量判断有序\" class=\"headerlink\" title=\"布尔类型变量判断有序\"></a>布尔类型变量判断有序</h2><p>这种冒泡排序的思想是，在每一轮遍历数组前，设置一个变量用于标识数组有序，如果在该轮中，数组相邻的元素之间发生了交换，则说明此时数组仍处于无序状态，反之则有序。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 布尔类型变量判断有序优化冒泡排序</span></span><br><span class=\"line\">System.out.println(<span class=\"string\">&quot;布尔类型变量判断有序优化冒泡排序&quot;</span>);</span><br><span class=\"line\">SortRunner.run(SortUtils.generateRandomArray(<span class=\"number\">10000</span>, <span class=\"number\">100</span>, <span class=\"number\">100000</span>),</span><br><span class=\"line\">        (arr) -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; arr.length - <span class=\"number\">1</span>; i++) &#123;</span><br><span class=\"line\">                <span class=\"type\">boolean</span> <span class=\"variable\">isSorted</span> <span class=\"operator\">=</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; j &lt; arr.length - i - <span class=\"number\">1</span>; j++) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (arr[j] &gt; arr[j + <span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">                        SortUtils.swap(arr, j, j + <span class=\"number\">1</span>);</span><br><span class=\"line\">                        isSorted = <span class=\"literal\">false</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (isSorted) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"无序边界值\"><a href=\"#无序边界值\" class=\"headerlink\" title=\"无序边界值\"></a>无序边界值</h2><p>布尔类型变量判断有序优化冒泡排序，本质上是减少了冒泡排序的轮数，可以让冒泡排序轮询 &lt;= n - 1 次，但是对于每一轮交换的元素个数，依然是固定的。</p>\n<p>但是有的时候，每一轮交换元素的时候，可能交换 n - i 次，数组后段的元素其实就已经有序了，这时继续向后遍历比较是无用的。</p>\n<p>所以为了解决这种情况，可以使用无序边界来优化冒泡排序</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 无序边界值优化冒泡排序</span></span><br><span class=\"line\">System.out.println(<span class=\"string\">&quot;无序边界值优化冒泡排序&quot;</span>);</span><br><span class=\"line\">SortRunner.run(SortUtils.generateRandomArray(<span class=\"number\">10000</span>, <span class=\"number\">100</span>, <span class=\"number\">100000</span>),</span><br><span class=\"line\">        (arr) -&gt; &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">lastExchangeIndex</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">sortBorder</span> <span class=\"operator\">=</span> arr.length - <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; arr.length - <span class=\"number\">1</span>; i++) &#123;</span><br><span class=\"line\">                <span class=\"type\">boolean</span> <span class=\"variable\">isSorted</span> <span class=\"operator\">=</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; j &lt; sortBorder; j++) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (arr[j] &gt; arr[j + <span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">                        SortUtils.swap(arr, j, j + <span class=\"number\">1</span>);</span><br><span class=\"line\">                        isSorted = <span class=\"literal\">false</span>;</span><br><span class=\"line\">                        lastExchangeIndex = j;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                sortBorder = lastExchangeIndex;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (isSorted) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"鸡尾酒排序\"><a href=\"#鸡尾酒排序\" class=\"headerlink\" title=\"鸡尾酒排序\"></a>鸡尾酒排序</h2><p>在一些特殊情况下，比如对一些近似有序的数组进行排序的时候，可以考虑用鸡尾酒排序来对数据进行排序。</p>\n<p>鸡尾酒排序的思想是：在冒泡排序比较元素和交换的过程中，使用双向遍历比较和交换元素。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 鸡尾酒排序</span></span><br><span class=\"line\">System.out.println(<span class=\"string\">&quot;鸡尾酒排序&quot;</span>);</span><br><span class=\"line\">SortRunner.run(SortUtils.generateRandomArray(<span class=\"number\">10000</span>, <span class=\"number\">100</span>, <span class=\"number\">100000</span>),</span><br><span class=\"line\">        (arr) -&gt; &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; arr.length / <span class=\"number\">2</span>; i++) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 奇数轮，从左往右排序</span></span><br><span class=\"line\">                <span class=\"type\">boolean</span> <span class=\"variable\">isSorted</span> <span class=\"operator\">=</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> i; j &lt; arr.length - i - <span class=\"number\">1</span>; j++) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (arr[j] &gt; arr[j + <span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">                        SortUtils.swap(arr, j, j + <span class=\"number\">1</span>);</span><br><span class=\"line\">                        isSorted = <span class=\"literal\">false</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (isSorted) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">// 偶数轮，从右往左毕竟</span></span><br><span class=\"line\">                isSorted = <span class=\"literal\">true</span>;</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> arr.length - i - <span class=\"number\">1</span>; j &gt; i; j--) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (arr[j] &lt; arr[j - <span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">                        SortUtils.swap(arr, j, j - <span class=\"number\">1</span>);</span><br><span class=\"line\">                        isSorted = <span class=\"literal\">false</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (isSorted) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"左右无序边界值\"><a href=\"#左右无序边界值\" class=\"headerlink\" title=\"左右无序边界值\"></a>左右无序边界值</h2><blockquote>\n<p>鸡尾酒排序同样可以使用无序边界值的方法对算法进行优化，不过因为鸡尾酒排序是双向的，所以无序值也是有左右两个。</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 左右无序边界值优化鸡尾酒排序</span></span><br><span class=\"line\">System.out.println(<span class=\"string\">&quot;左右无序边界值优化鸡尾酒排序&quot;</span>);</span><br><span class=\"line\">SortRunner.run(SortUtils.generateRandomArray(<span class=\"number\">10000</span>, <span class=\"number\">100</span>, <span class=\"number\">100000</span>),</span><br><span class=\"line\">        (arr) -&gt; &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 左边最后进行元素交换的索引位置</span></span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">leftExchangeIndex</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"comment\">// 左边界</span></span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">leftSortBorder</span> <span class=\"operator\">=</span> leftExchangeIndex;</span><br><span class=\"line\">            <span class=\"comment\">// 右边最后进行元素交换的索引位置</span></span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">rightExchangeIndex</span> <span class=\"operator\">=</span> arr.length - <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"comment\">// 右边界</span></span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">rightSortBorder</span> <span class=\"operator\">=</span> rightExchangeIndex;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; arr.length / <span class=\"number\">2</span>; i++) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 奇数轮，从左往右排序</span></span><br><span class=\"line\">                <span class=\"type\">boolean</span> <span class=\"variable\">isSorted</span> <span class=\"operator\">=</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> i; j &lt; rightSortBorder; j++) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (arr[j] &gt; arr[j + <span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">                        SortUtils.swap(arr, j, j + <span class=\"number\">1</span>);</span><br><span class=\"line\">                        isSorted = <span class=\"literal\">false</span>;</span><br><span class=\"line\">                        rightExchangeIndex = j;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                rightSortBorder = rightExchangeIndex;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (isSorted) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">// 偶数轮，从右往左毕竟</span></span><br><span class=\"line\">                isSorted = <span class=\"literal\">true</span>;</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> arr.length - i - <span class=\"number\">1</span>; j &gt; leftSortBorder; j--) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (arr[j] &lt; arr[j - <span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">                        SortUtils.swap(arr, j, j - <span class=\"number\">1</span>);</span><br><span class=\"line\">                        isSorted = <span class=\"literal\">false</span>;</span><br><span class=\"line\">                        leftExchangeIndex = j;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                leftSortBorder = leftExchangeIndex;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (isSorted) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"鸡尾酒排序的效率\"><a href=\"#鸡尾酒排序的效率\" class=\"headerlink\" title=\"鸡尾酒排序的效率\"></a>鸡尾酒排序的效率</h2><p>数组长度：100000</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>冒泡排序</th>\n<th>鸡尾酒排序</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>无序数组</td>\n<td>27412毫秒</td>\n<td>12868毫秒</td>\n</tr>\n<tr>\n<td>近似有序</td>\n<td>13962毫秒</td>\n<td>43毫秒</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p>以上的测试数据仅仅为简单测试，具体情况请自行测试，另外，如果排序数组长度过长，建议修改 SortRunner.run() 方法，去掉一些无用的操作步骤，减少排序测试的总体时长</p>\n</blockquote>\n<h1 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h1><blockquote>\n<p>本文<strong>Github</strong> <a href=\"https://github.com/herenpeng/code-learn\">https://github.com/herenpeng/code-learn</a> 已收录，欢迎<strong>Star</strong>。</p>\n</blockquote>\n","categories":["数据结构与算法"],"tags":["排序算法"]},{"title":"排序算法之计数排序","url":"/2021/04/18/algorithm/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E4%B9%8B%E8%AE%A1%E6%95%B0%E6%8E%92%E5%BA%8F/","content":"<h1 id=\"什么是计数排序\"><a href=\"#什么是计数排序\" class=\"headerlink\" title=\"什么是计数排序\"></a>什么是计数排序</h1><p>计数排序是一种利用数组下标来确定元素的正确位置的排序算法。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"算法实现\"><a href=\"#算法实现\" class=\"headerlink\" title=\"算法实现\"></a>算法实现</h2><p>1、根据数组中最大的元素的值 length，创建一个额外的长度为 length + 1 的数组，该数组的初始值均为 0。</p>\n<p>2、遍历原数组，通过原数组的值，找到新开辟的数组的位置，将该位置的元素值进行 +1 操作。</p>\n<p>3、遍历新数组，新数组中，下标标索引代表了原数组的元素的值，下标索引对应的值代表了原数组的元素出现的次数。</p>\n<h3 id=\"计数排序的基本实现\"><a href=\"#计数排序的基本实现\" class=\"headerlink\" title=\"计数排序的基本实现\"></a>计数排序的基本实现</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">    SortRunner.run(SortUtils.generateRandomArray(<span class=\"number\">10000</span>, <span class=\"number\">100</span>, <span class=\"number\">1000</span>),</span><br><span class=\"line\">            (arr) -&gt; &#123;</span><br><span class=\"line\">                countSort(arr);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">countSort</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">max</span> <span class=\"operator\">=</span> arr[<span class=\"number\">0</span>];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">1</span>; i &lt; arr.length; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (arr[i] &gt; max) &#123;</span><br><span class=\"line\">            max = arr[i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 统计每个元素的个数</span></span><br><span class=\"line\">    <span class=\"type\">int</span>[] countArray = <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[max + <span class=\"number\">1</span>];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class=\"line\">        countArray[arr[i]]++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 通过元素个数，输入所有元素</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">index</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; countArray.length; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; j &lt; countArray[i]; j++) &#123;</span><br><span class=\"line\">            arr[index++] = i;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"计数排序优化\"><a href=\"#计数排序优化\" class=\"headerlink\" title=\"计数排序优化\"></a>计数排序优化</h3><p>在上述的计数排序中，有一个问题，就是原数组的最小值是 100，最大值是 1000，而用于计数的数组长度开辟为 length + 1，这样一来，计数数组 0-99 的索引空间就被浪费了。</p>\n<p>所以可以对计数排序进行一些优化，获取数组的最小值，作为计数数组的偏移量，用于计算整数在计数数组中的下标。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">    SortRunner.run(SortUtils.generateRandomArray(<span class=\"number\">10000</span>, <span class=\"number\">100</span>, <span class=\"number\">1000</span>),</span><br><span class=\"line\">            (arr) -&gt; &#123;</span><br><span class=\"line\">                countSort(arr);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">countSort</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">max</span> <span class=\"operator\">=</span> arr[<span class=\"number\">0</span>];</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">min</span> <span class=\"operator\">=</span> arr[<span class=\"number\">0</span>];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">1</span>; i &lt; arr.length; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (arr[i] &gt; max) &#123;</span><br><span class=\"line\">            max = arr[i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (arr[i] &lt; min) &#123;</span><br><span class=\"line\">            min = arr[i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 统计每个元素的个数</span></span><br><span class=\"line\">    <span class=\"type\">int</span>[] countArray = <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[max - min + <span class=\"number\">1</span>];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class=\"line\">        countArray[arr[i] - min]++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 通过元素个数，输入所有元素</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">index</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; countArray.length; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; j &lt; countArray[i]; j++) &#123;</span><br><span class=\"line\">            arr[index++] = i + min;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"稳定排序\"><a href=\"#稳定排序\" class=\"headerlink\" title=\"稳定排序\"></a>稳定排序</h3><p>什么是稳定排序？</p>\n<p>稳定排序是指，在需要排序的元素之中，值相同的元素可以保持原本的相对位置，这种排序就被称作稳定排序。</p>\n<p>上述的计数排序并不是稳定排序，可以通过再次进行优化，而使计数排序变成一种稳定排序。</p>\n<p>为了使计数排序变成稳定排序，需要对计数数组进行变形，从计数数组的第二个元素开始，每一个元素都加上前面所有元素之和。</p>\n<p>这样做的目的是使得计数数组的元素值，由原本对应的整数的个数，变成对应整数的最终排序的序号。</p>\n<p>计数数组变形之和，从后往前遍历原数组，将原数组找到计数数组的值，从而将元素放入一个新的数组中，并将计数数组对应的值 -1。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">    SortRunner.run(SortUtils.generateRandomArray(<span class=\"number\">10000</span>, <span class=\"number\">100</span>, <span class=\"number\">1000</span>),</span><br><span class=\"line\">            (arr) -&gt; &#123;</span><br><span class=\"line\">                countSort(arr);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">countSort</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">max</span> <span class=\"operator\">=</span> arr[<span class=\"number\">0</span>];</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">min</span> <span class=\"operator\">=</span> arr[<span class=\"number\">0</span>];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">1</span>; i &lt; arr.length; i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (arr[i] &gt; max) &#123;</span><br><span class=\"line\">            max = arr[i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (arr[i] &lt; min) &#123;</span><br><span class=\"line\">            min = arr[i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 统计每个元素的个数</span></span><br><span class=\"line\">    <span class=\"type\">int</span>[] countArray = <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[max - min + <span class=\"number\">1</span>];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class=\"line\">        countArray[arr[i] - min]++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 变形</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">1</span>; i &lt; countArray.length; i++) &#123;</span><br><span class=\"line\">        countArray[i] += countArray[i - <span class=\"number\">1</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span>[] sortArray = <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[arr.length];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> arr.length - <span class=\"number\">1</span>; i &gt;= <span class=\"number\">0</span>; i--) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 获取排序的序号</span></span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">sort</span> <span class=\"operator\">=</span> countArray[arr[i] - min];</span><br><span class=\"line\">        <span class=\"comment\">// 索引 = 序号-1</span></span><br><span class=\"line\">        sortArray[sort - <span class=\"number\">1</span>] = arr[i];</span><br><span class=\"line\">        countArray[arr[i] - min]--;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    System.arraycopy(sortArray, <span class=\"number\">0</span>, arr, <span class=\"number\">0</span>, arr.length);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"计数排序的复杂度\"><a href=\"#计数排序的复杂度\" class=\"headerlink\" title=\"计数排序的复杂度\"></a>计数排序的复杂度</h2><p>元素数组的规模为 n，最大和最小整数的差值是 m，则计数排序的时间复杂度和空间复杂度为：</p>\n<p>时间复杂度为：O(n+m)</p>\n<p>空间复杂度为：O(m)</p>\n<h2 id=\"计数排序的局限性\"><a href=\"#计数排序的局限性\" class=\"headerlink\" title=\"计数排序的局限性\"></a>计数排序的局限性</h2><p>计数排序的速度非常快，但是有一定的局限性。</p>\n<p>1、当原始数组的规模最大值和最小值差距过大时，计数排序并不适用，因为差值过大的时候，会严重浪费空间，而且计数数组过大，也会增加时间复杂度。</p>\n<p>2、当原始数组的值不是整数的时候，也不适用计数排序，因为计数排序需要通过值来找到对应的索引，而小数找不到对应的索引。</p>\n<h1 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h1><blockquote>\n<p>本文<strong>Github</strong> <a href=\"https://github.com/herenpeng/code-learn\">https://github.com/herenpeng/code-learn</a> 已收录，欢迎<strong>Star</strong>。</p>\n</blockquote>\n","categories":["数据结构与算法"],"tags":["排序算法"]},{"title":"数据结构——栈与队列（Java实现）","url":"/2020/02/14/algorithm/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E2%80%94%E2%80%94%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97%EF%BC%88Java%E5%AE%9E%E7%8E%B0%EF%BC%89/","content":"<h1 id=\"什么是栈与队列？\"><a href=\"#什么是栈与队列？\" class=\"headerlink\" title=\"什么是栈与队列？\"></a>什么是栈与队列？</h1><ul>\n<li>栈是一种特殊的线性表结构，数据在栈中，只能从栈顶进入，也只能从栈顶弹出，具有<strong>先进后出</strong>的特点。</li>\n<li>队列也是一种特殊的线性表结构，数据在队列中，只能从队列的最后存入队列，数据移出只能从队列的最前面取出，具有<strong>先进先出，后进后出</strong>的特点。<span id=\"more\"></span>\n【<strong>循环队列</strong>】循环队列是一种特殊的队列，在满足普通队列的基础上，解决了普通队列因为取出数据而造成空间浪费的情况，它维护了队列的队首和队尾索引，使索引在越界时能够从新返回初始化。</li>\n</ul>\n<h2 id=\"栈的实现（Java）\"><a href=\"#栈的实现（Java）\" class=\"headerlink\" title=\"栈的实现（Java）\"></a>栈的实现（Java）</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *     数据栈，Java实现</span></span><br><span class=\"line\"><span class=\"comment\"> *         数据栈是一种特殊的线性表结构，</span></span><br><span class=\"line\"><span class=\"comment\"> *         所有数据只能从栈顶插入，也只能从栈顶取出</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> hrp</span></span><br><span class=\"line\"><span class=\"comment\"> * 2020年2月14日 上午11:33:59</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyStack</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span>[] arr;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> maxSize;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> top;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *     指定栈的大小，初始化栈</span></span><br><span class=\"line\"><span class=\"comment\">     *         maxSize：栈的最大容量</span></span><br><span class=\"line\"><span class=\"comment\">     *         top：栈顶数据的索引</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> size</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">MyStack</span><span class=\"params\">(<span class=\"type\">int</span> size)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.maxSize = size;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.arr = <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[maxSize];</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.top = -<span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *     压栈，将数据从栈顶压入栈中，维护top索引</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> value</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">push</span><span class=\"params\">(<span class=\"type\">int</span> value)</span> &#123;</span><br><span class=\"line\">        arr[++top] = value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *     弹出，将数据中栈顶弹出，维护top索引</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">pop</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> arr[top--];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *     判断栈是否为空，直接比较top==-1</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">isEmpty</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> top == -<span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *     判断栈是否满了，直接比较top==(maxSize-1)</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">isFull</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> top == maxSize - <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *     打印栈，循环次数为top+1</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">printStack</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt;= top; i++) &#123;</span><br><span class=\"line\">            System.out.print(arr[i]+<span class=\"string\">&quot;\\t&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println();</span><br><span class=\"line\">    &#125;    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"循环队列的实现（Java）\"><a href=\"#循环队列的实现（Java）\" class=\"headerlink\" title=\"循环队列的实现（Java）\"></a>循环队列的实现（Java）</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *     循环队列，Java实现</span></span><br><span class=\"line\"><span class=\"comment\"> *         队列是一种特殊的线性表结构，</span></span><br><span class=\"line\"><span class=\"comment\"> *         它只允许在表的前端进行删除操作，在表的后端进行添加操作 </span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> hrp</span></span><br><span class=\"line\"><span class=\"comment\"> * 2020年2月14日 上午10:46:57</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyQueue</span> &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span>[] arr;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> maxSize;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> elems;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> font;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> end;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *     指定队列的大小，初始化队列</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> size</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">MyQueue</span><span class=\"params\">(<span class=\"type\">int</span> size)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.maxSize = size;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.arr = <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[maxSize];</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.elems = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.font = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.end = -<span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *     插入操作，如果此时end索引已经到达最后了，将索引维护为-1，在执行插入操作</span></span><br><span class=\"line\"><span class=\"comment\">     *         同时判断队列是否满了，如果队列未满，则elems++，如果满了，则覆盖最前面的值，font++</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> value</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">insert</span><span class=\"params\">(<span class=\"type\">int</span> value)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(end == maxSize - <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            end = -<span class=\"number\">1</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        arr[++end] = value;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(elems &lt; maxSize) &#123;</span><br><span class=\"line\">            elems++;</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            font++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *     移除操作，先判断font是否已经超出了数组索引范围，是则重新维护索引</span></span><br><span class=\"line\"><span class=\"comment\">     *         首先队列长度elems--，并将font索引是指返回，同时维护索引位置</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">remove</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(font == maxSize) &#123;</span><br><span class=\"line\">            font = <span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        elems--;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> arr[font++];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *     判断队列是否为空，直接比较队列的elems属性是否为0</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">isEmpty</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.elems == <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *     判断队列是否满了，直接比较队列的elems属性和MaxSize的值是否相等</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">isFull</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.elems == maxSize;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *     打印队列，已知循环次数为队列长度，打印次数为elems</span></span><br><span class=\"line\"><span class=\"comment\">     *         注意：不应该直接使用font作为数组索引进行打印，</span></span><br><span class=\"line\"><span class=\"comment\">     *         因为在++过程中会破坏数组font索引的正确性</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">printQueue</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">index</span> <span class=\"operator\">=</span> font;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; elems; i++) &#123;</span><br><span class=\"line\">            System.out.print(arr[index++]+<span class=\"string\">&quot;\\t&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(index == maxSize) &#123;</span><br><span class=\"line\">                index = <span class=\"number\">0</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","categories":["数据结构与算法"],"tags":["数据结构","Java","栈","队列"]},{"title":"数据结构与算法-排序算法辅助工具编写与三种基本排序算法（Java实现）","url":"/2020/01/11/algorithm/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95-%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E8%BE%85%E5%8A%A9%E5%B7%A5%E5%85%B7%E7%BC%96%E5%86%99%E4%B8%8E%E4%B8%89%E7%A7%8D%E5%9F%BA%E6%9C%AC%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%EF%BC%88Java%E5%AE%9E%E7%8E%B0%EF%BC%89/","content":"<p>初学者刚刚接触算法的时候，可以通过编写一些辅助的工具来辅助算法的学习。</p>\n<span id=\"more\"></span>\n\n<h1 id=\"一、排序算法辅助工具类\"><a href=\"#一、排序算法辅助工具类\" class=\"headerlink\" title=\"一、排序算法辅助工具类\"></a>一、排序算法辅助工具类</h1><h2 id=\"1-随机生成一个整形数组\"><a href=\"#1-随机生成一个整形数组\" class=\"headerlink\" title=\"1. 随机生成一个整形数组\"></a>1. 随机生成一个整形数组</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *     随机生成一个整形数组</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> size        数组大小</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> rangeL    数组左边范围（包含）</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> rangeR    数组右边范围（包含）</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span>[] generateRandomArray(<span class=\"type\">int</span> size,<span class=\"type\">int</span> rangeL,<span class=\"type\">int</span> rangeR) &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span>[] arr = <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[size];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;i &lt; size;i++) &#123;</span><br><span class=\"line\">        arr[i] = (<span class=\"type\">int</span>) (Math.random() * (rangeR-rangeL+<span class=\"number\">1</span>)) + rangeL;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> arr;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-生成一个近乎有序的整形数组\"><a href=\"#2-生成一个近乎有序的整形数组\" class=\"headerlink\" title=\"2. 生成一个近乎有序的整形数组\"></a>2. 生成一个近乎有序的整形数组</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 生成一个近乎有序的整形数组</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> size        数组大小</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> swapTimes    将有序数组打乱次数</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span>[] generateAlmostOrderlyArray(<span class=\"type\">int</span> size,<span class=\"type\">int</span> swapTimes) &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span>[] arr = <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[size];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;i&lt;size;i++) &#123;</span><br><span class=\"line\">        arr[i] = i;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;i &lt; swapTimes;i++) &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">index1</span> <span class=\"operator\">=</span> (<span class=\"type\">int</span>) Math.random()*size;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">index2</span> <span class=\"operator\">=</span> (<span class=\"type\">int</span>) Math.random()*size;</span><br><span class=\"line\">        swap(arr,index1,index2);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> arr;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-判断一个数组是否正反皆有序\"><a href=\"#3-判断一个数组是否正反皆有序\" class=\"headerlink\" title=\"3. 判断一个数组是否正反皆有序\"></a>3. 判断一个数组是否正反皆有序</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 判断一个数组是否有序，有序返回true，无序返回false</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> arr    整形数组</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">boolean</span> <span class=\"title function_\">isOrderly</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(isOrderAsc(arr) || isOrderDesc(arr)) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 判断一个数组是否顺序有序，有序返回true，无序返回false</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> arr</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">boolean</span> <span class=\"title function_\">isOrderAsc</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> i=<span class=\"number\">0</span>;i &lt; arr.length-<span class=\"number\">1</span>;i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(arr[i] &gt; arr[i+<span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 判断一个数组是否倒序有序，有序返回true，无序返回false</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> arr</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">boolean</span> <span class=\"title function_\">isOrderDesc</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> arr.length-<span class=\"number\">1</span>; i &gt; <span class=\"number\">0</span>; i--) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(arr[i] &gt; arr[i-<span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-拷贝一个整形数组\"><a href=\"#4-拷贝一个整形数组\" class=\"headerlink\" title=\"4. 拷贝一个整形数组\"></a>4. 拷贝一个整形数组</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 拷贝一个整形数组</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> arr    整形数组</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span>[] copyIntArray(<span class=\"type\">int</span>[] arr) &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span>[] copyArr = <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[arr.length];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;i &lt; arr.length; i++) &#123;</span><br><span class=\"line\">        copyArr[i] = arr[i];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> copyArr;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"5-交换数组中的两个索引的位置\"><a href=\"#5-交换数组中的两个索引的位置\" class=\"headerlink\" title=\"5. 交换数组中的两个索引的位置\"></a>5. 交换数组中的两个索引的位置</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 交换数组中的两个索引的位置</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> arr    整形数组</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> i        第一个索引</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> j        第二个索引</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">swap</span><span class=\"params\">(<span class=\"type\">int</span>[] arr, <span class=\"type\">int</span> i, <span class=\"type\">int</span> j)</span>&#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">temp</span> <span class=\"operator\">=</span> arr[i];</span><br><span class=\"line\">    arr[i] = arr[j];</span><br><span class=\"line\">    arr[j] = temp;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"6-打印数组\"><a href=\"#6-打印数组\" class=\"headerlink\" title=\"6. 打印数组\"></a>6. 打印数组</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *     打印数组</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> arr    整形数组</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">printArray</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> i : arr) &#123;</span><br><span class=\"line\">        System.out.print(i+<span class=\"string\">&quot;\\t&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    System.out.println();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"二、三种基本排序算法\"><a href=\"#二、三种基本排序算法\" class=\"headerlink\" title=\"二、三种基本排序算法\"></a>二、三种基本排序算法</h1><h2 id=\"1-冒泡排序\"><a href=\"#1-冒泡排序\" class=\"headerlink\" title=\"1. 冒泡排序\"></a>1. 冒泡排序</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 冒泡排序</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> arr    整形数组</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">bubbleSort</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;i &lt; arr.length-<span class=\"number\">1</span>;i++) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;j &lt; arr.length-<span class=\"number\">1</span>;j++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(arr[j+<span class=\"number\">1</span>] &lt; arr[j]) &#123;</span><br><span class=\"line\">                SortTestUtils.swap(arr, j+<span class=\"number\">1</span>, j);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-选择排序\"><a href=\"#2-选择排序\" class=\"headerlink\" title=\"2. 选择排序\"></a>2. 选择排序</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 选择排序</span></span><br><span class=\"line\"><span class=\"comment\"> *         -选择一个最小的数，插入最左边</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> arr    整形数组</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">selectSort</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;i &lt; arr.length-<span class=\"number\">1</span>;i++) &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">min</span> <span class=\"operator\">=</span> i;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> i+<span class=\"number\">1</span>;j &lt; arr.length;j++) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(arr[j] &lt; arr[min]) &#123;</span><br><span class=\"line\">                min = j;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        SortTestUtils.swap(arr, i, min);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3-插入排序\"><a href=\"#3-插入排序\" class=\"headerlink\" title=\"3. 插入排序\"></a>3. 插入排序</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 插入排序</span></span><br><span class=\"line\"><span class=\"comment\"> *         -随机选一个数，插入到合适的位置</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> arr    整形数组</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">insertSort</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">1</span>; i &lt; arr.length; i++) &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">insertValue</span> <span class=\"operator\">=</span> arr[i];</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(j = i;j &gt; <span class=\"number\">0</span> &amp;&amp; arr[j-<span class=\"number\">1</span>] &gt; insertValue; j--) &#123;</span><br><span class=\"line\">            arr[j] = arr[j-<span class=\"number\">1</span>]; </span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        arr[j] = insertValue;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n","categories":["数据结构与算法"],"tags":["排序算法","数据结构","Java"]},{"title":"数据结构与算法——希尔排序（Java实现）","url":"/2020/02/18/algorithm/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E2%80%94%E2%80%94%E5%B8%8C%E5%B0%94%E6%8E%92%E5%BA%8F%EF%BC%88Java%E5%AE%9E%E7%8E%B0%EF%BC%89/","content":"<p>希尔排序是插入排序的一个变种排序算法，由D.L.Shell在1959年提出，所以命名为希尔排序。</p>\n<span id=\"more\"></span>\n<p>插入排序是一个时间复杂度为O(n^2)级别的不稳定的排序算法，之所以说它的不稳定的，是因为插入排序在处理近乎有序的数组的时候，排序效率会非常快，而在处理完全无序的数组的时候，排序效率则为N平方级别。<br>希尔排序就是为了解决插入排序在处理完全无序的数组时效率过慢而诞生的优秀算法。<br>希尔排序是思想是，在插入排序的基础上，对插入数组的索引的间隔进行扩大，这个间隔大小为 h。<br>h的最小值为1，最大值为h*3+1小于数组长度。</p>\n<ul>\n<li>希尔排序（Java实现）<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">shellsort</span><span class=\"params\">(<span class=\"type\">int</span>[] arr)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">h</span> <span class=\"operator\">=</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>((h*<span class=\"number\">3</span>+<span class=\"number\">1</span>) &lt; arr.length) &#123;</span><br><span class=\"line\">        h = h*<span class=\"number\">3</span>+<span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(h &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> h; i &lt; arr.length; i++) &#123;</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">insertValue</span> <span class=\"operator\">=</span> arr[i];</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">j</span> <span class=\"operator\">=</span> i;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(j = i; j &gt; h-<span class=\"number\">1</span> &amp;&amp; arr[j-h] &gt; insertValue; j = j-h ) &#123;</span><br><span class=\"line\">                arr[j] = arr[j-h];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            arr[j] = insertValue;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        h = (h-<span class=\"number\">1</span>)/<span class=\"number\">3</span>;</span><br><span class=\"line\">    &#125;    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n","categories":["数据结构与算法"],"tags":["排序算法"]},{"title":"数据结构之什么是二叉堆？","url":"/2021/03/06/algorithm/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B9%8B%E4%BB%80%E4%B9%88%E6%98%AF%E4%BA%8C%E5%8F%89%E5%A0%86/","content":"<h1 id=\"什么是二叉堆？\"><a href=\"#什么是二叉堆？\" class=\"headerlink\" title=\"什么是二叉堆？\"></a>什么是二叉堆？</h1><p>二叉堆本质上是一种完全二叉树，它分为两个类型：</p>\n<ul>\n<li>最大堆</li>\n<li>最小堆<span id=\"more\"></span>\n\n</li>\n</ul>\n<p>什么是最大堆？</p>\n<p>最大堆的任何一个父节点的值，都大于或等于它的左、右孩子节点的值。</p>\n<p>什么是最小堆？</p>\n<p>最小堆的任何一个父节点的值，都小于或等于它的左、右孩子节点的值。</p>\n<p>二叉堆的根节点叫做堆顶。<br>最大堆和最小堆的特点决定了：最大堆的堆顶是整个堆中的最大元素，最小堆的堆顶是整个堆中的最小元素。</p>\n<h1 id=\"二叉堆的自我调整\"><a href=\"#二叉堆的自我调整\" class=\"headerlink\" title=\"二叉堆的自我调整\"></a>二叉堆的自我调整</h1><p>二叉堆的操作都基于堆的自我调整。所谓堆的自我调整，就是把一个不符合堆性质的完全二叉树，调整为一个堆。</p>\n<blockquote>\n<p>本篇文章中是以最小堆为例子讲述的。</p>\n</blockquote>\n<h2 id=\"插入节点\"><a href=\"#插入节点\" class=\"headerlink\" title=\"插入节点\"></a>插入节点</h2><p>当二叉堆插入节点时，插入的位置是二叉堆的最后一个位置，可以将新插入的节点和它的父节点进行对比，如果新节点比父节点小，就需要让新节点“<strong>上浮</strong>”，和父节点交换位置。</p>\n<p>然后继续和父节点比较大小，直到父节点比当前节点的值小为止。</p>\n<h2 id=\"删除节点\"><a href=\"#删除节点\" class=\"headerlink\" title=\"删除节点\"></a>删除节点</h2><p>当二叉堆删除节点时，所删除的节点是对于堆顶的节点。</p>\n<p>然后将堆的最后一个节点补到堆顶的位置，然后对堆顶的位置的节点进行“<strong>下沉</strong>”操作</p>\n<h1 id=\"构建二叉堆\"><a href=\"#构建二叉堆\" class=\"headerlink\" title=\"构建二叉堆\"></a>构建二叉堆</h1><p>构建二叉堆，是通过一个无序的完全二叉树，对所有非叶子节点进行依次“下沉”操作，这样就得到了一个最小二叉堆。</p>\n<h2 id=\"最小二叉堆的实现\"><a href=\"#最小二叉堆的实现\" class=\"headerlink\" title=\"最小二叉堆的实现\"></a>最小二叉堆的实现</h2><p>二叉堆虽然是一个完全二叉堆，但是它并不是链式存储，而是顺序存储，也就是说，二叉堆是通过数组实现的。</p>\n<p>在数组中，在没有左、右孩子节点指针的情况下，可以通过数组下标的计算来得到一个节点的左右孩子节点。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">       <span class=\"number\">1</span></span><br><span class=\"line\">     /   \\</span><br><span class=\"line\">    <span class=\"number\">4</span>     <span class=\"number\">8</span></span><br><span class=\"line\">   /  \\  / \\</span><br><span class=\"line\">  <span class=\"number\">10</span>  <span class=\"number\">7</span>  <span class=\"number\">9</span>  <span class=\"number\">13</span></span><br><span class=\"line\"> / \\</span><br><span class=\"line\"><span class=\"number\">11</span>  <span class=\"number\">19</span></span><br></pre></td></tr></table></figure>\n\n<p>如上图中的最小堆，在数组中的存储位置为：</p>\n<table>\n<tr>\n<td>1</td>\n<td>4</td>\n<td>8</td>\n<td>10</td>\n<td>7</td>\n<td>9</td>\n<td>13</td>\n<td>11</td>\n<td>19</td>\n</tr>\n<tr>\n<td>0</td>\n<td>1</td>\n<td>2</td>\n<td>3</td>\n<td>4</td>\n<td>5</td>\n<td>6</td>\n<td>7</td>\n<td>8</td>\n</tr>\n</table>\n\n<p>如果一个节点的数组下标为<code>current</code>，则该节点的左孩子节点下标为<code>2 * current + 1</code>，该节点的右孩子节点下标为<code>2 * current + 2</code>，该节点的父节点下标为<code>(current - 1) / 2</code>。</p>\n<h2 id=\"最小堆的构建\"><a href=\"#最小堆的构建\" class=\"headerlink\" title=\"最小堆的构建\"></a>最小堆的构建</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MinHeap</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 用于存储二叉堆的数组</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer[] array;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 当前二叉堆的最大节点个数，即数组长度</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> maxSize;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 当前二叉堆的节点个数</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> size;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取数组的实际元素个数</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 数组的实际元素个数</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">size</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.size;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取数组的长度</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 数组的长度</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">length</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.maxSize;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 最小堆的构造函数</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> arr 数组</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">MinHeap</span><span class=\"params\">(Integer[] arr)</span> &#123;</span><br><span class=\"line\">        buildMinHeap(arr);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 构建最小堆</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> arr 数组</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">buildMinHeap</span><span class=\"params\">(Integer[] arr)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.size = arr.length;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.maxSize = arr.length;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.array = arr;</span><br><span class=\"line\">        <span class=\"comment\">// 获取最后一个节点的下标</span></span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">lastIndex</span> <span class=\"operator\">=</span> arr.length - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 从最后一个非叶子节点开始进行下沉</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> getParentIndex(lastIndex); i &gt;= <span class=\"number\">0</span>; i--) &#123;</span><br><span class=\"line\">            downAdjust(i);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 通过孩子节点下标，获取父节点下标</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> childIndex 孩子节点下标</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 父节点下标</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> <span class=\"title function_\">getParentIndex</span><span class=\"params\">(<span class=\"type\">int</span> childIndex)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 通过取余数的方式，直接获取左右孩子节点的父节点</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> (childIndex - <span class=\"number\">1</span>) / <span class=\"number\">2</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 通过父节点下标，获取左孩子节点下标</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> parentIndex 父节点下标</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 左孩子节点下标</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> <span class=\"title function_\">getLeftChildIndex</span><span class=\"params\">(<span class=\"type\">int</span> parentIndex)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">2</span> * parentIndex + <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 通过父节点下标，获取右孩子节点下标</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> parentIndex 父节点下标</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 右孩子节点下标</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> <span class=\"title function_\">getRightChildIndex</span><span class=\"params\">(<span class=\"type\">int</span> parentIndex)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">2</span> * parentIndex + <span class=\"number\">2</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"最小堆插入节点并上浮\"><a href=\"#最小堆插入节点并上浮\" class=\"headerlink\" title=\"最小堆插入节点并上浮\"></a>最小堆插入节点并上浮</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 在堆的末尾插入一个数据</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> data 数值</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">insert</span><span class=\"params\">(<span class=\"type\">int</span> data)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (size &gt;= maxSize) &#123;</span><br><span class=\"line\">        resize();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.array[<span class=\"built_in\">this</span>.size++] = data;</span><br><span class=\"line\">    upAdjust();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 数组扩容操作</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">resize</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 新数组的长度为原数组的2倍</span></span><br><span class=\"line\">    <span class=\"built_in\">this</span>.maxSize = <span class=\"built_in\">this</span>.maxSize * <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"comment\">// 初始化新数组</span></span><br><span class=\"line\">    Integer[] newArray = <span class=\"keyword\">new</span> <span class=\"title class_\">Integer</span>[maxSize];</span><br><span class=\"line\">    <span class=\"comment\">// 将原数组的元素复制到新数组中</span></span><br><span class=\"line\">    System.arraycopy(<span class=\"built_in\">this</span>.array, <span class=\"number\">0</span>, newArray, <span class=\"number\">0</span>, <span class=\"built_in\">this</span>.size);</span><br><span class=\"line\">    <span class=\"comment\">// 使用新数组替换原数组</span></span><br><span class=\"line\">    <span class=\"built_in\">this</span>.array = newArray;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 上浮操作</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">upAdjust</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 数组最后一个节点所在的下标，即需要上浮的节点</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">currentIndex</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.size - <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">parentIndex</span> <span class=\"operator\">=</span> getParentIndex(currentIndex);</span><br><span class=\"line\">    <span class=\"comment\">// 将当前孩子节点使用临时变量保存</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">temp</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.array[currentIndex];</span><br><span class=\"line\">    <span class=\"comment\">// 如果当前孩子节点的下标大于0，并且当前孩子节点的值小于父节点的值</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (currentIndex &gt; <span class=\"number\">0</span> &amp;&amp; temp &lt; <span class=\"built_in\">this</span>.array[parentIndex]) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 将父节点的值和当前孩子节点的值进行交换</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.array[currentIndex] = <span class=\"built_in\">this</span>.array[parentIndex];</span><br><span class=\"line\">        <span class=\"comment\">// 将当前孩子节点的值修改为之前的父节点的值</span></span><br><span class=\"line\">        currentIndex = parentIndex;</span><br><span class=\"line\">        <span class=\"comment\">// 维护父节点的下标</span></span><br><span class=\"line\">        parentIndex = getParentIndex(currentIndex);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.array[currentIndex] = temp;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"最小堆删除节点并下沉\"><a href=\"#最小堆删除节点并下沉\" class=\"headerlink\" title=\"最小堆删除节点并下沉\"></a>最小堆删除节点并下沉</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 移除堆顶的元素</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> 堆顶的元素</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Integer <span class=\"title function_\">remove</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">this</span>.size == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">Integer</span> <span class=\"variable\">removeData</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.array[<span class=\"number\">0</span>];</span><br><span class=\"line\">    <span class=\"comment\">// 获取最后一个节点</span></span><br><span class=\"line\">    <span class=\"built_in\">this</span>.array[<span class=\"number\">0</span>] = <span class=\"built_in\">this</span>.array[size - <span class=\"number\">1</span>];</span><br><span class=\"line\">    downAdjust(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.array[--size] = <span class=\"literal\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> removeData;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 下沉操作</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> parentIndex 需要下沉的节点下标</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">downAdjust</span><span class=\"params\">(<span class=\"type\">int</span> parentIndex)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 获取左孩子节点的下标</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">childIndex</span> <span class=\"operator\">=</span> getLeftChildIndex(parentIndex);</span><br><span class=\"line\">    <span class=\"comment\">// 将需要下沉的节点使用临时变量保存</span></span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">temp</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.array[parentIndex];</span><br><span class=\"line\">    <span class=\"comment\">// 如果左孩子节点的下标还在堆的有效个数之内，</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> (childIndex &lt; <span class=\"built_in\">this</span>.size) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 右孩子节点为左孩子节点的下一位</span></span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">rightChildIndex</span> <span class=\"operator\">=</span> childIndex + <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 如果有右孩子节点，并右孩子节点比左孩子节点的值小，则定位到右孩子节点</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (rightChildIndex &lt; <span class=\"built_in\">this</span>.size &amp;&amp; <span class=\"built_in\">this</span>.array[rightChildIndex] &lt; <span class=\"built_in\">this</span>.array[childIndex]) &#123;</span><br><span class=\"line\">            childIndex++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 如果需要下沉的节点小于孩子节点中最小的那个节点的值，直接打断程序，不继续下沉</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (temp &lt;= <span class=\"built_in\">this</span>.array[childIndex]) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">break</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 调换父子节点的值</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.array[parentIndex] = <span class=\"built_in\">this</span>.array[childIndex];</span><br><span class=\"line\">        <span class=\"comment\">// 将父节点的下标修改为子节点的下标</span></span><br><span class=\"line\">        parentIndex = childIndex;</span><br><span class=\"line\">        <span class=\"comment\">// 维护左孩子节点的下标</span></span><br><span class=\"line\">        childIndex = getLeftChildIndex(parentIndex);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.array[parentIndex] = temp;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"最小堆的完整代码实现\"><a href=\"#最小堆的完整代码实现\" class=\"headerlink\" title=\"最小堆的完整代码实现\"></a>最小堆的完整代码实现</h1><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MinHeap</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 用于存储二叉堆的数组</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer[] array;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 当前二叉堆的最大节点个数，即数组长度</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> maxSize;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 当前二叉堆的节点个数</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> size;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取数组的实际元素个数</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 数组的实际元素个数</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">size</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.size;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取数组的长度</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 数组的长度</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">length</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.maxSize;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 最小堆的构造函数</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> arr 数组</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">MinHeap</span><span class=\"params\">(Integer[] arr)</span> &#123;</span><br><span class=\"line\">        buildMinHeap(arr);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 构建最小堆</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> arr 数组</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">buildMinHeap</span><span class=\"params\">(Integer[] arr)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.size = arr.length;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.maxSize = arr.length;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.array = arr;</span><br><span class=\"line\">        <span class=\"comment\">// 获取最后一个节点的下标</span></span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">lastIndex</span> <span class=\"operator\">=</span> arr.length - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 从最后一个非叶子节点开始进行下沉</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> getParentIndex(lastIndex); i &gt;= <span class=\"number\">0</span>; i--) &#123;</span><br><span class=\"line\">            downAdjust(i);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 在堆的末尾插入一个数据</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> data 数值</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">insert</span><span class=\"params\">(<span class=\"type\">int</span> data)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (size &gt;= maxSize) &#123;</span><br><span class=\"line\">            resize();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.array[<span class=\"built_in\">this</span>.size++] = data;</span><br><span class=\"line\">        upAdjust();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 数组扩容操作</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">resize</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 新数组的长度为原数组的2倍</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.maxSize = <span class=\"built_in\">this</span>.maxSize * <span class=\"number\">2</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 初始化新数组</span></span><br><span class=\"line\">        Integer[] newArray = <span class=\"keyword\">new</span> <span class=\"title class_\">Integer</span>[maxSize];</span><br><span class=\"line\">        <span class=\"comment\">// 将原数组的元素复制到新数组中</span></span><br><span class=\"line\">        System.arraycopy(<span class=\"built_in\">this</span>.array, <span class=\"number\">0</span>, newArray, <span class=\"number\">0</span>, <span class=\"built_in\">this</span>.size);</span><br><span class=\"line\">        <span class=\"comment\">// 使用新数组替换原数组</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.array = newArray;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 上浮操作</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">upAdjust</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 数组最后一个节点所在的下标，即需要上浮的节点</span></span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">currentIndex</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.size - <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">parentIndex</span> <span class=\"operator\">=</span> getParentIndex(currentIndex);</span><br><span class=\"line\">        <span class=\"comment\">// 将当前孩子节点使用临时变量保存</span></span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">temp</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.array[currentIndex];</span><br><span class=\"line\">        <span class=\"comment\">// 如果当前孩子节点的下标大于0，并且当前孩子节点的值小于父节点的值</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (currentIndex &gt; <span class=\"number\">0</span> &amp;&amp; temp &lt; <span class=\"built_in\">this</span>.array[parentIndex]) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 将父节点的值和当前孩子节点的值进行交换</span></span><br><span class=\"line\">            <span class=\"built_in\">this</span>.array[currentIndex] = <span class=\"built_in\">this</span>.array[parentIndex];</span><br><span class=\"line\">            <span class=\"comment\">// 将当前孩子节点的值修改为之前的父节点的值</span></span><br><span class=\"line\">            currentIndex = parentIndex;</span><br><span class=\"line\">            <span class=\"comment\">// 维护父节点的下标</span></span><br><span class=\"line\">            parentIndex = getParentIndex(currentIndex);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.array[currentIndex] = temp;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 移除堆顶的元素</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 堆顶的元素</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Integer <span class=\"title function_\">remove</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"built_in\">this</span>.size == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">Integer</span> <span class=\"variable\">removeData</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.array[<span class=\"number\">0</span>];</span><br><span class=\"line\">        <span class=\"comment\">// 获取最后一个节点</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.array[<span class=\"number\">0</span>] = <span class=\"built_in\">this</span>.array[size - <span class=\"number\">1</span>];</span><br><span class=\"line\">        downAdjust(<span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.array[--size] = <span class=\"literal\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> removeData;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 下沉操作</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> parentIndex 需要下沉的节点下标</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">downAdjust</span><span class=\"params\">(<span class=\"type\">int</span> parentIndex)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 获取左孩子节点的下标</span></span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">childIndex</span> <span class=\"operator\">=</span> getLeftChildIndex(parentIndex);</span><br><span class=\"line\">        <span class=\"comment\">// 将需要下沉的节点使用临时变量保存</span></span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">temp</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.array[parentIndex];</span><br><span class=\"line\">        <span class=\"comment\">// 如果左孩子节点的下标还在堆的有效个数之内，</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (childIndex &lt; <span class=\"built_in\">this</span>.size) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 右孩子节点为左孩子节点的下一位</span></span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">rightChildIndex</span> <span class=\"operator\">=</span> childIndex + <span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"comment\">// 如果有右孩子节点，并右孩子节点比左孩子节点的值小，则定位到右孩子节点</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (rightChildIndex &lt; <span class=\"built_in\">this</span>.size &amp;&amp; <span class=\"built_in\">this</span>.array[rightChildIndex] &lt; <span class=\"built_in\">this</span>.array[childIndex]) &#123;</span><br><span class=\"line\">                childIndex++;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// 如果需要下沉的节点小于孩子节点中最小的那个节点的值，直接打断程序，不继续下沉</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (temp &lt;= <span class=\"built_in\">this</span>.array[childIndex]) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// 调换父子节点的值</span></span><br><span class=\"line\">            <span class=\"built_in\">this</span>.array[parentIndex] = <span class=\"built_in\">this</span>.array[childIndex];</span><br><span class=\"line\">            <span class=\"comment\">// 将父节点的下标修改为子节点的下标</span></span><br><span class=\"line\">            parentIndex = childIndex;</span><br><span class=\"line\">            <span class=\"comment\">// 维护左孩子节点的下标</span></span><br><span class=\"line\">            childIndex = getLeftChildIndex(parentIndex);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.array[parentIndex] = temp;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 通过孩子节点下标，获取父节点下标</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> childIndex 孩子节点下标</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 父节点下标</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> <span class=\"title function_\">getParentIndex</span><span class=\"params\">(<span class=\"type\">int</span> childIndex)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 通过取余数的方式，直接获取左右孩子节点的父节点</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> (childIndex - <span class=\"number\">1</span>) / <span class=\"number\">2</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 通过父节点下标，获取左孩子节点下标</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> parentIndex 父节点下标</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 左孩子节点下标</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> <span class=\"title function_\">getLeftChildIndex</span><span class=\"params\">(<span class=\"type\">int</span> parentIndex)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">2</span> * parentIndex + <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 通过父节点下标，获取右孩子节点下标</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> parentIndex 父节点下标</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 右孩子节点下标</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> <span class=\"title function_\">getRightChildIndex</span><span class=\"params\">(<span class=\"type\">int</span> parentIndex)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">2</span> * parentIndex + <span class=\"number\">2</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h1><blockquote>\n<p>本文<strong>Github</strong> <a href=\"https://github.com/herenpeng/code-learn\">https://github.com/herenpeng/code-learn</a> 已收录，欢迎<strong>Star</strong>。</p>\n</blockquote>\n","categories":["数据结构与算法"],"tags":["堆"]},{"title":"数据结构之什么是数组？","url":"/2021/02/23/algorithm/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B9%8B%E4%BB%80%E4%B9%88%E6%98%AF%E6%95%B0%E7%BB%84/","content":"<h1 id=\"什么是数组？\"><a href=\"#什么是数组？\" class=\"headerlink\" title=\"什么是数组？\"></a>什么是数组？</h1><p>数组对应的英文是array，是有限个相同类型的变量所组成的有序集合，数组中的每一个变量被称为元素。数组是最为简单、最为常用的数据结构。</p>\n<span id=\"more\"></span>\n\n<ul>\n<li>数组的每一个元素都有自己的下标，该下标从0开始，一直到数组长度-1结束。</li>\n<li>数组在内容中是顺序存储，在内存中的表现形式为一整块完整的内存空间。</li>\n<li>数组的特点，有限个数，相同类型，有序。</li>\n</ul>\n<h1 id=\"数组的基本操作\"><a href=\"#数组的基本操作\" class=\"headerlink\" title=\"数组的基本操作\"></a>数组的基本操作</h1><p>数组的基本操作，无非就是增、删、改、查四种情况。</p>\n<h2 id=\"查——读取元素\"><a href=\"#查——读取元素\" class=\"headerlink\" title=\"查——读取元素\"></a>查——读取元素</h2><p>对于数组来说，读取元素是最为简单的操作。由于数组在内存中顺序存储，所以只需要给出一个数组下标，就可以读取到对应的数组元素。</p>\n<p>这种通过数组下标读取元素的方式叫做<strong>随机读取</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">int</span>[] arr = <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[]&#123;<span class=\"number\">1</span>, <span class=\"number\">5</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">3</span>&#125;;</span><br><span class=\"line\"><span class=\"comment\">// 输出下标为2的数组元素，即数组的第三个元素，4</span></span><br><span class=\"line\">System.out.println(arr[<span class=\"number\">2</span>]);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"改——更新元素\"><a href=\"#改——更新元素\" class=\"headerlink\" title=\"改——更新元素\"></a>改——更新元素</h2><p>把数组的某一个元素替换为一个新值，也是非常简单的事情，直接利用数组的下标，就可以把新值赋给该元素。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">int</span>[] arr = <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[]&#123;<span class=\"number\">1</span>, <span class=\"number\">5</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">5</span>, <span class=\"number\">3</span>&#125;;</span><br><span class=\"line\"><span class=\"comment\">// 输出赋值前，下标为4的数组元素，值为：1</span></span><br><span class=\"line\">System.out.println(arr[<span class=\"number\">4</span>]);</span><br><span class=\"line\"><span class=\"comment\">// 赋值，改变数组元素的值</span></span><br><span class=\"line\">arr[<span class=\"number\">4</span>] = <span class=\"number\">10</span>;</span><br><span class=\"line\"><span class=\"comment\">// 输出赋值后，下标为4的数组元素，值为：10</span></span><br><span class=\"line\">System.out.println(arr[<span class=\"number\">4</span>]);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"增——插入元素\"><a href=\"#增——插入元素\" class=\"headerlink\" title=\"增——插入元素\"></a>增——插入元素</h2><p>数组的插入元素操作是一个比较复杂的操作，因为涉及数组元素个数的变动，所以在介绍插入元素操作之前，需要先介绍一下数组的长度和数组的实际元素个数。</p>\n<p>数组的长度：即数组初始化时开辟的内存空间大小。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 开辟了一个数组长度为5的数组内存空间</span></span><br><span class=\"line\"><span class=\"type\">int</span>[] arr = <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[<span class=\"number\">5</span>];</span><br></pre></td></tr></table></figure>\n\n<p>数组的实际元素个数：即数组中存在的元素个数。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 开辟了一个数组长度为5的数组内存空间</span></span><br><span class=\"line\"><span class=\"type\">int</span>[] arr = <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[<span class=\"number\">5</span>];</span><br><span class=\"line\">arr[<span class=\"number\">0</span>] = <span class=\"number\">2</span>;</span><br><span class=\"line\">arr[<span class=\"number\">1</span>] = <span class=\"number\">8</span>;</span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"type\">int</span> i : arr) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 输出：2 8 0 0 0，数组的实际元素个数为2</span></span><br><span class=\"line\">    System.out.print(i + <span class=\"string\">&quot;\\t&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>上述的数组中，实际的元素个数只有两个，即下标为0、1的两个元素，其他元素之所以输出为0，是因为在Java中，int类型的初始化值为0，所以输出的数组为<code>2 8 0 0 0</code>，如果使用<code>Integer</code>类型的数组，则可以通过<code>null</code>值进行更直观的判断。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 开辟了一个数组长度为5，类型为Integer的数组内存空间</span></span><br><span class=\"line\">Integer[] array = <span class=\"keyword\">new</span> <span class=\"title class_\">Integer</span>[<span class=\"number\">5</span>];</span><br><span class=\"line\">array[<span class=\"number\">0</span>] = <span class=\"number\">2</span>;</span><br><span class=\"line\">array[<span class=\"number\">1</span>] = <span class=\"number\">8</span>;</span><br><span class=\"line\"><span class=\"keyword\">for</span> (Integer integer : array) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 输出：2\t8\tnull\tnull\tnull，数组的实际元素个数为2</span></span><br><span class=\"line\">    System.out.print(integer + <span class=\"string\">&quot;\\t&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>正是因为存在数组的长度和实际元素个数不同的情况，所以在一般情况下，我们会使用一个变量来记录数组的实际元素个数。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Array</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 数组</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span>[] array;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 数组的最大元素个数，即为数组的长度</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> maxSize;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 数组的实际元素个数</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> size;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 构造函数</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> capacity 初始化数组的容量大小，即maxSize大小</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">Array</span><span class=\"params\">(<span class=\"type\">int</span> capacity)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 初始化数组长度</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.maxSize = capacity;</span><br><span class=\"line\">        <span class=\"comment\">// 初始化数组，开辟数组空间</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.array = <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[maxSize];</span><br><span class=\"line\">        <span class=\"comment\">// 初始化数组实际元素个数，为0</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.size = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取数组的实际元素个数</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 数组的实际元素个数</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">size</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.size;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取数组的长度</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 数组的长度</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">length</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.maxSize;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>我们只需要通过创建Array类的对象的方式，即可完成一个数组的初始化。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">Array</span> <span class=\"variable\">array</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Array</span>(<span class=\"number\">5</span>);</span><br><span class=\"line\"><span class=\"comment\">// 数组的实际元素个数为：0</span></span><br><span class=\"line\">System.out.println(array.size());</span><br><span class=\"line\"><span class=\"comment\">// 数组长度为：5</span></span><br><span class=\"line\">System.out.println(array.length());</span><br></pre></td></tr></table></figure>\n\n<p>这个时候，数组的插入插入操作即可以开始了。</p>\n<p>数组的插入操作也分为三种，分别为：</p>\n<ul>\n<li>尾部插入  </li>\n<li>中间插入，头部插入本质上也属于中间插入的一种</li>\n<li>超范围插入</li>\n</ul>\n<p>尾部插入最为简单，只需要将元素放置在数组尾部的空闲元素的位置上即可。</p>\n<p>中间插入较为复杂，因为在数组中间位置插入元素，需要先将插入位置及插入位置后面的元素向后移动，空出一个数组下标给插入的元素。</p>\n<p>超范围插入最为复杂，因为超范围插入涉及到了数组的扩容。</p>\n<h3 id=\"数组扩容\"><a href=\"#数组扩容\" class=\"headerlink\" title=\"数组扩容\"></a>数组扩容</h3><p>为什么需要数组扩容？</p>\n<p>我们不断往一个数组中插入元素，最终数组实际元素个数等于，甚至大于数组长度，这个时候数组已经无法容纳更多的元素了，所以我们需要通过扩容在扩大数组的容量。</p>\n<p>怎么扩容？</p>\n<p>数组的长度在初始化的时候就已经固定了，这也是数组有限个数的特点，如果如果想要对数组进行扩容，就需要创建一个容量比原数组更大的新数组，并将原数组的元素复制到新数组中，实现原数组的替换操作。</p>\n<p>所以数组的插入操作的具体代码为：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 直接在数组尾部插入元素</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> element 需要插入的元素</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">add</span><span class=\"params\">(<span class=\"type\">int</span> element)</span> &#123;</span><br><span class=\"line\">    add(<span class=\"built_in\">this</span>.size, element);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 在数组指定位置插入元素</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> index   数组指定的下标位置</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> element 需要插入的元素</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">add</span><span class=\"params\">(<span class=\"type\">int</span> index, <span class=\"type\">int</span> element)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 这样操作的目的是为了保证数组的元素全部都可以从0开始，并且中间不会出现空闲元素</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (index &lt; <span class=\"number\">0</span> || index &gt; size) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IndexOutOfBoundsException</span>(<span class=\"string\">&quot;插入元素的位置超出数组的实际元素范围&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 如果当前数组实际元素个数大于等于数组长度，进行扩容操作</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (size &gt;= maxSize) &#123;</span><br><span class=\"line\">        resize();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 从下标index开始将元素向后移动一位</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> size; i &gt; index; i--) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.array[i] = <span class=\"built_in\">this</span>.array[i - <span class=\"number\">1</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 在index位置插入需要插入的元素</span></span><br><span class=\"line\">    <span class=\"built_in\">this</span>.array[index] = element;</span><br><span class=\"line\">    <span class=\"comment\">// 数组实际元素个数+1</span></span><br><span class=\"line\">    size++;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 扩容操作，每次扩容，新数组的长度为原数组的2倍</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">resize</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 新数组的长度为原数组的2倍</span></span><br><span class=\"line\">    <span class=\"built_in\">this</span>.maxSize = <span class=\"built_in\">this</span>.maxSize * <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"comment\">// 初始化新数组</span></span><br><span class=\"line\">    <span class=\"type\">int</span>[] newArray = <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[maxSize];</span><br><span class=\"line\">    <span class=\"comment\">// 将原数组的元素复制到新数组中</span></span><br><span class=\"line\">    System.arraycopy(<span class=\"built_in\">this</span>.array, <span class=\"number\">0</span>, newArray, <span class=\"number\">0</span>, <span class=\"built_in\">this</span>.size);</span><br><span class=\"line\">    <span class=\"comment\">// 使用新数组替换原数组</span></span><br><span class=\"line\">    <span class=\"built_in\">this</span>.array = newArray;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"删——删除元素\"><a href=\"#删——删除元素\" class=\"headerlink\" title=\"删——删除元素\"></a>删——删除元素</h2><p>数组的删除操作比起插入元素来，比较简单一些，因为不涉及数组扩容的问题，我们只需要将数组被删除位置后面的元素向前移动即可。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 删除数组元素</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> index 需要删除的数组元素下标位置</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> 删除的元素</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">delete</span><span class=\"params\">(<span class=\"type\">int</span> index)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 判断需要删除的数组下标是否在数组实际元素范围之内</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (index &lt; <span class=\"number\">0</span> || index &gt;= size) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IndexOutOfBoundsException</span>(<span class=\"string\">&quot;删除元素的位置超出数组的实际元素范围&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">deleteElement</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.array[index];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> index; i &lt; size - <span class=\"number\">1</span>; i++) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.array[index] = <span class=\"built_in\">this</span>.array[index + <span class=\"number\">1</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    size--;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> deleteElement;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h1 id=\"数组操作的时间复杂度\"><a href=\"#数组操作的时间复杂度\" class=\"headerlink\" title=\"数组操作的时间复杂度\"></a>数组操作的时间复杂度</h1><table>\n<thead>\n<tr>\n<th>数组操作</th>\n<th>时间复杂度</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>读取元素</td>\n<td>O(1)</td>\n</tr>\n<tr>\n<td>更新元素</td>\n<td>O(1)</td>\n</tr>\n<tr>\n<td>插入元素</td>\n<td>O(n)</td>\n</tr>\n<tr>\n<td>删除元素</td>\n<td>O(n)</td>\n</tr>\n</tbody></table>\n<h1 id=\"数组的优势和劣势\"><a href=\"#数组的优势和劣势\" class=\"headerlink\" title=\"数组的优势和劣势\"></a>数组的优势和劣势</h1><p>优势：数组拥有非常高效的随机访问能力，只需要通过下标，就可以用常量时间找到对应的元素。</p>\n<p>劣势：数组在插入和删除的时候，需要移动大量元素，导致效率低下。</p>\n<p>总结：数组适用于读操作多，写操作少的场景。</p>\n<h1 id=\"数组的完整代码（Java）\"><a href=\"#数组的完整代码（Java）\" class=\"headerlink\" title=\"数组的完整代码（Java）\"></a>数组的完整代码（Java）</h1><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Array</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 数组</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span>[] array;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 数组的最大元素个数，即为数组的长度</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> maxSize;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 数组的实际元素个数</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> size;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 构造函数</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> capacity 初始化数组的容量大小，即maxSize大小</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">Array</span><span class=\"params\">(<span class=\"type\">int</span> capacity)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 初始化数组长度</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.maxSize = capacity;</span><br><span class=\"line\">        <span class=\"comment\">// 初始化数组，开辟数组空间</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.array = <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[maxSize];</span><br><span class=\"line\">        <span class=\"comment\">// 初始化数组实际元素个数，为0</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.size = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取数组的实际元素个数</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 数组的实际元素个数</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">size</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.size;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取数组的长度</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 数组的长度</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">length</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.maxSize;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取下标对应的元素</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> index 数组下标</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 下标对应的元素</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">get</span><span class=\"params\">(<span class=\"type\">int</span> index)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 判断需要删除的数组下标是否在数组实际元素范围之内</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (index &lt; <span class=\"number\">0</span> || index &gt;= size) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IndexOutOfBoundsException</span>(<span class=\"string\">&quot;删除元素的位置超出数组的实际元素范围&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.array[index];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 更新下标对应的元素</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> index   数组下标</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> element 需要更新的元素</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">update</span><span class=\"params\">(<span class=\"type\">int</span> index, <span class=\"type\">int</span> element)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 判断需要删除的数组下标是否在数组实际元素范围之内</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (index &lt; <span class=\"number\">0</span> || index &gt;= size) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IndexOutOfBoundsException</span>(<span class=\"string\">&quot;删除元素的位置超出数组的实际元素范围&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.array[index] = element;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 直接在数组尾部插入元素</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> element 需要插入的元素</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">add</span><span class=\"params\">(<span class=\"type\">int</span> element)</span> &#123;</span><br><span class=\"line\">        add(<span class=\"built_in\">this</span>.size, element);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 在数组指定位置插入元素</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> index   数组指定的下标位置</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> element 需要插入的元素</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">add</span><span class=\"params\">(<span class=\"type\">int</span> index, <span class=\"type\">int</span> element)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 这样操作的目的是为了保证数组的元素全部都可以从0开始，并且中间不会出现空闲元素</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (index &lt; <span class=\"number\">0</span> || index &gt; size) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IndexOutOfBoundsException</span>(<span class=\"string\">&quot;插入元素的位置超出数组的实际元素范围&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 如果当前数组实际元素个数大于等于数组长度，进行扩容操作</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (size &gt;= maxSize) &#123;</span><br><span class=\"line\">            resize();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 从下标index开始将元素向后移动一位</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> size; i &gt; index; i--) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">this</span>.array[i] = <span class=\"built_in\">this</span>.array[i - <span class=\"number\">1</span>];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 在index位置插入需要插入的元素</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.array[index] = element;</span><br><span class=\"line\">        <span class=\"comment\">// 数组实际元素个数+1</span></span><br><span class=\"line\">        size++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 扩容操作，每次扩容，新数组的长度为原数组的2倍</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">resize</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 新数组的长度为原数组的2倍</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.maxSize = <span class=\"built_in\">this</span>.maxSize * <span class=\"number\">2</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 初始化新数组</span></span><br><span class=\"line\">        <span class=\"type\">int</span>[] newArray = <span class=\"keyword\">new</span> <span class=\"title class_\">int</span>[maxSize];</span><br><span class=\"line\">        <span class=\"comment\">// 将原数组的元素复制到新数组中</span></span><br><span class=\"line\">        System.arraycopy(<span class=\"built_in\">this</span>.array, <span class=\"number\">0</span>, newArray, <span class=\"number\">0</span>, <span class=\"built_in\">this</span>.size);</span><br><span class=\"line\">        <span class=\"comment\">// 使用新数组替换原数组</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.array = newArray;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 删除数组元素</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> index 需要删除的数组元素下标位置</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 删除的元素</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">delete</span><span class=\"params\">(<span class=\"type\">int</span> index)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 判断需要删除的数组下标是否在数组实际元素范围之内</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (index &lt; <span class=\"number\">0</span> || index &gt;= size) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IndexOutOfBoundsException</span>(<span class=\"string\">&quot;删除元素的位置超出数组的实际元素范围&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">deleteElement</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.array[index];</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> index; i &lt; size - <span class=\"number\">1</span>; i++) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">this</span>.array[index] = <span class=\"built_in\">this</span>.array[index + <span class=\"number\">1</span>];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        size--;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> deleteElement;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h1><blockquote>\n<p>本文<strong>Github</strong> <a href=\"https://github.com/herenpeng/code-learn\">https://github.com/herenpeng/code-learn</a> 已收录，欢迎<strong>Star</strong>。</p>\n</blockquote>\n","categories":["数据结构与算法"],"tags":["数组"]},{"title":"数据结构之什么是树？","url":"/2021/02/28/algorithm/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B9%8B%E4%BB%80%E4%B9%88%E6%98%AF%E6%A0%91/","content":"<h1 id=\"什么是树？\"><a href=\"#什么是树？\" class=\"headerlink\" title=\"什么是树？\"></a>什么是树？</h1><p>数据结构中的树和现实生活中的树虽然不是同一种事物，但是却有着相同的特点。</p>\n<p>数据结构中的树，其实就是一种和现实生活中的树有着相似结构的数据逻辑结构，从同一个“根”衍生出许多“枝干”，最后衍生出更多的“叶子”。</p>\n<span id=\"more\"></span>\n\n<p>树的定义：</p>\n<blockquote>\n<p>树是n（你&gt;=0）个节点的有限集。当n=0时，称为空树。在任意一个非空树中，有如下特点。<br>1、有且仅有一个特定的称为根的节点。<br>2、当n&gt;1时，其余节点可分为m（m&gt;0）个互不相交的有限集，每一个集合本身又是一个树，并称为根的子树。</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">     <span class=\"number\">7</span></span><br><span class=\"line\">   /   \\</span><br><span class=\"line\">  <span class=\"number\">10</span>    <span class=\"number\">8</span></span><br><span class=\"line\"> /  \\  /  \\</span><br><span class=\"line\"><span class=\"number\">4</span>   <span class=\"number\">1</span>  <span class=\"number\">3</span>   <span class=\"number\">6</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p>根节点：树的最上面的那个节点，被称为<strong>根节点</strong>，所有非空树有且只有一个根节点。在上图中，元素<code>7</code>为根节点。</p>\n</li>\n<li><p>叶子节点：树的末端，没有“孩子”节点的节点被称作<strong>叶子节点</strong>。在上图中，元素<code>4、1、3、6</code>为叶子节点。</p>\n</li>\n<li><p>子树：树的非根节点，以及它的孩子节点，组成的树结构被称为<strong>子树</strong>。在上图中，由元素<code>10、4、1</code>组成的树结构为整棵树的子树。</p>\n</li>\n<li><p>树的高度：树的最大层级数，被称为树的高度或深度。在上图中，树的高度为<code>3</code>。</p>\n</li>\n<li><p>父节点：一个节点的上一层级的节点被称为当前节点的<strong>父节点</strong>。根节点没有父节点。在上图中，节点<code>10</code>是节点<code>4、1</code>的父节点。</p>\n</li>\n<li><p>孩子节点：一个节点的下一层级的节点被称为当前节点的<strong>孩子节点</strong>。叶子节点没有孩子节点。在上图中，节点<code>10</code>是节点<code>7</code>的孩子节点。</p>\n</li>\n<li><p>兄弟节点：一个节点同一层级的节点被称为当前节点的<strong>兄弟节点</strong>。所有节点都有n（n&gt;=0）个兄弟节点。在上图中，节点<code>8</code>是节点<code>10</code>的兄弟节点。</p>\n</li>\n</ul>\n<h1 id=\"什么是二叉树？\"><a href=\"#什么是二叉树？\" class=\"headerlink\" title=\"什么是二叉树？\"></a>什么是二叉树？</h1><p>二叉树（binary tree）是数的一种特殊形式。二叉，顾名思义，这种数的每个节点最多有2个孩子节点。</p>\n<blockquote>\n<p>注意：这里是最多有2两个，可能只有1个节点，或者没有孩子节点。</p>\n</blockquote>\n<p>二叉树节点的两个孩子节点，一个被称为左孩子（lift child），一个被称为右孩子（right child）。这两个孩子节点的顺序是固定的，不能够颠倒或者混淆。</p>\n<p>二叉树有两种特殊形式，分别叫做<strong>满二叉树</strong>和<strong>完全二叉树</strong>。</p>\n<p>什么是满二叉树？</p>\n<p>一个二叉树的所有非叶子节点都存在左右孩子，并且所有叶子节点都在同一层级上，那么这个树就叫做满二叉树。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">  满二叉树</span><br><span class=\"line\">     <span class=\"number\">7</span></span><br><span class=\"line\">   /   \\</span><br><span class=\"line\">  <span class=\"number\">10</span>    <span class=\"number\">8</span></span><br><span class=\"line\"> /  \\  /  \\</span><br><span class=\"line\"><span class=\"number\">4</span>   <span class=\"number\">1</span>  <span class=\"number\">3</span>   <span class=\"number\">6</span></span><br></pre></td></tr></table></figure>\n\n<p>什么是完全二叉树？</p>\n<p>对于一个有n个节点的二叉树，按层级顺序编号，则所有节点的编号为从1到n。如果这个树的所有节点和同样深度的满二叉树的编号为从1到n的节点位置相同，则这个二叉树为完全二叉树。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">  完全二叉树</span><br><span class=\"line\">     <span class=\"number\">7</span></span><br><span class=\"line\">   /   \\</span><br><span class=\"line\">  <span class=\"number\">10</span>    <span class=\"number\">8</span></span><br><span class=\"line\"> /  \\  /</span><br><span class=\"line\"><span class=\"number\">4</span>   <span class=\"number\">1</span>  <span class=\"number\">3</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"二叉树的实现\"><a href=\"#二叉树的实现\" class=\"headerlink\" title=\"二叉树的实现\"></a>二叉树的实现</h1><p>二叉树的实现方法一般有两种，分别为：</p>\n<ul>\n<li>链式存储结构</li>\n<li>数组</li>\n</ul>\n<h2 id=\"链式存储结构\"><a href=\"#链式存储结构\" class=\"headerlink\" title=\"链式存储结构\"></a>链式存储结构</h2><p>链式存储结构实现二叉树，每个二叉树的节点拥有存储数据的data变量，同时有着指向左右孩子节点的指针变量，这样就可以简单实现二叉树的数据结构了。</p>\n<h3 id=\"实现代码\"><a href=\"#实现代码\" class=\"headerlink\" title=\"实现代码\"></a>实现代码</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">BinaryTree</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 二叉树根节点指针</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> TreeNode root;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取二叉树的根节点</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 二叉树的根节点</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> TreeNode <span class=\"title function_\">root</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.root;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 通过数组创建二叉树时数组的索引位置</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> <span class=\"variable\">createBinaryTreeByArrIndex</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 通过数组创建二叉树的构造方法</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> arr 数组</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">BinaryTree</span><span class=\"params\">(Integer[] arr)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 通过数组构建二叉树，并保存二叉树根节点的指针</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.root = createBinaryTree(arr);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 创建二叉树的方法</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> arr 数组</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> root根节点指针</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> TreeNode <span class=\"title function_\">createBinaryTree</span><span class=\"params\">(Integer[] arr)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">TreeNode</span> <span class=\"variable\">node</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 如果数组为空，或者索引越界，则直接返回空的二叉树</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (arr == <span class=\"literal\">null</span> || arr.length == <span class=\"number\">0</span> || createBinaryTreeByArrIndex &lt; <span class=\"number\">0</span></span><br><span class=\"line\">                || createBinaryTreeByArrIndex &gt; arr.length - <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 通过索引获取数组对应位置的数据</span></span><br><span class=\"line\">        <span class=\"type\">Integer</span> <span class=\"variable\">data</span> <span class=\"operator\">=</span> arr[createBinaryTreeByArrIndex++];</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (data != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 如果这个数据不为空，则创建节点，并返回</span></span><br><span class=\"line\">            node = <span class=\"keyword\">new</span> <span class=\"title class_\">TreeNode</span>(data);</span><br><span class=\"line\">            <span class=\"comment\">// 数组的下一个节点为该节点的左孩子节点</span></span><br><span class=\"line\">            node.leftChild = createBinaryTree(arr);</span><br><span class=\"line\">            <span class=\"comment\">// 数组的下一个节点为该节点的右孩子节点</span></span><br><span class=\"line\">            node.rightChile = createBinaryTree(arr);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> node;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 二叉树节点</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">class</span> <span class=\"title class_\">TreeNode</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 二叉树节点存储节点数据的变量</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> Integer data;</span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 二叉树节点左孩子节点指针</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> TreeNode leftChild;</span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 二叉树节点右孩子节点指针</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> TreeNode rightChile;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 获取节点数据的方法</span></span><br><span class=\"line\"><span class=\"comment\">         *</span></span><br><span class=\"line\"><span class=\"comment\">         * <span class=\"doctag\">@return</span> 节点数据</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> Integer <span class=\"title function_\">data</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.data;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 获取节点左孩子节点指针的方法</span></span><br><span class=\"line\"><span class=\"comment\">         *</span></span><br><span class=\"line\"><span class=\"comment\">         * <span class=\"doctag\">@return</span> 节点左孩子节点指针</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> TreeNode <span class=\"title function_\">leftChild</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.leftChild;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 获取节点右孩子节点指针的方法</span></span><br><span class=\"line\"><span class=\"comment\">         *</span></span><br><span class=\"line\"><span class=\"comment\">         * <span class=\"doctag\">@return</span> 节点右孩子节点指针</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> TreeNode <span class=\"title function_\">rightChile</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.rightChile;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 节点构造方法</span></span><br><span class=\"line\"><span class=\"comment\">         *</span></span><br><span class=\"line\"><span class=\"comment\">         * <span class=\"doctag\">@param</span> data 节点数据</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        TreeNode(Integer data) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">this</span>.data = data;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"数组\"><a href=\"#数组\" class=\"headerlink\" title=\"数组\"></a>数组</h2><p>使用数组存储时，会按照层级顺序把二叉树的节点放入数组中对应的位置上去。如果某一个节点的左孩子或者右孩子缺失，则数组对应的位置也会空出来。</p>\n<p>其中二叉树的根节点存储在数组的第一位，即下标为0的位置。</p>\n<p>如果一个二叉树的父节点下标为<code>parent</code>，则该节点的左孩子节点的下标即为<code>2*parent+1</code>，该节点的右孩子节点的下标为<code>2*parent+2</code>。</p>\n<p>同理而言，一个左孩子节点的下标为<code>leftChild</code>，则该左孩子节点的父节点为<code>(leftChile-1)/2</code>。</p>\n<p>如果一个右孩子节点的下标为<code>rightChild</code>，则该右孩子节点的父节点为<code>(rightChild-1)/2</code>。</p>\n<h1 id=\"二叉查找树\"><a href=\"#二叉查找树\" class=\"headerlink\" title=\"二叉查找树\"></a>二叉查找树</h1><p>什么是二叉查找树？</p>\n<p>二叉查找树是一种特殊的二叉树，这种树的主要作用是进行查找操作的。</p>\n<ul>\n<li><p>如果左子树不为空，则左子树上的所有节点的值均小于根节点的值。</p>\n</li>\n<li><p>如果右子树不为空，则右子树上的所有节点的值均大于根节点的值。</p>\n</li>\n<li><p>左右子树也都是二叉查找树。</p>\n</li>\n</ul>\n<h1 id=\"二叉树的遍历\"><a href=\"#二叉树的遍历\" class=\"headerlink\" title=\"二叉树的遍历\"></a>二叉树的遍历</h1><p>二叉树的遍历，从节点之间的位置关系角度来看，二叉树的遍历分为4种：</p>\n<ul>\n<li>前序遍历</li>\n<li>中序遍历</li>\n<li>后续遍历</li>\n<li>层序遍历</li>\n</ul>\n<p>如果从宏观的角度来看，二叉树的遍历归结为两大类：</p>\n<ul>\n<li><p>深度优先遍历（前序遍历，中序遍历，后续遍历）</p>\n</li>\n<li><p>广度优先遍历（层序遍历）</p>\n</li>\n</ul>\n<h2 id=\"前序遍历\"><a href=\"#前序遍历\" class=\"headerlink\" title=\"前序遍历\"></a>前序遍历</h2><p>二叉树的前序遍历，输出顺序为根节点、左子树、右子树。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">     <span class=\"number\">3</span></span><br><span class=\"line\">   /   \\</span><br><span class=\"line\">  <span class=\"number\">2</span>     <span class=\"number\">8</span></span><br><span class=\"line\"> /  \\     \\</span><br><span class=\"line\"><span class=\"number\">9</span>   <span class=\"number\">10</span>     <span class=\"number\">4</span></span><br></pre></td></tr></table></figure>\n\n<p>上述的二叉树中，前序遍历的输出循序为：<code>3、2、9、10、8、4</code>。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">    Integer[] arr = <span class=\"keyword\">new</span> <span class=\"title class_\">Integer</span>[]&#123;<span class=\"number\">3</span>, <span class=\"number\">2</span>, <span class=\"number\">9</span>, <span class=\"literal\">null</span>, <span class=\"literal\">null</span>, <span class=\"number\">10</span>, <span class=\"literal\">null</span>, <span class=\"literal\">null</span>, <span class=\"number\">8</span>, <span class=\"literal\">null</span>, <span class=\"number\">4</span>&#125;;</span><br><span class=\"line\">    <span class=\"comment\">// 构建二叉树</span></span><br><span class=\"line\">    <span class=\"type\">BinaryTree</span> <span class=\"variable\">binaryTree</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">BinaryTree</span>(arr);</span><br><span class=\"line\">    <span class=\"comment\">// 获取二叉树的根节点</span></span><br><span class=\"line\">    BinaryTree.<span class=\"type\">TreeNode</span> <span class=\"variable\">root</span> <span class=\"operator\">=</span> binaryTree.root();</span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;前序遍历：&quot;</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 前序遍历</span></span><br><span class=\"line\">    preOrderTraveral(root);</span><br><span class=\"line\">    System.out.println();</span><br><span class=\"line\">    preOrderTraveralWithStack(root);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 前序遍历</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> node 节点</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">preOrderTraveral</span><span class=\"params\">(BinaryTree.TreeNode node)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (node == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    System.out.print(node.data() + <span class=\"string\">&quot;\\t&quot;</span>);</span><br><span class=\"line\">    preOrderTraveral(node.leftChild());</span><br><span class=\"line\">    preOrderTraveral(node.rightChile());</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 前序遍历，非递归</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> root 二叉树根节点</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">preOrderTraveralWithStack</span><span class=\"params\">(BinaryTree.TreeNode root)</span> &#123;</span><br><span class=\"line\">    Stack&lt;BinaryTree.TreeNode&gt; stack = <span class=\"keyword\">new</span> <span class=\"title class_\">Stack</span>&lt;&gt;();</span><br><span class=\"line\">    BinaryTree.<span class=\"type\">TreeNode</span> <span class=\"variable\">treeNode</span> <span class=\"operator\">=</span> root;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (treeNode != <span class=\"literal\">null</span> || !stack.isEmpty()) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (treeNode != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            System.out.print(treeNode.data() + <span class=\"string\">&quot;\\t&quot;</span>);</span><br><span class=\"line\">            stack.push(treeNode);</span><br><span class=\"line\">            treeNode = treeNode.leftChild();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!stack.isEmpty()) &#123;</span><br><span class=\"line\">            treeNode = stack.pop();</span><br><span class=\"line\">            treeNode = treeNode.rightChile();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"中序遍历\"><a href=\"#中序遍历\" class=\"headerlink\" title=\"中序遍历\"></a>中序遍历</h2><p>二叉树的中序遍历，输出顺序为左子树、根节点、右子树。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">     <span class=\"number\">3</span></span><br><span class=\"line\">   /   \\</span><br><span class=\"line\">  <span class=\"number\">2</span>     <span class=\"number\">8</span></span><br><span class=\"line\"> /  \\     \\</span><br><span class=\"line\"><span class=\"number\">9</span>   <span class=\"number\">10</span>     <span class=\"number\">4</span></span><br></pre></td></tr></table></figure>\n\n<p>上述的二叉树中，中序遍历的输出循序为：<code>9、2、10、3、8、4</code>。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">    Integer[] arr = <span class=\"keyword\">new</span> <span class=\"title class_\">Integer</span>[]&#123;<span class=\"number\">3</span>, <span class=\"number\">2</span>, <span class=\"number\">9</span>, <span class=\"literal\">null</span>, <span class=\"literal\">null</span>, <span class=\"number\">10</span>, <span class=\"literal\">null</span>, <span class=\"literal\">null</span>, <span class=\"number\">8</span>, <span class=\"literal\">null</span>, <span class=\"number\">4</span>&#125;;</span><br><span class=\"line\">    <span class=\"comment\">// 构建二叉树</span></span><br><span class=\"line\">    <span class=\"type\">BinaryTree</span> <span class=\"variable\">binaryTree</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">BinaryTree</span>(arr);</span><br><span class=\"line\">    <span class=\"comment\">// 获取二叉树的根节点</span></span><br><span class=\"line\">    BinaryTree.<span class=\"type\">TreeNode</span> <span class=\"variable\">root</span> <span class=\"operator\">=</span> binaryTree.root();</span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;中序遍历：&quot;</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 中序遍历</span></span><br><span class=\"line\">    inOrderTraveral(root);</span><br><span class=\"line\">    System.out.println();</span><br><span class=\"line\">    inOrderTraveralWithStack(root);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 中序遍历</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> node 节点</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">inOrderTraveral</span><span class=\"params\">(BinaryTree.TreeNode node)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (node == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    inOrderTraveral(node.leftChild());</span><br><span class=\"line\">    System.out.print(node.data() + <span class=\"string\">&quot;\\t&quot;</span>);</span><br><span class=\"line\">    inOrderTraveral(node.rightChile());</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 中序遍历，非递归</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> root 二叉树根节点</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">inOrderTraveralWithStack</span><span class=\"params\">(BinaryTree.TreeNode root)</span> &#123;</span><br><span class=\"line\">    Stack&lt;BinaryTree.TreeNode&gt; stack = <span class=\"keyword\">new</span> <span class=\"title class_\">Stack</span>&lt;&gt;();</span><br><span class=\"line\">    BinaryTree.<span class=\"type\">TreeNode</span> <span class=\"variable\">treeNode</span> <span class=\"operator\">=</span> root;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (treeNode != <span class=\"literal\">null</span> || !stack.isEmpty()) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (treeNode != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            stack.push(treeNode);</span><br><span class=\"line\">            treeNode = treeNode.leftChild();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!stack.isEmpty()) &#123;</span><br><span class=\"line\">            treeNode = stack.pop();</span><br><span class=\"line\">            System.out.print(treeNode.data() + <span class=\"string\">&quot;\\t&quot;</span>);</span><br><span class=\"line\">            treeNode = treeNode.rightChile();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"后序遍历\"><a href=\"#后序遍历\" class=\"headerlink\" title=\"后序遍历\"></a>后序遍历</h2><p>二叉树的后序遍历，输出顺序为左子树、右子树、根节点。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">     <span class=\"number\">3</span></span><br><span class=\"line\">   /   \\</span><br><span class=\"line\">  <span class=\"number\">2</span>     <span class=\"number\">8</span></span><br><span class=\"line\"> /  \\     \\</span><br><span class=\"line\"><span class=\"number\">9</span>   <span class=\"number\">10</span>     <span class=\"number\">4</span></span><br></pre></td></tr></table></figure>\n\n<p>上述的二叉树中，后序遍历的输出循序为：<code>9、10、2、4、8、3</code>。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">    Integer[] arr = <span class=\"keyword\">new</span> <span class=\"title class_\">Integer</span>[]&#123;<span class=\"number\">3</span>, <span class=\"number\">2</span>, <span class=\"number\">9</span>, <span class=\"literal\">null</span>, <span class=\"literal\">null</span>, <span class=\"number\">10</span>, <span class=\"literal\">null</span>, <span class=\"literal\">null</span>, <span class=\"number\">8</span>, <span class=\"literal\">null</span>, <span class=\"number\">4</span>&#125;;</span><br><span class=\"line\">    <span class=\"comment\">// 构建二叉树</span></span><br><span class=\"line\">    <span class=\"type\">BinaryTree</span> <span class=\"variable\">binaryTree</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">BinaryTree</span>(arr);</span><br><span class=\"line\">    <span class=\"comment\">// 获取二叉树的根节点</span></span><br><span class=\"line\">    BinaryTree.<span class=\"type\">TreeNode</span> <span class=\"variable\">root</span> <span class=\"operator\">=</span> binaryTree.root();</span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;后序遍历：&quot;</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 后序遍历</span></span><br><span class=\"line\">    postOrderTraveral(root);</span><br><span class=\"line\">    System.out.println();</span><br><span class=\"line\">    postOrderTraveralWithStack(root);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 后序遍历</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> node 节点</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">postOrderTraveral</span><span class=\"params\">(BinaryTree.TreeNode node)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (node == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    postOrderTraveral(node.leftChild());</span><br><span class=\"line\">    postOrderTraveral(node.rightChile());</span><br><span class=\"line\">    System.out.print(node.data() + <span class=\"string\">&quot;\\t&quot;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 后序遍历，非递归</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> root 二叉树根节点</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">postOrderTraveralWithStack</span><span class=\"params\">(BinaryTree.TreeNode root)</span> &#123;</span><br><span class=\"line\">    Stack&lt;BinaryTree.TreeNode&gt; stack = <span class=\"keyword\">new</span> <span class=\"title class_\">Stack</span>&lt;&gt;();</span><br><span class=\"line\">    List&lt;Integer&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">    BinaryTree.<span class=\"type\">TreeNode</span> <span class=\"variable\">treeNode</span> <span class=\"operator\">=</span> root;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (treeNode != <span class=\"literal\">null</span> || !stack.isEmpty()) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (treeNode != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            list.add(treeNode.data());</span><br><span class=\"line\">            stack.push(treeNode);</span><br><span class=\"line\">            treeNode = treeNode.rightChile();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!stack.isEmpty()) &#123;</span><br><span class=\"line\">            treeNode = stack.pop();</span><br><span class=\"line\">            treeNode = treeNode.leftChild();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> list.size() - <span class=\"number\">1</span>; i &gt;= <span class=\"number\">0</span>; i--) &#123;</span><br><span class=\"line\">        System.out.print(list.get(i) + <span class=\"string\">&quot;\\t&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"层序遍历\"><a href=\"#层序遍历\" class=\"headerlink\" title=\"层序遍历\"></a>层序遍历</h2><p>二叉树的层序遍历，输出顺序按照一层一层往下输出，所以也叫作广度优先遍历。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">     <span class=\"number\">3</span></span><br><span class=\"line\">   /   \\</span><br><span class=\"line\">  <span class=\"number\">2</span>     <span class=\"number\">8</span></span><br><span class=\"line\"> /  \\     \\</span><br><span class=\"line\"><span class=\"number\">9</span>   <span class=\"number\">10</span>     <span class=\"number\">4</span></span><br></pre></td></tr></table></figure>\n\n<p>上述的二叉树中，层序遍历的输出循序为：<code>3、2、8、9、10、4</code>。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">    Integer[] arr = <span class=\"keyword\">new</span> <span class=\"title class_\">Integer</span>[]&#123;<span class=\"number\">3</span>, <span class=\"number\">2</span>, <span class=\"number\">9</span>, <span class=\"literal\">null</span>, <span class=\"literal\">null</span>, <span class=\"number\">10</span>, <span class=\"literal\">null</span>, <span class=\"literal\">null</span>, <span class=\"number\">8</span>, <span class=\"literal\">null</span>, <span class=\"number\">4</span>&#125;;</span><br><span class=\"line\">    <span class=\"comment\">// 构建二叉树</span></span><br><span class=\"line\">    <span class=\"type\">BinaryTree</span> <span class=\"variable\">binaryTree</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">BinaryTree</span>(arr);</span><br><span class=\"line\">    <span class=\"comment\">// 获取二叉树的根节点</span></span><br><span class=\"line\">    BinaryTree.<span class=\"type\">TreeNode</span> <span class=\"variable\">root</span> <span class=\"operator\">=</span> binaryTree.root();</span><br><span class=\"line\">    System.out.println(<span class=\"string\">&quot;层序遍历：&quot;</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 层序遍历</span></span><br><span class=\"line\">    levelOrderTraveralWithQueue(root);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 层序遍历</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> root 二叉树根节点</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">levelOrderTraveralWithQueue</span><span class=\"params\">(BinaryTree.TreeNode root)</span> &#123;</span><br><span class=\"line\">    Queue&lt;BinaryTree.TreeNode&gt; queue = <span class=\"keyword\">new</span> <span class=\"title class_\">LinkedList</span>&lt;&gt;();</span><br><span class=\"line\">    queue.offer(root);</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (!queue.isEmpty()) &#123;</span><br><span class=\"line\">        BinaryTree.<span class=\"type\">TreeNode</span> <span class=\"variable\">node</span> <span class=\"operator\">=</span> queue.poll();</span><br><span class=\"line\">        System.out.print(node.data() + <span class=\"string\">&quot;\\t&quot;</span>);</span><br><span class=\"line\">        BinaryTree.<span class=\"type\">TreeNode</span> <span class=\"variable\">leftChild</span> <span class=\"operator\">=</span> node.leftChild();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (leftChild != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            queue.offer(leftChild);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        BinaryTree.<span class=\"type\">TreeNode</span> <span class=\"variable\">rightChile</span> <span class=\"operator\">=</span> node.rightChile();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (rightChile != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            queue.offer(rightChile);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h1><blockquote>\n<p>本文<strong>Github</strong> <a href=\"https://github.com/herenpeng/code-learn\">https://github.com/herenpeng/code-learn</a> 已收录，欢迎<strong>Star</strong>。</p>\n</blockquote>\n","categories":["数据结构与算法"],"tags":["树"]},{"title":"数据结构之什么是链表？","url":"/2021/02/24/algorithm/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B9%8B%E4%BB%80%E4%B9%88%E6%98%AF%E9%93%BE%E8%A1%A8/","content":"<h1 id=\"什么是链表？\"><a href=\"#什么是链表？\" class=\"headerlink\" title=\"什么是链表？\"></a>什么是链表？</h1><p>链表（linked list）是一种在物理上非连续、非顺序的数据结构，由若干个节点（node）所组成。</p>\n<span id=\"more\"></span>\n\n<p>链表分为单向链表和双向链表。</p>\n<ul>\n<li><p>单向链表的每一个节点包含两部分，一部分是存放数据的变量data，另一部分是指向下一个节点的指针next。</p>\n</li>\n<li><p>双向链表比单向链表复杂一些，它的每一个节点除了拥有data和next指针，还拥有指向前置节点的prev指针。</p>\n</li>\n</ul>\n<p>如果说数组在内存中的存储方式为顺序存储，那么链表在内存在的存储方式则是随机存储。</p>\n<p><strong>什么是随机存储？</strong></p>\n<p>数组在内存中占用了连续完整的存储空间。而链表则采用见缝插针的方式，链表的每一个节点分布在内存空间中的不同位置，依靠指针关联起来，这样可以灵活有效地利用零散的碎片空间。</p>\n<h1 id=\"链表的组成\"><a href=\"#链表的组成\" class=\"headerlink\" title=\"链表的组成\"></a>链表的组成</h1><blockquote>\n<p>本篇文章中的链表均以单链表的Demo，在文章的末尾处会附带双向链表的实现代码。</p>\n</blockquote>\n<ul>\n<li><p>节点：一个链表是有若干个结点组成的，节点是链表的基础结构。</p>\n</li>\n<li><p>头节点指针：链表需要一个头节点指针，用于表示链表开始的位置。</p>\n</li>\n<li><p>尾结点指针：链表可以设置一个尾部节点指针。</p>\n<blockquote>\n<p>当然，链表的尾部节点指针不是必须的，因为链表最后一个节点的next指针指向空，也可以标识链表的结尾。</p>\n</blockquote>\n</li>\n<li><p>链表实际长度：可以设置一个变量记录链表的实际长度。</p>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">LinkedList</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 链表的头指针</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Node head;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 链表的尾部指针</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Node last;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 链表的实际长度</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> size;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取链表的头指针</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 链表的头指针</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Node <span class=\"title function_\">head</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.head;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取链表的尾部指针</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 链表的尾部指针</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Node <span class=\"title function_\">last</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.last;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取链表的实际长度</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 链表的实际长度</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">size</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.size;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 将节点点作为链表的一个内部类</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">class</span> <span class=\"title class_\">Node</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 节点存储的数据data</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"type\">int</span> data;</span><br><span class=\"line\">        <span class=\"comment\">// 该指针指向下一个节点的指针next</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> Node next;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 构造函数</span></span><br><span class=\"line\">        Node(<span class=\"type\">int</span> data) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">this</span>.data = data;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 返回节点中存储的数据值</span></span><br><span class=\"line\"><span class=\"comment\">         *</span></span><br><span class=\"line\"><span class=\"comment\">         * <span class=\"doctag\">@return</span> 节点中存储的数据值</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">data</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.data;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 返回下一个节点的指针</span></span><br><span class=\"line\"><span class=\"comment\">         *</span></span><br><span class=\"line\"><span class=\"comment\">         * <span class=\"doctag\">@return</span> 下一个节点的指针</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> Node <span class=\"title function_\">next</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h1 id=\"链表的基本操作\"><a href=\"#链表的基本操作\" class=\"headerlink\" title=\"链表的基本操作\"></a>链表的基本操作</h1><p>和数组一样，链表的基本操作也同样是增、删、改、查四种操作。</p>\n<h2 id=\"查\"><a href=\"#查\" class=\"headerlink\" title=\"查\"></a>查</h2><p>链表查找元素不像数组那样可以通过下标进行随机访问，链表想要查找一个元素，只能从头节点开始，一个一个向后查找。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 链表的查找操作</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> index 需要查找的链表索引</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> 索引对应的链表节点</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Node <span class=\"title function_\">get</span><span class=\"params\">(<span class=\"type\">int</span> index)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (index &lt; <span class=\"number\">0</span> || index &gt;= size) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IndexOutOfBoundsException</span>(<span class=\"string\">&quot;超出链表的实际节点范围&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 找到链表的头节点的位置</span></span><br><span class=\"line\">    <span class=\"type\">Node</span> <span class=\"variable\">temp</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.head;</span><br><span class=\"line\">    <span class=\"comment\">// 从头节点向后查找，共向后循环index次，即可找到index位置的节点</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; index; i++) &#123;</span><br><span class=\"line\">        temp = temp.next;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> temp;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"改\"><a href=\"#改\" class=\"headerlink\" title=\"改\"></a>改</h2><p>链表的更新操作也比较简单，只需要查找到需要修改的节点，直接将原节点的数据替换即可。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 更新链表节点</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> index 需要更新的链表位置</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> data  需要更新的节点的值</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">update</span><span class=\"params\">(<span class=\"type\">int</span> index, <span class=\"type\">int</span> data)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (index &lt; <span class=\"number\">0</span> || index &gt;= size) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IndexOutOfBoundsException</span>(<span class=\"string\">&quot;超出链表的实际节点范围&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 找到链表的头节点的位置</span></span><br><span class=\"line\">    <span class=\"type\">Node</span> <span class=\"variable\">temp</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.head;</span><br><span class=\"line\">    <span class=\"comment\">// 从头节点向后查找，共向后循环index次，即可找到index位置的节点</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; index; i++) &#123;</span><br><span class=\"line\">        temp = temp.next;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 使用需要替换的值，替换原值</span></span><br><span class=\"line\">    temp.data = data;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"增\"><a href=\"#增\" class=\"headerlink\" title=\"增\"></a>增</h2><p>链表的插入操作分为三组：</p>\n<ul>\n<li><p>尾部插入</p>\n<blockquote>\n<p>链表的尾部操作最为简单，只需要将链表的尾部节点的next指针，指向新结点即可。<br>  如果有尾部节点指针，则还需要维护链表尾部节点指针，将其指向新节点。</p>\n</blockquote>\n</li>\n<li><p>中间插入</p>\n<blockquote>\n<p>链表的中间插入，分为三步：<br>  第一步：找到要插入的链表位置。<br>  第二步：将新结点的next指针指向插入位置的节点。<br>  第三步：将原插入位置的节点的上一个节点的next指针指向新节点。  </p>\n</blockquote>\n</li>\n<li><p>头部插入</p>\n<blockquote>\n<p>链表的头部插入，分为三步：<br>  第一步：将新节点的next指针指向新节点。<br>  第二步：维护链表的头部节点指针，将其指向新节点。</p>\n</blockquote>\n</li>\n</ul>\n<blockquote>\n<p>链表的插入操作与数组的插入操作有些许不同，就在于链表不会出现容量不足的情况，无需进行扩容操作。</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 直接在尾部插入</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> data 需要插入的数据</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">insert</span><span class=\"params\">(<span class=\"type\">int</span> data)</span> &#123;</span><br><span class=\"line\">    insert(size, data);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 直接在尾部插入</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> index 需要插入的链表位置</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> data  需要插入的数据</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">insert</span><span class=\"params\">(<span class=\"type\">int</span> index, <span class=\"type\">int</span> data)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (index &lt; <span class=\"number\">0</span> || index &gt; size) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IndexOutOfBoundsException</span>(<span class=\"string\">&quot;超出链表的实际节点范围&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 将需要插入的数据封装为一个链表节点</span></span><br><span class=\"line\">    <span class=\"type\">Node</span> <span class=\"variable\">insertNode</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Node</span>(data);</span><br><span class=\"line\">    <span class=\"comment\">// 链表节点为空的情况</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (size == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 维护链表头部节点指针</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.head = insertNode;</span><br><span class=\"line\">        <span class=\"comment\">// 维护链表尾部节点指针</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.last = insertNode;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (index == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 头部插入</span></span><br><span class=\"line\">        <span class=\"comment\">// 使用新节点的next指针指向头部节点</span></span><br><span class=\"line\">        insertNode.next = <span class=\"built_in\">this</span>.head;</span><br><span class=\"line\">        <span class=\"comment\">// 维护链表头部节点的指针</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.head = insertNode;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (index == size) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 尾部插入</span></span><br><span class=\"line\">        <span class=\"comment\">// 直接使用尾部节点指针指向新结点</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.last.next = insertNode;</span><br><span class=\"line\">        <span class=\"comment\">// 维护链表尾部节点的指针</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.last = insertNode;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 获取插入位置的前一个节点</span></span><br><span class=\"line\">        <span class=\"type\">Node</span> <span class=\"variable\">prevNode</span> <span class=\"operator\">=</span> get(index - <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 将新节点的next指针指向插入位置节点</span></span><br><span class=\"line\">        insertNode.next = prevNode.next;</span><br><span class=\"line\">        <span class=\"comment\">// 插入位置的前一个节点的next指针指向新节点</span></span><br><span class=\"line\">        prevNode.next = insertNode;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 维护链表长度</span></span><br><span class=\"line\">    size++;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"删\"><a href=\"#删\" class=\"headerlink\" title=\"删\"></a>删</h2><p>链表的删除操作和插入操作类似。</p>\n<ul>\n<li><p>删除头部节点</p>\n<blockquote>\n<p>删除头部节点，只需要将链表的head指针指向原head节点的下一个节点即可。</p>\n</blockquote>\n</li>\n<li><p>删除中间节点</p>\n<blockquote>\n<p>删除中间节点，删除位置的前一个节点的next指针指向删除位置的下一个节点即可。</p>\n</blockquote>\n</li>\n<li><p>删除尾部节点</p>\n<blockquote>\n<p>删除尾部节点，将尾部节点的前一个节点的next指针置空，并维护last指针即可。</p>\n</blockquote>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 删除链表的结点</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> index 需要删除的位置</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> 被删除的节点</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> Node <span class=\"title function_\">remove</span><span class=\"params\">(<span class=\"type\">int</span> index)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (index &lt; <span class=\"number\">0</span> || index &gt;= size) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IndexOutOfBoundsException</span>(<span class=\"string\">&quot;超出链表的实际节点范围&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"type\">Node</span> <span class=\"variable\">removeNode</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    <span class=\"comment\">// 头部删除</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (index == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        removeNode = <span class=\"built_in\">this</span>.head;</span><br><span class=\"line\">        <span class=\"comment\">// 维护链表的头部指针</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.head = removeNode.next;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (index == size - <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 尾部删除</span></span><br><span class=\"line\">        <span class=\"comment\">// 获取尾部的前一个节点</span></span><br><span class=\"line\">        <span class=\"type\">Node</span> <span class=\"variable\">prevNode</span> <span class=\"operator\">=</span> get(index - <span class=\"number\">1</span>);</span><br><span class=\"line\">        removeNode = prevNode.next;</span><br><span class=\"line\">        <span class=\"comment\">// 置空尾部的前一个节点的next指针</span></span><br><span class=\"line\">        prevNode.next = <span class=\"literal\">null</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 维护链表的尾部指针</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.last = prevNode;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 获取插入位置的前一个节点</span></span><br><span class=\"line\">        <span class=\"type\">Node</span> <span class=\"variable\">prevNode</span> <span class=\"operator\">=</span> get(index - <span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 需要删除的节点</span></span><br><span class=\"line\">        removeNode = prevNode.next;</span><br><span class=\"line\">        <span class=\"comment\">// 将删除位置的上一个节点的next指针指向删除位置的下一个节点</span></span><br><span class=\"line\">        prevNode.next = removeNode.next;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// 维护链表长度</span></span><br><span class=\"line\">    size--;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> removeNode;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"链表操作的时间复杂度\"><a href=\"#链表操作的时间复杂度\" class=\"headerlink\" title=\"链表操作的时间复杂度\"></a>链表操作的时间复杂度</h1><table>\n<thead>\n<tr>\n<th>链表操作</th>\n<th>时间复杂度</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>查找节点</td>\n<td>O(n)</td>\n</tr>\n<tr>\n<td>更新节点</td>\n<td>O(1)</td>\n</tr>\n<tr>\n<td>插入节点</td>\n<td>O(1)</td>\n</tr>\n<tr>\n<td>删除节点</td>\n<td>O(1)</td>\n</tr>\n</tbody></table>\n<h1 id=\"链表的优势和劣势\"><a href=\"#链表的优势和劣势\" class=\"headerlink\" title=\"链表的优势和劣势\"></a>链表的优势和劣势</h1><p>优势：链表能够灵活地插入，删除节点，所以更适用于插入，更新，删除操作更多场景。</p>\n<p>劣势：链表的查找操作，需要从头遍历整个链表，性能低下，不适用与读操作多的场景。</p>\n<h1 id=\"单链表的完整代码（Java）\"><a href=\"#单链表的完整代码（Java）\" class=\"headerlink\" title=\"单链表的完整代码（Java）\"></a>单链表的完整代码（Java）</h1><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">LinkedList</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 链表的头指针</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Node head;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 链表的尾部指针</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Node last;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 链表的实际长度</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> size;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取链表的头指针</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 链表的头指针</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Node <span class=\"title function_\">head</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.head;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取链表的尾部指针</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 链表的尾部指针</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Node <span class=\"title function_\">last</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.last;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取链表的实际长度</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 链表的实际长度</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">size</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.size;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 链表的查找操作</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> index 需要查找的链表索引</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 索引对应的链表节点</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Node <span class=\"title function_\">get</span><span class=\"params\">(<span class=\"type\">int</span> index)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (index &lt; <span class=\"number\">0</span> || index &gt;= size) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IndexOutOfBoundsException</span>(<span class=\"string\">&quot;超出链表的实际节点范围&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 找到链表的头节点的位置</span></span><br><span class=\"line\">        <span class=\"type\">Node</span> <span class=\"variable\">temp</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.head;</span><br><span class=\"line\">        <span class=\"comment\">// 从头节点向后查找，共向后循环index次，即可找到index位置的节点</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; index; i++) &#123;</span><br><span class=\"line\">            temp = temp.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> temp;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 更新链表节点</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> index 需要更新的链表位置</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> data  需要更新的节点的值</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">update</span><span class=\"params\">(<span class=\"type\">int</span> index, <span class=\"type\">int</span> data)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (index &lt; <span class=\"number\">0</span> || index &gt;= size) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IndexOutOfBoundsException</span>(<span class=\"string\">&quot;超出链表的实际节点范围&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 找到链表的头节点的位置</span></span><br><span class=\"line\">        <span class=\"type\">Node</span> <span class=\"variable\">temp</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.head;</span><br><span class=\"line\">        <span class=\"comment\">// 从头节点向后查找，共向后循环index次，即可找到index位置的节点</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; index; i++) &#123;</span><br><span class=\"line\">            temp = temp.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 使用需要替换的值，替换原值</span></span><br><span class=\"line\">        temp.data = data;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 直接在尾部插入</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> data 需要插入的数据</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">insert</span><span class=\"params\">(<span class=\"type\">int</span> data)</span> &#123;</span><br><span class=\"line\">        insert(size, data);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 直接在尾部插入</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> index 需要插入的链表位置</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> data  需要插入的数据</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">insert</span><span class=\"params\">(<span class=\"type\">int</span> index, <span class=\"type\">int</span> data)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (index &lt; <span class=\"number\">0</span> || index &gt; size) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IndexOutOfBoundsException</span>(<span class=\"string\">&quot;超出链表的实际节点范围&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 将需要插入的数据封装为一个链表节点</span></span><br><span class=\"line\">        <span class=\"type\">Node</span> <span class=\"variable\">insertNode</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Node</span>(data);</span><br><span class=\"line\">        <span class=\"comment\">// 链表节点为空的情况</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (size == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 维护链表头部节点指针</span></span><br><span class=\"line\">            <span class=\"built_in\">this</span>.head = insertNode;</span><br><span class=\"line\">            <span class=\"comment\">// 维护链表尾部节点指针</span></span><br><span class=\"line\">            <span class=\"built_in\">this</span>.last = insertNode;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (index == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 头部插入</span></span><br><span class=\"line\">            <span class=\"comment\">// 使用新节点的next指针指向头部节点</span></span><br><span class=\"line\">            insertNode.next = <span class=\"built_in\">this</span>.head;</span><br><span class=\"line\">            <span class=\"comment\">// 维护链表头部节点的指针</span></span><br><span class=\"line\">            <span class=\"built_in\">this</span>.head = insertNode;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (index == size) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 尾部插入</span></span><br><span class=\"line\">            <span class=\"comment\">// 直接使用尾部节点指针指向新结点</span></span><br><span class=\"line\">            <span class=\"built_in\">this</span>.last.next = insertNode;</span><br><span class=\"line\">            <span class=\"comment\">// 维护链表尾部节点的指针</span></span><br><span class=\"line\">            <span class=\"built_in\">this</span>.last = insertNode;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 获取插入位置的前一个节点</span></span><br><span class=\"line\">            <span class=\"type\">Node</span> <span class=\"variable\">prevNode</span> <span class=\"operator\">=</span> get(index - <span class=\"number\">1</span>);</span><br><span class=\"line\">            <span class=\"comment\">// 将新节点的next指针指向插入位置节点</span></span><br><span class=\"line\">            insertNode.next = prevNode.next;</span><br><span class=\"line\">            <span class=\"comment\">// 插入位置的前一个节点的next指针指向新节点</span></span><br><span class=\"line\">            prevNode.next = insertNode;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 维护链表长度</span></span><br><span class=\"line\">        size++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 删除链表的结点</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> index 需要删除的位置</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 被删除的节点</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Node <span class=\"title function_\">remove</span><span class=\"params\">(<span class=\"type\">int</span> index)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (index &lt; <span class=\"number\">0</span> || index &gt;= size) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IndexOutOfBoundsException</span>(<span class=\"string\">&quot;超出链表的实际节点范围&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">Node</span> <span class=\"variable\">removeNode</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 头部删除</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (index == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            removeNode = <span class=\"built_in\">this</span>.head;</span><br><span class=\"line\">            <span class=\"comment\">// 维护链表的头部指针</span></span><br><span class=\"line\">            <span class=\"built_in\">this</span>.head = removeNode.next;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (index == size - <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 尾部删除</span></span><br><span class=\"line\">            <span class=\"comment\">// 获取尾部的前一个节点</span></span><br><span class=\"line\">            <span class=\"type\">Node</span> <span class=\"variable\">prevNode</span> <span class=\"operator\">=</span> get(index - <span class=\"number\">1</span>);</span><br><span class=\"line\">            removeNode = prevNode.next;</span><br><span class=\"line\">            <span class=\"comment\">// 置空尾部的前一个节点的next指针</span></span><br><span class=\"line\">            prevNode.next = <span class=\"literal\">null</span>;</span><br><span class=\"line\">            <span class=\"comment\">// 维护链表的尾部指针</span></span><br><span class=\"line\">            <span class=\"built_in\">this</span>.last = prevNode;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 获取插入位置的前一个节点</span></span><br><span class=\"line\">            <span class=\"type\">Node</span> <span class=\"variable\">prevNode</span> <span class=\"operator\">=</span> get(index - <span class=\"number\">1</span>);</span><br><span class=\"line\">            <span class=\"comment\">// 需要删除的节点</span></span><br><span class=\"line\">            removeNode = prevNode.next;</span><br><span class=\"line\">            <span class=\"comment\">// 将删除位置的上一个节点的next指针指向删除位置的下一个节点</span></span><br><span class=\"line\">            prevNode.next = removeNode.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 维护链表长度</span></span><br><span class=\"line\">        size--;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> removeNode;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 将节点点作为链表的一个内部类</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">class</span> <span class=\"title class_\">Node</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 节点存储的数据data</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"type\">int</span> data;</span><br><span class=\"line\">        <span class=\"comment\">// 该指针指向下一个节点的指针next</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> Node next;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 构造函数</span></span><br><span class=\"line\">        Node(<span class=\"type\">int</span> data) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">this</span>.data = data;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 返回节点中存储的数据值</span></span><br><span class=\"line\"><span class=\"comment\">         *</span></span><br><span class=\"line\"><span class=\"comment\">         * <span class=\"doctag\">@return</span> 节点中存储的数据值</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">data</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.data;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 返回下一个节点的指针</span></span><br><span class=\"line\"><span class=\"comment\">         *</span></span><br><span class=\"line\"><span class=\"comment\">         * <span class=\"doctag\">@return</span> 下一个节点的指针</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> Node <span class=\"title function_\">next</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"双向链表的完整代码（Java）\"><a href=\"#双向链表的完整代码（Java）\" class=\"headerlink\" title=\"双向链表的完整代码（Java）\"></a>双向链表的完整代码（Java）</h1><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DoubleLinkedList</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 链表的头指针</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Node head;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 链表的尾部指针</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Node last;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 链表的实际长度</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> size;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取链表的头指针</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 链表的头指针</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Node <span class=\"title function_\">head</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.head;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取链表的尾部指针</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 链表的尾部指针</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Node <span class=\"title function_\">last</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.last;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取链表的实际长度</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 链表的实际长度</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">size</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.size;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 链表的查找操作</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> index 需要查找的链表索引</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 索引对应的链表节点</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Node <span class=\"title function_\">get</span><span class=\"params\">(<span class=\"type\">int</span> index)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (index &lt; <span class=\"number\">0</span> || index &gt;= size) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IndexOutOfBoundsException</span>(<span class=\"string\">&quot;超出链表的实际节点范围&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 找到链表的头节点的位置</span></span><br><span class=\"line\">        <span class=\"type\">Node</span> <span class=\"variable\">temp</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.head;</span><br><span class=\"line\">        <span class=\"comment\">// 从头节点向后查找，共向后循环index次，即可找到index位置的节点</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; index; i++) &#123;</span><br><span class=\"line\">            temp = temp.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> temp;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 更新链表节点</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> index 需要更新的链表位置</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> data  需要更新的节点的值</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">update</span><span class=\"params\">(<span class=\"type\">int</span> index, <span class=\"type\">int</span> data)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (index &lt; <span class=\"number\">0</span> || index &gt;= size) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IndexOutOfBoundsException</span>(<span class=\"string\">&quot;超出链表的实际节点范围&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 找到链表的头节点的位置</span></span><br><span class=\"line\">        <span class=\"type\">Node</span> <span class=\"variable\">temp</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.head;</span><br><span class=\"line\">        <span class=\"comment\">// 从头节点向后查找，共向后循环index次，即可找到index位置的节点</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; index; i++) &#123;</span><br><span class=\"line\">            temp = temp.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 使用需要替换的值，替换原值</span></span><br><span class=\"line\">        temp.data = data;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 直接在尾部插入</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> data 需要插入的数据</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">insert</span><span class=\"params\">(<span class=\"type\">int</span> data)</span> &#123;</span><br><span class=\"line\">        insert(size, data);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 直接在尾部插入</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> index 需要插入的链表位置</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> data  需要插入的数据</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">insert</span><span class=\"params\">(<span class=\"type\">int</span> index, <span class=\"type\">int</span> data)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (index &lt; <span class=\"number\">0</span> || index &gt; size) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IndexOutOfBoundsException</span>(<span class=\"string\">&quot;超出链表的实际节点范围&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 将需要插入的数据封装为一个链表节点</span></span><br><span class=\"line\">        <span class=\"type\">Node</span> <span class=\"variable\">insertNode</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Node</span>(data);</span><br><span class=\"line\">        <span class=\"comment\">// 链表节点为空的情况</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (size == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 维护链表头部节点指针</span></span><br><span class=\"line\">            <span class=\"built_in\">this</span>.head = insertNode;</span><br><span class=\"line\">            <span class=\"comment\">// 维护链表尾部节点指针</span></span><br><span class=\"line\">            <span class=\"built_in\">this</span>.last = insertNode;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (index == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 头部插入</span></span><br><span class=\"line\">            <span class=\"type\">Node</span> <span class=\"variable\">headNode</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.head;</span><br><span class=\"line\">            <span class=\"comment\">// 将原头节点的上一个节点指针指向新节点</span></span><br><span class=\"line\">            headNode.prev = insertNode;</span><br><span class=\"line\">            <span class=\"comment\">// 使用新节点的next指针指向头部节点</span></span><br><span class=\"line\">            insertNode.next = headNode;</span><br><span class=\"line\">            <span class=\"comment\">// 维护链表头部节点的指针</span></span><br><span class=\"line\">            <span class=\"built_in\">this</span>.head = insertNode;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (index == size) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 尾部插入</span></span><br><span class=\"line\">            <span class=\"comment\">// 直接使用尾部节点指针指向新结点</span></span><br><span class=\"line\">            <span class=\"built_in\">this</span>.last.next = insertNode;</span><br><span class=\"line\">            <span class=\"comment\">// 新节点的上一个节点指向原尾部节点</span></span><br><span class=\"line\">            insertNode.prev = <span class=\"built_in\">this</span>.last;</span><br><span class=\"line\">            <span class=\"comment\">// 维护链表尾部节点的指针</span></span><br><span class=\"line\">            <span class=\"built_in\">this</span>.last = insertNode;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 获取插入位置的前一个节点</span></span><br><span class=\"line\">            <span class=\"type\">Node</span> <span class=\"variable\">prevNode</span> <span class=\"operator\">=</span> get(index - <span class=\"number\">1</span>);</span><br><span class=\"line\">            <span class=\"comment\">// 插入位置的节点</span></span><br><span class=\"line\">            <span class=\"type\">Node</span> <span class=\"variable\">nextNode</span> <span class=\"operator\">=</span> prevNode.next;</span><br><span class=\"line\">            nextNode.prev = insertNode;</span><br><span class=\"line\">            <span class=\"comment\">// 将新节点的next指针指向插入位置节点,prev指针指向前一个节点</span></span><br><span class=\"line\">            insertNode.next = nextNode;</span><br><span class=\"line\">            insertNode.prev = prevNode;</span><br><span class=\"line\">            <span class=\"comment\">// 插入位置的前一个节点的next指针指向新节点</span></span><br><span class=\"line\">            prevNode.next = insertNode;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 维护链表长度</span></span><br><span class=\"line\">        size++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 删除链表的结点</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> index 需要删除的位置</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 被删除的节点</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Node <span class=\"title function_\">remove</span><span class=\"params\">(<span class=\"type\">int</span> index)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (index &lt; <span class=\"number\">0</span> || index &gt;= size) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IndexOutOfBoundsException</span>(<span class=\"string\">&quot;超出链表的实际节点范围&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">Node</span> <span class=\"variable\">removeNode</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 头部删除</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (index == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            removeNode = <span class=\"built_in\">this</span>.head;</span><br><span class=\"line\">            <span class=\"type\">Node</span> <span class=\"variable\">nextHead</span> <span class=\"operator\">=</span> removeNode.next;</span><br><span class=\"line\">            <span class=\"comment\">// 置空新的头部节点的pre指针</span></span><br><span class=\"line\">            nextHead.prev = <span class=\"literal\">null</span>;</span><br><span class=\"line\">            <span class=\"comment\">// 维护链表的头部指针</span></span><br><span class=\"line\">            <span class=\"built_in\">this</span>.head = nextHead;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (index == size - <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 尾部删除</span></span><br><span class=\"line\">            <span class=\"comment\">// 获取尾部的前一个节点</span></span><br><span class=\"line\">            <span class=\"type\">Node</span> <span class=\"variable\">prevNode</span> <span class=\"operator\">=</span> get(index - <span class=\"number\">1</span>);</span><br><span class=\"line\">            removeNode = prevNode.next;</span><br><span class=\"line\">            <span class=\"comment\">// 置空尾部的前一个节点的next指针</span></span><br><span class=\"line\">            prevNode.next = <span class=\"literal\">null</span>;</span><br><span class=\"line\">            <span class=\"comment\">// 维护链表的尾部指针</span></span><br><span class=\"line\">            <span class=\"built_in\">this</span>.last = prevNode;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 获取插入位置的前一个节点</span></span><br><span class=\"line\">            <span class=\"type\">Node</span> <span class=\"variable\">prevNode</span> <span class=\"operator\">=</span> get(index - <span class=\"number\">1</span>);</span><br><span class=\"line\">            <span class=\"comment\">// 需要删除的节点</span></span><br><span class=\"line\">            removeNode = prevNode.next;</span><br><span class=\"line\">            <span class=\"comment\">// 删除节点的下一个节点</span></span><br><span class=\"line\">            <span class=\"type\">Node</span> <span class=\"variable\">nextNode</span> <span class=\"operator\">=</span> removeNode.next;</span><br><span class=\"line\">            <span class=\"comment\">// 将删除位置的上一个节点的next指针指向删除位置的下一个节点</span></span><br><span class=\"line\">            prevNode.next = nextNode;</span><br><span class=\"line\">            nextNode.prev = prevNode;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 维护链表长度</span></span><br><span class=\"line\">        size--;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> removeNode;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 将节点点作为链表的一个内部类</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">class</span> <span class=\"title class_\">Node</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 节点存储的数据data</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"type\">int</span> data;</span><br><span class=\"line\">        <span class=\"comment\">// 该指针指向上一个</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> Node prev;</span><br><span class=\"line\">        <span class=\"comment\">// 该指针指向下一个节点的指针next</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> Node next;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 构造函数</span></span><br><span class=\"line\">        Node(<span class=\"type\">int</span> data) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">this</span>.data = data;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 返回节点中存储的数据值</span></span><br><span class=\"line\"><span class=\"comment\">         *</span></span><br><span class=\"line\"><span class=\"comment\">         * <span class=\"doctag\">@return</span> 节点中存储的数据值</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">data</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.data;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 返回上一个节点的指针</span></span><br><span class=\"line\"><span class=\"comment\">         *</span></span><br><span class=\"line\"><span class=\"comment\">         * <span class=\"doctag\">@return</span> 上一个节点的指针</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> Node <span class=\"title function_\">prev</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.prev;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 返回下一个节点的指针</span></span><br><span class=\"line\"><span class=\"comment\">         *</span></span><br><span class=\"line\"><span class=\"comment\">         * <span class=\"doctag\">@return</span> 下一个节点的指针</span></span><br><span class=\"line\"><span class=\"comment\">         */</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> Node <span class=\"title function_\">next</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.next;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h1><blockquote>\n<p>本文<strong>Github</strong> <a href=\"https://github.com/herenpeng/code-learn\">https://github.com/herenpeng/code-learn</a> 已收录，欢迎<strong>Star</strong>。</p>\n</blockquote>\n","categories":["数据结构与算法"],"tags":["链表"]},{"title":"面试算法之如何判断链表有环","url":"/2021/04/21/algorithm/%E9%9D%A2%E8%AF%95%E7%AE%97%E6%B3%95%E4%B9%8B%E5%A6%82%E4%BD%95%E5%88%A4%E6%96%AD%E9%93%BE%E8%A1%A8%E6%9C%89%E7%8E%AF/","content":"<h1 id=\"如何判断链表有环\"><a href=\"#如何判断链表有环\" class=\"headerlink\" title=\"如何判断链表有环\"></a>如何判断链表有环</h1><p>给一个单向链表，使用程序来判断链表中是否存在环结构。</p>\n<span id=\"more\"></span>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Node</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> data;</span><br><span class=\"line\">    Node next;</span><br><span class=\"line\"></span><br><span class=\"line\">    Node(<span class=\"type\">int</span> data) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.data = data;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">Node</span> <span class=\"variable\">node1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Node</span>(<span class=\"number\">5</span>);</span><br><span class=\"line\">    <span class=\"type\">Node</span> <span class=\"variable\">node2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Node</span>(<span class=\"number\">3</span>);</span><br><span class=\"line\">    <span class=\"type\">Node</span> <span class=\"variable\">node3</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Node</span>(<span class=\"number\">7</span>);</span><br><span class=\"line\">    <span class=\"type\">Node</span> <span class=\"variable\">node4</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Node</span>(<span class=\"number\">2</span>);</span><br><span class=\"line\">    <span class=\"type\">Node</span> <span class=\"variable\">node5</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Node</span>(<span class=\"number\">6</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    node1.next = node2;</span><br><span class=\"line\">    node2.next = node3;</span><br><span class=\"line\">    node3.next = node4;</span><br><span class=\"line\">    node4.next = node5;</span><br><span class=\"line\">    node5.next = node2;</span><br><span class=\"line\">    <span class=\"comment\">// 解法一</span></span><br><span class=\"line\">    System.out.println(isCycle1(node1));</span><br><span class=\"line\">    <span class=\"comment\">// 解法二</span></span><br><span class=\"line\">    System.out.println(isCycle2(node1));</span><br><span class=\"line\">    <span class=\"comment\">// 解法三</span></span><br><span class=\"line\">    System.out.println(isCycle3(node1));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"解法一\"><a href=\"#解法一\" class=\"headerlink\" title=\"解法一\"></a>解法一</h2><p>解法一：依次遍历链表的节点，每遍历一个节点，就从头部开始检查到当前节点之前的所有节点，用当前节点和此节点之前的所有节点进行比较，如果存在相等的节点，则说明链表结构存在环，否则继续遍历节点，直到链表结束。</p>\n<p>代码实现：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">boolean</span> <span class=\"title function_\">isCycle1</span><span class=\"params\">(Node head)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">Node</span> <span class=\"variable\">currentNode</span> <span class=\"operator\">=</span> head.next;</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">currentIndex</span> <span class=\"operator\">=</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (currentNode != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"type\">Node</span> <span class=\"variable\">node</span> <span class=\"operator\">=</span> head;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (node != <span class=\"literal\">null</span> &amp;&amp; i &lt; currentIndex) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (node == currentNode) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            node = node.next;</span><br><span class=\"line\">            i++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        currentNode = currentNode.next;</span><br><span class=\"line\">        currentIndex++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"解法二\"><a href=\"#解法二\" class=\"headerlink\" title=\"解法二\"></a>解法二</h2><p>解法二：使用一个 HashSet 结构，从头开始遍历链表，每次遍历连接，使用当前节点去 HashSet 中获取节点元素，如果 HashSet 中不存在当前节点，则将当前节点存入 HashSet 容器中，如果 HashSet 中存在当前节点，说明链表存在环。</p>\n<blockquote>\n<p>这其实是一种类似 Redis 中的布隆过滤器的结构。</p>\n</blockquote>\n<p>代码实现：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">boolean</span> <span class=\"title function_\">isCycle2</span><span class=\"params\">(Node head)</span> &#123;</span><br><span class=\"line\">    Set&lt;Node&gt; set = <span class=\"keyword\">new</span> <span class=\"title class_\">HashSet</span>&lt;&gt;();</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (head != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (set.remove(head)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        set.add(head);</span><br><span class=\"line\">        head = head.next;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"解法三\"><a href=\"#解法三\" class=\"headerlink\" title=\"解法三\"></a>解法三</h2><p>解法三：使用两个指针，让它们从头部开始遍历，其中一个指针每次遍历向后移动一个节点，另一个指针每次遍历向后移动两个节点，然后比较两个指针指向的节点是否相同。如果相同，则可以判断出链表有换，如果不同，则继续下一次循环。</p>\n<p>代码实现：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">boolean</span> <span class=\"title function_\">isCycle3</span><span class=\"params\">(Node head)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">Node</span> <span class=\"variable\">p1</span> <span class=\"operator\">=</span> head;</span><br><span class=\"line\">    <span class=\"type\">Node</span> <span class=\"variable\">p2</span> <span class=\"operator\">=</span> head;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (p2 != <span class=\"literal\">null</span> &amp;&amp; p2.next != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        p1 = p1.next;</span><br><span class=\"line\">        p2 = p2.next.next;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (p1 == p2) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"解法评估\"><a href=\"#解法评估\" class=\"headerlink\" title=\"解法评估\"></a>解法评估</h2><table>\n<thead>\n<tr>\n<th>-</th>\n<th>解法一</th>\n<th>解法二</th>\n<th>解法三</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>时间复杂度</td>\n<td>O(n^2)</td>\n<td>O(n)</td>\n<td>O(n)</td>\n</tr>\n<tr>\n<td>空间复杂度</td>\n<td>O(1)</td>\n<td>O(n)</td>\n<td>O(1)</td>\n</tr>\n</tbody></table>\n<h1 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h1><blockquote>\n<p>本文<strong>Github</strong> <a href=\"https://github.com/herenpeng/code-learn\">https://github.com/herenpeng/code-learn</a> 已收录，欢迎<strong>Star</strong>。</p>\n</blockquote>\n","categories":["数据结构与算法"],"tags":["链表","面试"]},{"title":"Golang中的GoPath和GoModule","url":"/2020/04/13/golang/Golang%E4%B8%AD%E7%9A%84GoPath%E5%92%8CGoModule/","content":"<blockquote>\n<p>在Golang中，有两个概念非常容易弄错，第一个就是GoPath，第二个则是GoModule，很多初学者不清楚这两者之间的关系，也就难以清晰地了解项目的整体结构，自然也就难以编写结构清晰的代码。</p>\n</blockquote>\n<span id=\"more\"></span>\n<h1 id=\"什么是GoPath？\"><a href=\"#什么是GoPath？\" class=\"headerlink\" title=\"什么是GoPath？\"></a>什么是GoPath？</h1><p>什么是Gopath？在我的上一篇博客<a href=\"/2020/04/08/golang/Golang环境安装&IDEA开发Golang/\">Golang环境安装&amp;IDEA开发Golang</a>中，曾经提到过GoPath的概念。<br>GoPath是Golang的工作空间，所有的Go文件，都需要放在GoPath下的src目录下才能够编译运行，所以我提议不要直接配置全局的GoPath目录，否则会非常难以管理所有的Golang项目。</p>\n<p>但是在另一篇博客<a href=\"/2020/04/12/golang/Golang连接MySQL数据库之CRUD/\">Golang连接MySQL数据库之CRUD</a>中，我也提到过，我们在项目中使用第三方类库的时候，可以使用<code>go get</code>命令从网下直接拉去第三方类库的包，而拉取下来的包就会直接下载到我们的GoPath目录下的src包下。</p>\n<p>这样就导致了一个问题，我们自己的Golang代码，和第三方的Golang文件混在了一起，这对于我们管理Golang项目的包显然是非常麻烦的，而且每个如果项目都需要同样的依赖，那么我们就会在不同的GoPath的src中下载大量重复的第三方依赖包，这同样会占用大量的磁盘空间。</p>\n<p><strong>我们给不同的项目设置不同的GoPath，优点非常明显：</strong></p>\n<p>便于管理项目，每个项目都是不同的GoPath，这对于我们管理多个Golang项目而言，能够非常清晰的处理项目结构。如果我们把所有项目都放在同一个GoPath的src包下，那么项目的结构就会变得非常混乱，难以管理。</p>\n<p><strong>但是当我们需要依赖第三方的包的时候，不同的项目设置不同的GoPath的缺点也非常明显：</strong></p>\n<ol>\n<li>第三方依赖的包和我们自己的Golang包混在一起，会给我们的项目文件管理带来一定的麻烦。</li>\n<li>不同的GoPath都需要下载依赖，那么磁盘中重复的依赖就会非常多，会占用我们大量的磁盘空间。</li>\n</ol>\n<p>所以，究竟是设置一个GoPath目录，解决依赖重复的问题，还是设置不同的GoPath目录，解决Golang项目结构混乱的问题，这是一个有争议性的问题。</p>\n<p><strong>为了解决这所有的问题，Golang最终引入了GoModule的概念。</strong></p>\n<h1 id=\"什么是GoModule？\"><a href=\"#什么是GoModule？\" class=\"headerlink\" title=\"什么是GoModule？\"></a>什么是GoModule？</h1><p>GoModule是Golang在1.11版本初步引入的概念，在1.12版本中正是开始使用，所以如果需要使用GoModule，那么需要保证你的Golang的版本在1.12或以上。<br>另外需要说一下，Golang1.11和1.12版本虽然已经引入了GoModule的概念，但是GoModule是默认不开启的，如果需要开启，那么需要配置一个环境变量：<code>GO111MODULE=on</code>，默认是<code>off</code>。</p>\n<p>而在Golang1.13及以上的版本中，GoModule的默认配置为auto，即GoModule会通过你的目录下是否有go.mod文件来判断是否开启GoModule。所以Golang1.13+的版本中我们就不需要配置GO111MODULE属性了。<br>所以如果你使用GoModule，那么就直接使用Golang1.13+的版本好了！</p>\n<p><strong>那么究竟什么是GoModule？</strong></p>\n<ul>\n<li>其实说得直白一下，GoModule就是一个用来取代GoPath的Golang的工作空间。</li>\n</ul>\n<p>我们之前说过，所有的Golang的文件，都需要放在GoPath目录下才能进行正确的编译和运行，而有了GoModule之后，那么我们就可以把文件放在GoModule目录下，而放在GoModule目录下的Golang文件，也可以正确地编译运行。</p>\n<p>那么我们有了GoModule之后，GoPath是不是就可以被舍弃了？</p>\n<p>不是的！</p>\n<p>我们之前说过，GoPath所引出的问题，就是因为第三方类库的包所导致的，所以我们在有了GoModule之后，GoPath和GoModule就分别负责不同的职责，共同为我们的Golang项目服务。</p>\n<p><strong>GoPath我们用来存放我们从网上拉取的第三方依赖包。</strong><br><strong>GoModule我们用来存放我们自己的Golang项目文件</strong>，当我们自己的项目需要依赖第三方的包的时候，我们通过GoModule目录下的一个go.mod文件来引用GoPath目录src包下的第三方依赖即可。</p>\n<p>这样依赖，既解决了原来只能局限在GoPath目录src包下进行编程的问题，也解决了第三方依赖包难以管理和重复依赖占用磁盘空间的问题。</p>\n<blockquote>\n<p>总而言之，在引入GoModule之后，我们不会直接在GoPath目录进行编程，而是把GoPath作为一个第三方依赖包的仓库，我们真正的工作空间在GoModule目录下。</p>\n</blockquote>\n<h1 id=\"GoModule的设置\"><a href=\"#GoModule的设置\" class=\"headerlink\" title=\"GoModule的设置\"></a>GoModule的设置</h1><p>既然搞清楚了GoPath和GoModule之间的区别，那么GoModule又该怎么配置呢？一个目录怎么才能算是一个GoModule目录了。</p>\n<p>很简单，我们直接使用<code>go mod init 模块名称</code>命令对目录进行初始化操作，即可将这个目录设置为GoModule目录。<br>我们在<code>F:\\GoModule</code>目录下创建一个文件夹，名字为：<code>go_module</code>。<br>然后通过cmd命令提示符进入该目录，执行<code>go mod init 模块名称</code>初始化命令。<br><img src=\"/images/2020/04/20200413173543729.png\" alt=\"在这里插入图片描述\"><br>当初始化命令执行完毕之后，会在go_module目录下生成一个go.mod文件，该文件就是用来引入GoPath目录下的第三方依赖的文件。</p>\n<p><strong>初始化之后的go.mod文件</strong></p>\n<figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\">module go_module</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">go</span> <span class=\"number\">1.14</span></span><br></pre></td></tr></table></figure>\n\n<p>当我们需要引入GoPath目录下的第三方依赖包的时候，只需要在go.mod目录下添加依赖名称，GoModule就会自动帮我们把第三方依赖包下载到GoPath目录下。</p>\n<p>例如下面的go.mod文件：</p>\n<figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\">module go_module_demo</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">go</span> <span class=\"number\">1.14</span></span><br><span class=\"line\"></span><br><span class=\"line\">require (</span><br><span class=\"line\">\tgithub.com/astaxie/beego v1<span class=\"number\">.12</span><span class=\"number\">.1</span></span><br><span class=\"line\">\tgithub.com/<span class=\"keyword\">go</span>-sql-driver/mysql v1<span class=\"number\">.5</span><span class=\"number\">.0</span></span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n\n<p>我们在这个go.mod文件中引入了两个依赖，分别是：<code>beego框架 v1.12.1版本</code>和<code>mysql驱动  v1.5.0版本</code>。</p>\n<ul>\n<li>而如果我们使用IDE进行开发的话，那么可以直接创建一个GoModule项目，这样的话IDE会自动帮我们生成所需要的文件，而且在使用依赖的包的时候，IDE还会自动帮我们加入依赖和下载依赖，这会省去我们大量的时间，而且可以不用再去记忆依赖的具体包名和版本号。</li>\n</ul>\n<h1 id=\"GoModule无法下载国外的依赖包问题\"><a href=\"#GoModule无法下载国外的依赖包问题\" class=\"headerlink\" title=\"GoModule无法下载国外的依赖包问题\"></a>GoModule无法下载国外的依赖包问题</h1><p>这是一个很多开发者都碰到过的问题，对于国外的依赖包无法直接通过网络进行下载，这显然会让开发者非常难受，所以Golang也引入了另一个属性：GOPROXY，我们只需要在环境变量中配置GOPROXY=<code>https://goproxy.io</code>即可解决GoModule无法下载国外的依赖包问题。<br>当然，也可以通过IDE来配置，这样省的在电脑系统的环境变量配置太多难以管理。</p>\n<p><strong>在IDEA中配置GOPROXY属性：</strong></p>\n<p><img src=\"/images/2020/04/2020041318024526.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["Golang"],"tags":["Golang"]},{"title":"Golang环境安装&IDEA开发Golang","url":"/2020/04/08/golang/Golang%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85&IDEA%E5%BC%80%E5%8F%91Golang/","content":"<blockquote>\n<p>在这篇博客中，我们学习Windows系统安装Golang的环境，并使用IDEA安装Go插件来开发Golang。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h1 id=\"Golang简介\"><a href=\"#Golang简介\" class=\"headerlink\" title=\"Golang简介\"></a>Golang简介</h1><p>Golang，即Go语言，是Google的Robert Griesemer，Rob Pike及Ken Thompson开发的一种静态强类型、编译型语言。Go语言语法与C相近，但功能上有：内存安全，GC（垃圾回收），结构形态及CSP-style并发计算。</p>\n<h1 id=\"Golang环境安装\"><a href=\"#Golang环境安装\" class=\"headerlink\" title=\"Golang环境安装\"></a>Golang环境安装</h1><p>Golang下载官网：<a href=\"https://studygolang.com/dl\">https://studygolang.com/dl</a></p>\n<p>我们首选访问官网，下载对应操作系统的Golang安装包，在这里，我们选择的是Windows版的安装包。<br><img src=\"/images/2020/04/2020040818545544.png\" alt=\"在这里插入图片描述\">安装包下载之后，直接安装，一路next即可安装完毕。<br>安装完毕之后，可以使用<code>go version</code>命令来查看golang版本，如果显示版本号，则说明golang安装成功。<br><img src=\"/images/2020/04/20200408190942781.png\" alt=\"在这里插入图片描述\"></p>\n<h1 id=\"Golang环境变量配置\"><a href=\"#Golang环境变量配置\" class=\"headerlink\" title=\"Golang环境变量配置\"></a>Golang环境变量配置</h1><p>Golang中有需要配置三个环境变量，分别是：</p>\n<ul>\n<li>GOROOT：Golang的安装目录</li>\n<li>PATH：Golang的安装目录下的bin目录</li>\n<li>GOPATH：Golang的项目目录</li>\n</ul>\n<p><strong>【注意】我们将GOROOT和PATH配置到系统的环境变量中，但是GOPATH我们不直接在系统变量中配置成一个固定的配置，因为我们可能在一个系统中创建多个Golang的项目，每一个项目都需要配置一个GOPATH变量，这显然是繁琐而且非常难以管理的，所以我们在创建项目的时候，直接通过IDE在创建项目的时候来配置GOPATH变量，这样就可以给每个Golang项目都配置上对应的GOPATH路径。</strong></p>\n<p>我们首先找到系统环境变量的配置界面：<br>此电脑（我的电脑）——右键属性——高级系统设置——环境变量<br>我们会看到如下的界面，其中GOROOT的环境变量如下：<br><img src=\"/images/2020/04/20200408192238222.png\" alt=\"在这里插入图片描述\"><br>PATH的环境变量配置如下：<br><img src=\"/images/2020/04/20200408192450190.png\" alt=\"在这里插入图片描述\"><br><strong>如果你是用的是msi的安装包安装Golang，一般都会在安装的时候自动帮你配置这些信息，只要是用<code>go version</code>能够查看版本信息，就说明Golang配置成功，这些变量也都已经配置好了。<br>如果你使用的是zip解压缩的方式，那么就需要手动配置这些环境变量。</strong></p>\n<h1 id=\"IDEA安装Go插件\"><a href=\"#IDEA安装Go插件\" class=\"headerlink\" title=\"IDEA安装Go插件\"></a>IDEA安装Go插件</h1><p>如果要使用IDEA来进行Golang的开发，那么我们需要下载一个Go插件，否则是无法进行Golang的开发的。<br>IDEA自动集成了Go插件，我们只需要在IDEA上下载安装一下即可。<br>我们进入插件下载界面：File——Settings——Plugins</p>\n<p><img src=\"/images/2020/04/2020040819341761.png\" alt=\"在这里插入图片描述\"></p>\n<h1 id=\"IDEA开发Golang\"><a href=\"#IDEA开发Golang\" class=\"headerlink\" title=\"IDEA开发Golang\"></a>IDEA开发Golang</h1><h2 id=\"创建一个Golang项目\"><a href=\"#创建一个Golang项目\" class=\"headerlink\" title=\"创建一个Golang项目\"></a>创建一个Golang项目</h2><p><img src=\"/images/2020/04/20200408193655789.png\" alt=\"在这里插入图片描述\"><br><img src=\"/images/2020/04/20200408193852625.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"配置GOPATH环境变量\"><a href=\"#配置GOPATH环境变量\" class=\"headerlink\" title=\"配置GOPATH环境变量\"></a>配置GOPATH环境变量</h2><p>我们创建项目之后，打开项目，选择File——Settings——Languages&amp;Frameworks——Go——GOPATH，配置项目的GOPATH路径。<br><img src=\"/images/2020/04/20200408194527479.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"Hello-World\"><a href=\"#Hello-World\" class=\"headerlink\" title=\"Hello World\"></a>Hello World</h2><p>Golang的项目代码全部放在GOPATH路径下的src目录下，所以我们直接在项目下创建一个src目录，用来存放我们的Golang源代码。</p>\n<p><strong>项目目录结构如下：</strong><br><img src=\"/images/2020/04/20200408200952535.png\" alt=\"在这里插入图片描述\"><br><strong>action.go</strong></p>\n<figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> person</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">&quot;fmt&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Say</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    fmt.Println(<span class=\"string\">&quot;我正在说话&quot;</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>main.go</strong></p>\n<figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">    <span class=\"string\">&quot;com/person&quot;</span></span><br><span class=\"line\">    <span class=\"string\">&quot;fmt&quot;</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">    fmt.Println(<span class=\"string\">&quot;Hello World!&quot;</span>)</span><br><span class=\"line\">    person.Say()</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>运行结果</strong><br><img src=\"/images/2020/04/20200408201121766.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["Golang"],"tags":["Golang","IDEA"]},{"title":"Golang连接MySQL数据库之CRUD","url":"/2020/04/12/golang/Golang%E8%BF%9E%E6%8E%A5MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B9%8BCRUD/","content":"<blockquote>\n<p>我们这次来学习使用Golang来连接MySQL数据库，并使用Golang实现数据库的CRUD操作。</p>\n</blockquote>\n<span id=\"more\"></span>\n<h1 id=\"搭建环境\"><a href=\"#搭建环境\" class=\"headerlink\" title=\"搭建环境\"></a>搭建环境</h1><p>首先我们创建一个Golang的项目，并配置项目GOPATH，这一步可以参考我的博客<a href=\"/2020/04/08/golang/Golang环境安装&IDEA开发Golang/\">Golang环境安装&amp;IDEA开发Golang</a>。</p>\n<p>因为我们使用的是MySQL数据库，所以我们需要获取Golang的MySQL数据库驱动。<br>我们在项目GOPATH的目录下，执行<code>go get</code>命令来获取MySQL的驱动，命令执行成功之后，会直接从网上下载MySQL驱动的包到你的<code>GOPATH</code>目录下的<code>src</code>目录下。</p>\n<figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">go</span> get -u github.com/<span class=\"keyword\">go</span>-sql-driver/mysql</span><br></pre></td></tr></table></figure>\n<p>Golang的项目环境搭建完成之后，我们还需要创建一张数据库表。</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> `tb_user` (</span><br><span class=\"line\">  `id` <span class=\"type\">int</span>(<span class=\"number\">11</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> AUTO_INCREMENT,</span><br><span class=\"line\">  `name` <span class=\"type\">varchar</span>(<span class=\"number\">11</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">  `password` <span class=\"type\">varchar</span>(<span class=\"number\">11</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">  <span class=\"keyword\">PRIMARY</span> KEY (`id`),</span><br><span class=\"line\">  KEY `nameindex` (`name`(<span class=\"number\">10</span>))</span><br><span class=\"line\">) ENGINE<span class=\"operator\">=</span>InnoDB <span class=\"keyword\">DEFAULT</span> CHARSET<span class=\"operator\">=</span>utf8;</span><br></pre></td></tr></table></figure>\n<h1 id=\"项目结构\"><a href=\"#项目结构\" class=\"headerlink\" title=\"项目结构\"></a>项目结构</h1><p><img src=\"/images/2020/04/2020041210175843.png\" alt=\"在这里插入图片描述\"></p>\n<h1 id=\"编写结构体\"><a href=\"#编写结构体\" class=\"headerlink\" title=\"编写结构体\"></a>编写结构体</h1><p>为了能够便于封装从数据库中获取的数据，我们创建一个Golang结构，来封装我们的数据。<br>我们创建一个<code>bean</code>包，然后在该包下创建一个<code>user.go</code>文件。</p>\n<p><strong>user.go</strong></p>\n<figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> bean</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> User <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tid <span class=\"type\">int</span></span><br><span class=\"line\">\tname <span class=\"type\">string</span></span><br><span class=\"line\">\tpassword <span class=\"type\">string</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(user *User)</span></span> GetId() <span class=\"type\">int</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> user.id</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(user *User)</span></span> SetId(id <span class=\"type\">int</span>) &#123;</span><br><span class=\"line\">\tuser.id = id</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(user *User)</span></span> GetName() <span class=\"type\">string</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> user.name</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(user *User)</span></span> SetName(name <span class=\"type\">string</span>) &#123;</span><br><span class=\"line\">\tuser.name = name</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(user *User)</span></span> GetPassword() <span class=\"type\">string</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> user.password</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(user *User)</span></span> SetPassword(password <span class=\"type\">string</span>) &#123;</span><br><span class=\"line\">\tuser.password = password</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"编写数据库连接工具\"><a href=\"#编写数据库连接工具\" class=\"headerlink\" title=\"编写数据库连接工具\"></a>编写数据库连接工具</h1><p>由于每次连接数据库都需要获取数据库连接，所以我们直接将数据库的连接操作封装为一个方法，这样就可以不用每次都执行获取连接的步骤了。<br>我们创建一个<code>util</code>包，在包下创建一个<code>initdb.go</code>文件。</p>\n<p><strong>initdb.go</strong></p>\n<figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> util</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">&quot;database/sql&quot;</span></span><br><span class=\"line\">\t_ <span class=\"string\">&quot;github.com/go-sql-driver/mysql&quot;</span></span><br><span class=\"line\">\t<span class=\"string\">&quot;strings&quot;</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//我们先将数据库配置信息定义成为常量</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> (</span><br><span class=\"line\">\tuserName = <span class=\"string\">&quot;root&quot;</span></span><br><span class=\"line\">\tpassword = <span class=\"string\">&quot;admin&quot;</span></span><br><span class=\"line\">\tip       = <span class=\"string\">&quot;127.0.0.1&quot;</span></span><br><span class=\"line\">\tport     = <span class=\"string\">&quot;3306&quot;</span></span><br><span class=\"line\">\tdbName   = <span class=\"string\">&quot;db_database08&quot;</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//初始化数据库连接，返回数据库连接的指针引用</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">InitDB</span><span class=\"params\">()</span></span> *sql.DB &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//Golang数据连接：&quot;用户名:密码@tcp(IP:端口号)/数据库名?charset=utf8&quot;</span></span><br><span class=\"line\">\tpath := strings.Join([]<span class=\"type\">string</span>&#123;userName, <span class=\"string\">&quot;:&quot;</span>, password, <span class=\"string\">&quot;@tcp(&quot;</span>, ip, <span class=\"string\">&quot;:&quot;</span>, port, <span class=\"string\">&quot;)/&quot;</span>, dbName, <span class=\"string\">&quot;?charset=utf8&quot;</span>&#125;, <span class=\"string\">&quot;&quot;</span>)</span><br><span class=\"line\">\t<span class=\"comment\">//打开数据库,前者是驱动名，所以要导入： _ &quot;github.com/go-sql-driver/mysql&quot;</span></span><br><span class=\"line\">\tdb, err := sql.Open(<span class=\"string\">&quot;mysql&quot;</span>, path)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//如果打开数据库错误，直接panic</span></span><br><span class=\"line\">\t\t<span class=\"built_in\">panic</span>(err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//设置数据库最大连接数</span></span><br><span class=\"line\">\tdb.SetConnMaxLifetime(<span class=\"number\">10</span>)</span><br><span class=\"line\">\t<span class=\"comment\">//设置上数据库最大闲置连接数</span></span><br><span class=\"line\">\tdb.SetMaxIdleConns(<span class=\"number\">5</span>)</span><br><span class=\"line\">\t<span class=\"comment\">//验证连接</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err := db.Ping(); err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">panic</span>(err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//将数据库连接的指针引用返回</span></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> db</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"CRUD操作\"><a href=\"#CRUD操作\" class=\"headerlink\" title=\"CRUD操作\"></a>CRUD操作</h1><h2 id=\"Insert操作\"><a href=\"#Insert操作\" class=\"headerlink\" title=\"Insert操作\"></a>Insert操作</h2><p>我们创建一个<code>insert</code>包，在该包下创建一个<code>insert.go</code>文件</p>\n<figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">&quot;fmt&quot;</span></span><br><span class=\"line\">\t<span class=\"string\">&quot;mysql/util&quot;</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//使用工具获取数据库连接</span></span><br><span class=\"line\">\tdb := util.InitDB()</span><br><span class=\"line\">\t<span class=\"comment\">//开启事务</span></span><br><span class=\"line\">\ttx, err := db.Begin()</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//事务开启失败，直接panic</span></span><br><span class=\"line\">\t\t<span class=\"built_in\">panic</span>(err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//准备SQL语句</span></span><br><span class=\"line\">\tsql := <span class=\"string\">&quot;insert into tb_user (`name`, `password`) values (?, ?)&quot;</span></span><br><span class=\"line\">\t<span class=\"comment\">//对SQL语句进行预处理</span></span><br><span class=\"line\">\tstmt, err := db.Prepare(sql)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">panic</span>(err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tresult, err := stmt.Exec(<span class=\"string\">&quot;阿部多瑞&quot;</span>,<span class=\"string\">&quot;123&quot;</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//SQL执行失败，直接panic</span></span><br><span class=\"line\">\t\t<span class=\"built_in\">panic</span>(err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//提交事务</span></span><br><span class=\"line\">\ttx.Commit()</span><br><span class=\"line\">\t<span class=\"comment\">//返回插入记录的id</span></span><br><span class=\"line\">\tfmt.Println(result.LastInsertId())</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Select操作\"><a href=\"#Select操作\" class=\"headerlink\" title=\"Select操作\"></a>Select操作</h2><p>我们创建一个<code>select</code>包，在该包下创建一个<code>select.go</code>文件</p>\n<figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">&quot;fmt&quot;</span></span><br><span class=\"line\">\t<span class=\"string\">&quot;mysql/bean&quot;</span></span><br><span class=\"line\">\t<span class=\"string\">&quot;mysql/util&quot;</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//使用工具获取数据库连接</span></span><br><span class=\"line\">\tdb := util.InitDB()</span><br><span class=\"line\">\t<span class=\"comment\">//准备SQL语句</span></span><br><span class=\"line\">\tsql := <span class=\"string\">&quot;select * from tb_user&quot;</span></span><br><span class=\"line\">\t<span class=\"comment\">//对SQL语句进行预处理</span></span><br><span class=\"line\">\tstmt, err := db.Prepare(sql)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">panic</span>(err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\trows, err := stmt.Query()</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//SQL执行失败，直接panic</span></span><br><span class=\"line\">\t\t<span class=\"built_in\">panic</span>(err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> users []bean.User</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> rows.Next() &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">var</span> id <span class=\"type\">int</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">var</span> name, password <span class=\"type\">string</span></span><br><span class=\"line\">\t\terr := rows.Scan(&amp;id, &amp;name, &amp;password)</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//读取结果集失败</span></span><br><span class=\"line\">\t\t\t<span class=\"built_in\">panic</span>(err)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">var</span> user bean.User</span><br><span class=\"line\">\t\tuser.SetId(id)</span><br><span class=\"line\">\t\tuser.SetName(name)</span><br><span class=\"line\">\t\tuser.SetPassword(password)</span><br><span class=\"line\">\t\tusers = <span class=\"built_in\">append</span>(users, user)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tfmt.Println(users)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Update操作\"><a href=\"#Update操作\" class=\"headerlink\" title=\"Update操作\"></a>Update操作</h2><p>我们创建一个<code>update</code>包，在该包下创建一个<code>update.go</code>文件</p>\n<figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">&quot;mysql/util&quot;</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//使用工具获取数据库连接</span></span><br><span class=\"line\">\tdb := util.InitDB()</span><br><span class=\"line\">\t<span class=\"comment\">//开启事务</span></span><br><span class=\"line\">\ttx, err := db.Begin()</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//事务开启失败，直接panic</span></span><br><span class=\"line\">\t\t<span class=\"built_in\">panic</span>(err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//准备SQL语句</span></span><br><span class=\"line\">\tsql := <span class=\"string\">&quot;update tb_user set `password` = ? where `id` = ?&quot;</span></span><br><span class=\"line\">\t<span class=\"comment\">//对SQL语句进行预处理</span></span><br><span class=\"line\">\tstmt, err := db.Prepare(sql)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">panic</span>(err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t_, err = stmt.Exec(<span class=\"string\">&quot;789&quot;</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//SQL执行失败，直接panic</span></span><br><span class=\"line\">\t\t<span class=\"built_in\">panic</span>(err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//提交事务</span></span><br><span class=\"line\">\ttx.Commit()</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Delete操作\"><a href=\"#Delete操作\" class=\"headerlink\" title=\"Delete操作\"></a>Delete操作</h2><p>我们创建一个<code>delete</code>包，在该包下创建一个<code>delete.go</code>文件</p>\n<figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">&quot;mysql/util&quot;</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//使用工具获取数据库连接</span></span><br><span class=\"line\">\tdb := util.InitDB()</span><br><span class=\"line\">\t<span class=\"comment\">//开启事务</span></span><br><span class=\"line\">\ttx, err := db.Begin()</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//事务开启失败，直接panic</span></span><br><span class=\"line\">\t\t<span class=\"built_in\">panic</span>(err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//准备SQL语句</span></span><br><span class=\"line\">\tsql := <span class=\"string\">&quot;delete from tb_user where `id` = ?&quot;</span></span><br><span class=\"line\">\t<span class=\"comment\">//对SQL语句进行预处理</span></span><br><span class=\"line\">\tstmt, err := db.Prepare(sql)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">panic</span>(err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t_, err = stmt.Exec(<span class=\"number\">1</span>)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//SQL执行失败，直接panic</span></span><br><span class=\"line\">\t\t<span class=\"built_in\">panic</span>(err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//提交事务</span></span><br><span class=\"line\">\ttx.Commit()</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","categories":["Golang"],"tags":["Golang","MySQL"]},{"title":"面试基础题目","url":"/2020/05/04/interview/%E9%9D%A2%E8%AF%95%E5%9F%BA%E7%A1%80%E9%A2%98%E7%9B%AE/","content":"<h1 id=\"如果浏览器的Cookie被禁用，有什么方法可以继续追踪Session？\"><a href=\"#如果浏览器的Cookie被禁用，有什么方法可以继续追踪Session？\" class=\"headerlink\" title=\"如果浏览器的Cookie被禁用，有什么方法可以继续追踪Session？\"></a>如果浏览器的Cookie被禁用，有什么方法可以继续追踪Session？</h1><p>Session是基于Cookie的一种会话机制，每当一个Session被开启之后，都会将SessionID返回给浏览器，浏览器中的Cookie保存着SessionID，每当浏览器发送一次请求之后，都会携带这么一份Cookie传递到服务器中，服务器通过SessionID找到浏览器对应的Session，从而追踪Session。</p>\n<span id=\"more\"></span>\n<p>如果浏览器Cookie被禁用，那么就无法通过Cookie将SessionID传递到服务器中，也无法找到对应的Session，Session也就无法使用了。<br>不过这种情况也不是没有办法了，可以用过URL重写的方式，在URL中加上一个参数，参数值为SessionID，这样的话就可以把SessionID传递到服务器中，从而继续追踪Session。</p>\n<h1 id=\"请简述HTTP的长连接和短连接。\"><a href=\"#请简述HTTP的长连接和短连接。\" class=\"headerlink\" title=\"请简述HTTP的长连接和短连接。\"></a>请简述HTTP的长连接和短连接。</h1><ul>\n<li>HTTP1.1规定了默认保持长连接（HTTP persistent connection ，也有翻译为持久连接），数据传输完成了保持TCP连接不断开（不发RST包、不四次挥手），等待在同域名下继续用这个通道传输数据。</li>\n<li>与长连接相反的就是短连接，数据传输完毕之后，便通过四次挥手断开连接。</li>\n</ul>\n<h1 id=\"请简述Integer和int的区别？\"><a href=\"#请简述Integer和int的区别？\" class=\"headerlink\" title=\"请简述Integer和int的区别？\"></a>请简述Integer和int的区别？</h1><ul>\n<li>Integer是int类型的包装类，Integer的引用数据类型，而int是基本数据类型。</li>\n<li>Integer的默认初始值是null，而int的默认初始值为0。</li>\n<li>Integer可以运用在泛型上，而int类型不能运用在泛型上。</li>\n</ul>\n<h1 id=\"为什么Golang的运行速度会快于Java？\"><a href=\"#为什么Golang的运行速度会快于Java？\" class=\"headerlink\" title=\"为什么Golang的运行速度会快于Java？\"></a>为什么Golang的运行速度会快于Java？</h1><p>Java的源代码会被编译成为字节码文件，而字节码文件需要运行在Java虚拟机（JVM）上，所以在运行速度上比较慢，而Golang的源代码会直接编译为机器代码，所以运行速度比起Java来要快很多。</p>\n","categories":["面试"],"tags":["面试"]},{"title":"面试系列01","url":"/2020/03/06/interview/%E9%9D%A2%E8%AF%95%E7%B3%BB%E5%88%9701/","content":"<h2 id=\"1、下面两段代码的输出结果是？\"><a href=\"#1、下面两段代码的输出结果是？\" class=\"headerlink\" title=\"1、下面两段代码的输出结果是？\"></a>1、下面两段代码的输出结果是？</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">int</span> <span class=\"variable\">a</span> <span class=\"operator\">=</span> <span class=\"number\">15</span>;</span><br><span class=\"line\">a += ++a;</span><br></pre></td></tr></table></figure>\n<span id=\"more\"></span>\n<p>输出结果为31</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">int</span> <span class=\"variable\">a</span> <span class=\"operator\">=</span> <span class=\"number\">15</span>;</span><br><span class=\"line\">a += a++;</span><br></pre></td></tr></table></figure>\n<p>输出结果为30</p>\n<h2 id=\"2、下面三个二进制式子的运算结果是（使用10进制表达）？\"><a href=\"#2、下面三个二进制式子的运算结果是（使用10进制表达）？\" class=\"headerlink\" title=\"2、下面三个二进制式子的运算结果是（使用10进制表达）？\"></a>2、下面三个二进制式子的运算结果是（使用10进制表达）？</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">1001</span>|<span class=\"number\">1010</span></span><br></pre></td></tr></table></figure>\n<p>|是<strong>或运算</strong>，参加运算的两个对象只要有一个为1结果则为1，否则为0，所以结果为11（1011）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">1001</span>^<span class=\"number\">1001</span></span><br></pre></td></tr></table></figure>\n<p>^是<strong>异或运算</strong>，参加运算的两个对象相同结果为0，否则为1，所以结果为0（0000）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">1100</span>&amp;<span class=\"number\">1010</span></span><br></pre></td></tr></table></figure>\n<p>&amp;是<strong>与运算</strong>，参加运算的两个对象都为1结果为1，否则为0，所以结果为8（1000）</p>\n<h2 id=\"3、下面代码的输出结果是什么？\"><a href=\"#3、下面代码的输出结果是什么？\" class=\"headerlink\" title=\"3、下面代码的输出结果是什么？\"></a>3、下面代码的输出结果是什么？</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Test</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">static</span> <span class=\"type\">int</span> i;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\t\tSystem.out.println(i);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>输出结果为：0</p>\n<h2 id=\"4、Linux系统中，用于显示TCP协议的相关信息的命令是？\"><a href=\"#4、Linux系统中，用于显示TCP协议的相关信息的命令是？\" class=\"headerlink\" title=\"4、Linux系统中，用于显示TCP协议的相关信息的命令是？\"></a>4、Linux系统中，用于显示TCP协议的相关信息的命令是？</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">netstat</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"5、POST请求由哪些部分组成？\"><a href=\"#5、POST请求由哪些部分组成？\" class=\"headerlink\" title=\"5、POST请求由哪些部分组成？\"></a>5、POST请求由哪些部分组成？</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">请求行：请求方式，请求路径，HTTP版本</span><br><span class=\"line\">请求头：消息报文，一些附加信息</span><br><span class=\"line\">请求体：请求主体，POST请求携带的参数就在这里</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"6、POST请求常用的编码格式？\"><a href=\"#6、POST请求常用的编码格式？\" class=\"headerlink\" title=\"6、POST请求常用的编码格式？\"></a>6、POST请求常用的编码格式？</h2><ul>\n<li><strong>Content-Type</strong>：application/x-www-form-urlencoded</li>\n<li><strong>Content-Type</strong>：multipart/form-data</li>\n<li><strong>Content-Type</strong>：application/json</li>\n<li><strong>Content-Type</strong>：text/xml</li>\n</ul>\n<h2 id=\"7、将两个长度为m和n的有序数组，合并为一个有序数组，最坏的情况的时间复杂度为？\"><a href=\"#7、将两个长度为m和n的有序数组，合并为一个有序数组，最坏的情况的时间复杂度为？\" class=\"headerlink\" title=\"7、将两个长度为m和n的有序数组，合并为一个有序数组，最坏的情况的时间复杂度为？\"></a>7、将两个长度为m和n的有序数组，合并为一个有序数组，最坏的情况的时间复杂度为？</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">O(m+n)</span><br></pre></td></tr></table></figure>\n\n","categories":["面试"],"tags":["面试"]},{"title":"面试系列02","url":"/2020/03/10/interview/%E9%9D%A2%E8%AF%95%E7%B3%BB%E5%88%9702/","content":"<h2 id=\"1、SpringBootApplication这个注解包含了哪些注解？\"><a href=\"#1、SpringBootApplication这个注解包含了哪些注解？\" class=\"headerlink\" title=\"1、SpringBootApplication这个注解包含了哪些注解？\"></a>1、SpringBootApplication这个注解包含了哪些注解？</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"meta\">@EnableAutoConfiguration</span></span><br><span class=\"line\"><span class=\"meta\">@ComponentScan</span></span><br></pre></td></tr></table></figure>\n<span id=\"more\"></span>\n\n<h2 id=\"2、Spring-bean的注入有哪几种方式？\"><a href=\"#2、Spring-bean的注入有哪几种方式？\" class=\"headerlink\" title=\"2、Spring bean的注入有哪几种方式？\"></a>2、Spring bean的注入有哪几种方式？</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">1</span>、构造方法注入</span><br><span class=\"line\"><span class=\"number\">2</span>、setter方法注入</span><br><span class=\"line\"><span class=\"number\">3</span>、注解注入</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3、Spring-bean的作用范围有哪些？\"><a href=\"#3、Spring-bean的作用范围有哪些？\" class=\"headerlink\" title=\"3、Spring bean的作用范围有哪些？\"></a>3、Spring bean的作用范围有哪些？</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">singleton：单例，默认作用范围。</span><br><span class=\"line\">prototype：多例。</span><br><span class=\"line\">request：每次请求都会创建一个实例对象。</span><br><span class=\"line\">session：每次会话都会创建一个实例对象。</span><br><span class=\"line\">globalSession：全局Session只有一个实例对象。</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4、Spring的声明式事务管理有哪几种？\"><a href=\"#4、Spring的声明式事务管理有哪几种？\" class=\"headerlink\" title=\"4、Spring的声明式事务管理有哪几种？\"></a>4、Spring的声明式事务管理有哪几种？</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">1.</span> PROPAGATION_REQUIRED：默认值，如果A中有事务，使用A中的事务，如果A没有，创建一个新的事务，将操作包含进来。</span><br><span class=\"line\"><span class=\"number\">2.</span> PROPAGATION_SUPPORTS：支持事务，如果A中有事务，使用A中的事务。如果A没有事务，不使用事务。</span><br><span class=\"line\"><span class=\"number\">3.</span> PROPAGATION_MANDATORY：如果A中有事务，使用A中的事务。如果A没有事务，抛出异常。</span><br><span class=\"line\"><span class=\"number\">4.</span> PROPAGATION_REQUIRES_NEW：如果A中有事务，将A的事务挂起（暂停），创建新事务，只包含自身操作。如果A中没有事务，创建一个新事务，包含自身操作。</span><br><span class=\"line\"><span class=\"number\">5.</span> PROPAGATION_NOT_SUPPORTED：如果A中有事务，将A的事务挂起。不使用事务管理。</span><br><span class=\"line\"><span class=\"number\">6.</span> PROPAGATION_NEVER：如果A中有事务，报异常。</span><br><span class=\"line\"><span class=\"number\">7.</span> PROPAGATION_NESTED：嵌套事务，如果A中有事务，按照A的事务执行，执行完成后，设置一个保存点，执行B中的操作，如果没有异常，执行通过，如果有异常，可以选择回滚到最初始位置，也可以回滚到保存点。</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"5、Java的元注解有哪些？\"><a href=\"#5、Java的元注解有哪些？\" class=\"headerlink\" title=\"5、Java的元注解有哪些？\"></a>5、Java的元注解有哪些？</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target</span>：表示可注解的位置，比如类上，方法上，或者参数上。</span><br><span class=\"line\"><span class=\"meta\">@Retention</span>：表示注解的保留阶段，源码阶段，class文件阶段，运行时阶段</span><br><span class=\"line\"><span class=\"meta\">@Documented</span>：表示注解是否被javadoc命令抽取为注释文档。</span><br><span class=\"line\"><span class=\"meta\">@Inherited</span>：表示子类是否可以继承该注解</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"6、MyBatis常用的动态标签有哪些？\"><a href=\"#6、MyBatis常用的动态标签有哪些？\" class=\"headerlink\" title=\"6、MyBatis常用的动态标签有哪些？\"></a>6、MyBatis常用的动态标签有哪些？</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">&lt;where&gt;</span><br><span class=\"line\">&lt;<span class=\"keyword\">if</span>&gt;</span><br><span class=\"line\">&lt;set&gt;</span><br><span class=\"line\">&lt;choose&gt;</span><br><span class=\"line\">&lt;Trim&gt;</span><br><span class=\"line\">&lt;prefix&gt;</span><br><span class=\"line\">&lt;suffix&gt;</span><br><span class=\"line\">&lt;prefixoverrides&gt;</span><br><span class=\"line\">&lt;suffixoverrides&gt;</span><br><span class=\"line\">&lt;Foreach&gt;</span><br><span class=\"line\">&lt;item&gt;</span><br><span class=\"line\">&lt;separator&gt;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"7、FTP协议的默认端口号是？\"><a href=\"#7、FTP协议的默认端口号是？\" class=\"headerlink\" title=\"7、FTP协议的默认端口号是？\"></a>7、FTP协议的默认端口号是？</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">FTP是文件传输协议，默认端口号为<span class=\"number\">21</span>。</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"8、Linux系统切换用户的命令是？\"><a href=\"#8、Linux系统切换用户的命令是？\" class=\"headerlink\" title=\"8、Linux系统切换用户的命令是？\"></a>8、Linux系统切换用户的命令是？</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">su [用户名]</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"9、Linux系统查看进程的命令是？\"><a href=\"#9、Linux系统查看进程的命令是？\" class=\"headerlink\" title=\"9、Linux系统查看进程的命令是？\"></a>9、Linux系统查看进程的命令是？</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">ps</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"10、不能用来修饰Interface的有（）\"><a href=\"#10、不能用来修饰Interface的有（）\" class=\"headerlink\" title=\"10、不能用来修饰Interface的有（）\"></a>10、不能用来修饰Interface的有（）</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">A：<span class=\"keyword\">private</span></span><br><span class=\"line\"></span><br><span class=\"line\">B：<span class=\"keyword\">public</span></span><br><span class=\"line\"></span><br><span class=\"line\">C：<span class=\"keyword\">protected</span></span><br><span class=\"line\"></span><br><span class=\"line\">D：<span class=\"keyword\">static</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">答案：ACD</span><br></pre></td></tr></table></figure>\n\n\n\n","categories":["面试"],"tags":["面试"]},{"title":"面试系列03","url":"/2020/03/13/interview/%E9%9D%A2%E8%AF%95%E7%B3%BB%E5%88%9703/","content":"<h2 id=\"1、HashMap的遍历方法？\"><a href=\"#1、HashMap的遍历方法？\" class=\"headerlink\" title=\"1、HashMap的遍历方法？\"></a>1、HashMap的遍历方法？</h2><span id=\"more\"></span>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">Map&lt;String,String&gt; map = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;String,String&gt;();</span><br><span class=\"line\"><span class=\"comment\">//第一种遍历方法</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (String key : map.keySet()) &#123;</span><br><span class=\"line\">\t<span class=\"type\">String</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> map.get(key);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//第二种遍历方法</span></span><br><span class=\"line\"><span class=\"keyword\">for</span>(Entry&lt;String,String&gt; entry : map.entrySet()) &#123;</span><br><span class=\"line\">\t<span class=\"type\">String</span> <span class=\"variable\">key</span> <span class=\"operator\">=</span> entry.getKey();</span><br><span class=\"line\">\t<span class=\"type\">String</span> <span class=\"variable\">valeu</span> <span class=\"operator\">=</span> entry.getValue();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//第三种遍历方法</span></span><br><span class=\"line\">Iterator&lt;String&gt; it =  map.keySet().iterator();</span><br><span class=\"line\"><span class=\"keyword\">while</span>(it.hasNext()) &#123;</span><br><span class=\"line\">\t<span class=\"type\">String</span> <span class=\"variable\">key</span> <span class=\"operator\">=</span> it.next();</span><br><span class=\"line\">\t<span class=\"type\">String</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> map.get(key);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2、ArrayList和LinkedList的区别？\"><a href=\"#2、ArrayList和LinkedList的区别？\" class=\"headerlink\" title=\"2、ArrayList和LinkedList的区别？\"></a>2、ArrayList和LinkedList的区别？</h2><table>\n<thead>\n<tr>\n<th>ArrayList</th>\n<th>LinkedList</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>底层基于数组实现</td>\n<td>底层基于链表实现</td>\n</tr>\n<tr>\n<td>查找效率快，增删效率慢</td>\n<td>查找效率慢，增删效率快</td>\n</tr>\n</tbody></table>\n<h2 id=\"3、ArrayList和LinkedList通过下标查找元素的时间复杂度是多少？\"><a href=\"#3、ArrayList和LinkedList通过下标查找元素的时间复杂度是多少？\" class=\"headerlink\" title=\"3、ArrayList和LinkedList通过下标查找元素的时间复杂度是多少？\"></a>3、ArrayList和LinkedList通过下标查找元素的时间复杂度是多少？</h2><table>\n<thead>\n<tr>\n<th>ArrayList</th>\n<th>LinkedList</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>O(1)</td>\n<td>O(n)</td>\n</tr>\n</tbody></table>\n<h2 id=\"4、浅拷贝和深拷贝的区别？\"><a href=\"#4、浅拷贝和深拷贝的区别？\" class=\"headerlink\" title=\"4、浅拷贝和深拷贝的区别？\"></a>4、浅拷贝和深拷贝的区别？</h2><p><strong>浅拷贝和深拷贝的区别在于引用数据类型的拷贝。</strong></p>\n<ul>\n<li>浅拷贝在拷贝引用数据类型的时候，只是将引用数据类的地址引用复制一份，不会在内存中开辟一块新的地址空间来创建新的对象。</li>\n<li>深拷贝会在内存中重新开辟一块地址空间，将原来的数据复制一份到新的内存中，创建一个新的对象。</li>\n</ul>\n<h2 id=\"5、数据结构中，与所使用的计算机无关的是数据的-？\"><a href=\"#5、数据结构中，与所使用的计算机无关的是数据的-？\" class=\"headerlink\" title=\"5、数据结构中，与所使用的计算机无关的是数据的( )？\"></a>5、数据结构中，与所使用的计算机无关的是数据的( )？</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">A．存储结构</span><br><span class=\"line\">B．物理结构</span><br><span class=\"line\">C．逻辑结构</span><br><span class=\"line\">D．物理和存储结构</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">答案：C</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"6、有一张sal表结构数据如图一所示，写出SQL语句将表数据查询为图2所示的结果。\"><a href=\"#6、有一张sal表结构数据如图一所示，写出SQL语句将表数据查询为图2所示的结果。\" class=\"headerlink\" title=\"6、有一张sal表结构数据如图一所示，写出SQL语句将表数据查询为图2所示的结果。\"></a>6、有一张sal表结构数据如图一所示，写出SQL语句将表数据查询为图2所示的结果。</h2><ul>\n<li><strong>图一</strong></li>\n</ul>\n<p><img src=\"/images/2020/03/20200313191642534.png\" alt=\"图一\"></p>\n<ul>\n<li><strong>图二</strong></li>\n</ul>\n<p><img src=\"/images/2020/03/20200313191736753.png\" alt=\"图二\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">SELECT years,</span><br><span class=\"line\">sum(<span class=\"keyword\">case</span> when quarter=<span class=\"string\">&#x27;1&#x27;</span> then sales end) as <span class=\"string\">&#x27;一季度&#x27;</span>,</span><br><span class=\"line\">sum(<span class=\"keyword\">case</span> when quarter=<span class=\"string\">&#x27;2&#x27;</span> then sales end) as <span class=\"string\">&#x27;二季度&#x27;</span>,</span><br><span class=\"line\">sum(<span class=\"keyword\">case</span> when quarter=<span class=\"string\">&#x27;3&#x27;</span> then sales end) as <span class=\"string\">&#x27;三季度&#x27;</span>,</span><br><span class=\"line\">sum(<span class=\"keyword\">case</span> when quarter=<span class=\"string\">&#x27;4&#x27;</span> then sales end) as <span class=\"string\">&#x27;四季度&#x27;</span></span><br><span class=\"line\"> from sal group by years</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"7、MySQL数据库查询当前时间？\"><a href=\"#7、MySQL数据库查询当前时间？\" class=\"headerlink\" title=\"7、MySQL数据库查询当前时间？\"></a>7、MySQL数据库查询当前时间？</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">select CURRENT_DATE;\t\t#查询当前日期</span><br><span class=\"line\">select CURRENT_TIME;\t\t#查询当前时间</span><br><span class=\"line\">select <span class=\"title function_\">now</span><span class=\"params\">()</span>;\t\t\t\t#查询当前日期和时间</span><br><span class=\"line\">select <span class=\"title function_\">SYSDATE</span><span class=\"params\">()</span>;\t\t\t#查询当前日期和时间</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"8、GET请求和POST请求的区别？\"><a href=\"#8、GET请求和POST请求的区别？\" class=\"headerlink\" title=\"8、GET请求和POST请求的区别？\"></a>8、GET请求和POST请求的区别？</h2><table>\n<thead>\n<tr>\n<th></th>\n<th>GET</th>\n<th>POST</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>后退按钮/刷新</td>\n<td>无害</td>\n<td>数据会被重新提交</td>\n</tr>\n<tr>\n<td>书签</td>\n<td>可收藏为书签</td>\n<td>不可收藏为书签</td>\n</tr>\n<tr>\n<td>缓存</td>\n<td>能被缓存</td>\n<td>不可缓存</td>\n</tr>\n<tr>\n<td>编码类型</td>\n<td>application/x-www-form-urlencoded</td>\n<td>application/x-www-form-urlencoded，multipart/form-data，application/json，text/xml</td>\n</tr>\n<tr>\n<td>历史</td>\n<td>参数保留在浏览器历史中</td>\n<td>参数不会保留在浏览器历史中</td>\n</tr>\n<tr>\n<td>对数据长度的限制</td>\n<td>2kb</td>\n<td>无限制</td>\n</tr>\n<tr>\n<td>对数据类型的限制</td>\n<td>只允许ASCII</td>\n<td>没有限制，也运行二进制数据</td>\n</tr>\n<tr>\n<td>安全性</td>\n<td>与POST相比，GET的安全性较差，因为所发送的数据是URL中的一部分</td>\n<td>POST比GET更安全，因为参数不会保存在浏览器历史或web服务器的日志中</td>\n</tr>\n<tr>\n<td>可见性</td>\n<td>数据在URL中对所有人都是可见的</td>\n<td>数据不会显示在URL中</td>\n</tr>\n</tbody></table>\n<h2 id=\"9、将字符串”abcdefg”反转，变为”gfedcba”。\"><a href=\"#9、将字符串”abcdefg”反转，变为”gfedcba”。\" class=\"headerlink\" title=\"9、将字符串”abcdefg”反转，变为”gfedcba”。\"></a>9、将字符串”abcdefg”反转，变为”gfedcba”。</h2><ul>\n<li><strong>方法一：使用StringBuffer的方法reverse()，可以实现字符串的反转。</strong></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;abcdefg&quot;</span>;</span><br><span class=\"line\"><span class=\"type\">StringBuffer</span> <span class=\"variable\">sb</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">StringBuffer</span>(str);</span><br><span class=\"line\">System.out.println(sb.reverse());</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><strong>方法二：使用Java的栈集合先进后出的特点，将字符串反转。</strong></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;abcdefg&quot;</span>;</span><br><span class=\"line\">Stack&lt;Character&gt; stack = <span class=\"keyword\">new</span> <span class=\"title class_\">Stack</span>&lt;Character&gt;();</span><br><span class=\"line\"><span class=\"keyword\">for</span>(<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; str.length(); i++) &#123;</span><br><span class=\"line\">\tstack.push(str.charAt(i));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">while</span>(<span class=\"literal\">true</span>)&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(stack.isEmpty()) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tSystem.out.print(stack.pop());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><strong>方法三：使用一个char数组，从后向前遍历该数组实现字符串的反转。</strong></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;abcdefg&quot;</span>;</span><br><span class=\"line\"><span class=\"type\">char</span>[] ch = str.toCharArray();</span><br><span class=\"line\"><span class=\"keyword\">for</span>(<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> ch.length-<span class=\"number\">1</span>; i &gt;= <span class=\"number\">0</span>; i--) &#123;</span><br><span class=\"line\">\tSystem.out.print(ch[i]);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","categories":["面试"],"tags":["面试"]},{"title":"面试系列04","url":"/2020/03/18/interview/%E9%9D%A2%E8%AF%95%E7%B3%BB%E5%88%9704/","content":"<h2 id=\"1、请简述一下Git的分支管理？\"><a href=\"#1、请简述一下Git的分支管理？\" class=\"headerlink\" title=\"1、请简述一下Git的分支管理？\"></a>1、请简述一下Git的分支管理？</h2><p><strong>两种核心分支</strong></p>\n<ul>\n<li><strong>master分支</strong>存放的是随时可供在生产环境中部署的稳定版本代码。</li>\n<li><strong>develop分支</strong>是保存当前最新开发成果的分支。<span id=\"more\"></span></li>\n</ul>\n<p><strong>三种辅助分支</strong></p>\n<ul>\n<li><strong>功能(feature)分支：</strong> 这个分支主要是用来开发一个新的功能，一旦开发完成，我们合并回Develop分支进入下一个Release。</li>\n<li><strong>预发布(release)分支：</strong> 当你需要一个发布一个新Release的时候，我们基于Develop分支创建一个Release分支，完成Release后，我们合并到Master和Develop分支。</li>\n<li><strong>修补bug(hotfix)分支：</strong> 当我们在Production发现新的Bug时候，我们需要创建一个Hotfix, 完成Hotfix后，我们合并回Master和Develop分支，所以Hotfix的改动会进入下一个Release。</li>\n</ul>\n<h2 id=\"2、请说一下Web项目的分层结构？\"><a href=\"#2、请说一下Web项目的分层结构？\" class=\"headerlink\" title=\"2、请说一下Web项目的分层结构？\"></a>2、请说一下Web项目的分层结构？</h2><p><strong>JavaWeb一般分为三层架构，分别是：</strong></p>\n<ul>\n<li>数据访问层，即Dao层，主要用来封装对数据库的操作。</li>\n<li>业务逻辑层，即Service层，主要用于处理具体的业务逻辑，即对Dao层的数据进行处理。</li>\n<li>Web层，或者是Controller层，主要用于对前端请求作出响应。</li>\n</ul>\n<h2 id=\"3、请简述一下Spring的IOC和AOP？\"><a href=\"#3、请简述一下Spring的IOC和AOP？\" class=\"headerlink\" title=\"3、请简述一下Spring的IOC和AOP？\"></a>3、请简述一下Spring的IOC和AOP？</h2><p><strong>Spring的两大核心特征就是IOC（控制反转）和AOP（面向切面编程）。</strong></p>\n<ul>\n<li><strong>IOC：</strong> 控制反转，是Spring用来解决类与类之间的程序耦合问题的，因为Java代码需要通过类与类之间的相互协作来完成特定的业务逻辑，每个类都需要管理与自己有交互的类的引用和依赖，代码将会变得难以维护和极度的高耦合。而Spring IOC正是为了解决这个问题，将类与类之间的引用和依赖交给Spring IOC容器管理，每个对象只需要专注自己的业务逻辑即可，降低了程序之间的耦合度。</li>\n<li><strong>AOP：</strong> 面向切面编程，AOP不是单独指某一种技术，而是一种编程思想，AOP是OOP的一种补充，用于处理各个业务逻辑中的横切关注点，比如日志记录，事务处理，性能统计，异常处理等等。AOP的主要功能是将大量的通用行为从业务逻辑中抽取出来，将这些行为封装成独立的非业务方法，用于横向切入，这些行为不会对已有的业务逻辑产生任何影响。AOP是一种设计思想，而Spring AOP则是符合AOP思想的一种框架实现。</li>\n</ul>\n<h2 id=\"4、怎么记录一个项目的访问日志？\"><a href=\"#4、怎么记录一个项目的访问日志？\" class=\"headerlink\" title=\"4、怎么记录一个项目的访问日志？\"></a>4、怎么记录一个项目的访问日志？</h2><p>可以使用Spring AOP技术，设置一个前置通知，记录访问开始时间和访问请求的具体信息，设置一个后置通知，记录响应的时间，并通过这些信息，处理获得请求的访问时长，访问方法，访问路径，访问用户等等信息。</p>\n<h2 id=\"5、MyBatis中-和-的区别？\"><a href=\"#5、MyBatis中-和-的区别？\" class=\"headerlink\" title=\"5、MyBatis中#{}和${}的区别？\"></a>5、MyBatis中#{}和${}的区别？</h2><table>\n<thead>\n<tr>\n<th>#{}</th>\n<th>${}</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>相当于的占位符</td>\n<td>相当于字符串拼接</td>\n</tr>\n<tr>\n<td>在传参的时候会先对SQL进行预编译</td>\n<td>在传参的时候相当于字符串拼接</td>\n</tr>\n<tr>\n<td>可以防止SQL注入</td>\n<td>不能防止SQL注入</td>\n</tr>\n<tr>\n<td>尽量使用</td>\n<td>在需要传入表名或者列名的时候使用，比如order by</td>\n</tr>\n</tbody></table>\n<h2 id=\"6、请简述一下left-join，right-join，inner-join？\"><a href=\"#6、请简述一下left-join，right-join，inner-join？\" class=\"headerlink\" title=\"6、请简述一下left join，right join，inner join？\"></a>6、请简述一下left join，right join，inner join？</h2><ul>\n<li><strong>left join:</strong> 在两张表进行连接查询时，会返回左表所有的行，即使在右表中没有匹配的记录。</li>\n<li><strong>right join:</strong> 在两张表进行连接查询时，会返回右表所有的行，即使在左表中没有匹配的记录。</li>\n<li><strong>inner join:</strong> 在两张表进行连接查询时，只保留两张表中完全匹配的结果集。</li>\n</ul>\n<h2 id=\"7、数据库为什么要有事务？\"><a href=\"#7、数据库为什么要有事务？\" class=\"headerlink\" title=\"7、数据库为什么要有事务？\"></a>7、数据库为什么要有事务？</h2><p>所谓事务是用户定义的一个数据库操作序列，这些操作要么全做要么全不做，是一个不可分割的工作单位。事务是数据库维护数据一致性的单位，在每个事务结束时，都能保持数据一致性。</p>\n<h2 id=\"8、乐观锁和悲观锁？\"><a href=\"#8、乐观锁和悲观锁？\" class=\"headerlink\" title=\"8、乐观锁和悲观锁？\"></a>8、乐观锁和悲观锁？</h2><ul>\n<li><strong>乐观锁：</strong> 总是假设最好的情况，每次去拿数据的时候都认为别人不会修改，所以不会上锁，但是在更新的时候会判断一下在此期间别人有没有去更新这个数据，可以使用版本号机制和CAS算法实现。</li>\n<li><strong>悲观锁：</strong> 总是假设最坏的情况，每次去拿数据的时候都认为别人会修改，所以每次在拿数据的时候都会上锁，这样别人想拿这个数据就会阻塞直到它拿到锁。</li>\n</ul>\n<h2 id=\"9、SpringBoot设置端口号？\"><a href=\"#9、SpringBoot设置端口号？\" class=\"headerlink\" title=\"9、SpringBoot设置端口号？\"></a>9、SpringBoot设置端口号？</h2><figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">server:</span></span><br><span class=\"line\">\t<span class=\"attr\">port:</span> <span class=\"number\">8888</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"10、数据库连接池？\"><a href=\"#10、数据库连接池？\" class=\"headerlink\" title=\"10、数据库连接池？\"></a>10、数据库连接池？</h2><ul>\n<li>数据库连接是一种关键的有限的昂贵资源，无论是创建数据库连接还是关闭数据库连接，都会消耗大量的系统性能，频繁创建连接和关闭连接，会造成系统性能低下。</li>\n<li>数据库连接池就是为了解决这个问题而诞生的，数据库连接池是在启动项目的时候，在程序中创建足够多的数据库连接池，当程序需要使用连接池的时候，就可以直接从数据库连接池中获取一个连接，使用完毕后则将连接归还到数据库连接池中。</li>\n<li>数据库连接池技术尽可能地减少了系统资源的开销，大大节省了内存，提高了程序的运行效率。</li>\n</ul>\n","categories":["面试"],"tags":["面试"]},{"title":"面试系列05——我的SQL为什么这么慢？","url":"/2020/03/18/interview/%E9%9D%A2%E8%AF%95%E7%B3%BB%E5%88%9705%E2%80%94%E2%80%94%E6%88%91%E7%9A%84SQL%E4%B8%BA%E4%BB%80%E4%B9%88%E8%BF%99%E4%B9%88%E6%85%A2/","content":"<h2 id=\"SQL执行速度慢的原因分析？\"><a href=\"#SQL执行速度慢的原因分析？\" class=\"headerlink\" title=\"SQL执行速度慢的原因分析？\"></a>SQL执行速度慢的原因分析？</h2><p><strong>SQL执行偶尔很慢</strong></p>\n<ul>\n<li>数据库在刷新脏页。</li>\n<li>数据库无法获取锁。<span id=\"more\"></span></li>\n</ul>\n<p><strong>SQL执行一直很慢</strong></p>\n<ul>\n<li>没有给字段设置索引或者字段设置了索引但是SQL没有用上。</li>\n<li>IO吞吐量小，形成了瓶颈效应。</li>\n<li>数据库内存不足。</li>\n<li>SQL查询的数据量太大，或者返回了不必要的行和列。</li>\n<li>如果SQL和数据库不再同一台服务器，那么还有可能是网络速度慢。</li>\n</ul>\n<h2 id=\"优化SQL执行速度慢的方法？\"><a href=\"#优化SQL执行速度慢的方法？\" class=\"headerlink\" title=\"优化SQL执行速度慢的方法？\"></a>优化SQL执行速度慢的方法？</h2><ul>\n<li>根据查询条件，给数据库表建立索引，优化索引，优化访问方式。</li>\n<li>横向、纵向拆分大表，减小表的尺寸。</li>\n<li>优化SQL，多次查询少量数据，少使用*、distinct等关键字。</li>\n<li>升级数据库服务器硬件，扩大内存。</li>\n<li>提高网速。</li>\n</ul>\n<h2 id=\"怎么判断一条SQL是否是通过索引查询到的数据？\"><a href=\"#怎么判断一条SQL是否是通过索引查询到的数据？\" class=\"headerlink\" title=\"怎么判断一条SQL是否是通过索引查询到的数据？\"></a>怎么判断一条SQL是否是通过索引查询到的数据？</h2><ul>\n<li>在select语句前加上explain就可以了。</li>\n<li>查找出来的结果中有一个key属性，key属性是用来显示使用的索引的，如果key属性为null，那就说明没有使用索引。<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">create</span> index nameindex <span class=\"keyword\">on</span> tb_user(name(<span class=\"number\">10</span>));\t#在tb_user表以name字段创建一个名为nameindex的索引</span><br><span class=\"line\">explain <span class=\"keyword\">select</span> <span class=\"operator\">*</span> <span class=\"keyword\">from</span> tb_user <span class=\"keyword\">where</span> name <span class=\"operator\">=</span> <span class=\"string\">&#x27;鞠婧祎&#x27;</span>;\t#通过关键字explain查询</span><br></pre></td></tr></table></figure>\n<img src=\"/images/2020/03/20200318202145836.png\" alt=\"在这里插入图片描述\"><h2 id=\"数据库的索引\"><a href=\"#数据库的索引\" class=\"headerlink\" title=\"数据库的索引\"></a>数据库的索引</h2></li>\n</ul>\n<p><strong>数据库索引的创建方式：</strong></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> INDEX [索引名] <span class=\"keyword\">ON</span> [表名]([列名](长度)); </span><br><span class=\"line\"><span class=\"keyword\">create</span> index nameindex <span class=\"keyword\">on</span> tb_user(name(<span class=\"number\">10</span>));</span><br></pre></td></tr></table></figure>\n<p><strong>索引的数据结构</strong></p>\n<ul>\n<li>索引的底层是一个平衡树（非二叉树）。</li>\n</ul>\n<p><strong>索引的优点：</strong></p>\n<ul>\n<li>提高SQL的查询速度。</li>\n</ul>\n<p><strong>索引的缺点：</strong></p>\n<ul>\n<li>虽然索引可以提高SQL的查询速度，但是会降低SQL语句insert、update、delete语句的速度，因为这些语句不仅要操作数据表数据，还要维护索引数据。</li>\n<li>索引会占用磁盘空间。</li>\n</ul>\n","categories":["面试"],"tags":["面试","MySQL"]},{"title":"面试系列06","url":"/2020/03/20/interview/%E9%9D%A2%E8%AF%95%E7%B3%BB%E5%88%9706/","content":"<h2 id=\"1、请简述一下SpringBoot？\"><a href=\"#1、请简述一下SpringBoot？\" class=\"headerlink\" title=\"1、请简述一下SpringBoot？\"></a>1、请简述一下SpringBoot？</h2><ul>\n<li>SpringBoot是一个Spring框架的启动器，使用SpringBoot可以快速地搭建一个基于Spring框架的Web项目。</li>\n<li>SpringBoot不是一个新的框架，而是Spring框架的延续和扩展。</li>\n<li>SpringBoot使用约定大于配置的原则，默认配置了Spring项目中的大部分配置，所以我们使用SpringBoot搭建Spring项目可以省去Spring框架的大部分配置，简化我们的开发。<span id=\"more\"></span>\n\n</li>\n</ul>\n<h2 id=\"2、请简述一下SpringCloud？\"><a href=\"#2、请简述一下SpringCloud？\" class=\"headerlink\" title=\"2、请简述一下SpringCloud？\"></a>2、请简述一下SpringCloud？</h2><ul>\n<li>SpringCloud并不是一个单独的框架，而是指一系列适用于解决分布式系统开发的框架集合。是一套用于治理微服务架构的解决方案。</li>\n<li>SpringCloud是基于SpringBoot，SpringCloud的每个微服务，都是使用SpringBoot来进行开发的。</li>\n</ul>\n<h2 id=\"3、什么是微服务？\"><a href=\"#3、什么是微服务？\" class=\"headerlink\" title=\"3、什么是微服务？\"></a>3、什么是微服务？</h2><ul>\n<li>微服务是指一个可以独立部署，水平拓展，独立访问的服务单元。</li>\n<li>微服务单独运行在独立的进程中，并通过轻量级的通信机制进行通信，一般使用的是HTTP协议。</li>\n<li>微服务强调技术独立，可以使用不同的语言编写或者不同的数据库存储，服务之间相互调用通过服务对外暴露的API接口进行，达到资源隔离的效果。</li>\n</ul>\n<h2 id=\"4、为什么要使用微服务，微服务有什么优势？\"><a href=\"#4、为什么要使用微服务，微服务有什么优势？\" class=\"headerlink\" title=\"4、为什么要使用微服务，微服务有什么优势？\"></a>4、为什么要使用微服务，微服务有什么优势？</h2><ul>\n<li>微服务可以独立开发，独立部署服务，更容易扩展，解决了一体化架构中服务难以扩展的问题。</li>\n<li>微服务开发速度快，敏捷性高，维护单个微服务不影响整体系统。</li>\n<li>微服务围绕业务功能创建、组织代码，代码可维护性高。</li>\n<li>自由（在某种程度上）选择实施技术/语言，实现了技术独立。</li>\n</ul>\n<h2 id=\"5、请简述一下HTTP协议？\"><a href=\"#5、请简述一下HTTP协议？\" class=\"headerlink\" title=\"5、请简述一下HTTP协议？\"></a>5、请简述一下HTTP协议？</h2><ul>\n<li>HTPP是超文本传输协议，是当前互联网上使用最为广泛的一种传输协议，HTTP是网络传输的一种规范，是客户端和服务器端请求和响应的标准。</li>\n<li>HTTP的默认端口号是80，HTTPS的默认端口号是443，HTTPS的HTTP的安全版本，是完全的Web传输协议。</li>\n<li>HTTP是无连接的，即每次连接都只处理一次请求，响应完成之后断开连接，这种方式可以节省传输时间。</li>\n<li>HTTP是无状态的，即HTTP的每次请求都是独立的，不会记忆之前的请求或数据。</li>\n<li>HTTP可以传输任意类型的数据对象，常用的请求方法有GET、POST等。</li>\n<li>HTTP的请求由三部分构成，分别是：<ul>\n<li>请求行：请求方法，请求URL，HTTP协议版本</li>\n<li>请求头：包含了一些请求客户端的信息，比如Cookie，Host，Accept等等</li>\n<li>请求体：GET请求没有请求体，POST请求的请求体用于存放参数和请求数据</li>\n</ul>\n</li>\n<li>HTTP的响应由三部分构成，分别是：<ul>\n<li>响应行：HTTP协议版本，状态码，状态代码的文本描述</li>\n<li>响应头：包含服务器发送非客户端的信息，比如Content-Type，Server等等</li>\n<li>响应正文：服务器响应给客户端的响应数据</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"6、请说一下HTTP协议的常见状态码及状态码的含义？\"><a href=\"#6、请说一下HTTP协议的常见状态码及状态码的含义？\" class=\"headerlink\" title=\"6、请说一下HTTP协议的常见状态码及状态码的含义？\"></a>6、请说一下HTTP协议的常见状态码及状态码的含义？</h2><table>\n<thead>\n<tr>\n<th>状态码</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>200</td>\n<td>成功</td>\n</tr>\n<tr>\n<td>301</td>\n<td>永久重定向，请求资源被移动到新的URL</td>\n</tr>\n<tr>\n<td>302</td>\n<td>临时重定向</td>\n</tr>\n<tr>\n<td>400</td>\n<td>错误的请求，请求格式错误</td>\n</tr>\n<tr>\n<td>401</td>\n<td>当前请求需要通过用户验证</td>\n</tr>\n<tr>\n<td>403</td>\n<td>拒绝服务</td>\n</tr>\n<tr>\n<td>404</td>\n<td>资源没有找到</td>\n</tr>\n<tr>\n<td>408</td>\n<td>请求超时</td>\n</tr>\n<tr>\n<td>500</td>\n<td>服务器内部错误</td>\n</tr>\n<tr>\n<td>502</td>\n<td>服务器网关错误</td>\n</tr>\n<tr>\n<td>504</td>\n<td>服务器响应超时</td>\n</tr>\n</tbody></table>\n<h2 id=\"7、什么是分布式事务（简述）？\"><a href=\"#7、什么是分布式事务（简述）？\" class=\"headerlink\" title=\"7、什么是分布式事务（简述）？\"></a>7、什么是分布式事务（简述）？</h2><ul>\n<li>分布式事务是指在分布式环境下的不同节点上的一系列操作，这一系列操作要么全部执行成功，要么全部执行失败。</li>\n<li>分布式事务是为了保证分布式环境下的数据一致性。</li>\n</ul>\n<h2 id=\"8、什么是分布式锁（简述）？\"><a href=\"#8、什么是分布式锁（简述）？\" class=\"headerlink\" title=\"8、什么是分布式锁（简述）？\"></a>8、什么是分布式锁（简述）？</h2><ul>\n<li>分布式锁就是指在分布式环境下，需要保证一个方法在同一时间只能被一个线程调用。</li>\n<li>分布式锁是为了保证数据的一致性而进行的加锁操作。</li>\n</ul>\n","categories":["面试"],"tags":["面试"]},{"title":"面试系列07","url":"/2020/03/25/interview/%E9%9D%A2%E8%AF%95%E7%B3%BB%E5%88%9707/","content":"<h2 id=\"1、请问下面代码的执行结果是？\"><a href=\"#1、请问下面代码的执行结果是？\" class=\"headerlink\" title=\"1、请问下面代码的执行结果是？\"></a>1、请问下面代码的执行结果是？</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\t<span class=\"type\">File</span> <span class=\"variable\">file</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">File</span>(<span class=\"string\">&quot;G:\\\\temp\\\\empty&quot;</span>);</span><br><span class=\"line\">\tSystem.out.println(file.canWrite());</span><br><span class=\"line\">\tSystem.out.println(file.canRead());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<span id=\"more\"></span>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">如果文件目录存在，结果为：<span class=\"literal\">true</span>，<span class=\"literal\">true</span>。</span><br><span class=\"line\">如果文件目录不存在，结果为：<span class=\"literal\">false</span>，<span class=\"literal\">false</span>。</span><br></pre></td></tr></table></figure>\n<h2 id=\"2、下面代码的输出结果为？\"><a href=\"#2、下面代码的输出结果为？\" class=\"headerlink\" title=\"2、下面代码的输出结果为？\"></a>2、下面代码的输出结果为？</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">String</span> <span class=\"variable\">initial</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;ABCDEFG&quot;</span>, after = <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">    after = initial = initial.replace(<span class=\"string\">&#x27;A&#x27;</span>, <span class=\"string\">&#x27;Z&#x27;</span>);</span><br><span class=\"line\">    System.out.println(initial + <span class=\"string\">&quot;, &quot;</span> + after);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">执行结果为：ZBCDEFG, ZBCDEFG</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3、请问下面的代码是否能够正常编译？\"><a href=\"#3、请问下面的代码是否能够正常编译？\" class=\"headerlink\" title=\"3、请问下面的代码是否能够正常编译？\"></a>3、请问下面的代码是否能够正常编译？</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">boolean</span> <span class=\"title function_\">final</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    test++;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">    test=<span class=\"number\">0</span>; </span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((<span class=\"keyword\">final</span>() | <span class=\"keyword\">final</span>()) || <span class=\"keyword\">final</span>()) </span><br><span class=\"line\">        test++; </span><br><span class=\"line\">    System.out.println(test); </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">不能</span><br><span class=\"line\"><span class=\"number\">1</span>、因为<span class=\"keyword\">final</span>是Java中的关键字，不能作为方法名。</span><br><span class=\"line\"><span class=\"number\">2</span>、静态方法不能调用非静态方法，所以<span class=\"keyword\">final</span>方法需要添加<span class=\"keyword\">static</span>关键字修饰。</span><br></pre></td></tr></table></figure>\n<h2 id=\"4、请简述一下Applet生命周期？\"><a href=\"#4、请简述一下Applet生命周期？\" class=\"headerlink\" title=\"4、请简述一下Applet生命周期？\"></a>4、请简述一下Applet生命周期？</h2><ul>\n<li><strong>init()方法：</strong> 当Applet在创建的时候会执行<code>init()</code>方法。</li>\n<li><strong>start()方法：</strong> 当执行完<code>init()</code>方法之后，会执行<code>start()</code>方法。</li>\n<li><strong>paint()方法:</strong> 当执行完<code>start()</code>方法之后，如果Applet调整浏览器窗口大小，会执行<code>paint()</code>方法。</li>\n<li><strong>stop()方法：</strong> 用于停止Applet，当Apple停止或者最小化浏览器窗口的时候，会执行<code>stop()</code>方法。</li>\n<li><strong>destory()方法：</strong> 用于销毁Applet，当关闭浏览器后悔执行<code>destory()</code>方法。</li>\n</ul>\n<p><strong>Applet的生命周期以<code>init()</code>方法开始，以<code>destory()</code>方法结束，且这两个方法只会执行一次，但是<code>start()</code>、<code>paint()</code>、<code>stop()</code>方法会执行多次。</strong></p>\n<h2 id=\"5、请编写一条SQL语句，从user表中获取name为Bod和Mike的用户的所有信息。\"><a href=\"#5、请编写一条SQL语句，从user表中获取name为Bod和Mike的用户的所有信息。\" class=\"headerlink\" title=\"5、请编写一条SQL语句，从user表中获取name为Bod和Mike的用户的所有信息。\"></a>5、请编写一条SQL语句，从user表中获取name为Bod和Mike的用户的所有信息。</h2><figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> <span class=\"operator\">*</span> <span class=\"keyword\">from</span> <span class=\"keyword\">user</span> <span class=\"keyword\">where</span> name <span class=\"keyword\">in</span> (<span class=\"string\">&#x27;Bod&#x27;</span>,<span class=\"string\">&#x27;Mike&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">select</span> <span class=\"operator\">*</span> <span class=\"keyword\">from</span> <span class=\"keyword\">user</span> <span class=\"keyword\">where</span> name <span class=\"operator\">=</span> <span class=\"string\">&#x27;Bod&#x27;</span> <span class=\"keyword\">or</span> name <span class=\"operator\">=</span> <span class=\"string\">&#x27;Mike&#x27;</span>;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"6、程序编写，判断字符串是否为回文？\"><a href=\"#6、程序编写，判断字符串是否为回文？\" class=\"headerlink\" title=\"6、程序编写，判断字符串是否为回文？\"></a>6、程序编写，判断字符串是否为回文？</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\t<span class=\"type\">String</span> <span class=\"variable\">str</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;abcdcba&quot;</span>;</span><br><span class=\"line\">\tSystem.out.println(isPalindrome(str));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">boolean</span> <span class=\"title function_\">isPalindrome</span><span class=\"params\">(String str)</span> &#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> <span class=\"variable\">start</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>,end = str.length()-<span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">while</span>(start &lt; end) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(str.charAt(start++) != str.charAt(end--)) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"7、请问下面代码的输出结果，为什么？\"><a href=\"#7、请问下面代码的输出结果，为什么？\" class=\"headerlink\" title=\"7、请问下面代码的输出结果，为什么？\"></a>7、请问下面代码的输出结果，为什么？</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\t<span class=\"type\">String</span> <span class=\"variable\">str1</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;abc&quot;</span>;</span><br><span class=\"line\">\t<span class=\"type\">String</span> <span class=\"variable\">str2</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;abc&quot;</span>;</span><br><span class=\"line\">\tSystem.out.println(str1.equals(str2));</span><br><span class=\"line\">\t<span class=\"type\">StringBuffer</span> <span class=\"variable\">sb1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">StringBuffer</span>(<span class=\"string\">&quot;abc&quot;</span>);</span><br><span class=\"line\">\t<span class=\"type\">StringBuffer</span> <span class=\"variable\">sb2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">StringBuffer</span>(<span class=\"string\">&quot;abc&quot;</span>);</span><br><span class=\"line\">\tSystem.out.println(sb1.equals(sb2));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">输出结果为：</span><br><span class=\"line\"><span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"literal\">false</span></span><br><span class=\"line\">因为在Java语言中，String类重写了equals()方法，但是StringBuffer类没有重写equals()方法。</span><br></pre></td></tr></table></figure>\n<h2 id=\"8、下面代码的结果是什么，为什么？\"><a href=\"#8、下面代码的结果是什么，为什么？\" class=\"headerlink\" title=\"8、下面代码的结果是什么，为什么？\"></a>8、下面代码的结果是什么，为什么？</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> <span class=\"variable\">i1</span> <span class=\"operator\">=</span> <span class=\"number\">100</span>;</span><br><span class=\"line\">\t<span class=\"type\">int</span> <span class=\"variable\">i2</span> <span class=\"operator\">=</span> <span class=\"number\">100</span>;</span><br><span class=\"line\">\tSystem.out.println(i1 == i2);</span><br><span class=\"line\">\ti1 = <span class=\"number\">200</span>;</span><br><span class=\"line\">\ti2 = <span class=\"number\">200</span>;</span><br><span class=\"line\">\tSystem.out.println(i1 == i2);</span><br><span class=\"line\">\t<span class=\"type\">Integer</span> <span class=\"variable\">in1</span> <span class=\"operator\">=</span> <span class=\"number\">100</span>;</span><br><span class=\"line\">\t<span class=\"type\">Integer</span> <span class=\"variable\">in2</span> <span class=\"operator\">=</span> <span class=\"number\">100</span>;</span><br><span class=\"line\">\tSystem.out.println(in1 == in2);</span><br><span class=\"line\">\tin1 = <span class=\"number\">200</span>;</span><br><span class=\"line\">\tin1 = <span class=\"number\">200</span>;</span><br><span class=\"line\">\tSystem.out.println(in1 == in2);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">输出结果为：</span><br><span class=\"line\"><span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"literal\">false</span></span><br><span class=\"line\">因为基本数据类类型使用==比较的是值，而引用数据类型使用==比较的是引用。</span><br><span class=\"line\">但是Integer类型的值如果在[-<span class=\"number\">128</span>,<span class=\"number\">127</span>]之间的话，那么会使用Integer类中的缓存，而不会创建新的对象。</span><br><span class=\"line\">所以最后一个比较值为<span class=\"literal\">false</span>。</span><br></pre></td></tr></table></figure>\n\n","categories":["面试"],"tags":["面试"]},{"title":"面试系列08","url":"/2021/03/13/interview/%E9%9D%A2%E8%AF%95%E7%B3%BB%E5%88%9708/","content":"<h2 id=\"说一下Java对象的创建过程\"><a href=\"#说一下Java对象的创建过程\" class=\"headerlink\" title=\"说一下Java对象的创建过程\"></a>说一下Java对象的创建过程</h2><p>Java对象的创建过程一共分为五个步骤：</p>\n<span id=\"more\"></span>\n<p>1、当创建一个对象的时候，JVM 会去常量池中找该类的符号引用，并且检查该类还有没有被 JVM 加载过，如果没有，则进行类的加载过程。</p>\n<p>2、在类加载检查通过之后，JVM 开始在 Java 堆中为对象分配具体的内存空间。</p>\n<p>3、对象内存分配完成之后，JVM 会给 Java 对象除了对象头之外的示例数据初始化零值。这就是为什么类变量可以不需要手动进行初始化值，就可以使用的原因，而局部变量需要手动赋值才可以使用。</p>\n<p>4、设置对象头，给对象头设置一些信息。比如：对象的哈希吗，对象的 GC 分代年龄，指向类的元数据信息的指针，锁信息等等。</p>\n<p>5、执行对象的 init 方法，比如执行普通代码块，构造函数等等。</p>\n<h2 id=\"简单聊聊-JVM-内存分配与回收\"><a href=\"#简单聊聊-JVM-内存分配与回收\" class=\"headerlink\" title=\"简单聊聊 JVM 内存分配与回收\"></a>简单聊聊 JVM 内存分配与回收</h2><p>Java 内存管理主要是针对对象内存的分配和对象内存的回收。</p>\n<p>Java 堆是垃圾收集管理的主要区域，因此 Java 堆也被称作 GC 堆。从垃圾回收的角度，目前的垃圾回收器基本上采用的是分代垃圾收集算法，所以 Java 堆也被划分为多个区域。</p>\n<p>Java 堆主要分为新生代和老年代，其中新生代又分为 <code>Eden</code> 空间、<code>From Survivor</code>、<code>To Survivor</code> 等空间。</p>\n<p>1、当创建一个新的对象，对象会被分配到 Eden 空间。</p>\n<p>2、如果该对象经历过一次垃圾回收之后，该对象还存活，则会将该对象移动到 <code>From Survivor</code> 或者 <code>To Survivor</code> 区域，并且该对象的年龄变为 1 岁。</p>\n<p>3、该对象在  <code>From Survivor</code> 或者 <code>To Survivor</code> 区域 每经过一次垃圾回收，年龄就会 +1 。当对象年龄达到晋升老年代区域的阈值的时候，就会将该对象移动至老年代区域。晋升老年代区域的阈值默认为 15 岁，并且该阈值可以通过参数 <code>-XX:MaxTenuringThreshold</code> 来设置。</p>\n<h2 id=\"说一下堆内存中对象的分配的基本策略\"><a href=\"#说一下堆内存中对象的分配的基本策略\" class=\"headerlink\" title=\"说一下堆内存中对象的分配的基本策略\"></a>说一下堆内存中对象的分配的基本策略</h2><p>1、对象优先分配在 Eden 区域，当 eden 区没有足够空间进行分配时，虚拟机将发起一次 Minor GC 。</p>\n<p>2、大对象直接进入老年代，比如字符串和数组。</p>\n<p>3、年龄大的对象，进入老年区。对象在 Eden 区域经过一次 GC ，移动到Survivor 区域，年龄为1岁，然后每经过一次 GC ，对象年龄 +1 ，当对象年龄达到晋升老年代区域的阈值年龄时，对象移动到老年代，晋升老年代区域的阈值年龄默认为 15 岁，并且该阈值可以通过参数 <code>-XX:MaxTenuringThreshold</code> 来设置。</p>\n<h2 id=\"如何判断对象是否死亡\"><a href=\"#如何判断对象是否死亡\" class=\"headerlink\" title=\"如何判断对象是否死亡\"></a>如何判断对象是否死亡</h2><p>1、引用计数法</p>\n<p>给对象添加一个引用计数器，每当有一个地方引用该对象，则计数器 +1 ，如果引用失效，则计数器 -1 ，计数器为 0 的对象将不可以再被使用，即被判定为死亡。</p>\n<p>2、可达性分析算法</p>\n<p>这个算法是通过一系列被称作 <code>GC Roots</code> 的对象作为起点，从这些节点依次向下搜索，该节点走过的路径被称为引用链，凡是在引用链上的对象，则对象可用，如果一个对象没有到达 <code>GC Roots</code> 的引用链相连接的话，则说明该对象不可用，判断为死亡。</p>\n<h2 id=\"如何判断一个常量是废弃常量\"><a href=\"#如何判断一个常量是废弃常量\" class=\"headerlink\" title=\"如何判断一个常量是废弃常量\"></a>如何判断一个常量是废弃常量</h2><p>当一个常量没有被任何变量所引用的时候，就将该变量称为废弃变量，这时如果发生 GC ，并且内存不足的时候，就会将废弃变量回收。</p>\n<h2 id=\"如何判断一个类是无用的类\"><a href=\"#如何判断一个类是无用的类\" class=\"headerlink\" title=\"如何判断一个类是无用的类\"></a>如何判断一个类是无用的类</h2><p>满足以下三点，该类则被称作无用的类：</p>\n<p>1、该类的所有对象实例都已经被回收。</p>\n<p>2、加载该类的 <code>ClassLoader</code> 被回收。</p>\n<p>3、该类对应的 <code>java.lang.Class</code> 对象在任何地方都没有被引用，程序无法通过反射访问该类的方法。</p>\n","categories":["面试"],"tags":["面试"]},{"title":"面试系列09","url":"/2021/03/17/interview/%E9%9D%A2%E8%AF%95%E7%B3%BB%E5%88%9709/","content":"<h2 id=\"简单介绍一下-Spring-有啥缺点\"><a href=\"#简单介绍一下-Spring-有啥缺点\" class=\"headerlink\" title=\"简单介绍一下 Spring?有啥缺点?\"></a>简单介绍一下 Spring?有啥缺点?</h2><p>答：Spring框架中使用了大量的反射操作，比起原生的 Java 代码更加消耗性能。</p>\n<span id=\"more\"></span>\n<h2 id=\"说出使用-Spring-Boot-的主要优点\"><a href=\"#说出使用-Spring-Boot-的主要优点\" class=\"headerlink\" title=\"说出使用 Spring Boot 的主要优点\"></a>说出使用 Spring Boot 的主要优点</h2><p>1、SpringBoot 是对 Spring 框架的二次封装，简化了 Spirng 框架繁琐的配置，能够进行自动装配。</p>\n<p>2、SpringBoot 提供了内嵌的 Tomcat 容器，能够将项目打包成 jar 包独立运行。</p>\n<p>3、SpringBoot 能够很轻松地集成第三方的框架。</p>\n<h2 id=\"什么是-Spring-Boot-Starters\"><a href=\"#什么是-Spring-Boot-Starters\" class=\"headerlink\" title=\"什么是 Spring Boot Starters?\"></a>什么是 Spring Boot Starters?</h2><p>答：Spring Boot Starters 是一个启动器，里面包含了程序需要集成的一系列依赖，使用 Starters 可以快速使用一项技术，而不用考虑其他繁琐的问题。</p>\n<p>其中 SpringBoot 的官方依赖都以 <code>spring-boot-starter-</code> 命名，而第三方的 Stater 则以 <code>-spring-boot-starter</code> 命名。</p>\n<h2 id=\"Spring-Boot-支持哪些内嵌-Servlet-容器？\"><a href=\"#Spring-Boot-支持哪些内嵌-Servlet-容器？\" class=\"headerlink\" title=\"Spring Boot 支持哪些内嵌 Servlet 容器？\"></a>Spring Boot 支持哪些内嵌 Servlet 容器？</h2><p>答：Tomcat、jetty、undertow</p>\n<h2 id=\"如何在-Spring-Boot-应用程序中使-undertow-而不是-Tomcat\"><a href=\"#如何在-Spring-Boot-应用程序中使-undertow-而不是-Tomcat\" class=\"headerlink\" title=\"如何在 Spring Boot 应用程序中使 undertow 而不是 Tomcat?\"></a>如何在 Spring Boot 应用程序中使 undertow 而不是 Tomcat?</h2><p>答：排除 <code>Tomcat</code> 容器，引入 <code>undertow</code> 容器的 Starter 。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--排除Tomcat容器--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">exclusions</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">exclusion</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">exclusion</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">exclusions</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--替换内置默认容器--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-undertow<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"介绍一下-SpringBootApplication-注解\"><a href=\"#介绍一下-SpringBootApplication-注解\" class=\"headerlink\" title=\"介绍一下@SpringBootApplication 注解\"></a>介绍一下@SpringBootApplication 注解</h2><p>答：SpringBootApplication 注解是一个复合型注解，其中包含了 <code>@Configuration</code>、<code>@EnableAutoConfiguration</code>、<code>@ComponentScan</code> 三个注解。</p>\n<h2 id=\"开发-RESTful-Web-服务常用的注解有哪些？\"><a href=\"#开发-RESTful-Web-服务常用的注解有哪些？\" class=\"headerlink\" title=\"开发 RESTful Web 服务常用的注解有哪些？\"></a>开发 RESTful Web 服务常用的注解有哪些？</h2><p>答：<br><code>@RestController</code>、<code>@RequestMapper</code>、<code>@GetMapper</code>、<code>@PostMapper</code>、<code>@PutMapper</code>、<code>@DeleteMapper</code>、<code>@PathVariable</code>、<code>@RequestBody</code>、<code>@RequestParam</code></p>\n<h2 id=\"Spirng-Boot-常用的两种配置文件\"><a href=\"#Spirng-Boot-常用的两种配置文件\" class=\"headerlink\" title=\"Spirng Boot 常用的两种配置文件\"></a>Spirng Boot 常用的两种配置文件</h2><p>答：<code>application.yml</code>、<code>application.properties</code></p>\n<h2 id=\"什么是-YAML？YAML-配置的优势在哪里\"><a href=\"#什么是-YAML？YAML-配置的优势在哪里\" class=\"headerlink\" title=\"什么是 YAML？YAML 配置的优势在哪里 ?\"></a>什么是 YAML？YAML 配置的优势在哪里 ?</h2><p>答：YAML 是一种数据序列化语言、是一种可读的文本数据结构。YAML的优势在于：易于阅读，程序易于解析，能够使用本地数据结构进行存储。</p>\n<h2 id=\"Spring-Boot-常用的读取配置文件的方法有哪些？\"><a href=\"#Spring-Boot-常用的读取配置文件的方法有哪些？\" class=\"headerlink\" title=\"Spring Boot 常用的读取配置文件的方法有哪些？\"></a>Spring Boot 常用的读取配置文件的方法有哪些？</h2><p>答：<br>1、<code>@Value</code> 注解读取文件<br>2、<code>@ConfigurationProperties</code></p>\n<h2 id=\"Spring-Boot-如何做请求参数校验？\"><a href=\"#Spring-Boot-如何做请求参数校验？\" class=\"headerlink\" title=\"Spring Boot 如何做请求参数校验？\"></a>Spring Boot 如何做请求参数校验？</h2><p>答：可以使用 <code>spring-boot-starter-validation</code> 框架进行注解式参数校验。</p>\n<h2 id=\"如何使用-Spring-Boot-实现全局异常处理？\"><a href=\"#如何使用-Spring-Boot-实现全局异常处理？\" class=\"headerlink\" title=\"如何使用 Spring Boot 实现全局异常处理？\"></a>如何使用 Spring Boot 实现全局异常处理？</h2><p>答：可以使用 <code>@ControllerAdvice</code> 和 <code>@ExceptionHandler</code> 注解实现全局异常处理。</p>\n<h2 id=\"Spring-Boot-中如何实现定时任务\"><a href=\"#Spring-Boot-中如何实现定时任务\" class=\"headerlink\" title=\"Spring Boot 中如何实现定时任务 ?\"></a>Spring Boot 中如何实现定时任务 ?</h2><p>答：可以使用 <code>@Scheduled</code> 注解实现定时任务。</p>\n","categories":["面试"],"tags":["面试"]},{"title":"TCP协议的三次握手和四次挥手","url":"/2020/03/22/computer/TCP%E5%8D%8F%E8%AE%AE%E7%9A%84%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B/","content":"<h2 id=\"什么是TCP协议？\"><a href=\"#什么是TCP协议？\" class=\"headerlink\" title=\"什么是TCP协议？\"></a>什么是TCP协议？</h2><p>TCP是传输控制协议，是一个面向连接的协议，在使用TCP协议收发数据前，必须和对方建立可靠的连接，一个TCP连接必须要经过3次“对话”才能建立起来。</p>\n<span id=\"more\"></span>\n<p>第一次对话：由主机A发送一个请求连接的消息报文给主机B。<br>第二次对话：由主机B发送同意连接和要求同步的数据包。<br>第三次对话：由主机A发送一个数据包确认主机B要求同步。</p>\n<p><img src=\"/images/2020/03/20200322143430540.png\" alt=\"在这里插入图片描述\"></p>\n<p><strong>同步就是两台主机一个发送，一个接收，协调工作。</strong></p>\n<blockquote>\n<p>三次“对话”的目的是使数据包的发送和接受同步，经过三次“对话”之后，主机A才向主机B正式发送数据。</p>\n</blockquote>\n<h2 id=\"TCP的三次握手\"><a href=\"#TCP的三次握手\" class=\"headerlink\" title=\"TCP的三次握手\"></a>TCP的三次握手</h2><p><strong>TCP建立可靠连接的三次对话过程也被称作为三次握手。</strong></p>\n<p>在了解TCP的三次握手前，需要先了解几个概念。</p>\n<ul>\n<li><strong>Seq：</strong> 序列号，根据序列号标识某个操作。</li>\n<li><strong>Ack：</strong> 确认标志，如果确认某个操作，则回复Ack=对方主机Seq+1。</li>\n<li><strong>SYN：</strong> 同步标志。</li>\n<li><strong>FIN：</strong> 结束标志。</li>\n</ul>\n<p><img src=\"/images/2020/03/20200322143744670.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"TCP的四次挥手\"><a href=\"#TCP的四次挥手\" class=\"headerlink\" title=\"TCP的四次挥手\"></a>TCP的四次挥手</h2><p><strong>TCP的四次挥手是为了正常断开连接，并保证传输的数据的完整性。</strong></p>\n<p><img src=\"/images/2020/03/20200322144424861.png\" alt=\"在这里插入图片描述\"></p>\n<blockquote>\n<p>TCP的四次挥手不一定是由Client发起的，Client和Server均可以发起四次挥手，断开连接。</p>\n</blockquote>\n<h2 id=\"为什么TCP是三次握手，四次挥手？\"><a href=\"#为什么TCP是三次握手，四次挥手？\" class=\"headerlink\" title=\"为什么TCP是三次握手，四次挥手？\"></a>为什么TCP是三次握手，四次挥手？</h2><ul>\n<li>当Server端接收到Client端发送的SYN（同步标志）连接请求的消息报文之后，可以直接发送Ack+SYN报文给Client，其中Ack表示应答，确认，SYN报文是表示同步。</li>\n<li>但是当被动方接受到FIN（结束标志）消息报文之后，很可能不会立即关闭Socket，所以只能先回复一个Ack表示同意结束连接。</li>\n<li>当被动方的所有报文发送完毕，发会发送FIN（结束标志）报文，所以TCP是四次挥手断开连接。</li>\n</ul>\n<blockquote>\n<p>总而言之，TCP协议之所以是三次握手，四次挥手，全部都是为了保证数据传输的完整性。</p>\n</blockquote>\n","categories":["计算机"],"tags":["Java","网络编程"]},{"title":"cmd命令提示窗口进入其他盘符","url":"/2020/04/12/computer/cmd%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E7%AA%97%E5%8F%A3%E8%BF%9B%E5%85%A5%E5%85%B6%E4%BB%96%E7%9B%98%E7%AC%A6/","content":"<p>打开cmd命令提示窗口，然后输入<code>cd F:\\\\GoPath</code>命令，然后输入<code>F:</code>命令，即可进入<code>F</code>盘下的<code>F:\\\\GoPath</code>目录。</p>\n<span id=\"more\"></span>\n<p>这个问题虽然很小，但是今天使用cmd的时候，一时间突然就想不起了，所以才说<strong>好记性不如烂笔头</strong>。<br>现在把这个问题记录在这里，既是自己学习的笔记，也是给其他可能突然想不起的朋友提供一个解决办法。</p>\n<p><img src=\"/images/2020/04/20200412172937115.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["计算机"],"tags":["计算机"]},{"title":"为什么1个字节是8个比特？","url":"/2023/01/18/computer/%E4%B8%BA%E4%BB%80%E4%B9%881%E4%B8%AA%E5%AD%97%E8%8A%82%E6%98%AF8%E4%B8%AA%E6%AF%94%E7%89%B9/","content":"<h2 id=\"字节？比特？\"><a href=\"#字节？比特？\" class=\"headerlink\" title=\"字节？比特？\"></a>字节？比特？</h2><p>在很多IO操作的底层实现中，字节是最基本的操作单位，很多IO操作，都是将数据读取为字节数组，或者将一个字节数组写成数据。</p>\n<p>根据我们所学习的计算机知识，一个字节（byte）是八个比特位（bit），那么为什么一个字节是八个比特，而不是7个，或者说9个、16个？</p>\n<span id=\"more\"></span>\n<p>或者说，我们能不能直接将数据读取为bit的形式，而不是读取为byte的形式呢？</p>\n<p>首先我先回答一下这个问题。</p>\n<p>答案是能！</p>\n<p>因为计算机本身只能识别0与1组成的机器语言，所以任何的编程语言从计算机中读取到的数据，本质上都是0和1组成的bit数据，例如<code>0100100001000101010011000100110001001111</code>。</p>\n<p>而字节数组（byte[]）是我们人为将bit数据按照八位为一组，划分之后得到的一组数据。</p>\n<p>比如<code>0100100001000101010011000100110001001111</code>这组bit数据按照八位为一组，划分之后便可以得到一个字节数组，这个字节数组的表现形式可以粗略地表示为<code>[01001000,01000101,01001100,01001100,01001111]</code>。</p>\n<p>那么为什么要按照八位为一组进行划分呢？</p>\n<h2 id=\"ASCII编码表\"><a href=\"#ASCII编码表\" class=\"headerlink\" title=\"ASCII编码表\"></a>ASCII编码表</h2><p>首先我们必须明确，一个bit位只能表示0和1两种状态，这对于人类而言明显是不够的。</p>\n<p>比如说用<code>0</code>来表示人类语言中是<code>你今天早上吃饭了吗？</code>这句话，用<code>1</code>来表示人类语言中是<code>你今天中午吃饭了吗？</code>这句话，那么如果人类需要用机器语言表示<code>你今天晚上吃饭了吗？</code>又该怎么办呢？</p>\n<p>于是人类便用两个bit位，比如<code>10</code>来表示<code>你今天晚上吃饭了吗？</code>，甚至这个时候，两个bit位还有一个<code>11</code>能够用来表示其他的人类语言，于是人类就将<code>11</code>表示为<code>吃了</code>。</p>\n<p>但是这个时候又犯难了，如果<code>没吃</code>用机器语言又该怎么表示呢？</p>\n<p>所以说，一个或者两个bit位对于人类而言并没有太大的含义，所以人类需要一个对照表，能够用机器语言来表示所有的人类语言。</p>\n<p>于是在计算机发展早期，美国国家标准学会制定了ASCII编码表，用来表示机器语言和人类语言的对照表。</p>\n<p>只要所有人按照ASCII的标准进行编码，那么所有人都可以将人类语言写成机器语言，而且这些机器语言同样可以被其他遵守ASCII的标准的人正确读取为人类语言。</p>\n<p>例如上述中的<code>0100100001000101010011000100110001001111</code>，按照ASCII标准，可以翻译为人类语言的<code>HELLO</code>。</p>\n<p>在ASCII编码表中，规定了人类使用的128种类型（0-127）的字符与机器语言的对照。</p>\n<p>而为了表示128种类型，即0-127的值，机器语言最少需要使用7个bit位来表示（2的7次方）。</p>\n<p>但是ASCII编码表为了保留扩展性，保留了一个bit位作为扩展，于是ASCII编码便规定了八个bit位作为一个人类可读的有效字符。</p>\n<blockquote>\n<p>ASCII编码理论上能够表示256种类型的字符，ASCII编码表目前规定的128种类型的字符中，第八个bit位均为0。一些欧洲国家使用的编码表便是在ASCII编码表是基础上进行扩展的，能够表示256种字符。<br>至于为什么不使用16个bit位进行表示呢？那是因为早期的计算机资源极其珍贵，在八个bit位能够表示所有字符（美国国家标准学会当初认为的所有字符）的情况下，使用16个bit位来表示一个字符是非常浪费的。</p>\n</blockquote>\n<h2 id=\"为什么1个字节是8个比特？\"><a href=\"#为什么1个字节是8个比特？\" class=\"headerlink\" title=\"为什么1个字节是8个比特？\"></a>为什么1个字节是8个比特？</h2><p>所以说，目前的计算机之所以使用使用八个比特来表示一个字节，主要就是因为当初美国国家标准学会制定了ASCII编码，其中规定了使用八个比特来表示一个字节。</p>\n<p>后期虽然发展出了类似UTF-8之类的编码表，需要使用27个比特或者32个比特来表示一个字符，但是因为历史的原因，人类依然按照八个比特来读取一个字节，然后用多个字节来表示UTF-8支持的字符。</p>\n<p>如果当初的美国国家标准学会能够知道互联网在未来会发展成全球性的网络环境，那么或许他们当初就会直接制定类似于UTF-8一样的编码标准了，这样或许就不是八个比特来表示一个字节，而是27个比特表示一个字节，或者32个比特表示一个字节。</p>\n<p>或许当初真的这样制定了编码标准，现在的人就应该发问：为什么1个字节是32个比特？</p>\n","categories":["计算机"],"tags":["计算机"]},{"title":"Electron-vue build 报错： Multispinner is not defined","url":"/2021/06/14/javascript/Electron-vue%20build%20%E6%8A%A5%E9%94%99%EF%BC%9A%20Multispinner%20is%20not%20defined/","content":"<h2 id=\"Multispinner-类没有定义\"><a href=\"#Multispinner-类没有定义\" class=\"headerlink\" title=\"Multispinner 类没有定义\"></a>Multispinner 类没有定义</h2><ul>\n<li><p>错误信息</p>\n<blockquote>\n<p>UnhandledPromiseRejectionWarning: ReferenceError: Multispinner is not defined</p>\n</blockquote>\n<span id=\"more\"></span>\n</li>\n<li><p>错误原因</p>\n</li>\n</ul>\n<blockquote>\n<p>我使用的是 electron -vue 的模板，在该模板中，没有引入 <code>multispinner</code> 相关的依赖，使用命令将 multispinner 依赖重新安装，并在 build.js 文件中加入引用。</p>\n</blockquote>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><span class=\"line\">npm install multispinner -D</span><br></pre></td></tr></table></figure>\n<p>build.js 文件中引用：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">Multispinner</span> = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;multispinner&#x27;</span>)</span><br></pre></td></tr></table></figure>\n","categories":["JavaScript"],"tags":["JavaScript","Electron"]},{"title":"FreeMarker include指令实现文件复用","url":"/2020/05/01/javascript/FreeMarker%20include%E6%8C%87%E4%BB%A4%E5%AE%9E%E7%8E%B0%E6%96%87%E4%BB%B6%E5%A4%8D%E7%94%A8/","content":"<p>在正式开发中，我们可能需要将一些文件封装成独立的模板文件，然后在其他文件中引入即可，这样可以实现文件的复用，减少了大量重复代码的编写。<br>FreeMarker中同样也支持这种方式，FreeMarker使用的是&lt;#include&gt;的指令实现的。</p>\n<span id=\"more\"></span>\n\n<p>我们先创建一个<strong>head.ftl</strong>文件。</p>\n<figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;en&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>头部文件<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>这是头部文件<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>然后创建一个<strong>footer.ftl</strong>文件。</p>\n<figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;en&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>底部文件<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>这是底部文件<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>我们在<strong>page.ftl</strong>文件中使用&lt;#include&gt;指令引入这两个文件内容，实现文件内容的复用。</p>\n<figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;en&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>页面<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    &lt;#include &quot;head.ftl&quot;&gt;</span><br><span class=\"line\">    这是中间页面的内容</span><br><span class=\"line\">    &lt;#include &quot;footer.ftl&quot;&gt;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>最后我们在Web层中的UserController中添加一个方法。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;/page&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">page</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;page&quot;</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>启动项目，我们访问<a href=\"http://localhost:8080/page路径。\">http://localhost:8080/page路径。</a><br><img src=\"/images/2020/05/20200501162915946.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["JavaScript"],"tags":["JavaScript","Thymeleaf"]},{"title":"JavaScript 导出 table 为 Excel 表格","url":"/2021/07/05/javascript/JavaScript%20%E5%AF%BC%E5%87%BA%20table%20%E4%B8%BA%20Excel%20%E8%A1%A8%E6%A0%BC/","content":"<p>JavaScript 是一种可以运行在浏览器中的语言，结合浏览器，JavaScript 可以实现非常多的功能。</p>\n<span id=\"more\"></span>\n\n<p>JavaScript 可以导出页面的 table 表格为 Excel。</p>\n<p>具体代码如下：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>JavaScript导出Excel<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;exportExcel&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">table</span> <span class=\"attr\">border</span>=<span class=\"string\">&quot;1&quot;</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;float: left; font-family: &#x27;宋体&#x27;;f ont-size: 14px;&quot;</span> <span class=\"attr\">cellspacing</span>=<span class=\"string\">&quot;0&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span> <span class=\"attr\">colspan</span>=<span class=\"string\">&quot;4&quot;</span>&gt;</span>学生信息表<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;width: 100px;&quot;</span>&gt;</span>序号<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;width: 100px;&quot;</span>&gt;</span>姓名<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;width: 100px;&quot;</span>&gt;</span>性别<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;width: 100px;&quot;</span>&gt;</span>年龄<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>小明<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>男<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>16<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>2<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>小红<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>女<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>15<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">table</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;button&quot;</span> <span class=\"attr\">onclick</span>=<span class=\"string\">&quot;exportExcel(&#x27;exportExcel&#x27;)&quot;</span>&gt;</span>导出Excel<span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">function</span> <span class=\"title function_\">exportExcel</span>(<span class=\"params\">id</span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">var</span> table = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(id).<span class=\"property\">innerHTML</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">var</span> template = <span class=\"string\">`</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"language-javascript\">        &lt;html&gt;</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"language-javascript\">            &lt;head&gt;</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"language-javascript\">                &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"language-javascript\">            &lt;/head&gt;</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"language-javascript\">            &lt;body&gt;</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"language-javascript\">                <span class=\"subst\">$&#123;table&#125;</span></span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"language-javascript\">            &lt;/body&gt;</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"language-javascript\">        &lt;/html&gt;`</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">var</span> excelBlob = <span class=\"keyword\">new</span> <span class=\"title class_\">Blob</span>([template], &#123; <span class=\"attr\">type</span>: <span class=\"string\">&quot;application/vnd.ms-excel&quot;</span> &#125;);</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">var</span> link = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&quot;a&quot;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">        link.<span class=\"property\">href</span> = <span class=\"variable constant_\">URL</span>.<span class=\"title function_\">createObjectURL</span>(excelBlob);</span></span><br><span class=\"line\"><span class=\"language-javascript\">        link.<span class=\"property\">download</span> = <span class=\"string\">&quot;导出Excel.xls&quot;</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"variable language_\">document</span>.<span class=\"property\">body</span>.<span class=\"title function_\">appendChild</span>(link);</span></span><br><span class=\"line\"><span class=\"language-javascript\">        link.<span class=\"title function_\">click</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"variable language_\">document</span>.<span class=\"property\">body</span>.<span class=\"title function_\">removeChild</span>(link);</span></span><br><span class=\"line\"><span class=\"language-javascript\">    &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n","categories":["JavaScript"],"tags":["JavaScript"]},{"title":"JavaScript实现贪吃蛇小游戏（网页单机版）","url":"/2023/05/13/javascript/JavaScript%E5%AE%9E%E7%8E%B0%E8%B4%AA%E5%90%83%E8%9B%87%E5%B0%8F%E6%B8%B8%E6%88%8F%EF%BC%88%E7%BD%91%E9%A1%B5%E5%8D%95%E6%9C%BA%E7%89%88%EF%BC%89/","content":"<p>今天使用 <code>JavaScript</code> 实现了一个网页版的贪吃蛇小游戏。</p>\n<span id=\"more\"></span>\n\n<h1 id=\"项目地址\"><a href=\"#项目地址\" class=\"headerlink\" title=\"项目地址\"></a>项目地址</h1><ul>\n<li><p>Github: <a href=\"https://github.com/herenpeng/snake\">https://github.com/herenpeng/snake</a></p>\n</li>\n<li><p>Gitee: <a href=\"https://gitee.com/herenpeng/snake\">https://gitee.com/herenpeng/snake</a></p>\n</li>\n<li><p>线上体验：<a href=\"https://herenpeng.github.io/static/snake.html\">https://herenpeng.github.io/static/snake.html</a></p>\n</li>\n</ul>\n<h1 id=\"项目介绍\"><a href=\"#项目介绍\" class=\"headerlink\" title=\"项目介绍\"></a>项目介绍</h1><h2 id=\"游戏开始\"><a href=\"#游戏开始\" class=\"headerlink\" title=\"游戏开始\"></a>游戏开始</h2><p>使用浏览器打开 <code>snake.html</code> 文件，可以看到小游戏的主界面。</p>\n<p><img src=\"/images/2023/05/01.png\" alt=\"选择排序演示\"></p>\n<p>按下键盘回车键，即可开始游戏。</p>\n<p><img src=\"/images/2023/05/02.png\" alt=\"选择排序演示\"></p>\n<h2 id=\"游戏暂停\"><a href=\"#游戏暂停\" class=\"headerlink\" title=\"游戏暂停\"></a>游戏暂停</h2><p>在游戏中，重新按下回车键，即可暂停游戏，使用键盘的上、下、左、右四个方向键，即可控制贪吃蛇移动。</p>\n<p><img src=\"/images/2023/05/03.png\" alt=\"选择排序演示\"></p>\n<h2 id=\"游戏模式\"><a href=\"#游戏模式\" class=\"headerlink\" title=\"游戏模式\"></a>游戏模式</h2><p>游戏一共有两种模式：</p>\n<ul>\n<li><p>正常模式：该模式中迷宫墙体为真实墙体，贪吃蛇触之即死。</p>\n</li>\n<li><p>无限模式：该模式下迷宫墙体为时空间隙，贪吃蛇撞墙后，会从墙体的另一边穿越过来。</p>\n</li>\n</ul>\n<p>游戏模式可以通过修改 <code>snake.html</code> 文件中的 <code>CYCLE</code> 布尔常量值来修改。</p>\n<table>\n<thead>\n<tr>\n<th>模式</th>\n<th>CYCLE</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>正常模式</td>\n<td>false</td>\n</tr>\n<tr>\n<td>无限模式</td>\n<td>true</td>\n</tr>\n</tbody></table>\n<h2 id=\"游戏死亡\"><a href=\"#游戏死亡\" class=\"headerlink\" title=\"游戏死亡\"></a>游戏死亡</h2><table>\n<thead>\n<tr>\n<th>模式</th>\n<th>死亡原因</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>正常模式</td>\n<td>撞墙、咬到自己的身体</td>\n</tr>\n<tr>\n<td>无限模式</td>\n<td>咬到自己的身体</td>\n</tr>\n</tbody></table>\n<p><img src=\"/images/2023/05/04.png\" alt=\"选择排序演示\"></p>\n<h2 id=\"重新开始\"><a href=\"#重新开始\" class=\"headerlink\" title=\"重新开始\"></a>重新开始</h2><p>在任意情况下，只要按下键盘 F5 键，即可刷新网页小游戏，重新开始。</p>\n<h1 id=\"结尾\"><a href=\"#结尾\" class=\"headerlink\" title=\"结尾\"></a>结尾</h1><p>对项目有兴趣的同学可以从 <code>Github</code> 或者 <code>Gitee</code> 上进行下载，也欢迎其他同学为项目提供 PR。<br>如果你喜欢这个项目，欢迎 <code>Star</code>。</p>\n","categories":["JavaScript"],"tags":["JavaScript","贪吃蛇","小游戏"]},{"title":"Node.js环境安装","url":"/2019/12/23/javascript/Node.js%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/","content":"<p>简单的说 Node.js 就是运行在服务端的 JavaScript。<br>Node.js 是一个基于Chrome JavaScript 运行时建立的一个平台。<br>Node.js是一个事件驱动I/O服务端JavaScript环境，基于Google的V8引擎，V8引擎执行Javascript的速度非常快，性能非常好。</p>\n<span id=\"more\"></span>\n\n<p><strong>Node.js中文官网 <a href=\"https://nodejs.org/zh-cn/\">https://nodejs.org/zh-cn/</a></strong></p>\n<p><strong>第一步：进入官网。</strong><br><img src=\"/images/2019/12/20191222233453362.png\" alt=\"\"></p>\n<p><strong>第二步：选择对应的操作系统的版本，这里选择的是64位的windows版本。</strong><br><img src=\"/images/2019/12/20191222233615877.png\" alt=\"在这里插入图片描述\"></p>\n<p><strong>下载之后得到一个node-v12.14.0-x64.msi安装包，我们只需要双击这个安装包，一路next即可完成安装。</strong><br><img src=\"/images/2019/12/20191222233835466.png\" alt=\"在这里插入图片描述\"></p>\n<p><strong>第三步：进入cmd界面，可以通过一些命令来进行操作。</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">node -v</span><br></pre></td></tr></table></figure>\n<p><strong>node -v查看node的版本。</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">npm -v</span><br></pre></td></tr></table></figure>\n<p><strong>npm -v查看npm的版本【安装完Node应该自带了npm】</strong><br><img src=\"/images/2019/12/20191222234024400.png\" alt=\"在这里插入图片描述\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">npm install nrm –g</span><br></pre></td></tr></table></figure>\n<p><strong>在控制台输入npm install nrm –g进行安装nrm。</strong></p>\n<p>安装完成后，可以使用nrm ls命令查看nrm所有的镜像。<br><img src=\"/images/2019/12/2019122223441128.png\" alt=\"在这里插入图片描述\"><br>由于网络环境的问题，我们选择使用taobao的镜像。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">nrm use taobao</span><br></pre></td></tr></table></figure>\n<p>使用淘宝镜像。<br><img src=\"/images/2019/12/20191222235236850.png\" alt=\"在这里插入图片描述\"><br>我们可以使用进行测试是否成功。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">nrm test taobao</span><br></pre></td></tr></table></figure>\n<p>显示使用淘宝镜像的网络环境为201ms，说明可以使用该镜像。<br><img src=\"/images/2019/12/20191222235356822.png\" alt=\"在这里插入图片描述\"></p>\n<p>安装完Node之后，我们打开IDEA，我们在IDEA上安装Node插件，就可以在IDEA上来开发Node程序了。<br><img src=\"/images/2019/12/20200523121009261.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["JavaScript"],"tags":["JavaScript","Node"]},{"title":"Thymeleaf静态化页面","url":"/2020/03/25/javascript/Thymeleaf%E9%9D%99%E6%80%81%E5%8C%96%E9%A1%B5%E9%9D%A2/","content":"<h1 id=\"前置知识\"><a href=\"#前置知识\" class=\"headerlink\" title=\"前置知识\"></a>前置知识</h1><blockquote>\n<p>什么是<a href=\"/2020/03/24/java/Thymeleaf静态模板引擎/\">Thymeleaf静态模板引擎</a>？</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h1 id=\"为什么要做页面静态化？\"><a href=\"#为什么要做页面静态化？\" class=\"headerlink\" title=\"为什么要做页面静态化？\"></a>为什么要做页面静态化？</h1><p>在生产环境中，业务复杂多变，我们需要保证系统要求高可用，高并发。<br>如果系统的某一个页面需要返回大量的数据，而且该页面经常被大量请求访问，那么该页面的数据渲染问题就会变成系统性能的短板，同时大量的请求会对数据库造成极大的压力。<br>这个时候，我们通过后端获取数据，然后响应前端渲染数据的方法就很难解决这个问题。</p>\n<h2 id=\"Redis缓存？\"><a href=\"#Redis缓存？\" class=\"headerlink\" title=\"Redis缓存？\"></a>Redis缓存？</h2><p>Redis是一款基于缓存的数据库，可以快速地响应大量数据，可以使用Redis作为缓存来响应该页面的数据，保证该页面的访问性能吗？<br><strong>不行！</strong><br>因为Redis虽然是基于缓存的，但是它只适用于存放少量数据，如果数据量过大，很容易造成Redis缓存崩溃，然后所有请求打在数据库上，造成数据库宕机。<br>所以缓存不是万能的。</p>\n<h2 id=\"页面静态化技术\"><a href=\"#页面静态化技术\" class=\"headerlink\" title=\"页面静态化技术\"></a>页面静态化技术</h2><p>后端访问数据，然后渲染前端的方法会使系统性能下降，那么我们就可以使用页面静态化技术，就是将动态生成的HTML文件，变成一个静态的HTML文件保存起来，然后让用户访问这个静态页面。<br>这样就省去了系统请求后端的和前端渲染数据的时间，大大提高了系统的访问效率。</p>\n<h2 id=\"怎么实现页面静态化？\"><a href=\"#怎么实现页面静态化？\" class=\"headerlink\" title=\"怎么实现页面静态化？\"></a>怎么实现页面静态化？</h2><p>目前，静态化页面都是通过模板引擎来生成，常用的模板引擎有：</p>\n<ul>\n<li>Freemarker</li>\n<li>Velocity</li>\n<li>Thymeleaf</li>\n</ul>\n<h1 id=\"Thymeleaf静态化技术\"><a href=\"#Thymeleaf静态化技术\" class=\"headerlink\" title=\"Thymeleaf静态化技术\"></a>Thymeleaf静态化技术</h1><h2 id=\"准备工作\"><a href=\"#准备工作\" class=\"headerlink\" title=\"准备工作\"></a>准备工作</h2><p>该项目的环境搭建，Thymeleaf前端页面渲染，都已经在<a href=\"/2020/03/24/java/Thymeleaf静态模板引擎/\">Thymeleaf静态模板引擎</a>中准备好了。</p>\n<h2 id=\"编写Service层代码\"><a href=\"#编写Service层代码\" class=\"headerlink\" title=\"编写Service层代码\"></a>编写Service层代码</h2><p>我们将页面静态化的代码逻辑放在Service层。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Service</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThymeleafService</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> TemplateEngine templateEngine;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">createHtml</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> FileNotFoundException &#123;</span><br><span class=\"line\">        <span class=\"type\">User</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>(<span class=\"number\">1</span>,<span class=\"string\">&quot;张三&quot;</span>,<span class=\"number\">20</span>);</span><br><span class=\"line\">        <span class=\"comment\">//创建thymeleaf上下文对象</span></span><br><span class=\"line\">        <span class=\"type\">Context</span> <span class=\"variable\">context</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Context</span>();</span><br><span class=\"line\">        <span class=\"comment\">//把数据放入上下文对象</span></span><br><span class=\"line\">        context.setVariable(<span class=\"string\">&quot;user&quot;</span>,user);</span><br><span class=\"line\">        context.setVariable(<span class=\"string\">&quot;msg&quot;</span>,<span class=\"string\">&quot;Hello, Thymeleaf!&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//创建一个输出流</span></span><br><span class=\"line\">        <span class=\"type\">PrintWriter</span> <span class=\"variable\">writer</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">PrintWriter</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">File</span>(<span class=\"string\">&quot;G:\\\\temp\\\\html\\\\&quot;</span>+user.getId()+<span class=\"string\">&quot;.html&quot;</span>));</span><br><span class=\"line\">        <span class=\"comment\">//生成静态页面</span></span><br><span class=\"line\">        templateEngine.process(<span class=\"string\">&quot;hello&quot;</span>,context,writer);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"编写Web层代码\"><a href=\"#编写Web层代码\" class=\"headerlink\" title=\"编写Web层代码\"></a>编写Web层代码</h2><p>我们修改Web的代码逻辑，增加页面静态化的方法。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Controller</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;user&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserController</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> ThymeleafService thymeleafService;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping(&quot;hello&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">hello</span><span class=\"params\">(Model model)</span> <span class=\"keyword\">throws</span> FileNotFoundException &#123;</span><br><span class=\"line\">        <span class=\"type\">User</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>(<span class=\"number\">1</span>,<span class=\"string\">&quot;张三&quot;</span>,<span class=\"number\">20</span>);</span><br><span class=\"line\">        model.addAttribute(<span class=\"string\">&quot;user&quot;</span>,user);</span><br><span class=\"line\">        model.addAttribute(<span class=\"string\">&quot;msg&quot;</span>, <span class=\"string\">&quot;Hello, Thymeleaf!&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//调用Service层的方法，创建HTML文件</span></span><br><span class=\"line\">        thymeleafService.createHtml();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;hello&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"功能测试\"><a href=\"#功能测试\" class=\"headerlink\" title=\"功能测试\"></a>功能测试</h2><p>启动项目，访问<code>/user/hello</code>接口，我们就发现在<code>G:\\temp\\html</code>目录下生成了一个<code>1.html</code>文件。</p>\n<p><strong>hello.html模板文件</strong></p>\n<figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;en&quot;</span> <span class=\"attr\">xmlns:th</span>=<span class=\"string\">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Hello页面<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h1</span> <span class=\"attr\">th:text</span>=<span class=\"string\">&quot;$&#123;user.name&#125;&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h1</span> <span class=\"attr\">th:text</span>=<span class=\"string\">&quot;$&#123;msg&#125;&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>1.html静态页面文件</strong></p>\n<figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;en&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Hello页面<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>张三<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>Hello, Thymeleaf!<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n\n\n\n","categories":["JavaScript"],"tags":["JavaScript","Thymeleaf"]},{"title":"Vue-cli项目解决跨域问题","url":"/2020/09/05/javascript/Vue-cli%E9%A1%B9%E7%9B%AE%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98/","content":"<blockquote>\n<p>前后端分离开发是如今Web开发的一个趋势，不过前后端分离开发也给开发带来了一些区别于传统项目的问题。<br>由于前后端分离开发中，前端项目和后端项目由于需要部署在不同的服务上，基于浏览器的同源策略限制，前端的JavaScript脚本所发出的异步请求，无法和后端的接口进行交互，这就是前后端分离开发中的跨域问题。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n\n<p>如果在Vue项目中想要解决跨域问题，我们可以直接在vue.config.js配置文件中配置项目的代理路径，这样即可解决Vue项目的跨域代理问题。</p>\n<ul>\n<li><strong>vue.config.js</strong><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">    <span class=\"attr\">devServer</span>:&#123;</span><br><span class=\"line\">        <span class=\"attr\">port</span>:<span class=\"number\">9090</span>, <span class=\"comment\">// 启动端口</span></span><br><span class=\"line\">        <span class=\"attr\">open</span>:<span class=\"literal\">true</span>,  <span class=\"comment\">// 启动后是否自动打开网页</span></span><br><span class=\"line\">        <span class=\"attr\">proxy</span>: <span class=\"string\">&#x27;http://127.0.0.1:8080&#x27;</span> <span class=\"comment\">//代理路径，如果在当前路径下没有找到对应的服务器资源，则去代理路径寻找</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>【备注】vue.config.js文件放在项目目录的下面，与src目录、node_modules目录同级。</p>\n</blockquote>\n</li>\n</ul>\n","categories":["JavaScript"],"tags":["JavaScript","Vue"]},{"title":"Vue-template组件开发","url":"/2020/02/21/javascript/Vue-template%E7%BB%84%E4%BB%B6%E5%BC%80%E5%8F%91/","content":"<p>使用vue进行开发的时候，可以将页面的一个个模块封装成一个个组件，便于模块的复用和管理，最为常见的就是将头部或者底部封装为一个页面，然后在其他页面中引入即可。<br>首先先创建一个my-template.vue模板vue文件。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">template</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">        您好，我是Vue模块组件</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">template</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>【注意】在<strong>template</strong>标签下，只能有一个根标签。即在template下只能有一个div或者其他标签，不能有其他标签与div为同级标签。</p>\n<p>创建另外一个index.html文件，在文件中引入该模板。</p>\n<figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>首页<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--这里需要引入三个和vue相关的js文件，也可以将这三个文件下载下来，在本地引用--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;https://vuejs.org/js/vue.min.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;https://unpkg.com/http-vue-loader&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;https://unpkg.com/element-ui/lib/index.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!--最外面的div，id为app，需要被vue管理的范围--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;app&quot;</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"comment\">&lt;!--这里写一个模板，模板名字自定义--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">hello</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">hello</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text/javascript&quot;</span>&gt;</span><span class=\"language-handlebars\"><span class=\"language-xml\"></span></span></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"language-handlebars\">\t<span class=\"comment\">&lt;!--vue使用httpVueLoader--&gt;</span></span></span></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"language-handlebars\">    Vue.use(httpVueLoader);</span></span></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"language-handlebars\">    const app = new Vue(&#123;</span></span></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"language-handlebars\">    \t<span class=\"comment\">&lt;!--使用id选择器，表示被vue管理的范围--&gt;</span></span></span></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"language-handlebars\">        el: &quot;#app&quot;,</span></span></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"language-handlebars\">        components: &#123;</span></span></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"language-handlebars\">        \t<span class=\"comment\">&lt;!--给自己自定义的模板选择资源路径--&gt;</span></span></span></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"language-handlebars\">            &#x27;hello&#x27;: &#x27;url:./my-template.vue&#x27;,</span></span></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"language-handlebars\">        &#125;,</span></span></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"language-handlebars\">    &#125;);</span></span></span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"language-handlebars\"></span></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>访问index.html页面，结果如下，模板已经完全引入了。</p>\n<p><img src=\"/images/2020/02/20200221100603345.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["JavaScript"],"tags":["JavaScript","Vue"]},{"title":"WebStrom 开发 Vue 项目，安装 ESLint 代码风格检查工具","url":"/2021/08/30/javascript/WebStrom%20%E5%BC%80%E5%8F%91%20Vue%20%E9%A1%B9%E7%9B%AE%EF%BC%8C%E5%AE%89%E8%A3%85%20ESLint%20%E4%BB%A3%E7%A0%81%E9%A3%8E%E6%A0%BC%E6%A3%80%E6%9F%A5%E5%B7%A5%E5%85%B7/","content":"<p>WebStrom 开发 Vue 项目，安装 ESLint 代码风格检查工具</p>\n<span id=\"more\"></span>\n\n<h1 id=\"ESLint\"><a href=\"#ESLint\" class=\"headerlink\" title=\"ESLint\"></a>ESLint</h1><blockquote>\n<p>ESLint最初是由<a href=\"http://nczonline.net\">Nicholas C. Zakas</a> 于2013年6月创建的开源项目。它的目标是提供一个插件化的javascript代码检测工具。</p>\n</blockquote>\n<p>在一个 Vue 项目中要使用 ESLint 工具，首先需要安装 Vue，并创建一个简单的 Vue 项目，而后在 Vue 项目的基础上安装 ESLint 依赖，最后进行 ESLint 的相关配置。</p>\n<h2 id=\"创建-Vue-项目\"><a href=\"#创建-Vue-项目\" class=\"headerlink\" title=\"创建 Vue 项目\"></a>创建 Vue 项目</h2><p>1、使用 npm 安装 Vue3 的最新版本。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">npm install vue@next</span><br></pre></td></tr></table></figure>\n\n\n\n<p>2、安装最新版本的 Vue-cli 脚手架模板。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">npm install -g @vue/cli@next</span><br></pre></td></tr></table></figure>\n\n\n\n<p>3、使用 Vite 构建项目。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">npm init vite-app &lt;project-name&gt;</span><br><span class=\"line\">cd &lt;project-name&gt;</span><br><span class=\"line\">npm install</span><br><span class=\"line\">npm run dev</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"安装-ESLint\"><a href=\"#安装-ESLint\" class=\"headerlink\" title=\"安装 ESLint\"></a>安装 ESLint</h2><p>我们可以使用 npm 命令安装 ESLint，一共需要安装三个 ESLint 项目的依赖，本地安装和全局安装任选一个即可。</p>\n<ul>\n<li>本地安装</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">npm install eslint --save-dev</span><br><span class=\"line\">npm install eslint-plugin-vue --save-dev</span><br><span class=\"line\">npm install babel-eslint --save-dev</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>全局安装</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">npm install -g eslint</span><br><span class=\"line\">npm install -g eslint-plugin-vue</span><br><span class=\"line\">npm install -g babel-eslint</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"配置-WebStrom\"><a href=\"#配置-WebStrom\" class=\"headerlink\" title=\"配置 WebStrom\"></a>配置 WebStrom</h2><p>在 Vue 项目中安装完 ESLint 依赖，还需要对 WebStrom 进行配置。</p>\n<p>打开 File -&gt; Settings -&gt; Languages &amp; Frameworks -&gt; JavaScript -&gt; Code Quality Tools -&gt; ESLint</p>\n<p>界面如下：</p>\n<p><img src=\"/images/2023/02/01.png\" alt=\"img\"></p>\n<p>最后，点击界面右下角的 <code>Apply</code> 按钮，应用该配置即可。</p>\n<h2 id=\"添加-ESLint-配置文件\"><a href=\"#添加-ESLint-配置文件\" class=\"headerlink\" title=\"添加 ESLint 配置文件\"></a>添加 ESLint 配置文件</h2><p>在没有 ESLint 配置文件的情况下，会使用默认的代码风格配置进行检查，我们可以给项目增加 ESLint 的配置文件来对项目进行代码风格配置，变成自己适应的代码风格。</p>\n<ul>\n<li>在项目的顶级目录下新增 <code>.eslintrc.js</code> 和 <code>.eslintignore</code> 文件，其中 <code>.eslintrc.js</code> 文件是 ESLint 的代码风格配置文件，而 <code>.eslintignore</code> 文件，则是忽略 ESLint 代码风格检查的文件的名称或路径的配置文件。</li>\n</ul>\n<h3 id=\"eslintignore\"><a href=\"#eslintignore\" class=\"headerlink\" title=\".eslintignore\"></a>.eslintignore</h3><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><span class=\"line\">build<span class=\"comment\">/*.js</span></span><br><span class=\"line\"><span class=\"comment\">src/assets</span></span><br><span class=\"line\"><span class=\"comment\">public</span></span><br><span class=\"line\"><span class=\"comment\">dist</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"eslintrc-js\"><a href=\"#eslintrc-js\" class=\"headerlink\" title=\".eslintrc.js\"></a>.eslintrc.js</h3><figure class=\"highlight javascript\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  <span class=\"attr\">root</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">  <span class=\"attr\">parserOptions</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">parser</span>: <span class=\"string\">&#x27;babel-eslint&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">sourceType</span>: <span class=\"string\">&#x27;module&#x27;</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">env</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">browser</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    <span class=\"attr\">node</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    <span class=\"attr\">es6</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">extends</span>: [<span class=\"string\">&#x27;plugin:vue/recommended&#x27;</span>, <span class=\"string\">&#x27;eslint:recommended&#x27;</span>],</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// add your custom rules here</span></span><br><span class=\"line\">  <span class=\"comment\">// it is base on https://github.com/vuejs/eslint-config-vue</span></span><br><span class=\"line\">  <span class=\"attr\">rules</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;vue/max-attributes-per-line&#x27;</span>: [<span class=\"number\">2</span>, &#123;</span><br><span class=\"line\">      <span class=\"string\">&#x27;singleline&#x27;</span>: <span class=\"number\">10</span>,</span><br><span class=\"line\">      <span class=\"string\">&#x27;multiline&#x27;</span>: &#123;</span><br><span class=\"line\">        <span class=\"string\">&#x27;max&#x27;</span>: <span class=\"number\">5</span>,</span><br><span class=\"line\">        <span class=\"string\">&#x27;allowFirstLine&#x27;</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;],</span><br><span class=\"line\">    <span class=\"string\">&#x27;vue/singleline-html-element-content-newline&#x27;</span>: <span class=\"string\">&#x27;off&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;vue/multiline-html-element-content-newline&#x27;</span>: <span class=\"string\">&#x27;off&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;vue/name-property-casing&#x27;</span>: [<span class=\"string\">&#x27;error&#x27;</span>, <span class=\"string\">&#x27;PascalCase&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;vue/no-v-html&#x27;</span>: <span class=\"string\">&#x27;off&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;accessor-pairs&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;arrow-spacing&#x27;</span>: [<span class=\"number\">2</span>, &#123;</span><br><span class=\"line\">      <span class=\"string\">&#x27;before&#x27;</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">      <span class=\"string\">&#x27;after&#x27;</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;],</span><br><span class=\"line\">    <span class=\"string\">&#x27;block-spacing&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"string\">&#x27;always&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;brace-style&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"string\">&#x27;1tbs&#x27;</span>, &#123;</span><br><span class=\"line\">      <span class=\"string\">&#x27;allowSingleLine&#x27;</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;],</span><br><span class=\"line\">    <span class=\"string\">&#x27;camelcase&#x27;</span>: [<span class=\"number\">0</span>, &#123;</span><br><span class=\"line\">      <span class=\"string\">&#x27;properties&#x27;</span>: <span class=\"string\">&#x27;always&#x27;</span></span><br><span class=\"line\">    &#125;],</span><br><span class=\"line\">    <span class=\"string\">&#x27;comma-dangle&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"string\">&#x27;never&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;comma-spacing&#x27;</span>: [<span class=\"number\">2</span>, &#123;</span><br><span class=\"line\">      <span class=\"string\">&#x27;before&#x27;</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">      <span class=\"string\">&#x27;after&#x27;</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;],</span><br><span class=\"line\">    <span class=\"string\">&#x27;comma-style&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"string\">&#x27;last&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;constructor-super&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;curly&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"string\">&#x27;multi-line&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;dot-location&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"string\">&#x27;property&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;eol-last&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;eqeqeq&#x27;</span>: [<span class=\"string\">&#x27;error&#x27;</span>, <span class=\"string\">&#x27;always&#x27;</span>, &#123; <span class=\"string\">&#x27;null&#x27;</span>: <span class=\"string\">&#x27;ignore&#x27;</span> &#125;],</span><br><span class=\"line\">    <span class=\"string\">&#x27;generator-star-spacing&#x27;</span>: [<span class=\"number\">2</span>, &#123;</span><br><span class=\"line\">      <span class=\"string\">&#x27;before&#x27;</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">      <span class=\"string\">&#x27;after&#x27;</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;],</span><br><span class=\"line\">    <span class=\"string\">&#x27;handle-callback-err&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"string\">&#x27;^(err|error)$&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;indent&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"number\">2</span>, &#123;</span><br><span class=\"line\">      <span class=\"string\">&#x27;SwitchCase&#x27;</span>: <span class=\"number\">1</span></span><br><span class=\"line\">    &#125;],</span><br><span class=\"line\">    <span class=\"string\">&#x27;jsx-quotes&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"string\">&#x27;prefer-single&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;key-spacing&#x27;</span>: [<span class=\"number\">2</span>, &#123;</span><br><span class=\"line\">      <span class=\"string\">&#x27;beforeColon&#x27;</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">      <span class=\"string\">&#x27;afterColon&#x27;</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;],</span><br><span class=\"line\">    <span class=\"string\">&#x27;keyword-spacing&#x27;</span>: [<span class=\"number\">2</span>, &#123;</span><br><span class=\"line\">      <span class=\"string\">&#x27;before&#x27;</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">      <span class=\"string\">&#x27;after&#x27;</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;],</span><br><span class=\"line\">    <span class=\"string\">&#x27;new-cap&#x27;</span>: [<span class=\"number\">2</span>, &#123;</span><br><span class=\"line\">      <span class=\"string\">&#x27;newIsCap&#x27;</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">      <span class=\"string\">&#x27;capIsNew&#x27;</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">    &#125;],</span><br><span class=\"line\">    <span class=\"string\">&#x27;new-parens&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-array-constructor&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-caller&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-console&#x27;</span>: <span class=\"string\">&#x27;off&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-class-assign&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-cond-assign&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-const-assign&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-control-regex&#x27;</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-delete-var&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-dupe-args&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-dupe-class-members&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-dupe-keys&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-duplicate-case&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-empty-character-class&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-empty-pattern&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-eval&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-ex-assign&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-extend-native&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-extra-bind&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-extra-boolean-cast&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-extra-parens&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"string\">&#x27;functions&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-fallthrough&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-floating-decimal&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-func-assign&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-implied-eval&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-inner-declarations&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"string\">&#x27;functions&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-invalid-regexp&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-irregular-whitespace&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-iterator&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-label-var&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-labels&#x27;</span>: [<span class=\"number\">2</span>, &#123;</span><br><span class=\"line\">      <span class=\"string\">&#x27;allowLoop&#x27;</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">      <span class=\"string\">&#x27;allowSwitch&#x27;</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">    &#125;],</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-lone-blocks&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-mixed-spaces-and-tabs&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-multi-spaces&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-multi-str&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-multiple-empty-lines&#x27;</span>: [<span class=\"number\">2</span>, &#123;</span><br><span class=\"line\">      <span class=\"string\">&#x27;max&#x27;</span>: <span class=\"number\">1</span></span><br><span class=\"line\">    &#125;],</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-native-reassign&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-negated-in-lhs&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-new-object&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-new-require&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-new-symbol&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-new-wrappers&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-obj-calls&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-octal&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-octal-escape&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-path-concat&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-proto&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-redeclare&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-regex-spaces&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-return-assign&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"string\">&#x27;except-parens&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-self-assign&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-self-compare&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-sequences&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-shadow-restricted-names&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-spaced-func&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-sparse-arrays&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-this-before-super&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-throw-literal&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-trailing-spaces&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-undef&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-undef-init&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-unexpected-multiline&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-unmodified-loop-condition&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-unneeded-ternary&#x27;</span>: [<span class=\"number\">2</span>, &#123;</span><br><span class=\"line\">      <span class=\"string\">&#x27;defaultAssignment&#x27;</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">    &#125;],</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-unreachable&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-unsafe-finally&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-unused-vars&#x27;</span>: [<span class=\"number\">2</span>, &#123;</span><br><span class=\"line\">      <span class=\"string\">&#x27;vars&#x27;</span>: <span class=\"string\">&#x27;all&#x27;</span>,</span><br><span class=\"line\">      <span class=\"string\">&#x27;args&#x27;</span>: <span class=\"string\">&#x27;none&#x27;</span></span><br><span class=\"line\">    &#125;],</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-useless-call&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-useless-computed-key&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-useless-constructor&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-useless-escape&#x27;</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-whitespace-before-property&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-with&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;one-var&#x27;</span>: [<span class=\"number\">2</span>, &#123;</span><br><span class=\"line\">      <span class=\"string\">&#x27;initialized&#x27;</span>: <span class=\"string\">&#x27;never&#x27;</span></span><br><span class=\"line\">    &#125;],</span><br><span class=\"line\">    <span class=\"string\">&#x27;operator-linebreak&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"string\">&#x27;after&#x27;</span>, &#123;</span><br><span class=\"line\">      <span class=\"string\">&#x27;overrides&#x27;</span>: &#123;</span><br><span class=\"line\">        <span class=\"string\">&#x27;?&#x27;</span>: <span class=\"string\">&#x27;before&#x27;</span>,</span><br><span class=\"line\">        <span class=\"string\">&#x27;:&#x27;</span>: <span class=\"string\">&#x27;before&#x27;</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;],</span><br><span class=\"line\">    <span class=\"string\">&#x27;padded-blocks&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"string\">&#x27;never&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;quotes&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"string\">&#x27;single&#x27;</span>, &#123;</span><br><span class=\"line\">      <span class=\"string\">&#x27;avoidEscape&#x27;</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">      <span class=\"string\">&#x27;allowTemplateLiterals&#x27;</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;],</span><br><span class=\"line\">    <span class=\"string\">&#x27;semi&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"string\">&#x27;never&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;semi-spacing&#x27;</span>: [<span class=\"number\">2</span>, &#123;</span><br><span class=\"line\">      <span class=\"string\">&#x27;before&#x27;</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">      <span class=\"string\">&#x27;after&#x27;</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;],</span><br><span class=\"line\">    <span class=\"string\">&#x27;space-before-blocks&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"string\">&#x27;always&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;space-before-function-paren&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"string\">&#x27;never&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;space-in-parens&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"string\">&#x27;never&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;space-infix-ops&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;space-unary-ops&#x27;</span>: [<span class=\"number\">2</span>, &#123;</span><br><span class=\"line\">      <span class=\"string\">&#x27;words&#x27;</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">      <span class=\"string\">&#x27;nonwords&#x27;</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">    &#125;],</span><br><span class=\"line\">    <span class=\"string\">&#x27;spaced-comment&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"string\">&#x27;always&#x27;</span>, &#123;</span><br><span class=\"line\">      <span class=\"string\">&#x27;markers&#x27;</span>: [<span class=\"string\">&#x27;global&#x27;</span>, <span class=\"string\">&#x27;globals&#x27;</span>, <span class=\"string\">&#x27;eslint&#x27;</span>, <span class=\"string\">&#x27;eslint-disable&#x27;</span>, <span class=\"string\">&#x27;*package&#x27;</span>, <span class=\"string\">&#x27;!&#x27;</span>, <span class=\"string\">&#x27;,&#x27;</span>]</span><br><span class=\"line\">    &#125;],</span><br><span class=\"line\">    <span class=\"string\">&#x27;template-curly-spacing&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"string\">&#x27;never&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;use-isnan&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;valid-typeof&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;wrap-iife&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"string\">&#x27;any&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;yield-star-spacing&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"string\">&#x27;both&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;yoda&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"string\">&#x27;never&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;prefer-const&#x27;</span>: <span class=\"number\">2</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;no-debugger&#x27;</span>: process.<span class=\"property\">env</span>.<span class=\"property\">NODE_ENV</span> === <span class=\"string\">&#x27;production&#x27;</span> ? <span class=\"number\">2</span> : <span class=\"number\">0</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;object-curly-spacing&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"string\">&#x27;always&#x27;</span>, &#123;</span><br><span class=\"line\">      <span class=\"attr\">objectsInObjects</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">    &#125;],</span><br><span class=\"line\">    <span class=\"string\">&#x27;array-bracket-spacing&#x27;</span>: [<span class=\"number\">2</span>, <span class=\"string\">&#x27;never&#x27;</span>]</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"格式化代码快捷键\"><a href=\"#格式化代码快捷键\" class=\"headerlink\" title=\"格式化代码快捷键\"></a>格式化代码快捷键</h2><p>在配置完 ESLint 代码风格检查工具之后，我们可以直接格式化代码，使得我们的前端代码自动格式化为 ESLint 的所配置的代码风格。</p>\n<h3 id=\"右键格式化\"><a href=\"#右键格式化\" class=\"headerlink\" title=\"右键格式化\"></a>右键格式化</h3><p>在需要格式化的文件中点击鼠标右键，可以看到右键菜单中有一个 <code>Fix ESLint Problems</code> 的选项，点击该选项，即可格式化该文件的全部代码。</p>\n<p><img src=\"/images/2023/02/02.png\" alt=\"img\"></p>\n<h3 id=\"快捷键格式化\"><a href=\"#快捷键格式化\" class=\"headerlink\" title=\"快捷键格式化\"></a>快捷键格式化</h3><p>右键菜单的方法毕竟还是比较繁琐的，我们还可以通过配置快捷键的方式，直接使用快捷键对文件代码进行格式化操作。</p>\n<p>打开 File -&gt; Settings -&gt; Keymap</p>\n<p><img src=\"/images/2023/02/03.png\" alt=\"img\"></p>\n","categories":["JavaScript"],"tags":["JavaScript","Vue","WebStrom"]},{"title":"vue+SpringBoot实现文件上传","url":"/2020/08/08/javascript/vue+SpringBoot%E5%AE%9E%E7%8E%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/","content":"<blockquote>\n<p>今天我们来学习使用Vue+SpringBoot来实现文件上传，其实今天的重点在于前端使用Vue获取文件，并传输到后台，至于后台上传文件则是通用的代码。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h2 id=\"Vue获取文件\"><a href=\"#Vue获取文件\" class=\"headerlink\" title=\"Vue获取文件\"></a>Vue获取文件</h2><ul>\n<li><p>upload.html</p>\n<p><strong>前端我们使用了Vue.js，其中使用axios来发送异步请求。</strong></p>\n</li>\n</ul>\n<figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;app&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;file&quot;</span> @<span class=\"attr\">change</span>=<span class=\"string\">&quot;getFile($event)&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;button&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;上传&quot;</span> @<span class=\"attr\">click</span>=<span class=\"string\">&quot;upload()&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">const</span> app = <span class=\"keyword\">new</span> <span class=\"title class_\">Vue</span>(&#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"attr\">el</span>: <span class=\"string\">&quot;#app&quot;</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"attr\">data</span>: &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">formData</span>: <span class=\"keyword\">new</span> <span class=\"title class_\">FormData</span>(),</span></span><br><span class=\"line\"><span class=\"language-javascript\">        &#125;,</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"attr\">methods</span>: &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"title function_\">upload</span>(<span class=\"params\"></span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                axios.<span class=\"title function_\">post</span>(<span class=\"string\">&quot;/upload/image&quot;</span>,<span class=\"variable language_\">this</span>.<span class=\"property\">formData</span>).<span class=\"title function_\">then</span>(<span class=\"function\"><span class=\"params\">resp</span> =&gt;</span> &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"keyword\">if</span> (resp.<span class=\"property\">status</span> == <span class=\"number\">200</span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"title function_\">alert</span>(<span class=\"string\">&quot;success&quot;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                &#125;);</span></span><br><span class=\"line\"><span class=\"language-javascript\">            &#125;,</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"title function_\">getFile</span>(<span class=\"params\">event</span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">let</span> file = event.<span class=\"property\">target</span>.<span class=\"property\">files</span>[<span class=\"number\">0</span>];</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">let</span> fileName = file.<span class=\"property\">name</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">let</span> index = fileName.<span class=\"title function_\">lastIndexOf</span>(<span class=\"string\">&quot;.&quot;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"keyword\">if</span> (index != -<span class=\"number\">1</span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"keyword\">let</span> suffix = fileName.<span class=\"title function_\">substr</span>(index + <span class=\"number\">1</span>).<span class=\"title function_\">toLowerCase</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    <span class=\"keyword\">if</span> (suffix == <span class=\"string\">&#x27;png&#x27;</span> || suffix == <span class=\"string\">&#x27;jpg&#x27;</span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                        <span class=\"variable language_\">this</span>.<span class=\"property\">formData</span>.<span class=\"title function_\">append</span>(<span class=\"string\">&quot;file&quot;</span>,file);</span></span><br><span class=\"line\"><span class=\"language-javascript\">                    &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    &#125;)</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"后台项目依赖\"><a href=\"#后台项目依赖\" class=\"headerlink\" title=\"后台项目依赖\"></a>后台项目依赖</h2><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--SpringBoot的启动器--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.0.4.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"comment\">&lt;!--SpringMVC的启动器--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--用来处理文件上传的一个通用工具类--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>commons-io<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>commons-io<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.6<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--lombox插件--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.projectlombok<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>lombok<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"文件上传相关配置\"><a href=\"#文件上传相关配置\" class=\"headerlink\" title=\"文件上传相关配置\"></a>文件上传相关配置</h2><ul>\n<li><p>application.yml</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">file:</span></span><br><span class=\"line\">  <span class=\"attr\">upload:</span></span><br><span class=\"line\">    <span class=\"attr\">path:</span> <span class=\"string\">G:\\temp\\images\\</span>   <span class=\"comment\">#文件上传目标路径</span></span><br><span class=\"line\">    <span class=\"attr\">allowTypes:</span>             <span class=\"comment\">#文件上传允许的类型</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">image/jpeg</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">image/png</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">image/jpg</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">image/bmp</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>UploadProperties.java</p>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 图片上传的Java配置类，通过SpringBoot自动读取配置文件注入</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"meta\">@ConfigurationProperties(prefix = &quot;file.upload&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UploadProperties</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">// 图片上传路径</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String path;</span><br><span class=\"line\">    <span class=\"comment\">// 文件上传允许类型</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> List&lt;String&gt; allowTypes;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 图片上传的Java配置类</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UploadConfig</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> MultipartConfigElement <span class=\"title function_\">multipartConfigElement</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">MultipartConfigFactory</span> <span class=\"variable\">factory</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MultipartConfigFactory</span>();</span><br><span class=\"line\">        <span class=\"comment\">//  单个数据大小</span></span><br><span class=\"line\">        factory.setMaxFileSize(<span class=\"string\">&quot;10240KB&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">/// 总上传数据大小</span></span><br><span class=\"line\">        factory.setMaxRequestSize(<span class=\"string\">&quot;102400KB&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> factory.createMultipartConfig();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"文件上传后台代码\"><a href=\"#文件上传后台代码\" class=\"headerlink\" title=\"文件上传后台代码\"></a>文件上传后台代码</h2><ul>\n<li>controller层<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;upload&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UploadController</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> UploadService uploadService;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping(&quot;image&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> ResponseEntity&lt;String&gt; <span class=\"title function_\">upload</span><span class=\"params\">(<span class=\"meta\">@RequestParam(&quot;file&quot;)</span> MultipartFile file)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ResponseEntity.ok(uploadService.uploadImage(file));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n<li>service层接口</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">UploadService</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 上传图片</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> file</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    String <span class=\"title function_\">uploadImage</span><span class=\"params\">(MultipartFile file)</span> <span class=\"keyword\">throws</span> Exception;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>service层实现</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Service</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UploadServiceImpl</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">UploadService</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> UploadProperties uploadProperties;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">uploadImage</span><span class=\"params\">(MultipartFile file)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!uploadProperties.getAllowTypes().contains(file.getContentType()))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IOException</span>(<span class=\"string\">&quot;文件上传类型错误！&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">fileName</span> <span class=\"operator\">=</span> UploadUtils.generateFileName(file.getOriginalFilename());</span><br><span class=\"line\">        file.transferTo(<span class=\"keyword\">new</span> <span class=\"title class_\">File</span>(uploadProperties.getPath()+fileName));</span><br><span class=\"line\">        <span class=\"keyword\">return</span> fileName;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"文件上传工具类\"><a href=\"#文件上传工具类\" class=\"headerlink\" title=\"文件上传工具类\"></a>文件上传工具类</h2><ul>\n<li>IDUtils <figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">IDUtils</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 唯一ID生成器，可以生成唯一ID</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 唯一ID</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title function_\">generateUniqueId</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> UUID.randomUUID().toString() + System.currentTimeMillis();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n<li>UploadUtils <figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UploadUtils</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 文件名称替换工具，将文件名称替换为随机名称</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> oldName 上传文件名字</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 生成的新文件名</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title function_\">generateFileName</span><span class=\"params\">(String oldName)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">suffix</span> <span class=\"operator\">=</span> oldName.substring(oldName.lastIndexOf(<span class=\"string\">&quot;.&quot;</span>));</span><br><span class=\"line\">        <span class=\"keyword\">return</span> IDUtils.generateUniqueId() + suffix;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n","categories":["JavaScript"],"tags":["JavaScript","Vue","SpringBoot"]},{"title":"推荐几种简洁美观的博客背景效果","url":"/2023/03/14/javascript/%E6%8E%A8%E8%8D%90%E5%87%A0%E7%A7%8D%E7%AE%80%E6%B4%81%E7%BE%8E%E8%A7%82%E7%9A%84%E5%8D%9A%E5%AE%A2%E8%83%8C%E6%99%AF%E6%95%88%E6%9E%9C/","content":"<p>在很多的博客网页中，都有一些非常简洁美观的博客动画背景，比如 <code>Canvas-Ribbon</code>、 <code>three-waves</code>、 <code>canvas-nest</code>、 <code>canvas_lines</code>、 <code>canvas_sphere</code> 等等。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"背景彩带效果：Canvas-Ribbon\"><a href=\"#背景彩带效果：Canvas-Ribbon\" class=\"headerlink\" title=\"背景彩带效果：Canvas-Ribbon\"></a>背景彩带效果：Canvas-Ribbon</h2><p>这种背景效果是一条颜色鲜艳的彩色丝带，随着鼠标点击可以自动变换舞动。</p>\n<p>在 <code>&lt;script&gt;</code> 标签上可以通过几个参数调整该彩带效果：</p>\n<ul>\n<li>size: 彩带宽度</li>\n<li>alpha: 彩带透明效果</li>\n<li>zIndex: 彩带层次</li>\n</ul>\n<p><img src=\"/images/2023/03/image-20230314230558611.png\" alt=\"image-20230314230558611\"></p>\n<figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;ribbon&quot;</span> <span class=\"attr\">size</span>=<span class=\"string\">&quot;150&quot;</span> <span class=\"attr\">alpha</span>=<span class=\"string\">&#x27;0.9&#x27;</span> <span class=\"attr\">zIndex</span>=<span class=\"string\">&quot;-2&quot;</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;https://cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-ribbon@1/canvas-ribbon.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"波浪效果：three-waves\"><a href=\"#波浪效果：three-waves\" class=\"headerlink\" title=\"波浪效果：three-waves\"></a>波浪效果：three-waves</h2><p>由小球组成的动态波浪效果，波浪起伏方向会随着鼠标的移动而改变方向。</p>\n<p><img src=\"/images/2023/03/image-20230314225522914.png\" alt=\"image-20230314225522914\"></p>\n<figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;https://cdnjs.cloudflare.com/ajax/libs/three.js/87/three.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;https://cdn.jsdelivr.net/gh/theme-next/theme-next-three@latest/three-waves.min.js&quot;</span> &gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"蜂窝巢效果：canvas-nest\"><a href=\"#蜂窝巢效果：canvas-nest\" class=\"headerlink\" title=\"蜂窝巢效果：canvas-nest\"></a>蜂窝巢效果：canvas-nest</h2><p>由线条组成的动态效果，线条会随着鼠标的移动和停止而不断汇聚，形成类似蜂窝巢一样的结构。</p>\n<p><img src=\"/images/2023/03/image-20230314224230121.png\" alt=\"image-20230314224230121\"></p>\n<figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;https://cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"随机点、画线效果：canvas-lines\"><a href=\"#随机点、画线效果：canvas-lines\" class=\"headerlink\" title=\"随机点、画线效果：canvas_lines\"></a>随机点、画线效果：canvas_lines</h2><p>由线条和小球组成的动态效果，线条和小球相互连接，会随着鼠标的移动而改变方向。</p>\n<p><img src=\"/images/2023/03/image-20230314225723843.png\" alt=\"image-20230314225723843\"></p>\n<figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;https://cdnjs.cloudflare.com/ajax/libs/three.js/87/three.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;https://cdn.jsdelivr.net/gh/theme-next/theme-next-three@latest/canvas_lines.min.js&quot;</span> &gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"球状光线效果：canvas-sphere\"><a href=\"#球状光线效果：canvas-sphere\" class=\"headerlink\" title=\"球状光线效果：canvas_sphere\"></a>球状光线效果：canvas_sphere</h2><p>由线条模拟光球的动态效果，光球会随着鼠标的移动而旋转改变方向。</p>\n<p><img src=\"/images/2023/03/image-20230314225755469.png\" alt=\"image-20230314225755469\"></p>\n<figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;https://cdnjs.cloudflare.com/ajax/libs/three.js/87/three.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;https://cdn.jsdelivr.net/gh/theme-next/theme-next-three@latest/canvas_sphere.min.js&quot;</span> &gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"注意事项\"><a href=\"#注意事项\" class=\"headerlink\" title=\"注意事项\"></a>注意事项</h2><blockquote>\n<p>以上的内容是背景效果图和效果图对应需要的 <code>js</code> 文件，在引入这些 <code>js</code> 文件的时候，需要将这些 <code>&lt;script&gt;</code> 标签放置在 <code>&lt;body&gt;</code> 标签之后。</p>\n</blockquote>\n","categories":["JavaScript"],"tags":["JavaScript"]},{"title":"Apache lang3 StringUtils工具类常用方法","url":"/2020/08/26/java/Apache%20lang3%20StringUtils%E5%B7%A5%E5%85%B7%E7%B1%BB%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95/","content":"<blockquote>\n<p>在工作中，apache lang3是一个非常常用的工具包，其中包含了很多通用的方法，能够在工作中提升我们的效率，简化我们的代码开发。<br>其中StringUtils是apache lang3对字符串方法封装的一个常用工具类，今天我们就来学习一下这个字符串工具类。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h1 id=\"引入依赖\"><a href=\"#引入依赖\" class=\"headerlink\" title=\"引入依赖\"></a>引入依赖</h1><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.commons<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>commons-lang3<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.7<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"StringUtils常用方法\"><a href=\"#StringUtils常用方法\" class=\"headerlink\" title=\"StringUtils常用方法\"></a>StringUtils常用方法</h1><h2 id=\"isBlank\"><a href=\"#isBlank\" class=\"headerlink\" title=\"isBlank\"></a>isBlank</h2><ul>\n<li><p><strong>字符串非空判断，只要传入的字符串不为<code>null</code>并且长度不为0，则返回<code>false</code>。</strong></p>\n</li>\n<li><p><strong>注意：如果字符串是一些特殊字符，也会被判定为空，返回<code>true</code>。</strong></p>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str1</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">System.out.println(StringUtils.isBlank(str1));  <span class=\"comment\">//true</span></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str2</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.isBlank(str2));  <span class=\"comment\">//true</span></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str3</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.isBlank(str3));  <span class=\"comment\">//true</span></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str4</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;\\u001C&quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.isBlank(str4));  <span class=\"comment\">//true</span></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str5</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;字符串&quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.isBlank(str5));  <span class=\"comment\">//false</span></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str6</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;  abc  &quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.isBlank(str6));  <span class=\"comment\">//false</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"isNotBlank\"><a href=\"#isNotBlank\" class=\"headerlink\" title=\"isNotBlank\"></a>isNotBlank</h2><ul>\n<li><strong>返回结果正好是isBlank的非值，因为该方法的底层实现其实就是<code>return !isBlank(cs);</code></strong></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str1</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">System.out.println(StringUtils.isNotBlank(str1));  <span class=\"comment\">//false</span></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str2</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.isNotBlank(str2));  <span class=\"comment\">//false</span></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str3</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.isNotBlank(str3));  <span class=\"comment\">//false</span></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str4</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;\\u001C&quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.isNotBlank(str4));  <span class=\"comment\">//false</span></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str5</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;字符串&quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.isNotBlank(str5));  <span class=\"comment\">//true</span></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str6</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;  abc  &quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.isNotBlank(str6));  <span class=\"comment\">//true</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"isEmpty\"><a href=\"#isEmpty\" class=\"headerlink\" title=\"isEmpty\"></a>isEmpty</h2><ul>\n<li><strong>isEmpty的作用和isBlank类似，但是在效果上有所区别，因为isEmpty不会判断特殊字符，如果存在特殊字符，会将其当成普通字符串处理。</strong></li>\n<li><strong>isEmpty的判断逻辑为，只要字符串不为<code>null</code>，并且长度不为0，则说明非空，返回<code>false</code></strong></li>\n<li><strong>建议在工作开发中使用isBlank或者isNotBlank方法来判断字符串是否非空。</strong><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str1</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">System.out.println(StringUtils.isEmpty(str1));  <span class=\"comment\">//true</span></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str2</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.isEmpty(str2));  <span class=\"comment\">//true</span></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str3</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.isEmpty(str3));  <span class=\"comment\">//false</span></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str4</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;\\u001C&quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.isEmpty(str4));  <span class=\"comment\">//false</span></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str5</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;字符串&quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.isEmpty(str5));  <span class=\"comment\">//false</span></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str6</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;  abc  &quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.isEmpty(str6));  <span class=\"comment\">//false</span></span><br></pre></td></tr></table></figure>\n\n\n</li>\n</ul>\n<h2 id=\"isNotEmpty\"><a href=\"#isNotEmpty\" class=\"headerlink\" title=\"isNotEmpty\"></a>isNotEmpty</h2><ul>\n<li><strong>返回结果正好是isEmpty的非值，因为该方法的底层实现其实就是<code>return !isEmpty(cs);</code></strong></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str1</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">System.out.println(StringUtils.isNotEmpty(str1));  <span class=\"comment\">//false</span></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str2</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.isNotEmpty(str2));  <span class=\"comment\">//false</span></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str3</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;\\n&quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.isNotEmpty(str3));  <span class=\"comment\">//true</span></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str4</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;\\u001C&quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.isNotEmpty(str4));  <span class=\"comment\">//true</span></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str5</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;字符串&quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.isNotEmpty(str5));  <span class=\"comment\">//true</span></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str6</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;  abc  &quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.isNotEmpty(str6));  <span class=\"comment\">//true</span></span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"join\"><a href=\"#join\" class=\"headerlink\" title=\"join\"></a>join</h2><ul>\n<li><strong>join是StringUtils提供的一个字符串拼接的方法。</strong></li>\n<li><strong>该方法的实现是以StringBuilder的方式来进行字符串拼接的，线程不安全，多线程环境下不建议使用。</strong></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str1</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;abc&quot;</span>;</span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str2</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;def&quot;</span>;</span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str3</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str4</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str5</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;123&quot;</span>;</span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">join</span> <span class=\"operator\">=</span> StringUtils.join(str1, str2, str3,str4,str5);</span><br><span class=\"line\">System.out.println(join);   <span class=\"comment\">//abcdef123</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"equals\"><a href=\"#equals\" class=\"headerlink\" title=\"equals\"></a>equals</h2><ul>\n<li><strong><code>StringUtils.equals()</code>方法是字符串<code>String.equals()</code>方法的一个增强，在StringUtils中添加了字符串为<code>null</code>的判断逻辑，即使使用<code>null</code>进行比较，也不会出现空指针异常。</strong></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str1</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;abc&quot;</span>;</span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str2</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;def&quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.equals(str1, str2)); <span class=\"comment\">//false</span></span><br><span class=\"line\">str1 = <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">str2 = <span class=\"string\">&quot;def&quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.equals(str1, str2)); <span class=\"comment\">//false</span></span><br><span class=\"line\">str1 = <span class=\"literal\">null</span>;</span><br><span class=\"line\">str2 = <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.equals(str1, str2)); <span class=\"comment\">//false</span></span><br><span class=\"line\">str1 = <span class=\"literal\">null</span>;</span><br><span class=\"line\">str2 = <span class=\"literal\">null</span>;</span><br><span class=\"line\">System.out.println(StringUtils.equals(str1, str2)); <span class=\"comment\">//true</span></span><br><span class=\"line\">str1 = <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">str2 = <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.equals(str1, str2)); <span class=\"comment\">//true</span></span><br><span class=\"line\">str1 = <span class=\"string\">&quot;123&quot;</span>;</span><br><span class=\"line\">str2 = <span class=\"string\">&quot;123&quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.equals(str1, str2)); <span class=\"comment\">//true</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"equalsIgnoreCase\"><a href=\"#equalsIgnoreCase\" class=\"headerlink\" title=\"equalsIgnoreCase\"></a>equalsIgnoreCase</h2><ul>\n<li><strong>忽略大小写比较字符串是否相同</strong></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str1</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;abc&quot;</span>;</span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str2</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;ABC&quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.equalsIgnoreCase(str1, str2)); <span class=\"comment\">//true</span></span><br><span class=\"line\">str1 = <span class=\"string\">&quot;abc&quot;</span>;</span><br><span class=\"line\">str2 = <span class=\"string\">&quot;ABc&quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.equalsIgnoreCase(str1, str2)); <span class=\"comment\">//true</span></span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"split\"><a href=\"#split\" class=\"headerlink\" title=\"split\"></a>split</h2><ul>\n<li><strong>StringUtils中的split同样是字符串split方法的一个增强。</strong></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str1</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;abc 123\\nDEF&quot;</span>;</span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str2</span> <span class=\"operator\">=</span> <span class=\"string\">&quot; &quot;</span>;</span><br><span class=\"line\">String[] split1 = StringUtils.split(str1);</span><br><span class=\"line\"><span class=\"keyword\">for</span> (String str : split1) &#123;</span><br><span class=\"line\">    System.out.println(str);</span><br><span class=\"line\">&#125;   <span class=\"comment\">// abc  123   DEF</span></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str3</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;abc,123,DEF$456&quot;</span>;</span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str4</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;,&quot;</span>;</span><br><span class=\"line\">String[] split2 = StringUtils.split(str3, str4);</span><br><span class=\"line\"><span class=\"keyword\">for</span> (String str : split2) &#123;</span><br><span class=\"line\">    System.out.println(str);</span><br><span class=\"line\">&#125;   <span class=\"comment\">// abc  123   DEF$456</span></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str5</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str6</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">String[] split3 = StringUtils.split(str5, str6);</span><br><span class=\"line\">System.out.println(split3); <span class=\"comment\">// null</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"trim\"><a href=\"#trim\" class=\"headerlink\" title=\"trim\"></a>trim</h2><ul>\n<li><strong>用于除去字符串两边的空格，如果为<code>null</code>，则返回<code>null</code>。</strong></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str1</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;  abcdef  &quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.trim(str1)); <span class=\"comment\">//abcdef</span></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str2</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;abcdef  &quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.trim(str2)); <span class=\"comment\">//abcdef</span></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str3</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;  abcdef&quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.trim(str3)); <span class=\"comment\">//abcdef</span></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str4</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;&quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.trim(str4)); <span class=\"comment\">//      [空字符串]</span></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str5</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">System.out.println(StringUtils.trim(str5)); <span class=\"comment\">//null</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"contains\"><a href=\"#contains\" class=\"headerlink\" title=\"contains\"></a>contains</h2><ul>\n<li><strong>用于判断字符串中是否包含另外的字符串，如果有值为<code>null</code>，则返回<code>false</code>。</strong></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str1</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;abcdef123ghijk&quot;</span>;</span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">str2</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;23&quot;</span>;</span><br><span class=\"line\">System.out.println(StringUtils.contains(str1, str2)); <span class=\"comment\">//true</span></span><br><span class=\"line\">str1 = <span class=\"literal\">null</span>;</span><br><span class=\"line\">str2 = <span class=\"literal\">null</span>;</span><br><span class=\"line\">System.out.println(StringUtils.contains(str1, str2)); <span class=\"comment\">//false</span></span><br><span class=\"line\">str1 = <span class=\"string\">&quot;abcdef&quot;</span>;</span><br><span class=\"line\">str2 = <span class=\"literal\">null</span>;</span><br><span class=\"line\">System.out.println(StringUtils.contains(str1, str2)); <span class=\"comment\">//false</span></span><br></pre></td></tr></table></figure>\n\n\n<blockquote>\n<p>Apache lang3 StringUtils中封装的字符串方法较为常用的就是上面的这些方法，除此之外，还有其他一些方法，以后如果有时间也会向各位同学一一介绍。</p>\n</blockquote>\n","categories":["Java"],"tags":["Java"]},{"title":"IDEA Java项目JDK无效","url":"/2020/08/10/java/IDEA%20Java%E9%A1%B9%E7%9B%AEJDK%E6%97%A0%E6%95%88/","content":"<p>今天在创建一个新的Java项目的时候，发现项目的JDK失效了，导致main方法的String类爆红，而且其他JDK的类也无法使用。</p>\n<span id=\"more\"></span>\n<p>一开始我以为是项目资源的Project SDK没有设置，但是我打开File-&gt;Project Structure的时候，发现SDK已经设置了。<br><img src=\"/images/2020/08/20200810221241367.png\" alt=\"在这里插入图片描述\"></p>\n<blockquote>\n<p>最终我发现，该问题其实是因为设置了忽略文件导致的。</p>\n</blockquote>\n<p><img src=\"/images/2020/08/20200810221422533.png\" alt=\"在这里插入图片描述\"><br>由于我在Ignore Files and Folders中设置了<code>*.classes</code>,导致项目无法依赖JDK下的包，所以才导致了这个问题，我们把Ignore Files and Folders中的<code>*.classes</code>删除即可解决该问题。</p>\n","categories":["Java"],"tags":["Java","IDEA"]},{"title":"IDEA使用Spring Initializr创建Spring项目","url":"/2020/03/31/java/IDEA%E4%BD%BF%E7%94%A8Spring%20Initializr%E5%88%9B%E5%BB%BASpring%E9%A1%B9%E7%9B%AE/","content":"<p>今天我们来学习使用 IDEA 自带的 Spring Initializr 项目来创建一个全新的 Spring 项目。</p>\n<span id=\"more\"></span>\n<h2 id=\"1、创建一个Module项目\"><a href=\"#1、创建一个Module项目\" class=\"headerlink\" title=\"1、创建一个Module项目\"></a>1、创建一个Module项目</h2><p><img src=\"/images/2020/03/20200331091443775.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"2、选择Spring-Initializr创建项目。\"><a href=\"#2、选择Spring-Initializr创建项目。\" class=\"headerlink\" title=\"2、选择Spring_Initializr创建项目。\"></a>2、选择Spring_Initializr创建项目。</h2><p><img src=\"/images/2020/03/20200331091705922.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"3、设置项目的基本信息\"><a href=\"#3、设置项目的基本信息\" class=\"headerlink\" title=\"3、设置项目的基本信息\"></a>3、设置项目的基本信息</h2><p><img src=\"/images/2020/03/20200331091740988.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"4、选择项目所需的依赖\"><a href=\"#4、选择项目所需的依赖\" class=\"headerlink\" title=\"4、选择项目所需的依赖\"></a>4、选择项目所需的依赖</h2><p><img src=\"/images/2020/03/20200331091808586.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"5、创建SpringBoot项目\"><a href=\"#5、创建SpringBoot项目\" class=\"headerlink\" title=\"5、创建SpringBoot项目\"></a>5、创建SpringBoot项目</h2><p><img src=\"/images/2020/03/20200331091826459.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"6、项目结构图\"><a href=\"#6、项目结构图\" class=\"headerlink\" title=\"6、项目结构图\"></a>6、项目结构图</h2><p><img src=\"/images/2020/03/20200331092101572.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"7、项目pom-xml文件\"><a href=\"#7、项目pom-xml文件\" class=\"headerlink\" title=\"7、项目pom.xml文件\"></a>7、项目pom.xml文件</h2><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=<span class=\"string\">&quot;1.0&quot;</span> encoding=<span class=\"string\">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">project</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class=\"attr\">xmlns:xsi</span>=<span class=\"string\">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">xsi:schemaLocation</span>=<span class=\"string\">&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">modelVersion</span>&gt;</span>4.0.0<span class=\"tag\">&lt;/<span class=\"name\">modelVersion</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.2.6.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">relativePath</span>/&gt;</span> <span class=\"comment\">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring_initializr_demo<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>0.0.1-SNAPSHOT<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>spring_initializr_demo<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">description</span>&gt;</span>Demo project for Spring Boot<span class=\"tag\">&lt;/<span class=\"name\">description</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">java.version</span>&gt;</span>1.8<span class=\"tag\">&lt;/<span class=\"name\">java.version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.mybatis.spring.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.1.2<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-test<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>test<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">exclusions</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">exclusion</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.junit.vintage<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>junit-vintage-engine<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">exclusion</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">exclusions</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">project</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n","categories":["Java"],"tags":["Java","IDEA","Spring"]},{"title":"JDK8新特性之Optional类","url":"/2021/04/06/java/JDK8%E6%96%B0%E7%89%B9%E6%80%A7%E4%B9%8BOptional%E7%B1%BB/","content":"<h1 id=\"什么是-Optional-类？\"><a href=\"#什么是-Optional-类？\" class=\"headerlink\" title=\"什么是 Optional 类？\"></a>什么是 Optional 类？</h1><p>Optional 是 JDK8 新增加的一个工具类，位于 <code>java.util</code> 包下。</p>\n<p>Optional 类是一个可以为 <code>null</code> 的容器对象。如果值存在则 isPresent() 方法会返回 <code>true</code>，调用 get() 方法会返回该对象。</p>\n<p>Optional 是个容器：它可以保存类型 <code>T</code> 的值，或者仅仅保存null。Optional提供很多有用的方法，这样我们就不用显式进行空值检测。</p>\n<p>Optional 类的引入很好的解决空指针异常（微笑）。</p>\n<span id=\"more\"></span>\n\n<h1 id=\"Optional-类的方法及使用\"><a href=\"#Optional-类的方法及使用\" class=\"headerlink\" title=\"Optional 类的方法及使用\"></a>Optional 类的方法及使用</h1><p>Optional 类中提供了一些常用的方法，同时结合 JDK8 的 Lambda 新特性使用，能够更加方便。</p>\n<h2 id=\"私有构造\"><a href=\"#私有构造\" class=\"headerlink\" title=\"私有构造\"></a>私有构造</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"title function_\">Optional</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.value = <span class=\"literal\">null</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>在 Optional 类中，构造函数被私有访问修饰符修饰，也就意味着我们无法使用 <code>new</code> 关键字来创建对象。</p>\n<h2 id=\"empty\"><a href=\"#empty\" class=\"headerlink\" title=\"empty()\"></a>empty()</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">Optional&lt;User&gt; empty = Optional.empty();</span><br><span class=\"line\">System.out.println(empty != <span class=\"literal\">null</span>);</span><br><span class=\"line\">System.out.println(empty);</span><br></pre></td></tr></table></figure>\n\n<p>使用 <code>Optional</code> 类的静态方法 <code>empty()</code> ，可以创建一个容器内值为 <code>null</code> 的 <code>Optional</code> 对象。使用该方法，得到的 <code>Optional</code> 类是存在的，只不过该类中的值为 <code>null</code>。</p>\n<p>源码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Optional&lt;?&gt; EMPTY = <span class=\"keyword\">new</span> <span class=\"title class_\">Optional</span>&lt;&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span>&lt;T&gt; Optional&lt;T&gt; <span class=\"title function_\">empty</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class=\"line\">    Optional&lt;T&gt; t = (Optional&lt;T&gt;) EMPTY;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> t;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"of-T-value\"><a href=\"#of-T-value\" class=\"headerlink\" title=\"of(T value)\"></a>of(T value)</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>();</span><br><span class=\"line\">Optional&lt;User&gt; optionalUser1 = Optional.of(user1);</span><br><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user2</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">Optional&lt;User&gt; optionalUser2 = Optional.of(user2);</span><br></pre></td></tr></table></figure>\n\n<p><code>of(T value)</code> 方法是 <code>Optional</code> 类创建容器的主要方法，使用该方法，可以创建一个泛型为 <code>T</code> 的 <code>Optional</code> 容器，并向容器内注入一个值对象。</p>\n<p>需要注意的是，使用 <code>of(T value)</code> 方法，参数不可以为 <code>null</code>，否则程序会报空指针异常。</p>\n<p>源码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> &lt;T&gt; Optional&lt;T&gt; <span class=\"title function_\">of</span><span class=\"params\">(T value)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Optional</span>&lt;&gt;(value);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"title function_\">Optional</span><span class=\"params\">(T value)</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.value = Objects.requireNonNull(value);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> &lt;T&gt; T <span class=\"title function_\">requireNonNull</span><span class=\"params\">(T obj)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (obj == <span class=\"literal\">null</span>)</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">NullPointerException</span>();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> obj;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ofNullable-T-value\"><a href=\"#ofNullable-T-value\" class=\"headerlink\" title=\"ofNullable(T value)\"></a>ofNullable(T value)</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>();</span><br><span class=\"line\">Optional&lt;User&gt; optionalUser1 = Optional.ofNullable(user1);</span><br><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user2</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">Optional&lt;User&gt; optionalUser2 = Optional.ofNullable(user2);</span><br></pre></td></tr></table></figure>\n\n<p><code>ofNullable(T value)</code> 方法和 <code>of(T value)</code> 方法唯一的区别在于，参数可以为 <code>null</code>，如果参数为 <code>null</code>，会调用 <code>empty()</code> 方法返回一个空的 <code>Optional</code> 对象。</p>\n<p>源码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> &lt;T&gt; Optional&lt;T&gt; <span class=\"title function_\">ofNullable</span><span class=\"params\">(T value)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> value == <span class=\"literal\">null</span> ? empty() : of(value);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"get\"><a href=\"#get\" class=\"headerlink\" title=\"get()\"></a>get()</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>();</span><br><span class=\"line\">Optional&lt;User&gt; optionalUser1 = Optional.ofNullable(user1);</span><br><span class=\"line\">optionalUser1.get();</span><br><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user2</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">Optional&lt;User&gt; optionalUser2 = Optional.ofNullable(user2);</span><br><span class=\"line\">optionalUser2.get();</span><br></pre></td></tr></table></figure>\n<p><code>get()</code> 方法，用于返回 <code>Optional</code> 容器中的值对象。但是如果 <code>Optional</code> 容器为一个空容器，即内部的值为 <code>null</code>，则会抛出 <code>NoSuchElementException</code> 异常。</p>\n<p>源码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> T <span class=\"title function_\">get</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (value == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">NoSuchElementException</span>(<span class=\"string\">&quot;No value present&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> value;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"isPresent\"><a href=\"#isPresent\" class=\"headerlink\" title=\"isPresent()\"></a>isPresent()</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>();</span><br><span class=\"line\">Optional&lt;User&gt; optionalUser1 = Optional.ofNullable(user1);</span><br><span class=\"line\">System.out.println(optionalUser1.isPresent());</span><br><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user2</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">Optional&lt;User&gt; optionalUser2 = Optional.ofNullable(user2);</span><br><span class=\"line\">System.out.println(optionalUser2.isPresent());</span><br></pre></td></tr></table></figure>\n<p><code>isPresent()</code> 方法，用于判断 <code>Optional</code> 容器内是否有值，有则返回 <code>true</code>，否则返回 <code>false</code>。</p>\n<p>源码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">isPresent</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> value != <span class=\"literal\">null</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ifPresent-Consumer-lt-super-T-gt-consumer\"><a href=\"#ifPresent-Consumer-lt-super-T-gt-consumer\" class=\"headerlink\" title=\"ifPresent(Consumer&lt;? super T&gt; consumer)\"></a>ifPresent(Consumer&lt;? super T&gt; consumer)</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>();</span><br><span class=\"line\">Optional&lt;User&gt; optionalUser1 = Optional.ofNullable(user1);</span><br><span class=\"line\">optionalUser1.ifPresent((o) -&gt; System.out.println(o));</span><br><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user2</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">Optional&lt;User&gt; optionalUser2 = Optional.ofNullable(user2);</span><br><span class=\"line\">optionalUser2.ifPresent((o) -&gt; System.out.println(o));</span><br></pre></td></tr></table></figure>\n\n<p><code>ifPresent(Consumer&lt;? super T&gt; consumer)</code> 方法，参数是一个消费型函数式接口，可以配合 Lambda 表达式使用。<br>该方法的作用为：如果 <code>Optional</code> 容器中有值，则执行 <code>Consumer</code> 接口中的方法，否则不做其他任何操作。</p>\n<p>源码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">ifPresent</span><span class=\"params\">(Consumer&lt;? <span class=\"built_in\">super</span> T&gt; consumer)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (value != <span class=\"literal\">null</span>)</span><br><span class=\"line\">        consumer.accept(value);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"filter-Predicate-lt-super-T-gt-predicate\"><a href=\"#filter-Predicate-lt-super-T-gt-predicate\" class=\"headerlink\" title=\"filter(Predicate&lt;? super T&gt; predicate)\"></a>filter(Predicate&lt;? super T&gt; predicate)</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>();</span><br><span class=\"line\">user1.setUsername(<span class=\"string\">&quot;zhangsan&quot;</span>);</span><br><span class=\"line\">Optional&lt;User&gt; optionalUser1 = Optional.ofNullable(user1);</span><br><span class=\"line\">System.out.println(optionalUser1.filter((o) -&gt; o.getUsername().equals(<span class=\"string\">&quot;zhangsan&quot;</span>)));;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>();</span><br><span class=\"line\">user2.setUsername(<span class=\"string\">&quot;lisi&quot;</span>);</span><br><span class=\"line\">Optional&lt;User&gt; optionalUser2 = Optional.ofNullable(user2);</span><br><span class=\"line\">System.out.println(optionalUser2.filter((o) -&gt; o.getUsername().equals(<span class=\"string\">&quot;zhangsan&quot;</span>)));;</span><br></pre></td></tr></table></figure>\n\n<p><code>filter(Predicate&lt;? super T&gt; predicate)</code> 方法用于过滤 <code>Optional</code> 容器中的值，如果 容器内的值符合 <code>Predicate</code> 函数所定义的接口，即返回 <code>true</code>，则返回原来的 <code>Optional</code> 对象，否则返回空的 <code>Optional</code> 容器对象。</p>\n<p>源码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> Optional&lt;T&gt; <span class=\"title function_\">filter</span><span class=\"params\">(Predicate&lt;? <span class=\"built_in\">super</span> T&gt; predicate)</span> &#123;</span><br><span class=\"line\">    Objects.requireNonNull(predicate);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!isPresent())</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> predicate.test(value) ? <span class=\"built_in\">this</span> : empty();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"map-Function-lt-super-T-extends-U-gt-mapper\"><a href=\"#map-Function-lt-super-T-extends-U-gt-mapper\" class=\"headerlink\" title=\"map(Function&lt;? super T, ? extends U&gt; mapper)\"></a>map(Function&lt;? super T, ? extends U&gt; mapper)</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>();</span><br><span class=\"line\">user1.setUsername(<span class=\"string\">&quot;zhangsan&quot;</span>);</span><br><span class=\"line\">Optional&lt;User&gt; optionalUser1 = Optional.ofNullable(user1);</span><br><span class=\"line\">System.out.println(optionalUser1.map((o) -&gt; o.getUsername()).get());</span><br></pre></td></tr></table></figure>\n\n<p><code>map(Function&lt;? super T, ? extends U&gt; mapper)</code> 方法，可以将 <code>Optional</code> 容器内的值替换为其他类型的值，具体的替换规则由 <code>Function</code> 函数定义。<br>例如上面的代码中，将 <code>User</code> 类型的 <code>Optional</code> 容器替换为了 <code>String</code> 类型的 <code>Optional</code> 容器。</p>\n<p>源码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span>&lt;U&gt; Optional&lt;U&gt; <span class=\"title function_\">map</span><span class=\"params\">(Function&lt;? <span class=\"built_in\">super</span> T, ? extends U&gt; mapper)</span> &#123;</span><br><span class=\"line\">    Objects.requireNonNull(mapper);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!isPresent())</span><br><span class=\"line\">        <span class=\"keyword\">return</span> empty();</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Optional.ofNullable(mapper.apply(value));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"flatMap-Function-lt-super-T-Optional-gt-mapper\"><a href=\"#flatMap-Function-lt-super-T-Optional-gt-mapper\" class=\"headerlink\" title=\"flatMap(Function&lt;? super T, Optional&gt; mapper)\"></a>flatMap(Function&lt;? super T, Optional<U>&gt; mapper)</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>();</span><br><span class=\"line\">user1.setUsername(<span class=\"string\">&quot;zhangsan&quot;</span>);</span><br><span class=\"line\">Optional&lt;User&gt; optionalUser1 = Optional.ofNullable(user1);</span><br><span class=\"line\">System.out.println(optionalUser1.flatMap((o) -&gt; Optional.ofNullable(o.getUsername())).get());</span><br></pre></td></tr></table></figure>\n\n<p>该方法与 <code>map(Function&lt;? super T, ? extends U&gt; mapper)</code> 方法类似，不过该方法要求在 <code>Function</code> 函数中返回 <code>Optional</code> 对象，并且返回的 <code>Optional</code> 对象不允许为 <code>null</code>。</p>\n<p>源码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span>&lt;U&gt; Optional&lt;U&gt; <span class=\"title function_\">flatMap</span><span class=\"params\">(Function&lt;? <span class=\"built_in\">super</span> T, Optional&lt;U&gt;&gt; mapper)</span> &#123;</span><br><span class=\"line\">    Objects.requireNonNull(mapper);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!isPresent())</span><br><span class=\"line\">        <span class=\"keyword\">return</span> empty();</span><br><span class=\"line\">    <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Objects.requireNonNull(mapper.apply(value));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"orElse-T-other\"><a href=\"#orElse-T-other\" class=\"headerlink\" title=\"orElse(T other)\"></a>orElse(T other)</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>();</span><br><span class=\"line\">Optional&lt;User&gt; optionalUser1 = Optional.ofNullable(user1);</span><br><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user2</span> <span class=\"operator\">=</span> optionalUser1.orElse(<span class=\"keyword\">new</span> <span class=\"title class_\">User</span>());</span><br><span class=\"line\">System.out.println(user1 == user2);</span><br></pre></td></tr></table></figure>\n\n<p> <code>orElse(T other)</code> 方法和 <code>get()</code> 方法类似，不过比 <code>get()</code> 方法多了一层保险机制，如果 <code>Optional</code> 容器中的值为 <code>null</code>，则会返回 <code>orElse(T other)</code> 方法参数中的对象，该参数类型必须和 <code>Optional</code> 泛型类型一致。</p>\n<p>源码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> T <span class=\"title function_\">orElse</span><span class=\"params\">(T other)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> value != <span class=\"literal\">null</span> ? value : other;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"orElseGet-Supplier-lt-extends-T-gt-other\"><a href=\"#orElseGet-Supplier-lt-extends-T-gt-other\" class=\"headerlink\" title=\"orElseGet(Supplier&lt;? extends T&gt; other)\"></a>orElseGet(Supplier&lt;? extends T&gt; other)</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>();</span><br><span class=\"line\">Optional&lt;User&gt; optionalUser1 = Optional.ofNullable(user1);</span><br><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user2</span> <span class=\"operator\">=</span> optionalUser1.orElseGet(() -&gt; <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>());</span><br><span class=\"line\">System.out.println(user1 == user2);</span><br></pre></td></tr></table></figure>\n\n<p>该方法和功能类似，不过和 orElse(T other) 方法不同的是， <code>Optional</code> 容器中的值为 <code>null</code>时返回的对象通过生产型函数接口来创建并返回。</p>\n<p>源码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> T <span class=\"title function_\">orElseGet</span><span class=\"params\">(Supplier&lt;? extends T&gt; other)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> value != <span class=\"literal\">null</span> ? value : other.get();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"orElseThrow-Supplier-lt-extends-X-gt-exceptionSupplier\"><a href=\"#orElseThrow-Supplier-lt-extends-X-gt-exceptionSupplier\" class=\"headerlink\" title=\"orElseThrow(Supplier&lt;? extends X&gt; exceptionSupplier)\"></a>orElseThrow(Supplier&lt;? extends X&gt; exceptionSupplier)</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>();</span><br><span class=\"line\">Optional&lt;User&gt; optionalUser1 = Optional.ofNullable(user1);</span><br><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user2</span> <span class=\"operator\">=</span> optionalUser1.orElseThrow(() -&gt; <span class=\"keyword\">new</span> <span class=\"title class_\">Exception</span>(<span class=\"string\">&quot;抛出异常信息&quot;</span>));</span><br><span class=\"line\">System.out.println(user1 == user2);</span><br></pre></td></tr></table></figure>\n\n<p>该方法的逻辑和 <code>orElse(T other)</code>、<code>orElseGet(Supplier&lt;? extends T&gt; other)</code> 基本类似，不过当 <code>Optional</code> 容器的值为 <code>null</code> 时，会抛出生产型函数返回的异常对象。</p>\n<p>源码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> &lt;X <span class=\"keyword\">extends</span> <span class=\"title class_\">Throwable</span>&gt; T <span class=\"title function_\">orElseThrow</span><span class=\"params\">(Supplier&lt;? extends X&gt; exceptionSupplier)</span> <span class=\"keyword\">throws</span> X &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (value != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> value;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> exceptionSupplier.get();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"其他方法\"><a href=\"#其他方法\" class=\"headerlink\" title=\"其他方法\"></a>其他方法</h2><p><code>Optional</code> 类除了上述的特有方法之外，还重写了 <code>equals()</code>、<code>hashCode()</code>、<code>toString()</code> 等通用方法，在本篇文章中不做过多的讲述。</p>\n","categories":["Java"],"tags":["Java"]},{"title":"JDK8新特性之Stream流","url":"/2020/03/15/java/JDK8%E6%96%B0%E7%89%B9%E6%80%A7%E4%B9%8BStream%E6%B5%81/","content":"<h1 id=\"什么是Stream流？\"><a href=\"#什么是Stream流？\" class=\"headerlink\" title=\"什么是Stream流？\"></a>什么是Stream流？</h1><p>Stream流是JDK8中的一个全新的概念，用于解决已有集合类库既有的弊端。</p>\n<span id=\"more\"></span>\n<h2 id=\"传统集合遍历的弊端\"><a href=\"#传统集合遍历的弊端\" class=\"headerlink\" title=\"传统集合遍历的弊端\"></a>传统集合遍历的弊端</h2><ul>\n<li>每当我们需要对集合中的元素进行操作的时候，总是需要循环、循环、再循环，循环是遍历集合的方式，而不是目的，我们的目的是将集合中的元素全部都处理。</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\tList&lt;String&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;String&gt;();</span><br><span class=\"line\">\tlist.add(<span class=\"string\">&quot;我爱中国&quot;</span>);</span><br><span class=\"line\">\tlist.add(<span class=\"string\">&quot;第二元素&quot;</span>);</span><br><span class=\"line\">\tlist.add(<span class=\"string\">&quot;第三元素&quot;</span>);</span><br><span class=\"line\">\tlist.add(<span class=\"string\">&quot;东西南北&quot;</span>);</span><br><span class=\"line\">\tlist.add(<span class=\"string\">&quot;碳元素&quot;</span>);\t</span><br><span class=\"line\">\t<span class=\"comment\">//对list集合中的元素进行过滤，将包含&quot;元素&quot;的元素放入listA集合</span></span><br><span class=\"line\">\tList&lt;String&gt; listA = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;String&gt;();</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (String str : list) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(str.contains(<span class=\"string\">&quot;元素&quot;</span>)) &#123;</span><br><span class=\"line\">\t\t\tlistA.add(str);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;\t</span><br><span class=\"line\">\t<span class=\"comment\">//对listA集合中的元素进行过滤，将包含&quot;三&quot;的元素放入listB集合</span></span><br><span class=\"line\">\tList&lt;String&gt; listB = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;String&gt;();</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (String str : listA) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(str.contains(<span class=\"string\">&quot;三&quot;</span>)) &#123;</span><br><span class=\"line\">\t\t\tlistB.add(str);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//遍历listB集合，输出元素</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (String str : listB) &#123;</span><br><span class=\"line\">\t\tSystem.out.println(str);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Stream的方式\"><a href=\"#Stream的方式\" class=\"headerlink\" title=\"Stream的方式\"></a>Stream的方式</h2><ul>\n<li>使用Stream流的方式，可以更简单高效的方式处理集合。</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\tList&lt;String&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;String&gt;();</span><br><span class=\"line\">\tlist.add(<span class=\"string\">&quot;我爱中国&quot;</span>);</span><br><span class=\"line\">\tlist.add(<span class=\"string\">&quot;第二元素&quot;</span>);</span><br><span class=\"line\">\tlist.add(<span class=\"string\">&quot;第三元素&quot;</span>);</span><br><span class=\"line\">\tlist.add(<span class=\"string\">&quot;东西南北&quot;</span>);</span><br><span class=\"line\">\tlist.add(<span class=\"string\">&quot;碳元素&quot;</span>);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tlist.stream()</span><br><span class=\"line\">\t\t.filter(name-&gt;name.contains(<span class=\"string\">&quot;元素&quot;</span>))</span><br><span class=\"line\">\t\t.filter(name-&gt;name.contains(<span class=\"string\">&quot;三&quot;</span>)).forEach(name-&gt;System.out.println(name));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"两种获取Stream流的方式\"><a href=\"#两种获取Stream流的方式\" class=\"headerlink\" title=\"两种获取Stream流的方式\"></a>两种获取Stream流的方式</h1><p>java.util.stream.Stream是JDK8新加入的最常用的流接口（这不是一个函数式接口）。</p>\n<ul>\n<li>所有Collection集合都可以通过stream默认方法获取流。</li>\n<li>Stream接口中的静态方法of可以获取数组对应的流。</li>\n</ul>\n<h2 id=\"根据stream-方法获取流\"><a href=\"#根据stream-方法获取流\" class=\"headerlink\" title=\"根据stream()方法获取流\"></a>根据stream()方法获取流</h2><p>Collection接口中有一个默认方法stream()，所有Collection集合都可以通过这个方法来获取流。</p>\n<ul>\n<li>Map集合无法直接通过这种方式获取流。</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//List集合获取流对象</span></span><br><span class=\"line\">List&lt;String&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;String&gt;();</span><br><span class=\"line\">Stream&lt;String&gt; stream1 = list.stream();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Set集合获取流对象</span></span><br><span class=\"line\">Set&lt;String&gt; set = <span class=\"keyword\">new</span> <span class=\"title class_\">HashSet</span>&lt;String&gt;();</span><br><span class=\"line\">Stream&lt;String&gt; stream2 = set.stream();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//通过Map集合的keySet获取流对象</span></span><br><span class=\"line\">Map&lt;String, String&gt; map = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;String, String&gt;();</span><br><span class=\"line\"><span class=\"comment\">//获取map集合的键stream流</span></span><br><span class=\"line\">Set&lt;String&gt; keySet = map.keySet();</span><br><span class=\"line\">Stream&lt;String&gt; stream3 = keySet.stream();</span><br><span class=\"line\"><span class=\"comment\">//获取map集合的值stream流</span></span><br><span class=\"line\">Collection&lt;String&gt; values = map.values();</span><br><span class=\"line\">Stream&lt;String&gt; stream4 = values.stream();</span><br><span class=\"line\"><span class=\"comment\">//获取map集合键值对的stream流</span></span><br><span class=\"line\">Set&lt;Entry&lt;String, String&gt;&gt; entries = map.entrySet();</span><br><span class=\"line\">Stream&lt;Entry&lt;String, String&gt;&gt; stream5 = entries.stream();</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"根据of-方法获取流\"><a href=\"#根据of-方法获取流\" class=\"headerlink\" title=\"根据of()方法获取流\"></a>根据of()方法获取流</h2><p>Stream接口中的静态方法of()，参数是一个可变参数。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//直接传入可变数组</span></span><br><span class=\"line\">Stream&lt;Integer&gt; stream6 = Stream.of(<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>);</span><br><span class=\"line\"><span class=\"comment\">//传入一个整形数组</span></span><br><span class=\"line\">Integer[] arr1 = &#123;<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>&#125;;</span><br><span class=\"line\">Stream&lt;Integer&gt; stream7 = Stream.of(arr1);</span><br><span class=\"line\"><span class=\"comment\">//传入一个字符串数组</span></span><br><span class=\"line\">String[] arr2 = &#123;<span class=\"string\">&quot;a&quot;</span>,<span class=\"string\">&quot;bb&quot;</span>,<span class=\"string\">&quot;ccc&quot;</span>&#125;;</span><br><span class=\"line\">Stream&lt;String&gt; stream8 = Stream.of(arr2);</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Stream流中的常用方法\"><a href=\"#Stream流中的常用方法\" class=\"headerlink\" title=\"Stream流中的常用方法\"></a>Stream流中的常用方法</h1><p>Stream流中的方法被分成两种：</p>\n<ul>\n<li><strong>延迟方法：</strong> 返回值类型仍然是Stream流接口自身类型的方法，因此支持链式编程（除了终结方法外，其余方法均为延迟方法）。</li>\n<li><strong>终结方法：</strong> 返回值类型不再是Stream流接口自身类型的方法，因此不再支持链式编程调用。</li>\n</ul>\n<h2 id=\"延迟方法\"><a href=\"#延迟方法\" class=\"headerlink\" title=\"延迟方法\"></a>延迟方法</h2><p><strong>过滤：filter</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">Stream&lt;T&gt; <span class=\"title function_\">filter</span><span class=\"params\">(Predicate&lt;? <span class=\"built_in\">super</span> T&gt; predicate)</span>;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>代码示例：</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">Stream&lt;String&gt; stream1 = Stream.of(<span class=\"string\">&quot;张三&quot;</span>,<span class=\"string\">&quot;李四&quot;</span>,<span class=\"string\">&quot;王五&quot;</span>);</span><br><span class=\"line\">Stream&lt;String&gt; stream2 = stream1.filter(name-&gt;name.startsWith(<span class=\"string\">&quot;张&quot;</span>));</span><br><span class=\"line\">stream2.forEach(name-&gt;System.out.println(name));</span><br></pre></td></tr></table></figure>\n<p><strong>映射： map</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">&lt;R&gt; Stream&lt;R&gt; <span class=\"title function_\">map</span><span class=\"params\">(Function&lt;? <span class=\"built_in\">super</span> T, ? extends R&gt; mapper)</span>;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>代码示例：</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">Stream&lt;String&gt; stream1 = Stream.of(<span class=\"string\">&quot;1&quot;</span>,<span class=\"string\">&quot;2&quot;</span>,<span class=\"string\">&quot;3&quot;</span>);</span><br><span class=\"line\">Stream&lt;Integer&gt; stream2 = stream1.map(str-&gt;Integer.parseInt(str));</span><br><span class=\"line\">stream2.forEach(i-&gt;System.out.println(i));</span><br></pre></td></tr></table></figure>\n<p><strong>切割前几个元素：limit</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">Stream&lt;T&gt; <span class=\"title function_\">limit</span><span class=\"params\">(<span class=\"type\">long</span> maxSize)</span>;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>代码示例：</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">Stream&lt;String&gt; stream1 = Stream.of(<span class=\"string\">&quot;1&quot;</span>,<span class=\"string\">&quot;2&quot;</span>,<span class=\"string\">&quot;3&quot;</span>,<span class=\"string\">&quot;4&quot;</span>,<span class=\"string\">&quot;5&quot;</span>);</span><br><span class=\"line\">Stream&lt;String&gt; stream2 = stream1.limit(<span class=\"number\">3</span>);</span><br><span class=\"line\">stream2.forEach(str-&gt;System.out.println(str));</span><br></pre></td></tr></table></figure>\n\n<p><strong>跳过前几个元素：skip</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">Stream&lt;T&gt; <span class=\"title function_\">skip</span><span class=\"params\">(<span class=\"type\">long</span> n)</span>;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>代码示例：</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">Stream&lt;String&gt; stream1 = Stream.of(<span class=\"string\">&quot;1&quot;</span>,<span class=\"string\">&quot;2&quot;</span>,<span class=\"string\">&quot;3&quot;</span>,<span class=\"string\">&quot;4&quot;</span>,<span class=\"string\">&quot;5&quot;</span>);</span><br><span class=\"line\">Stream&lt;String&gt; stream2 = stream1.skip(<span class=\"number\">3</span>);</span><br><span class=\"line\">stream2.forEach(str-&gt;System.out.println(str));</span><br></pre></td></tr></table></figure>\n<p><strong>组合：concat</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">Stream&lt;String&gt; stream1 = Stream.of(<span class=\"string\">&quot;美羊羊&quot;</span>,<span class=\"string\">&quot;懒羊羊&quot;</span>);</span><br><span class=\"line\">Stream&lt;String&gt; stream2 = Stream.of(<span class=\"string\">&quot;灰太狼&quot;</span>,<span class=\"string\">&quot;红太狼&quot;</span>);</span><br><span class=\"line\">Stream&lt;String&gt; stream3 = Stream.concat(stream1, stream2);</span><br><span class=\"line\">stream3.forEach(str-&gt;System.out.println(str));</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"终结方法\"><a href=\"#终结方法\" class=\"headerlink\" title=\"终结方法\"></a>终结方法</h2><p><strong>逐一处理：forEach</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">void</span> <span class=\"title function_\">forEach</span><span class=\"params\">(Consumer&lt;? <span class=\"built_in\">super</span> T&gt; action)</span>;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>代码示例：</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\tStream&lt;String&gt; stream = Stream.of(<span class=\"string\">&quot;张三&quot;</span>,<span class=\"string\">&quot;李四&quot;</span>,<span class=\"string\">&quot;王五&quot;</span>);</span><br><span class=\"line\">\tstream.forEach(name-&gt;System.out.println(name));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>统计个数：count</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">long</span> <span class=\"title function_\">count</span><span class=\"params\">()</span>;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>代码示例：</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">Stream&lt;String&gt; stream = Stream.of(<span class=\"string\">&quot;1&quot;</span>,<span class=\"string\">&quot;2&quot;</span>,<span class=\"string\">&quot;3&quot;</span>);</span><br><span class=\"line\"><span class=\"type\">long</span> <span class=\"variable\">count</span> <span class=\"operator\">=</span> stream.count();</span><br><span class=\"line\">System.out.println(count);</span><br></pre></td></tr></table></figure>\n\n\n<h1 id=\"Stream流属于管道流\"><a href=\"#Stream流属于管道流\" class=\"headerlink\" title=\"Stream流属于管道流\"></a>Stream流属于管道流</h1><p>Stream流属于管道流，只能被消费（使用）一次，第一个Stream流调用完毕方法，数据就会流转到下一个Stream上，而这时第一个Stream流已经使用完毕，就会关闭流，所以第一个Stream流就不能调用方法了。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\tStream&lt;String&gt; stream1 = Stream.of(<span class=\"string\">&quot;张三&quot;</span>,<span class=\"string\">&quot;李四&quot;</span>,<span class=\"string\">&quot;王五&quot;</span>);</span><br><span class=\"line\">\tStream&lt;String&gt; stream2 = stream1.filter(name-&gt;name.startsWith(<span class=\"string\">&quot;张&quot;</span>));</span><br><span class=\"line\">\tstream1.forEach(name-&gt;System.out.println(name));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>以上代码编译通过，但是执行后爆出stream流已经关闭的异常。</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">java.lang.IllegalStateException: stream has already been operated upon or closed</span><br></pre></td></tr></table></figure>\n\n","categories":["Java"],"tags":["Java"]},{"title":"JDK8新特性之函数式接口","url":"/2020/03/14/java/JDK8%E6%96%B0%E7%89%B9%E6%80%A7%E4%B9%8B%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3/","content":"<h1 id=\"函数式接口\"><a href=\"#函数式接口\" class=\"headerlink\" title=\"函数式接口\"></a>函数式接口</h1><ul>\n<li><strong>JDK8更新了很多的新特性，其中函数式接口就是JDK8中最为受欢迎的新特性之一。</strong><span id=\"more\"></span>\n\n</li>\n</ul>\n<h2 id=\"什么是函数式接口？\"><a href=\"#什么是函数式接口？\" class=\"headerlink\" title=\"什么是函数式接口？\"></a>什么是函数式接口？</h2><ul>\n<li>有且仅有一个抽象方法，但是可以有多个非抽象方法的接口。</li>\n</ul>\n<p>函数式接口是适用于函数式编程的接口，而JDK8中的函数式编程就是Lambda，所以函数式接口就是可以使用于Lambda表达式使用的接口，只有确保接口中只有一个抽象方法，Java中的Lambda才可以顺利进行推导。</p>\n<p><strong>格式</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">MyFunctionInterface</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">void</span> <span class=\"title function_\">method</span><span class=\"params\">()</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"FunctionalInterface注解\"><a href=\"#FunctionalInterface注解\" class=\"headerlink\" title=\"@FunctionalInterface注解\"></a>@FunctionalInterface注解</h2><p>@FunctionalInterface注解是一个和函数式接口相关的注解，可以检测一个接口是否是一个函数式接口。如果是则编译成功，如果不是则编译失败。<br>编译失败的可能原因：接口中没有抽象方法或者有多个抽象方法。</p>\n<p><strong>编译成功的情况：</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@FunctionalInterface</span>\t\t<span class=\"comment\">//编译成功</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">MyFunctionInterface</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">void</span> <span class=\"title function_\">method</span><span class=\"params\">()</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>编译失败的情况：</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@FunctionalInterface</span>\t\t<span class=\"comment\">//编译失败</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">MyFunctionInterface</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">void</span> <span class=\"title function_\">method</span><span class=\"params\">()</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">void</span> <span class=\"title function_\">method2</span><span class=\"params\">()</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Lambda表达式\"><a href=\"#Lambda表达式\" class=\"headerlink\" title=\"Lambda表达式\"></a>Lambda表达式</h1><p>Lambda表达式的重要特征:</p>\n<ul>\n<li>可选类型声明：不需要声明参数类型，编译器可以统一识别参数值。</li>\n<li>可选的参数圆括号：一个参数无需定义圆括号，但多个参数需要定义圆括号。</li>\n<li>可选的大括号：如果主体只包含了一行代码，可以不需要使用大括号。</li>\n<li>可选的返回关键字：如果主体只有一个表达式返回值则编译器会自动返回值，大括号需要指定明表达式返回了一个数值。</li>\n</ul>\n<h2 id=\"Lambda表达式的使用\"><a href=\"#Lambda表达式的使用\" class=\"headerlink\" title=\"Lambda表达式的使用\"></a>Lambda表达式的使用</h2><p>我们平常面向接口编程的时候，都需要实现该接口，重写内部方法，我们可以使用匿名内部类的方式编写代码，代码如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">show</span><span class=\"params\">(MyFunctionInterface myInterface)</span> &#123;</span><br><span class=\"line\">\tmyInterface.method();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\tshow(<span class=\"keyword\">new</span> <span class=\"title class_\">MyFunctionInterface</span>() &#123;\t\t</span><br><span class=\"line\">\t\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(<span class=\"string\">&quot;使用匿名内部类的方式重写接口中的方法。&quot;</span>);\t\t\t\t</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<p>而如果这个接口是一个函数式接口，那么我们可以使用Lambda表达式来重写这个接口中的方法，简化代码。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">show</span><span class=\"params\">(MyFunctionInterface myInterface)</span> &#123;</span><br><span class=\"line\">\tmyInterface.method();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\tshow(()-&gt;&#123;</span><br><span class=\"line\">\t\tSystem.out.println(<span class=\"string\">&quot;使用Lambda表达式的方式重写接口中的方法。&quot;</span>);</span><br><span class=\"line\">\t&#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Lambda表达式的简化：如果这个重写的方法中有且仅有一行代码，那么我们可以省略方法体中的大括号和分号。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">show</span><span class=\"params\">(MyFunctionInterface myInterface)</span> &#123;</span><br><span class=\"line\">\tmyInterface.method();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\tshow(()-&gt;System.out.println(<span class=\"string\">&quot;使用Lambda表达式的方式重写接口中的方法。&quot;</span>));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"匿名内部类和Lambda表达式的区别？\"><a href=\"#匿名内部类和Lambda表达式的区别？\" class=\"headerlink\" title=\"匿名内部类和Lambda表达式的区别？\"></a>匿名内部类和Lambda表达式的区别？</h2><p>匿名内部类会生成一个匿名内部类的class文件，而Lambda表达式不会有class文件，节省了空间。</p>\n<h2 id=\"Lambda表达式的延迟执行\"><a href=\"#Lambda表达式的延迟执行\" class=\"headerlink\" title=\"Lambda表达式的延迟执行\"></a>Lambda表达式的延迟执行</h2><p>有些场景的代码执行后，结果有不一定会被使用，从而造成了性能的浪费，而Lambda表达式是延迟执行的，这正好可以作为解决方案，提升性能。</p>\n<p><strong>性能浪费的日志案例</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Logger</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">showLog</span><span class=\"params\">(<span class=\"type\">int</span> level, String message)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(level == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(message);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">String</span> <span class=\"variable\">msg1</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;Hello&quot;</span>;</span><br><span class=\"line\">\t\t<span class=\"type\">String</span> <span class=\"variable\">msg2</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;World&quot;</span>;</span><br><span class=\"line\">\t\t<span class=\"type\">String</span> <span class=\"variable\">msg3</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;Java&quot;</span>;</span><br><span class=\"line\">\t\tshowLog(<span class=\"number\">1</span>, msg1+msg2+msg3);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>以上代码中，如果传入的level参数为2，那么message参数传入的拼接字符串就造成了性能浪费。</p>\n<p><strong>使用Lambda表达式的延迟执行优化这段代码</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@FunctionalInterface</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">MessageBuilder</span> &#123;</span><br><span class=\"line\">\tString <span class=\"title function_\">builderMessage</span><span class=\"params\">()</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">showLog</span><span class=\"params\">(<span class=\"type\">int</span> level, MessageBuilder mb)</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(level == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\tSystem.out.println(mb.builderMessage());</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\t<span class=\"type\">String</span> <span class=\"variable\">msg1</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;Hello&quot;</span>;</span><br><span class=\"line\">\t<span class=\"type\">String</span> <span class=\"variable\">msg2</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;World&quot;</span>;</span><br><span class=\"line\">\t<span class=\"type\">String</span> <span class=\"variable\">msg3</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;Java&quot;</span>;</span><br><span class=\"line\">\tshowLog(<span class=\"number\">1</span>, ()-&gt;&#123;</span><br><span class=\"line\">\t\tSystem.out.println(<span class=\"string\">&quot;当条件符合时才会执行这段方法！&quot;</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> msg1+msg2+msg3;</span><br><span class=\"line\">\t&#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>使用Lambda表达式作为参数传递，仅仅是把参数传递到showLog方法中。</p>\n<ul>\n<li>只有满足条件，参数level为1时，才会调用的MessageBuilder接口中的builderMessage方法，字符串才会进行拼接。</li>\n<li>如果不满足条件，参数level不为1时，不会调用的MessageBuilder接口中的builderMessage方法，字符串也不会进行拼接。</li>\n</ul>\n<p>这就是Lambda表达式的延迟执行，避免了性能的浪费。</p>\n<h2 id=\"Lambda表达式和线程\"><a href=\"#Lambda表达式和线程\" class=\"headerlink\" title=\"Lambda表达式和线程\"></a>Lambda表达式和线程</h2><p>线程中的Runnable接口就是一个函数式接口，其中有且仅有一个抽象方法run()方法。</p>\n<p>我们就可以使用Lambda表达式来创建线程。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(()-&gt;</span><br><span class=\"line\">\t\tSystem.out.println(Thread.currentThread().getName()+<span class=\"string\">&quot;线程启动了！&quot;</span>)</span><br><span class=\"line\">\t).start();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"常用的函数式接口\"><a href=\"#常用的函数式接口\" class=\"headerlink\" title=\"常用的函数式接口\"></a>常用的函数式接口</h1><ul>\n<li><strong>JDK为我们提供了一些常用的函数式接口，这些接口全部放在java.util.function包中。</strong></li>\n</ul>\n<h2 id=\"Supplier接口\"><a href=\"#Supplier接口\" class=\"headerlink\" title=\"Supplier接口\"></a>Supplier接口</h2><p>Supplier是一个函数式接口，其中仅有一个无参的方法：T get()。用来获取一个泛型参数指定类型的对象数据。</p>\n<ul>\n<li>Supplier接口被称之为生产型接口，指定接口是什么泛型，就会生产什么类型的数据。</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">SupplierDemo</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title function_\">getString</span><span class=\"params\">(Supplier&lt;String&gt; supplier)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> supplier.get();</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">String</span> <span class=\"variable\">str</span> <span class=\"operator\">=</span> getString(()-&gt;<span class=\"string\">&quot;Supplier接口生产一个String类型的数据。&quot;</span>);</span><br><span class=\"line\">\t\tSystem.out.println(str);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"Consumer接口\"><a href=\"#Consumer接口\" class=\"headerlink\" title=\"Consumer接口\"></a>Consumer接口</h2><ul>\n<li>Consumer接口被称之为消费型接口，指定什么类型的泛型，就会消费什么类型的数据。</li>\n</ul>\n<p><strong>抽象方法：void accept(T t)</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ConsumerDemo</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method</span><span class=\"params\">(String name, Consumer&lt;String&gt; consumer)</span> &#123;</span><br><span class=\"line\">\t\tconsumer.accept(name);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\t\tmethod(<span class=\"string\">&quot;消费了这个字符串&quot;</span>, (t)-&gt;&#123;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//消费方法的逻辑可以由设计者随便定义</span></span><br><span class=\"line\">\t\t\tSystem.out.println(<span class=\"keyword\">new</span> <span class=\"title class_\">StringBuffer</span>(t).reverse());</span><br><span class=\"line\">\t\t&#125;);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>默认方法：default Consumer<T> andThen(Consumer&lt;? super T&gt; after)</strong></p>\n<ul>\n<li>andThen方法谁在前面，谁先消费！</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ConsumerDemo</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">method</span><span class=\"params\">(String name, Consumer&lt;String&gt; consumer1, Consumer&lt;String&gt; consumer2)</span> &#123;</span><br><span class=\"line\">\t\tconsumer1.andThen(consumer2).accept(name);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\t\tmethod(<span class=\"string\">&quot;消费了这个字符串&quot;</span>, (t)-&gt;&#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(<span class=\"string\">&quot;第一次消费：&quot;</span> + <span class=\"keyword\">new</span> <span class=\"title class_\">StringBuffer</span>(t).reverse());</span><br><span class=\"line\">\t\t&#125;,(t)-&gt;&#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(<span class=\"string\">&quot;第二次消费：&quot;</span> + <span class=\"keyword\">new</span> <span class=\"title class_\">StringBuffer</span>(t).reverse());</span><br><span class=\"line\">\t\t&#125;);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Predicate接口\"><a href=\"#Predicate接口\" class=\"headerlink\" title=\"Predicate接口\"></a>Predicate接口</h2><ul>\n<li>Predicate接口的作用是对数据类型的数据进行判断，结果返回一个boolean值。</li>\n</ul>\n<p><strong>抽象方法：test(T t)</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">PredicateDemo</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">boolean</span> <span class=\"title function_\">checkString</span><span class=\"params\">(String str, Predicate&lt;String&gt; predicate)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> predicate.test(str);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">boolean</span> <span class=\"variable\">b</span> <span class=\"operator\">=</span> checkString(<span class=\"string\">&quot;abcdefg&quot;</span>, (s)-&gt;s.length() &gt; <span class=\"number\">5</span>);</span><br><span class=\"line\">\t\tSystem.out.println(b);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>默认方法：default Predicate<T> and(Predicate&lt;? super T&gt; other)</strong></p>\n<ul>\n<li>相当于逻辑表达式&amp;&amp;（与）</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">PredicateDemo</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">boolean</span> <span class=\"title function_\">checkString</span><span class=\"params\">(String str, Predicate&lt;String&gt; predicate1, Predicate&lt;String&gt; predicate2)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> predicate1.and(predicate2).test(str);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">boolean</span> <span class=\"variable\">b</span> <span class=\"operator\">=</span> checkString(<span class=\"string\">&quot;abcdefg&quot;</span>, (s)-&gt;s.length() &gt; <span class=\"number\">5</span>,(s)-&gt;s.contains(<span class=\"string\">&quot;a&quot;</span>));</span><br><span class=\"line\">\t\tSystem.out.println(b);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>默认方法：default Predicate<T> or(Predicate&lt;? super T&gt; other)</strong></p>\n<ul>\n<li>相当于逻辑表达式||（或）</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">PredicateDemo</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">boolean</span> <span class=\"title function_\">checkString</span><span class=\"params\">(String str, Predicate&lt;String&gt; predicate1, Predicate&lt;String&gt; predicate2)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> predicate1.or(predicate2).test(str);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">boolean</span> <span class=\"variable\">b</span> <span class=\"operator\">=</span> checkString(<span class=\"string\">&quot;abcdefg&quot;</span>, (s)-&gt;s.length() &gt; <span class=\"number\">5</span>,(s)-&gt;s.contains(<span class=\"string\">&quot;h&quot;</span>));</span><br><span class=\"line\">\t\tSystem.out.println(b);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>默认方法：default Predicate<T> negate()</strong></p>\n<ul>\n<li>相当于逻辑表达式!（非）<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">PredicateDemo</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">boolean</span> <span class=\"title function_\">checkString</span><span class=\"params\">(String str, Predicate&lt;String&gt; predicate)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> predicate.negate().test(str);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">boolean</span> <span class=\"variable\">b</span> <span class=\"operator\">=</span> checkString(<span class=\"string\">&quot;abcdefg&quot;</span>, (s)-&gt;s.length() &gt; <span class=\"number\">5</span>);</span><br><span class=\"line\">\t\tSystem.out.println(b);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n</li>\n</ul>\n<h2 id=\"Function接口\"><a href=\"#Function接口\" class=\"headerlink\" title=\"Function接口\"></a>Function接口</h2><ul>\n<li>Function接口用来根据一个类型的数据得到另一个类型的数据。</li>\n</ul>\n<p><strong>抽象方法：R apply(T t)</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">FunctionDemo</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">change</span><span class=\"params\">(String s, Function&lt;String, Integer&gt; fun)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">Integer</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> fun.apply(s);</span><br><span class=\"line\">\t\tSystem.out.println(i);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\t\tchange(<span class=\"string\">&quot;56&quot;</span>, (s)-&gt;Integer.parseInt(s));</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>默认方法：default <V> Function&lt;T, V&gt; andThen(Function&lt;? super R, ? extends V&gt; after)</strong></p>\n<ul>\n<li>andThen方法谁在前面，谁先执行！</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">FunctionDemo</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">change</span><span class=\"params\">(String s, Function&lt;String, Integer&gt; fun1, Function&lt;Integer, String&gt; fun2)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">String</span> <span class=\"variable\">str</span> <span class=\"operator\">=</span> fun1.andThen(fun2).apply(s);</span><br><span class=\"line\">\t\tSystem.out.println(str);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\t\tchange(<span class=\"string\">&quot;56&quot;</span>, (s)-&gt;Integer.parseInt(s),(i)-&gt;i+<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","categories":["Java"],"tags":["Java"]},{"title":"JDK源码-Object类解析","url":"/2020/01/07/java/JDK%E6%BA%90%E7%A0%81-Object%E7%B1%BB%E8%A7%A3%E6%9E%90/","content":"<h1 id=\"一、JDK源码\"><a href=\"#一、JDK源码\" class=\"headerlink\" title=\"一、JDK源码\"></a>一、JDK源码</h1><p>作为Java中所有Class的爸爸，Object类无疑是Java中非常重要的一个类，今天我们就直接来阅读以下JDK源码中的Object类，对其中的代码进行解析。</p>\n<span id=\"more\"></span>\n<p>首先，废话不多说，我们直接上源码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> java.lang;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Object</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title function_\">registerNatives</span><span class=\"params\">()</span>;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        registerNatives();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">native</span> Class&lt;?&gt; getClass();</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">native</span> <span class=\"type\">int</span> <span class=\"title function_\">hashCode</span><span class=\"params\">()</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">equals</span><span class=\"params\">(Object obj)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (<span class=\"built_in\">this</span> == obj);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"keyword\">native</span> Object <span class=\"title function_\">clone</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> CloneNotSupportedException;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">toString</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> getClass().getName() + <span class=\"string\">&quot;@&quot;</span> +Integer.toHexString(hashCode());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title function_\">notify</span><span class=\"params\">()</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title function_\">notifyAll</span><span class=\"params\">()</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title function_\">wait</span><span class=\"params\">(<span class=\"type\">long</span> timeout)</span> <span class=\"keyword\">throws</span> InterruptedException;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title function_\">wait</span><span class=\"params\">(<span class=\"type\">long</span> timeout, <span class=\"type\">int</span> nanos)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (timeout &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IllegalArgumentException</span>(<span class=\"string\">&quot;timeout value is negative&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (nanos &lt; <span class=\"number\">0</span> || nanos &gt; <span class=\"number\">999999</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IllegalArgumentException</span>(</span><br><span class=\"line\">                                <span class=\"string\">&quot;nanosecond timeout value out of range&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (nanos &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            timeout++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        wait(timeout);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title function_\">wait</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">        wait(<span class=\"number\">0</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title function_\">finalize</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Throwable &#123; &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"二、Object类\"><a href=\"#二、Object类\" class=\"headerlink\" title=\"二、Object类\"></a>二、Object类</h1><p>看到上面的代码，是不是非常惊讶，作为Java中的基类，Object的源码似乎也并不是太复杂。<br>是的，你没有感觉错误，其实只要你打开JDK的源码来看一看的话，就会发现，在Object类中，除去那些一大堆的看不懂的英文注释之外，所有的有效代码就是上面的那些。<br><strong>Object类</strong>是java.lang包下的一个Class，从写法上来看，它和我们平常自己写的类也没有太大的区别，那么Object类作为java中的基类有什么特殊之处呢，那就让我们来解析一下吧。</p>\n<p><strong>1、所有的类都继承自Object类</strong><br>首先，Object类作为Java的基类，Java中所有的类（包含JDK中的和我们自己定义的）都会显式或隐式继承Object类，所以Object类是Java中所有类的父类，或者是超父类。故此，我们也将Object类称作基类，或者是超类。</p>\n<p><strong>2、Object类中的方法</strong><br>既然Object类是基类，那么根据Java中继承的特性，也就是所Java中除了Object类之外的所有类都是Object类的子类，也就是说Object类中的所有的<strong>非私有</strong>方法都会被其子类继承。<br>所以，Java中的任意一个类，都可以调用Object类中的方法。</p>\n<p><strong>Object类中的方法一共有13个，1个构造方法，1个私有方法，2个受保护方法，其余9个则是公有方法</strong>。</p>\n<p>而今天需要详细解析的也就是这13个方法。</p>\n<h1 id=\"三、Object中的方法\"><a href=\"#三、Object中的方法\" class=\"headerlink\" title=\"三、Object中的方法\"></a>三、Object中的方法</h1><h2 id=\"1、Object\"><a href=\"#1、Object\" class=\"headerlink\" title=\"1、Object()\"></a>1、Object()</h2><p>Object类的构造方法在JDK源码中并没有直接书写出来，是一个默认的无参构造方法，可以直接通过关键字<strong>new</strong>来进行创建一个Object类型的对象。<br>例如：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">Object</span> <span class=\"variable\">object</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br></pre></td></tr></table></figure>\n<h2 id=\"2、registerNatives\"><a href=\"#2、registerNatives\" class=\"headerlink\" title=\"2、registerNatives()\"></a>2、registerNatives()</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title function_\">registerNatives</span><span class=\"params\">()</span>;</span><br></pre></td></tr></table></figure>\n<p>这个方法是private的，是私有的，所以这个方法是Object类独有的方法，不会被其子类继承。<br><strong>registerNatives()</strong> 方法独特的地方在于，使用了 <strong>native</strong>关键字进行修饰，在java中，使用native关键字进行修饰，那就说明这个方法的底层实现，并不是由Java代码来进行编写的，而是调用了其他语言编写的接口来进行实现的。<br>我们可以从源码中发现：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">    registerNatives();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>在Object类中有一个静态代码块，直接调用了这个方法，也就是说，这个方法是所有的类进行实例化的时候都会执行的方法。<br>这个方法和Java语言的底层实现有关系，我们只需要了解即可，并不是今天的重点。</p>\n<h2 id=\"3、clone\"><a href=\"#3、clone\" class=\"headerlink\" title=\"3、clone()\"></a>3、clone()</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">protected</span> <span class=\"keyword\">native</span> Object <span class=\"title function_\">clone</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> CloneNotSupportedException;</span><br></pre></td></tr></table></figure>\n<p>clone()方法是一个受保护的方法，作用是克隆一个对象，我们可以实例化一个Object类的对象，看看Object对象可以直接调用哪些方法：<br><img src=\"/images/2020/01/20200107225037605.png\" alt=\"在这里插入图片描述\"><br>从上面的图我们可以发现，其实Object类的实例对象竟然也无法调用clone()方法，那么Java中该怎么调用clone()方法呢？<br>方法很简单，实现Cloneable接口，并覆写clone()方法即可！<br>我们先来写一个User类，并让User类实现Cloneable接口，并覆写clone()方法。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Cloneable</span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">private</span> Integer id;</span><br><span class=\"line\">\t<span class=\"keyword\">private</span> String username;</span><br><span class=\"line\">\t<span class=\"keyword\">private</span> String password;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> Integer <span class=\"title function_\">getId</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> id;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">setId</span><span class=\"params\">(Integer id)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">this</span>.id = id;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> String <span class=\"title function_\">getUsername</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> username;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">setUsername</span><span class=\"params\">(String username)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">this</span>.username = username;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> String <span class=\"title function_\">getPassword</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> password;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">setPassword</span><span class=\"params\">(String password)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">this</span>.password = password;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> String <span class=\"title function_\">toString</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"string\">&quot;User [id=&quot;</span> + id + <span class=\"string\">&quot;, username=&quot;</span> + username + <span class=\"string\">&quot;, password=&quot;</span> + password + <span class=\"string\">&quot;]&quot;</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"keyword\">protected</span> Object <span class=\"title function_\">clone</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> CloneNotSupportedException &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"built_in\">super</span>.clone();</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>我们写好了User类，并让User类实现了Cloneable接口和覆写clone()方法，那么我们来实例化一个User对象。<br><img src=\"/images/2020/01/20200107230520425.png\" alt=\"在这里插入图片描述\"><br>从上面的图我们可以看见，除去User类自己的6个setter和getter方法之后，User类可以调用的方法有10个，其中就包括之前无法调用的clone()方法。<br>说完了实现，我们在说说clone方法的结果。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>();</span><br><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user2</span> <span class=\"operator\">=</span> (User) user1.clone();</span><br><span class=\"line\">System.out.println(user1 == user2);</span><br></pre></td></tr></table></figure>\n<p>执行上面的代码，得到结果：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"literal\">false</span></span><br></pre></td></tr></table></figure>\n<p>从这个结果我们可以看出，其中clone()方法克隆出来的对象，和原来的对象并不是同一个，而是从新创建了一个新的对象。</p>\n<h2 id=\"4、finalize\"><a href=\"#4、finalize\" class=\"headerlink\" title=\"4、finalize()\"></a>4、finalize()</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title function_\">finalize</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Throwable &#123; &#125;</span><br></pre></td></tr></table></figure>\n<p>finalize()方法是一个和Java的垃圾回收机制有关的方法。<br>这个方法会在Java的垃圾回收机制回收对象所占内存之前被调用，即当一个对象被Java虚拟机宣告死亡时会先调用它finalize()方法，让这个对象处理它被回收前的最后事情。<br>如果我们在Java类中覆写了该方法，可以通过覆写的方法，摆脱本身被Java垃圾回收机制回收的命运。<br>对于这个方法，我们只限于了解，并不深究。</p>\n<h2 id=\"5、getClass\"><a href=\"#5、getClass\" class=\"headerlink\" title=\"5、getClass()\"></a>5、getClass()</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">native</span> Class&lt;?&gt; getClass();</span><br></pre></td></tr></table></figure>\n<p>接下来要说的是9个公有方法，也是Java类中最为常用的9个方法。第一个就是getClass()。<br>通过这个方法，可以获取Java对象的字节码对象，具体操作如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>();</span><br><span class=\"line\"><span class=\"type\">Class</span> <span class=\"variable\">clazz</span> <span class=\"operator\">=</span> user.getClass();</span><br></pre></td></tr></table></figure>\n<h2 id=\"6、hashCode\"><a href=\"#6、hashCode\" class=\"headerlink\" title=\"6、hashCode()\"></a>6、hashCode()</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">native</span> <span class=\"type\">int</span> <span class=\"title function_\">hashCode</span><span class=\"params\">()</span>;</span><br></pre></td></tr></table></figure>\n<p>hashCode()方法，可以获取Java对象的哈希码值，具体操作如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>();</span><br><span class=\"line\"><span class=\"type\">int</span> <span class=\"variable\">code</span> <span class=\"operator\">=</span> user.hashCode();</span><br><span class=\"line\">System.out.println(code);</span><br></pre></td></tr></table></figure>\n<p>运行结果如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">366712642</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"7、equals-Object-obj\"><a href=\"#7、equals-Object-obj\" class=\"headerlink\" title=\"7、equals(Object obj)\"></a>7、equals(Object obj)</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">equals</span><span class=\"params\">(Object obj)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (<span class=\"built_in\">this</span> == obj);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>equals(Object obj)方法，其实从源码不难发现，equals方法最底层还是调用了==运算符来实现的，也就是说Object类的equals方法和双等号运算符并没有什么区别。<br>也就是<strong>基本数据类型比较值是否相等，应用数据类型比较内存地址是否相等</strong>。<br>而String类型的equals方法之所以可以比较应用数据类的值是否相等，那是因为String类中重写了equals方法。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>();</span><br><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user2</span> <span class=\"operator\">=</span> user1;</span><br><span class=\"line\">System.out.println(user1 == user2);</span><br></pre></td></tr></table></figure>\n<p>结果如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"8、toString\"><a href=\"#8、toString\" class=\"headerlink\" title=\"8、toString()\"></a>8、toString()</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> String <span class=\"title function_\">toString</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> getClass().getName() + <span class=\"string\">&quot;@&quot;</span> + Integer.toHexString(hashCode());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>toString()方法，在JavaBean中经常被覆写的方法，用于返回对象的字符串表示形式。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>();</span><br><span class=\"line\">System.out.println(user.toString());</span><br></pre></td></tr></table></figure>\n<p>没有被覆写时结果为：（包名+引用内存地址）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">com.day01.object.User@15db9742</span><br></pre></td></tr></table></figure>\n<p>当toString()方法被覆写时：（字符串形式为自己覆写的toString决定）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">User [id=<span class=\"literal\">null</span>, username=<span class=\"literal\">null</span>, password=<span class=\"literal\">null</span>]</span><br></pre></td></tr></table></figure>\n<p>可以一提的是：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">System.out.println(user);</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">System.out.println(user.toString());</span><br></pre></td></tr></table></figure>\n<p>这个两个书写方式都是一样的，打印一个对象时，默认就是调用该对象的toString()方法。</p>\n<h2 id=\"9、notify\"><a href=\"#9、notify\" class=\"headerlink\" title=\"9、notify()\"></a>9、notify()</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title function_\">notify</span><span class=\"params\">()</span>;</span><br></pre></td></tr></table></figure>\n<p>唤醒正在等待对象监视器的单个线程。 </p>\n<h2 id=\"10、notifyAll\"><a href=\"#10、notifyAll\" class=\"headerlink\" title=\"10、notifyAll()\"></a>10、notifyAll()</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title function_\">notifyAll</span><span class=\"params\">()</span>;</span><br></pre></td></tr></table></figure>\n<p>唤醒正在等待对象监视器的所有线程。 </p>\n<h2 id=\"11、wait\"><a href=\"#11、wait\" class=\"headerlink\" title=\"11、wait()\"></a>11、wait()</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title function_\">wait</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">    wait(<span class=\"number\">0</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>导致当前线程等待，直到另一个线程调用该对象的 notify()方法或 notifyAll()方法。 </p>\n<h2 id=\"12、wait-long-timeout\"><a href=\"#12、wait-long-timeout\" class=\"headerlink\" title=\"12、wait(long timeout)\"></a>12、wait(long timeout)</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title function_\">wait</span><span class=\"params\">(<span class=\"type\">long</span> timeout)</span> <span class=\"keyword\">throws</span> InterruptedException;</span><br></pre></td></tr></table></figure>\n<p>导致当前线程等待，直到另一个线程调用 notify()方法或该对象的 notifyAll()方法，或者指定的时间已过。</p>\n<h2 id=\"13、wait-long-timeout-int-nanos\"><a href=\"#13、wait-long-timeout-int-nanos\" class=\"headerlink\" title=\"13、wait(long timeout, int nanos)\"></a>13、wait(long timeout, int nanos)</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title function_\">wait</span><span class=\"params\">(<span class=\"type\">long</span> timeout, <span class=\"type\">int</span> nanos)</span> <span class=\"keyword\">throws</span> InterruptedException &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (timeout &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IllegalArgumentException</span>(<span class=\"string\">&quot;timeout value is negative&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (nanos &lt; <span class=\"number\">0</span> || nanos &gt; <span class=\"number\">999999</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IllegalArgumentException</span>(</span><br><span class=\"line\">                            <span class=\"string\">&quot;nanosecond timeout value out of range&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (nanos &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        timeout++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    wait(timeout);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>导致当前线程等待，直到另一个线程调用该对象的 notify()方法或 notifyAll()方法，或者某些其他线程中断当前线程，或一定量的实时时间。 </p>\n<h1 id=\"四、结束\"><a href=\"#四、结束\" class=\"headerlink\" title=\"四、结束\"></a>四、结束</h1><p>写到这里，Object类的JDK源码也就讲完了。<br>其实我们可以发现，即便是JDK源码，其实也和我们自己写的代码没有太大的区别，我们完全可以自己阅读JDK源码，理解JDK中各个Java类的具体实现，知道JDK源码中的具体运行原理，这对我们学习Java有很大的帮助。<br>JDK源码中，有很多的类都是JDK自己封装的Java类，这些类都是由最基础的Java知识衍生而来，万变不离其宗！</p>\n","categories":["Java"],"tags":["Java","JDK"]},{"title":"Jackson解析Yaml文件报错","url":"/2023/02/09/java/Jackson%E8%A7%A3%E6%9E%90Yaml%E6%96%87%E4%BB%B6%E6%8A%A5%E9%94%99/","content":"<p>今天在使用<code>jackson-dataformat-yaml</code>框架解析<code>Yaml</code>文件的时候，解析过程中爆出了这样一个错误。</p>\n<span id=\"more\"></span>\n<p>错误信息大致如下：</p>\n<blockquote>\n<p>Exception in thread “main” java.lang.NoSuchMethodError: com.fasterxml.jackson.dataformat.yaml.YAMLFactory._createContentReference(Ljava/lang/Object;)Lcom/fasterxml/jackson/core/io/ContentReference;<br>    at com.fasterxml.jackson.dataformat.yaml.YAMLFactory.createParser(YAMLFactory.java:353)<br>    at com.fasterxml.jackson.dataformat.yaml.YAMLFactory.createParser(YAMLFactory.java:15)<br>    at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3413)</p>\n</blockquote>\n<p>这个错误产生的原因是因为，我们的项目同时引入了<code>jackson-databind</code>框架，而<code>jackson-databind</code>框架和<code>jackson-dataformat-yaml</code>框架同时引入了一些<code>jackson</code>相关的核心依赖，且这两个框架的核心依赖版本不一致，导致了报错。</p>\n<p><img src=\"/images/2023/02/12ac822be492400a83ad7a73f0f525d7.png\" alt=\"Maven依赖分析\"></p>\n<p>使用Maven进行依赖分析，我们可以看到：</p>\n<ul>\n<li>我们项目自己引入的<code>jackson-databind</code>框架，且版本较低。</li>\n<li><code>jackson-dataformat-yaml</code>框架依赖了<code>jackson-core</code>、<code>jackson-databind</code>等依赖，且版本较高。</li>\n<li>根据Maven依赖原则，<code>jackson-databind</code>框架的依赖被优先使用（<code>jackson-databind</code>框架在<code>pom.xml</code>文件中被先声明也是导致依赖被优先使用的原因）。</li>\n</ul>\n<p>根据以上的分析，我们可以得到两个解决方案：</p>\n<ul>\n<li><p>根据最少依赖原则，我们可以直接注释<code>pom.xml</code>文件中的<code>jackson-databind</code>框架依赖，这样项目就可以直接依赖<code>jackson-dataformat-yaml</code>框架，且<code>jackson-dataformat-yaml</code>框架中依赖了<code>jackson-databind</code>项目，所以完全不影响项目的正常使用。【推荐该方案】</p>\n</li>\n<li><p>在<code>pom.xml</code>文件中，将<code>jackson-databind</code>框架依赖声明在<code>jackson-dataformat-yaml</code>框架依赖之后。（这个方案本质上和注释<code>jackson-databind</code>依赖区别不大，因为根据Maven依赖原则，这个依赖完全不会被使用。）</p>\n</li>\n</ul>\n","categories":["Java"],"tags":["Java","Jackson","Yaml"]},{"title":"Java main方法中的String[] args","url":"/2021/01/10/java/Java%20main%E6%96%B9%E6%B3%95%E4%B8%AD%E7%9A%84String%5B%5D%20args/","content":"<blockquote>\n<p>在每一个学习Java的同学，都应该写过下面的这一段代码。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Hello</span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\t\tSystem.out.println(<span class=\"string\">&quot;Hello,World!&quot;</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>在Java语言中，规定了入口函数是一个<code>main()</code>方法，该方法有一个<code>String[]</code>类型的参数，但是在很多时候，很多人都使用不上这个参数，也不关心为什么要写这个参数。</p>\n<p>那么这个字符串数组类型的参数究竟是什么东西呢？</p>\n<blockquote>\n<p>其实很简单，main()方法中的字符串数组类型的参数就是java命令的参数，使用java命令的方式运行main()方法，会将java命令的参数入参到Java main()方法的字符串数组参数中。</p>\n</blockquote>\n<p>我们可以通过以下方式来进行验证：</p>\n<ul>\n<li>1、先编写一个Hello.java文件，文件内容如下：</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Hello</span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\t\tSystem.out.println(<span class=\"string\">&quot;==============args start============&quot;</span>);</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; args.length; i++) &#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(args[i]);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\tSystem.out.println(<span class=\"string\">&quot;==============args end============&quot;</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p>2、在<code>Hello.java</code>文件的路径下打开cmd命令提示符，运行<code>javac Hello.java</code>命令编译该文件，这将会在对应的文件路径下，得到一个<code>Hello.class</code>字节码文件。</p>\n</li>\n<li><p>3、使用<code>java Hello</code>命令运行Hello.class文件，我们将会得到如下的运行结果：<br><img src=\"/images/2021/01/20210110215255723.png\" alt=\"在这里插入图片描述\"></p>\n<ul>\n<li>4、我们这次在java命令后面添加一些参数，这些参数我们可以自己定义。<br>例如：<code>java Hello a b c d</code> ，我们将会得到如下的运行结果：<br><img src=\"/images/2021/01/20210110215501851.png\" alt=\"在这里插入图片描述\"><blockquote>\n<p>正是因为Java main()方法的这个扩展性，使得每一个开发者，可以通过自己定义一些Java命令的参数，实现一些不同的功能。</p>\n</blockquote>\n</li>\n</ul>\n</li>\n</ul>\n<p>其中SpringBoot的启动类，其实也使用了这个特性，SpringApplication.run()方法有一个重载方法，其中第一个入参的是注解了<code>@SpringBootApplication</code>注解的类的字节码对象，而第二个参数，即为main()方法的字符串数组参数。</p>\n<p>SpringBoot可以通过这个字符串数组参数，通过<code>java</code>命令参数的方式，在不同的环境下实现不同的应用配置。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyApplication</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        SpringApplication.run(MyApplication.class, args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","categories":["Java"],"tags":["Java"]},{"title":"Java位运算，Int类型存储用户的登录足迹","url":"/2021/08/23/java/Java%E4%BD%8D%E8%BF%90%E7%AE%97%EF%BC%8CInt%E7%B1%BB%E5%9E%8B%E5%AD%98%E5%82%A8%E7%94%A8%E6%88%B7%E7%9A%84%E7%99%BB%E5%BD%95%E8%B6%B3%E8%BF%B9/","content":"<blockquote>\n<p>今天接到一家公司的面试邀请，于是我来到了这家公司，前台的小姐姐面带微笑地把我请进会议室，等待了一会，一位面试官走了进来……</p>\n<p>在进行了简单的自我介绍之后，面试官开始发问了……</p>\n</blockquote>\n<span id=\"more\"></span>\n\n\n\n<p>面试官：你好，请你使用最少的存储空间，记录一个用户在一个月内的登录记录，只需要知道用户在某一日是否登录即可。</p>\n<p>我（略作沉思）：好的，我们可以建立一张登录日志表，在用户登录的时候，记录一条登录日志数据，这张表和用户表是一对多的关系，有用户主键、登录类型、登录时间等等，如果有需要，我们还可以记录用户的登录 IP、登录国家、城市等等信息……</p>\n<p>面试官（面无表情）：……好的，请你回去等我们的通知吧……</p>\n<p>我：……开玩笑的，既然要使用最少的存储空间来实现这个需求，使用传统的数据库记录登录日志的方式自然是难以达到这个条件的，所以我们需要打破传统的存储方式来实现这个需求。</p>\n<p>面试官（略有兴趣）：哦，那你要怎么实现呢？</p>\n<p>我：总所周知，在 Java 中，一个 int 类型所占的内存空间是 4 个字节，而一个字节是 8 个 bit，所以一个 int 类型的数据，所占用的内存空间是 32 个 bit 位，而我的想法就是，使用一个 int 类型的数据，也就是 32 个 bit 位记录用户在一个月内的登录记录。</p>\n<p>面试官（点了点头）：32 个 bit 位，这个存储空间确实非常少，但是具体要怎么实现呢？你详细说说。</p>\n<p>我：我之前也说了，一个 int 类型的数据，占用的内存空间是 32 个 bit 位，而 Java 中的 int 是一个有符号位的数据，除去最高位的符号位之外，在 Java 中一个 int 类型的数据，能够表达状态的一共有 31 个 bit 位。例如，一个值为 0 的 int 类型数据，转换为二进制的 bit 位，显示为 <code>00000000 00000000 00000000 00000000</code>。</p>\n<p>面试官满意地点了点头……</p>\n<p>我：一个 int 类型的 bit 为可以有 0 和 1 两个状态，而且恰好有 31 个 bit 位可用，我们完全可以使用这 31 个 bit 位来记录用户当日是否登录。比如一个用户在 3 号登录了，使用 bit 位表示为： <code>00000000 00000000 00000000 00000100</code> 。而后这个用户在 5 号也登录，使用 bit 位可以表示为： <code>00000000 00000000 00000000 00010100</code> 。依次类推，一个月最多也就 31 天，假如一个用户在一个大月中每天都登录，使用 bit 位可以表示为： <code>01111111 11111111 11111111 11111111</code> 。最后，我们将这个二进制的 bit 数据转换为 int 类型即可。</p>\n<p>面试官：思路不错，但是具体要怎么实现呢？如果将一个 int 类型的数据转换为二进制的 bit 位数据，具体的算法实现会不会非常麻烦呢？程序的执行效率会不会很慢呢？</p>\n<p>我（面带自信）：我的实现很简单，而且程序的执行效率也非常快，甚至要比 Java 中的其他运算都要快！</p>\n<p>面试官：哦……</p>\n<p>我：我的实现方式，就是使用 Java 中的位运算来实现，使用位运算，不仅实现简单，而且运行效率远比其他符号运算快！</p>\n<p>面试官（递过来一张纸）：请你在草稿纸上简单实现一下吧。</p>\n<p>我：……</p>\n<p>我：首先定义一个私有的 int 类型的数据。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">login</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>我：其次，我们需要两个公有的方法，用来操作这个 int 类型的数据。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">setBit</span><span class=\"params\">(<span class=\"type\">int</span> bitIndex)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (bitIndex &lt; <span class=\"number\">0</span> || bitIndex &gt; <span class=\"number\">30</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IndexOutOfBoundsException</span>(<span class=\"string\">&quot;超过 int 类型 bit 位的有效范围&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    login |= <span class=\"number\">1</span> &lt;&lt; bitIndex;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">boolean</span> <span class=\"title function_\">getBit</span><span class=\"params\">(<span class=\"type\">int</span> bitIndex)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (bitIndex &lt; <span class=\"number\">0</span> || bitIndex &gt; <span class=\"number\">30</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IndexOutOfBoundsException</span>(<span class=\"string\">&quot;超过 int 类型 bit 位的有效范围&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (login &amp; <span class=\"number\">1</span> &lt;&lt; bitIndex) != <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>我：最后，我们可以测试一下这个方法。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">    setBit(<span class=\"number\">0</span>);</span><br><span class=\"line\">    setBit(<span class=\"number\">3</span>);</span><br><span class=\"line\">    setBit(<span class=\"number\">4</span>);</span><br><span class=\"line\">    setBit(<span class=\"number\">16</span>);</span><br><span class=\"line\">    setBit(<span class=\"number\">30</span>);</span><br><span class=\"line\">    System.out.println(Integer.toBinaryString(login));  <span class=\"comment\">// 1000000 00000001 00000000 00011001</span></span><br><span class=\"line\">    System.out.println(getBit(<span class=\"number\">0</span>));   <span class=\"comment\">// true</span></span><br><span class=\"line\">    System.out.println(getBit(<span class=\"number\">1</span>));   <span class=\"comment\">// false</span></span><br><span class=\"line\">    System.out.println(getBit(<span class=\"number\">2</span>));   <span class=\"comment\">// false</span></span><br><span class=\"line\">    System.out.println(getBit(<span class=\"number\">3</span>));   <span class=\"comment\">// true</span></span><br><span class=\"line\">    System.out.println(getBit(<span class=\"number\">30</span>));  <span class=\"comment\">// true</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>我：在这段代码中，我没有对日期进行一个真实数据的维护，比如 1 号对应的是 0 位的 bit 位，31 号对应的是 30 位的 bit 位，所以在正式使用的时候，需要手动对真实的日期数据进行 -1 维护。</p>\n<p>面试官（面露微笑）：精彩！精彩啊！很好，我们公司就需要你这也的人才，明天来我们公司报道吧！</p>\n<p>我（激动）：好的，请问我的薪资是……</p>\n<p>面试官（沉吟片刻）：就 3k 吧。</p>\n<p>我：……&amp;#￥$@@*&amp;^%……</p>\n","categories":["Java"],"tags":["Java"]},{"title":"Java基础——File类和IO","url":"/2020/03/09/java/Java%E5%9F%BA%E7%A1%80%E2%80%94%E2%80%94File%E7%B1%BB%E5%92%8CIO/","content":"<h2 id=\"File类\"><a href=\"#File类\" class=\"headerlink\" title=\"File类\"></a>File类</h2><p>File是Java中的文件类，用于处理和文件相关的一些操作，例如文件的创建，删除等等。</p>\n<span id=\"more\"></span>\n<p><strong>构造方法</strong></p>\n<ul>\n<li>File(File parent, String child)<br>从父抽象路径名和子路径名字符串创建新的 File实例。 </li>\n<li>File(String parent, String child)<br>从父路径名字符串和子路径名字符串创建新的 File实例。 </li>\n<li>File(String pathname)<br>通过将给定的路径名字符串转换为抽象路径名来创建新的 File实例。 </li>\n<li>File(URI uri)<br>通过将给定的 file: URI转换为抽象路径名来创建新的 File实例。 </li>\n</ul>\n<p><strong>常用方法</strong></p>\n<ul>\n<li>boolean mkdir()<br>创建由此抽象路径名命名的目录。  </li>\n<li>boolean mkdirs()<br>创建由此抽象路径名命名的目录，包括任何必需但不存在的父目录。  </li>\n<li>boolean delete()<br>删除由此抽象路径名表示的文件或目录。  </li>\n<li>boolean exists()<br>测试此抽象路径名表示的文件或目录是否存在。  </li>\n<li>String getName()<br>返回由此抽象路径名表示的文件或目录的名称。</li>\n<li>String getPath()<br>将此抽象路径名转换为路径名字符串。</li>\n<li>boolean isDirectory()<br>测试此抽象路径名表示的文件是否为目录。  </li>\n<li>boolean isFile()<br>测试此抽象路径名表示的文件是否为普通文件。  </li>\n<li>String[] list()<br>返回一个字符串数组，命名由此抽象路径名表示的目录中的文件和目录。  </li>\n</ul>\n<h2 id=\"IO流\"><a href=\"#IO流\" class=\"headerlink\" title=\"IO流\"></a>IO流</h2><p>所谓IO流，便是Input和Output，即输入流和输出流，具体是指文件的输入流和输出流。<br>IO流分为很多类，其中最为常用的就是IO字节流和IO字符流，除此之外，还有缓冲流，转换流，序列化流，打印流等等。</p>\n<p><strong>IO字节流</strong><br>IO字节流有两个上层接口，分别是InputStream和OutputStream接口，我们常用的具体实现类有FileInputStream和FileOutputStream，即文件输入字节流和文件输出字节流。</p>\n<ul>\n<li>FileInputStream</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>常用方法</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>int read(byte[] b)</td>\n<td>从输入流读取一些字节数，并将它们存储到缓冲区 b 。</td>\n</tr>\n<tr>\n<td>void close()</td>\n<td>关闭此输入流并释放与流相关联的任何系统资源。</td>\n</tr>\n</tbody></table>\n<ul>\n<li>FileOutputStream</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>常用方法</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>void write(byte[] b, int off, int len)</td>\n<td>从指定的字节数组写入 len个字节，从偏移 off开始输出到此输出流。</td>\n</tr>\n<tr>\n<td>void flush()</td>\n<td>刷新此输出流并强制任何缓冲的输出字节被写出。</td>\n</tr>\n<tr>\n<td>void close()</td>\n<td>关闭此输出流并释放与此流相关联的任何系统资源。</td>\n</tr>\n</tbody></table>\n<p><strong>IO字节流代码示例：</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">\t<span class=\"type\">FileInputStream</span> <span class=\"variable\">fis</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">FileInputStream</span>(<span class=\"string\">&quot;a.txt&quot;</span>);</span><br><span class=\"line\">\t<span class=\"type\">FileOutputStream</span> <span class=\"variable\">fos</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">FileOutputStream</span>(<span class=\"string\">&quot;b.txt&quot;</span>);</span><br><span class=\"line\">\t<span class=\"type\">byte</span>[] bytes = <span class=\"keyword\">new</span> <span class=\"title class_\">byte</span>[<span class=\"number\">1024</span>];</span><br><span class=\"line\">\t<span class=\"type\">int</span> <span class=\"variable\">len</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">while</span>((len = fis.read(bytes)) != -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\tfos.write(bytes,<span class=\"number\">0</span>,len);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tfos.flush();</span><br><span class=\"line\">\tfos.close();</span><br><span class=\"line\">\tfis.close();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>IO字符流</strong><br>IO字符流有两个上层接口，分别是Reader和Writer接口，我们常用的具体实现类有FileReader和FileWriter，即文件输入字符流和文件输出字符流。</p>\n<ul>\n<li>FileReader</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>常用方法</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>int read(char ch)</td>\n<td>从输入流读取一些字符数，并将它们存储到缓冲区 b 。</td>\n</tr>\n<tr>\n<td>void close()</td>\n<td>关闭此输入流并释放与流相关联的任何系统资源。</td>\n</tr>\n</tbody></table>\n<ul>\n<li>FileWriter</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>常用方法</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>void write(char[] b, int off, int len)</td>\n<td>从指定的字符数组写入 len个字节，从偏移 off开始输出到此输出流。</td>\n</tr>\n<tr>\n<td>void flush()</td>\n<td>刷新此输出流并强制任何缓冲的输出字符被写出。</td>\n</tr>\n<tr>\n<td>void close()</td>\n<td>关闭此输出流并释放与此流相关联的任何系统资源。</td>\n</tr>\n</tbody></table>\n<p><strong>IO字符流代码示例：</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">\t<span class=\"type\">FileReader</span> <span class=\"variable\">fr</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">FileReader</span>(<span class=\"string\">&quot;a.txt&quot;</span>);</span><br><span class=\"line\">\t<span class=\"type\">FileWriter</span> <span class=\"variable\">fw</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">FileWriter</span>(<span class=\"string\">&quot;b.txt&quot;</span>);</span><br><span class=\"line\">\t<span class=\"type\">char</span>[] ch = <span class=\"keyword\">new</span> <span class=\"title class_\">char</span>[<span class=\"number\">1024</span>];</span><br><span class=\"line\">\t<span class=\"type\">int</span> <span class=\"variable\">len</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">while</span>((len = fr.read(ch)) != -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\tfw.write(ch,<span class=\"number\">0</span>,len);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tfw.flush();</span><br><span class=\"line\">\tfw.close();</span><br><span class=\"line\">\tfr.close();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"缓冲流\"><a href=\"#缓冲流\" class=\"headerlink\" title=\"缓冲流\"></a>缓冲流</h2><p><strong>缓冲字节流</strong></p>\n<ul>\n<li>BufferedInputStream(InputStream in)<br>创建一个 BufferedInputStream并保存其参数，输入流 in ，供以后使用。 </li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>常用方法</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>int read(byte[] b, int off, int len)</td>\n<td>从给定的偏移开始，将字节输入流中的字节读入指定的字节数组。</td>\n</tr>\n<tr>\n<td>void close()</td>\n<td>关闭此输入流并释放与流相关联的任何系统资源。</td>\n</tr>\n</tbody></table>\n<ul>\n<li>BufferedOutputStream(OutputStream out)<br>创建一个新的缓冲输出流，以将数据写入指定的底层输出流。 </li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>常用方法</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>void write(byte[] b, int off, int len)</td>\n<td>从指定的字节数组写入 len个字节，从偏移 off开始到缓冲的输出流。</td>\n</tr>\n<tr>\n<td>void flush()</td>\n<td>刷新缓冲输出流。</td>\n</tr>\n<tr>\n<td>void close()</td>\n<td>关闭此输出流并释放与流相关联的任何系统资源。</td>\n</tr>\n</tbody></table>\n<p><strong>缓冲字节流代码示例：</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> Exception&#123;</span><br><span class=\"line\">\t<span class=\"type\">BufferedInputStream</span> <span class=\"variable\">bis</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">BufferedInputStream</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">FileInputStream</span>(<span class=\"string\">&quot;a.txt&quot;</span>));</span><br><span class=\"line\">\t<span class=\"type\">BufferedOutputStream</span> <span class=\"variable\">bos</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">BufferedOutputStream</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">FileOutputStream</span>(<span class=\"string\">&quot;b.txt&quot;</span>));</span><br><span class=\"line\">\t<span class=\"type\">byte</span>[] bytes = <span class=\"keyword\">new</span> <span class=\"title class_\">byte</span>[<span class=\"number\">1024</span>];</span><br><span class=\"line\">\t<span class=\"type\">int</span> <span class=\"variable\">len</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">while</span>((len = bis.read(bytes)) != -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\tbos.write(bytes,<span class=\"number\">0</span>,len);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tbos.flush();</span><br><span class=\"line\">\tbos.close();</span><br><span class=\"line\">\tbis.close();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>缓冲字符流</strong></p>\n<ul>\n<li>BufferedReader(Reader in)<br>创建使用默认大小的输入缓冲区的缓冲字符输入流。 </li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>常用方法</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>int read(char[] cbuf, int off, int len)</td>\n<td>将字符读入数组的一部分。</td>\n</tr>\n<tr>\n<td>String readLine()</td>\n<td>读一行文字。</td>\n</tr>\n<tr>\n<td>void close()</td>\n<td>关闭流并释放与之相关联的任何系统资源。</td>\n</tr>\n</tbody></table>\n<ul>\n<li>BufferedWriter(Writer out)<br>创建使用默认大小的输出缓冲区的缓冲字符输出流。 </li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>常用方法</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>void write(char[] cbuf, int off, int len)</td>\n<td>写入字符数组的一部分。</td>\n</tr>\n<tr>\n<td>void newLine()</td>\n<td>写一行行分隔符。</td>\n</tr>\n<tr>\n<td>void flush()</td>\n<td>刷新流。</td>\n</tr>\n<tr>\n<td>void close()</td>\n<td>关闭流，先刷新。</td>\n</tr>\n</tbody></table>\n<p><strong>缓冲字符流代码示例：</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">\t<span class=\"type\">BufferedReader</span> <span class=\"variable\">br</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">BufferedReader</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">FileReader</span>(<span class=\"string\">&quot;a.txt&quot;</span>));</span><br><span class=\"line\">\t<span class=\"type\">BufferedWriter</span> <span class=\"variable\">bw</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">BufferedWriter</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">FileWriter</span>(<span class=\"string\">&quot;b.txt&quot;</span>));</span><br><span class=\"line\">\t<span class=\"type\">String</span> <span class=\"variable\">line</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">while</span>((line = br.readLine()) != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">\t\tbw.write(line);</span><br><span class=\"line\">\t\tbw.newLine();</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tbw.close();</span><br><span class=\"line\">\tbr.close();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"转换流\"><a href=\"#转换流\" class=\"headerlink\" title=\"转换流\"></a>转换流</h2><ul>\n<li>InputStreamReader(InputStream in, String charsetName)<br>创建一个使用命名字符集的InputStreamReader。 </li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>常用方法</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>int read(char[] cbuf, int offset, int length)</td>\n<td>将字符读入数组的一部分。</td>\n</tr>\n<tr>\n<td>void close()</td>\n<td>关闭流并释放与之相关联的任何系统资源。</td>\n</tr>\n<tr>\n<td>String getEncoding()</td>\n<td>返回此流使用的字符编码的名称。</td>\n</tr>\n</tbody></table>\n<ul>\n<li>OutputStreamWriter(OutputStream out, String charsetName)<br>创建一个使用命名字符集的OutputStreamWriter。 </li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>常用方法</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>void write(char[] cbuf, int off, int len)</td>\n<td>写入字符数组的一部分。</td>\n</tr>\n<tr>\n<td>void flush()</td>\n<td>刷新流。</td>\n</tr>\n<tr>\n<td>void close()</td>\n<td>关闭流，先刷新。</td>\n</tr>\n<tr>\n<td>String getEncoding()</td>\n<td>返回此流使用的字符编码的名称。</td>\n</tr>\n</tbody></table>\n<p><strong>转换流代码示例：</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">\t<span class=\"type\">InputStreamReader</span> <span class=\"variable\">isr</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">InputStreamReader</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">FileInputStream</span>(<span class=\"string\">&quot;a.txt&quot;</span>),<span class=\"string\">&quot;UTF-8&quot;</span>);</span><br><span class=\"line\">\t<span class=\"type\">OutputStreamWriter</span> <span class=\"variable\">osw</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">OutputStreamWriter</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">FileOutputStream</span>(<span class=\"string\">&quot;b.txt&quot;</span>),<span class=\"string\">&quot;UTF-8&quot;</span>);</span><br><span class=\"line\">\t<span class=\"type\">char</span>[] ch = <span class=\"keyword\">new</span> <span class=\"title class_\">char</span>[<span class=\"number\">1024</span>];</span><br><span class=\"line\">\t<span class=\"type\">int</span> <span class=\"variable\">len</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">while</span>((len = isr.read(ch)) != -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\tosw.write(ch,<span class=\"number\">0</span>,len);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tosw.close();</span><br><span class=\"line\">\tisr.close();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"序列化流\"><a href=\"#序列化流\" class=\"headerlink\" title=\"序列化流\"></a>序列化流</h2><ul>\n<li>ObjectInputStream(InputStream in)<br>反序列化流：创建从指定的InputStream读取的ObjectInputStream。 </li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>常用方法</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Object readObject()</td>\n<td>从ObjectInputStream读取一个对象。</td>\n</tr>\n<tr>\n<td>int read(byte[] buf, int off, int len)</td>\n<td>读入一个字节数组。</td>\n</tr>\n</tbody></table>\n<ul>\n<li>ObjectOutputStream(OutputStream out)<br>序列化流：创建一个写入指定的OutputStream的ObjectOutputStream。 </li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>常用方法</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>void writeObject(Object obj)</td>\n<td>将指定的对象写入ObjectOutputStream。</td>\n</tr>\n<tr>\n<td>void write(byte[] buf, int off, int len)</td>\n<td>写入一个子字节数组。</td>\n</tr>\n</tbody></table>\n<p>【注意】需要序列化的对象，必须要实现Serializable接口。</p>\n<p><strong>序列化流代码示例：</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class=\"line\">\t<span class=\"type\">ObjectOutputStream</span> <span class=\"variable\">oos</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ObjectOutputStream</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">FileOutputStream</span>(<span class=\"string\">&quot;a.txt&quot;</span>));</span><br><span class=\"line\">\t<span class=\"type\">ObjectInputStream</span> <span class=\"variable\">ois</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ObjectInputStream</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">FileInputStream</span>(<span class=\"string\">&quot;a.txt&quot;</span>));</span><br><span class=\"line\">\toos.writeObject(<span class=\"keyword\">new</span> <span class=\"title class_\">User</span>(<span class=\"number\">1</span>,<span class=\"string\">&quot;张三&quot;</span>,<span class=\"string\">&quot;123&quot;</span>));</span><br><span class=\"line\">\t<span class=\"type\">User</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> (User) ois.readObject();</span><br><span class=\"line\">\tSystem.out.println(user);</span><br><span class=\"line\">\toos.close();</span><br><span class=\"line\">\tois.close();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"打印流\"><a href=\"#打印流\" class=\"headerlink\" title=\"打印流\"></a>打印流</h2><ul>\n<li>PrintStream(File file)<br>使用指定的文件创建一个新的打印流，而不需要自动换行。 </li>\n<li>PrintStream(String fileName)<br>使用指定的文件名创建新的打印流，无需自动换行。 </li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>常用方法</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>void print(String s)</td>\n<td>打印字符串。</td>\n</tr>\n</tbody></table>\n<p><strong>System.out的本质就是一个打印流</strong></p>\n<p><strong>打印流代码示例：</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> FileNotFoundException &#123;</span><br><span class=\"line\">\t<span class=\"type\">PrintStream</span> <span class=\"variable\">out</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">PrintStream</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">File</span>(<span class=\"string\">&quot;a.txt&quot;</span>));</span><br><span class=\"line\">\tout.print(<span class=\"string\">&quot;打印流&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"思维导图\"><a href=\"#思维导图\" class=\"headerlink\" title=\"思维导图\"></a>思维导图</h2><p><img src=\"/images/2020/03/20200309001534514.png\" alt=\"在这里插入图片描述\"><br><img src=\"/images/2020/03/20200309002348424.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["Java"],"tags":["Java"]},{"title":"Java基础——GC机制","url":"/2020/03/10/java/Java%E5%9F%BA%E7%A1%80%E2%80%94%E2%80%94GC%E6%9C%BA%E5%88%B6/","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>Java语言的一大特点就是，Java有自动回收内存的GC机制，程序不需要手动释放内存空间，这样一来就使得程序员在代码设计的时候省去了很多的事情，而且也不需要再考虑内存泄露的问题。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"JavaGC机制原理\"><a href=\"#JavaGC机制原理\" class=\"headerlink\" title=\"JavaGC机制原理\"></a>JavaGC机制原理</h2><ul>\n<li>垃圾回收器通常作为一个单独的低级别的线程运行，在不可预知的情况下对内存堆中已经死亡的或很长时间没有用过的对象进行清除和回收。</li>\n<li>程序员不能实时的对某个对象或所有对象调用垃圾回收器进行垃圾回收。</li>\n<li>程序员可以手动执行System.gc()，通知GC运行，但是Java语言规范并不保证GC一定会执行。</li>\n</ul>\n<p><strong>【注意】JavaGC机制表明，Java程序一定是一个多线程程序，最起码运行了main线程和GC线程。</strong></p>\n<h2 id=\"Java的四种引用类型\"><a href=\"#Java的四种引用类型\" class=\"headerlink\" title=\"Java的四种引用类型\"></a>Java的四种引用类型</h2><ul>\n<li>强引用：发生 gc 的时候不会被回收。</li>\n<li>软引用：有用但不是必须的对象，在发生内存溢出之前会被回收。</li>\n<li>弱引用：有用但不是必须的对象，在下一次GC时会被回收。</li>\n<li>虚引用（幽灵引用/幻影引用）：无法通过虚引用获得对象，用 PhantomReference 实现虚引用，虚引用的用途是在 gc 时返回一个通知。</li>\n</ul>\n<h2 id=\"JVM永久代\"><a href=\"#JVM永久代\" class=\"headerlink\" title=\"JVM永久代\"></a>JVM永久代</h2><ul>\n<li>垃圾回收不会发生在永久代，如果永久代满了或者是超过了临界值，会触发<strong>完全垃圾回收(Full GC)</strong>。如果你仔细查看垃圾收集器的输出信息，就会发现永久代也是被回收的。这就是为什么正确的永久代大小对避免Full GC是非常重要的原因。</li>\n</ul>\n<p><strong>【注意】Java8中已经移除了永久代，新加了一个叫做元数据区的native内存区。</strong></p>\n<h2 id=\"垃圾回收算法\"><a href=\"#垃圾回收算法\" class=\"headerlink\" title=\"垃圾回收算法\"></a>垃圾回收算法</h2><ul>\n<li><strong>标记-清除算法：</strong> 标记无用对象，然后进行清除回收。缺点：效率不高，无法清除垃圾碎片。</li>\n<li><strong>复制算法：</strong> 按照容量划分二个大小相等的内存区域，当一块用完的时候将活着的对象复制到另一块上，然后再把已使用的内存空间一次清理掉。缺点：内存使用率不高，只有原来的一半。</li>\n<li><strong>标记-整理算法：</strong> 标记无用对象，让所有存活的对象都向一端移动，然后直接清除掉端边界以外的内存。</li>\n<li><strong>分代收集算法：</strong> 根据对象存活周期的不同将内存划分为几块，一般是新生代和老年代，<code>新生代基本采用复制算法，老年代采用标记整理算法</code>。</li>\n</ul>\n<h2 id=\"思维导图\"><a href=\"#思维导图\" class=\"headerlink\" title=\"思维导图\"></a>思维导图</h2><p><img src=\"/images/2020/03/20200310105337178.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["Java"],"tags":["Java"]},{"title":"Java基础——JDK，JRE，JVM","url":"/2020/03/04/java/Java%E5%9F%BA%E7%A1%80%E2%80%94%E2%80%94JDK%EF%BC%8CJRE%EF%BC%8CJVM/","content":"<h2 id=\"JDK，JRE，JVM是什么\"><a href=\"#JDK，JRE，JVM是什么\" class=\"headerlink\" title=\"JDK，JRE，JVM是什么\"></a>JDK，JRE，JVM是什么</h2><p><strong>JDK</strong>全称为Java Development Kit（Java开发工具包），提供了Java语言开发的一系列工具，可以用来运行，编译Java程序。<br><strong>JRE</strong>全称为Java Runtime Environment（Java运行环境），是Java语言的运行环境。<br><strong>JVM</strong>全称为Java Virtual Machine（Java虚拟机），是一种计算机平台的规范，是一种虚拟的计算机，JVM是专门用来运行Java程序的，不同的操作系统中，可以安装与操作系统适应的JVM。</p>\n<span id=\"more\"></span>\n<p>【<strong>注意</strong>】</p>\n<ul>\n<li>JDK和JRE并不是包含与被包含的关系，因为JDK是Java开发工具包，而JRE是Java运行环境。如果我们只需要进行Java开发，那么只需要安装JDK即可，同理，如果我们只是需要进行Java程序的运行，那么只安装JRE即可。<strong>但是，在一般的JDK中，都会包含JRE，所以我们日常所说的JDK，其实也都是指包含了JRE的JDK</strong>。</li>\n<li>不同的操作系统需要安装相对应的JVM，这也是Java程序为什么可以跨平台运行的原因，因为<strong>不同操作系统的JVM屏蔽了Java程序与操作系统之间的联系</strong>。</li>\n</ul>\n<h2 id=\"JVM的组成\"><a href=\"#JVM的组成\" class=\"headerlink\" title=\"JVM的组成\"></a>JVM的组成</h2><p>Java虚拟机一共由两部分组成，分别是两个子系统和两个组件。</p>\n<p><strong>两个子系统</strong></p>\n<ul>\n<li><strong>类加载</strong>（Class loader）：根据给定的全限定名类名来装载class文件到Runtime data area中的method area。</li>\n<li><strong>执行引擎</strong>（Execution engine）：执行classes中的指令。执行引擎包含即时编译器和垃圾回收器。</li>\n</ul>\n<p><strong>两个组件</strong></p>\n<ul>\n<li><strong>本地接口</strong>（Native Interface）：与native libraries交互，是其它编程语言交互的接口。</li>\n<li><strong>运行时数据区</strong>（Runtime data area）：这就是我们常说的JVM的内存。</li>\n</ul>\n<h2 id=\"JVM的内存\"><a href=\"#JVM的内存\" class=\"headerlink\" title=\"JVM的内存\"></a>JVM的内存</h2><p>JVM的内存，即运行时数据区，分为两个区域，分别是<strong>线程隔离数据区</strong>和<strong>线程共享数据区</strong>。</p>\n<p><strong>线程隔离数据区</strong></p>\n<ul>\n<li><strong>程序计数器</strong>：当前线程所执行的字节码的行号指示器，字节码解析器的工作是通过改变这个计数器的值，来选取下一条需要执行的字节码指令，分支、循环、跳转、异常处理、线程恢复等基础功能，都需要依赖这个计数器来完成。</li>\n<li><strong>本地方法栈</strong>：与虚拟机栈的作用是一样的，只不过虚拟机栈是服务 Java 方法的，而本地方法栈是为虚拟机调用 Native 方法服务的。</li>\n<li><strong>Java虚拟机栈</strong>：用于存储局部变量表、操作数栈、动态链接、方法出口等信息。</li>\n</ul>\n<p><strong>线程共享数据区</strong></p>\n<ul>\n<li><strong>Java堆</strong>：Java 虚拟机中内存最大的一块，是被所有线程共享的，几乎所有的对象实例都在这里分配内存。</li>\n<li><strong>方法区</strong>：用于存储已被虚拟机加载的类信息、常量、静态变量、即时编译后的代码等数据。</li>\n</ul>\n<h2 id=\"JVM调优\"><a href=\"#JVM调优\" class=\"headerlink\" title=\"JVM调优\"></a>JVM调优</h2><table>\n<thead>\n<tr>\n<th>JVM调优参数</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>-Xms2g</td>\n<td>初始化推大小为 2g</td>\n</tr>\n<tr>\n<td>-Xmx2g</td>\n<td>堆最大内存为 2g</td>\n</tr>\n<tr>\n<td>-XX:NewRatio=4</td>\n<td>设置年轻的和老年代的内存比例为 1:4</td>\n</tr>\n<tr>\n<td>-XX:SurvivorRatio=8</td>\n<td>设置新生代 Eden 和 Survivor 比例为 8:2</td>\n</tr>\n<tr>\n<td>–XX:+UseParNewGC</td>\n<td>指定使用 ParNew + Serial Old 垃圾回收器组合</td>\n</tr>\n<tr>\n<td>-XX:+UseParallelOldGC</td>\n<td>指定使用 ParNew + ParNew Old 垃圾回收器组合</td>\n</tr>\n<tr>\n<td>-XX:+UseConcMarkSweepGC</td>\n<td>指定使用 CMS + Serial Old 垃圾回收器组合</td>\n</tr>\n<tr>\n<td>-XX:+PrintGC</td>\n<td>开启打印 gc 信息</td>\n</tr>\n<tr>\n<td>-XX:+PrintGCDetails</td>\n<td>打印 gc 详细信息</td>\n</tr>\n</tbody></table>\n<h2 id=\"思维导图\"><a href=\"#思维导图\" class=\"headerlink\" title=\"思维导图\"></a>思维导图</h2><p><img src=\"/images/2020/03/20200304165045887.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["Java"],"tags":["Java","JDK","JVM"]},{"title":"Java基础——Java数据类型","url":"/2020/03/03/java/Java%E5%9F%BA%E7%A1%80%E2%80%94%E2%80%94Java%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/","content":"<p>Java语言中数据类型主要分为两大类：<strong>基本数据类型</strong>和<strong>引用数据类型</strong>。</p>\n<span id=\"more\"></span>\n<h2 id=\"基本数据类型\"><a href=\"#基本数据类型\" class=\"headerlink\" title=\"基本数据类型\"></a>基本数据类型</h2><p>基本数据类型，顾名思义，这是Java中最为基本的数据类型，Java中所有的数据都是以基本数据类型为底层基础而进行存储或保存的。<br>Java中基本数据类型有四类八种，四类分别是整数型，浮点型，字符型，布尔型。<br>八种数据类型中，整数型有四种，浮点型有两种，字符型一种，布尔型一种。</p>\n<p><strong>整数型</strong>：默认初始化值为0。</p>\n<ul>\n<li>byte：字节型，长度大小为1个字节。</li>\n<li>short：短整型，长度大小为2个字节。</li>\n<li>int：整型，长度大小为4个字节。</li>\n<li>long：长整型，长度大小为8个字节。</li>\n</ul>\n<p><strong>浮点型</strong>：默认初始化值为0.0。</p>\n<ul>\n<li>float：单精度浮点型，长度大小为4个字节。</li>\n<li>double：双精度浮点型，长度大小为8个字节。</li>\n</ul>\n<p><strong>字符型</strong>：默认初始化值为” “。</p>\n<ul>\n<li>char：字符型，长度大小为2个字节。</li>\n</ul>\n<p><strong>布尔型</strong>：默认初始化值为false。</p>\n<ul>\n<li>boolean：布尔型，长度大小为1/8个字节，即1位二进制。</li>\n</ul>\n<h2 id=\"基本数据类型的包装类型\"><a href=\"#基本数据类型的包装类型\" class=\"headerlink\" title=\"基本数据类型的包装类型\"></a>基本数据类型的包装类型</h2><p>Java中为每一个基本数据类型都设计了一个包装类型，八种基本数据类型和它们各自的包装类型对应如下：</p>\n<table>\n<thead>\n<tr>\n<th>数据类型名称</th>\n<th>基本数据类型</th>\n<th>包装类型</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>字节型</td>\n<td>byte</td>\n<td>Byte</td>\n</tr>\n<tr>\n<td>短整型</td>\n<td>short</td>\n<td>Short</td>\n</tr>\n<tr>\n<td>整型</td>\n<td>int</td>\n<td>Integer</td>\n</tr>\n<tr>\n<td>长整型</td>\n<td>long</td>\n<td>Long</td>\n</tr>\n<tr>\n<td>单精度浮点型</td>\n<td>float</td>\n<td>Float</td>\n</tr>\n<tr>\n<td>双精度浮点型</td>\n<td>double</td>\n<td>Double</td>\n</tr>\n<tr>\n<td>字符型</td>\n<td>char</td>\n<td>Character</td>\n</tr>\n<tr>\n<td>布尔型</td>\n<td>boolean</td>\n<td>Boolean</td>\n</tr>\n</tbody></table>\n<p>基本数据类型与包装类型的区别：</p>\n<ul>\n<li>包装类型的初始化值为null，而基本数据类型不可以为null。</li>\n<li>包装类型可以运用在泛型上，而基本数据类型不可以。</li>\n<li>基本数据类型的执行效率比包装类型要快。</li>\n<li>基本数据类型转换为包装类型叫装箱，而包装类型转换为基本数据类型叫拆箱。</li>\n</ul>\n<p>【<strong>注意</strong>】包装类型是引用数据类型。<br>【<strong>注意</strong>】整型的包装类型，在进行装箱的过程中，如果数据在-128至127之间，那么会使用包装类型中的缓存，而不会重新创建新对象。</p>\n<h2 id=\"引用数据类型\"><a href=\"#引用数据类型\" class=\"headerlink\" title=\"引用数据类型\"></a>引用数据类型</h2><p>引用数据类型分为三种，分别是类，接口，数组。<br>它们的初始化值均为null。</p>\n<ul>\n<li><strong>类</strong>：关键字为class。</li>\n<li><strong>接口</strong>：关键字为interface。</li>\n<li><strong>数组</strong>：关键字为[]。</li>\n</ul>\n<h2 id=\"基本数据类型和引用数据类型的区别\"><a href=\"#基本数据类型和引用数据类型的区别\" class=\"headerlink\" title=\"基本数据类型和引用数据类型的区别\"></a>基本数据类型和引用数据类型的区别</h2><table>\n<thead>\n<tr>\n<th>基本数据类型</th>\n<th>引用数据类型</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>基本数据类型不可以为null值</td>\n<td>引用数据类型的初始化值为null</td>\n</tr>\n<tr>\n<td>基本数据类型指向的是内存中的具体的值</td>\n<td>引用数据类型指向的是内存地址的引用</td>\n</tr>\n<tr>\n<td>基本数据类型使用==比较是值</td>\n<td>引用数据类型使用==比较是内存地址的引用</td>\n</tr>\n</tbody></table>\n<p><img src=\"/images/2020/03/20200303221136577.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["Java"],"tags":["Java"]},{"title":"Java基础——多线程","url":"/2020/03/10/java/Java%E5%9F%BA%E7%A1%80%E2%80%94%E2%80%94%E5%A4%9A%E7%BA%BF%E7%A8%8B/","content":"<h2 id=\"线程和进程\"><a href=\"#线程和进程\" class=\"headerlink\" title=\"线程和进程\"></a>线程和进程</h2><p><strong>进程：</strong> 是执行中一段程序，即一旦程序被载入到内存中并准备执行，它就是一个进程。进程是表示资源分配的的基本概念，又是调度运行的基本单位，是系统中的并发执行的单位。</p>\n<p><strong>线程：</strong> 单个进程中执行中每个任务就是一个线程。线程是进程中执行运算的最小单位。</p>\n<span id=\"more\"></span>\n<p><strong>进程和线程的区别</strong></p>\n<table>\n<thead>\n<tr>\n<th>进程</th>\n<th>线程</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>资源分配的基本概念，调度运行的基本单位，系统中并发执行的单位</td>\n<td>执行运算的最小单位，是程序运行的最小单位</td>\n</tr>\n<tr>\n<td>一个进程可以有很多个线程</td>\n<td>一个线程只能属于一个进程</td>\n</tr>\n<tr>\n<td>切换进程系统开销大，创建进程比较消耗性能</td>\n<td>切换线程系统开销小，创建线程性能消耗较小</td>\n</tr>\n<tr>\n<td>进程有独立的内存空间和系统资源</td>\n<td>所有线程共享进程中的内存空间和系统资源</td>\n</tr>\n<tr>\n<td>父子进程之间使用进程通信机制进行通信</td>\n<td>同一进程的线程使用进程变量来进行通信</td>\n</tr>\n<tr>\n<td>进程死亡之后，不会影响其它进程</td>\n<td>线程死掉，会导致整个进程死亡</td>\n</tr>\n</tbody></table>\n<h2 id=\"线程的创建方式\"><a href=\"#线程的创建方式\" class=\"headerlink\" title=\"线程的创建方式\"></a>线程的创建方式</h2><p>在Java中，线程的创建方式一共有4中。</p>\n<p><strong>1、继承Thread类，并重写run方法。</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyThread</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Thread</span>&#123;</span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span> ;i &lt; <span class=\"number\">10</span>; i ++) &#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(getName()+<span class=\"string\">&quot;---&quot;</span>+i);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>创建线程，并开启线程。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\t<span class=\"type\">MyThread</span> <span class=\"variable\">myThread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyThread</span>();</span><br><span class=\"line\">\tmyThread.start();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>【注意】在开启线程的时候，我们必须要调用线程的start方法，因为start方法才会开辟一条线程通道，而如果调用run方法的话，那么就只是一个普通方法而已。</strong></p>\n<p><strong>2、实现Runnable接口。</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyThread2</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Runnable</span>&#123;</span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title function_\">run</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span> ;i &lt; <span class=\"number\">50</span>; i ++) &#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(Thread.currentThread().getName()+<span class=\"string\">&quot;---&quot;</span>+i);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>创建线程，并开启线程。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\t<span class=\"type\">MyThread</span> <span class=\"variable\">myThread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyThread</span>();</span><br><span class=\"line\">\t<span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(myThread).start();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>【注意】由于Runnable接口是一个函数式接口，所以我们可以使用Lombda表达式来创建线程。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span> ;i &lt; <span class=\"number\">10</span>; i ++) &#123;</span><br><span class=\"line\">\t\tSystem.out.println(Thread.currentThread().getName()+<span class=\"string\">&quot;---&quot;</span>+i);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;).start();</span><br></pre></td></tr></table></figure>\n\n<p><strong>3、实现Callable接口。</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyThread</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Callable</span>&lt;String&gt;&#123;</span><br><span class=\"line\">\t<span class=\"meta\">@Override</span></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> String <span class=\"title function_\">call</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span> ;i &lt; <span class=\"number\">10</span>; i ++) &#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(Thread.currentThread().getName()+<span class=\"string\">&quot;---&quot;</span>+i);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"string\">&quot;mythread&quot;</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>创建线程，并开启线程。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\tFutureTask&lt;String&gt; futureTask = <span class=\"keyword\">new</span> <span class=\"title class_\">FutureTask</span>&lt;String&gt;(<span class=\"keyword\">new</span> <span class=\"title class_\">MyThread</span>());</span><br><span class=\"line\">\t<span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(futureTask).start();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>【注意】由于Callable接口也是一个函数式接口，所以我们也可以使用Lombda表达式来创建线程。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">FutureTask</span>&lt;String&gt;(() -&gt; &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span> ;i &lt; <span class=\"number\">10</span>; i ++) &#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(Thread.currentThread().getName()+<span class=\"string\">&quot;---&quot;</span>+i);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"string\">&quot;mythread&quot;</span>;</span><br><span class=\"line\">\t&#125;)).start();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>4、线程池</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\t<span class=\"type\">ExecutorService</span> <span class=\"variable\">es</span> <span class=\"operator\">=</span> Executors.newFixedThreadPool(<span class=\"number\">5</span>);</span><br><span class=\"line\">\tes.submit(() -&gt; &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span> ;i &lt; <span class=\"number\">10</span>; i ++) &#123;</span><br><span class=\"line\">\t\t\tSystem.out.println(Thread.currentThread().getName()+<span class=\"string\">&quot;---&quot;</span>+i);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>【注意】这里直接使用的是Lambda表达式，submit的方法参数可以是Runnable接口和Callable接口的实现类。</strong></p>\n<h2 id=\"Java的线程状态\"><a href=\"#Java的线程状态\" class=\"headerlink\" title=\"Java的线程状态\"></a>Java的线程状态</h2><p>在Java中，java.lang.Thread包中有一个内部枚举类State，里面列举了Java线程的6中状态。</p>\n<table>\n<thead>\n<tr>\n<th>线程状态</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>NEW（新建）</td>\n<td>刚刚new出来的线程就处于新建状态。</td>\n</tr>\n<tr>\n<td>RUNNABLE（运行）</td>\n<td>线程调用start方法，并获得CPU的执行时间片。</td>\n</tr>\n<tr>\n<td>BLOCKED（锁阻塞）</td>\n<td>在使用同步机制的时候，线程没有获取到同步锁，进入锁阻塞。</td>\n</tr>\n<tr>\n<td>WAITING（等待）</td>\n<td>线程调用wait方法。</td>\n</tr>\n<tr>\n<td>TIMED_WAITING（定时等待）</td>\n<td>线程调用sleep方法，或者wait和join带时间参数的方法。</td>\n</tr>\n<tr>\n<td>TERMINATED（终止）</td>\n<td>线程代码执行完毕，线程终止运行。在已终止的线程上调用start方法，会抛出IllegalThreadStateException异常。</td>\n</tr>\n</tbody></table>\n<h2 id=\"线程常用方法\"><a href=\"#线程常用方法\" class=\"headerlink\" title=\"线程常用方法\"></a>线程常用方法</h2><p>Java中的线程常用方法主要在两个类中，分别是Thread类和Object类。</p>\n<p><strong>Thread类</strong></p>\n<table>\n<thead>\n<tr>\n<th>方法</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>String getName()</td>\n<td>返回此线程的名称。</td>\n</tr>\n<tr>\n<td>void setName(String name)</td>\n<td>将此线程的名称更改为等于参数 name</td>\n</tr>\n<tr>\n<td>long getId()</td>\n<td>返回此线程的标识符</td>\n</tr>\n<tr>\n<td>Thread.State getState()</td>\n<td>返回此线程的状态</td>\n</tr>\n<tr>\n<td>static Thread currentThread()</td>\n<td>返回对当前正在执行的线程对象的引用</td>\n</tr>\n<tr>\n<td>static void sleep(long millis)</td>\n<td>使当前正在执行的线程以指定的毫秒数暂停（暂时停止执行）</td>\n</tr>\n<tr>\n<td>void join(long millis)</td>\n<td>等待这个线程死亡最多 millis毫秒</td>\n</tr>\n<tr>\n<td>void start()</td>\n<td>导致此线程开始执行; Java虚拟机调用此线程的run方法</td>\n</tr>\n<tr>\n<td>void run()</td>\n<td>如果这个线程使用单独的Runnable运行对象构造，则调用该Runnable对象的run方法; 否则，此方法不执行任何操作并返回</td>\n</tr>\n</tbody></table>\n<p><strong>Object类</strong></p>\n<table>\n<thead>\n<tr>\n<th>方法</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>void wait()</td>\n<td>导致当前线程等待，直到另一个线程调用该对象的 notify()方法或 notifyAll()方法。</td>\n</tr>\n<tr>\n<td>void wait(long timeout)</td>\n<td>导致当前线程等待，直到另一个线程调用 notify()方法或该对象的 notifyAll()方法，或者指定的时间已过。</td>\n</tr>\n<tr>\n<td>void notify()</td>\n<td>唤醒正在等待对象监视器的单个线程。</td>\n</tr>\n<tr>\n<td>void notifyAll()</td>\n<td>唤醒正在等待对象监视器的所有线程。</td>\n</tr>\n</tbody></table>\n<p><strong>sleep和wait方法的区别</strong></p>\n<table>\n<thead>\n<tr>\n<th>sleep</th>\n<th>wait</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Thread类中的静态方法</td>\n<td>Object类中的普通方法，由锁对象调用</td>\n</tr>\n<tr>\n<td>sleep方法不会释放锁</td>\n<td>wait方法会释放锁</td>\n</tr>\n<tr>\n<td>sleep不需要被唤醒</td>\n<td>无参的wait方法需要被唤醒</td>\n</tr>\n<tr>\n<td>sleep不依赖synchronized关键字</td>\n<td>wait方法依赖synchronized关键字</td>\n</tr>\n</tbody></table>\n<h2 id=\"synchronized关键字\"><a href=\"#synchronized关键字\" class=\"headerlink\" title=\"synchronized关键字\"></a>synchronized关键字</h2><p>在多线程环境下，会有可以发送线程安全问题，导致一些共享数据产生错误，这个时候，我们为了避免线程安全问题，就需要对线程代码进行同步。<br>synchronized关键字是Java线程中用来保证代码同步的关键字。</p>\n<p><strong>原理：</strong> synchronized关键字是JVM层面的同步，可以保证在同一时刻，只有一个被synchronized关键字修饰的代码块或方法进入临界区。</p>\n<p><strong>synchronized关键字的锁对象</strong></p>\n<ul>\n<li>同步方法块：锁对象为括号内的对象。</li>\n<li>普通方法：锁对象为当前实例对象。</li>\n<li>静态方法，锁对象为该类的字节码对象。</li>\n</ul>\n<p><strong>synchronized和Lock的区别</strong></p>\n<table>\n<thead>\n<tr>\n<th>synchronized</th>\n<th>Lock</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Java关键字，JVM层面实现</td>\n<td>Java中的一个类，代码实现</td>\n</tr>\n<tr>\n<td>只有当synchronized关键字修饰的代码全部执行完毕，才会释放锁。代码发生异常，JVM自动释放锁</td>\n<td>使用unlock释放锁，否则会造成死锁</td>\n</tr>\n<tr>\n<td>无法判断锁状态</td>\n<td>可以判断锁状态</td>\n</tr>\n<tr>\n<td>可重入、不可中断、非公平</td>\n<td>可重入、可判断、可公平（两者皆可）</td>\n</tr>\n<tr>\n<td>适合少量同步代码</td>\n<td>适合大量同步代码</td>\n</tr>\n</tbody></table>\n<h2 id=\"思维导图\"><a href=\"#思维导图\" class=\"headerlink\" title=\"思维导图\"></a>思维导图</h2><p><img src=\"/images/2020/03/20200310093845950.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["Java"],"tags":["Java"]},{"title":"Java基础——类装载的执行过程","url":"/2020/03/08/java/Java%E5%9F%BA%E7%A1%80%E2%80%94%E2%80%94%E7%B1%BB%E8%A3%85%E8%BD%BD%E7%9A%84%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B/","content":"<h2 id=\"什么是类装载？\"><a href=\"#什么是类装载？\" class=\"headerlink\" title=\"什么是类装载？\"></a>什么是类装载？</h2><p>我们都知道，Java代码有三个阶段，分别是源代码阶段，类加载阶段，运行阶段。</p>\n<span id=\"more\"></span>\n<p><img src=\"/images/2020/03/20200308151655161.png\" alt=\"在这里插入图片描述\"></p>\n<p>我们所说的类装载其实就指的就是类加载阶段的Java代码在JVM中的加载过程。</p>\n<h2 id=\"类装载的执行过程\"><a href=\"#类装载的执行过程\" class=\"headerlink\" title=\"类装载的执行过程\"></a>类装载的执行过程</h2><p>类装载大致可以分为三个阶段，分别是加载，连接，初始化。<br>其中连接阶段最为复杂，又可以分为验证，准备，解析三个小阶段。</p>\n<p><strong>加载</strong></p>\n<ul>\n<li>根据查找路径找到相应的 class 文件然后导入内存中。</li>\n</ul>\n<p><strong>验证</strong></p>\n<ul>\n<li>检查加载的 class 文件的正确性。</li>\n</ul>\n<p><strong>准备（重要）</strong></p>\n<ul>\n<li>给类中的静态变量分配内存空间，并赋予默认初始值，给常量赋值。</li>\n</ul>\n<p>准备阶段是类装载的一个重要阶段，在这个阶段中，JVM会给静态变量赋给默认值，而常量则会直接赋值。<br>比如：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">10</span>;\t\t\t<span class=\"comment\">//准备阶段静态变量赋予默认值i=0;</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">I</span> <span class=\"operator\">=</span> <span class=\"number\">10</span>;\t<span class=\"comment\">//准备阶段常量赋值I=10;</span></span><br></pre></td></tr></table></figure>\n<p><strong>解析</strong></p>\n<ul>\n<li>虚拟机将常量池中的符号引用替换成直接引用的过程。符号引用就理解为一个标示，而在直接引用直接指向内存中的地址。</li>\n</ul>\n<p><strong>初始化（重要）</strong></p>\n<ul>\n<li>对静态变量和静态代码块执行初始化工作。类变量（static变量）的赋值语句、静态代码块，最终组成类初始化方法。</li>\n</ul>\n<h2 id=\"初始化\"><a href=\"#初始化\" class=\"headerlink\" title=\"初始化\"></a>初始化</h2><p><strong>什么时候会发生类的初始化？</strong></p>\n<ul>\n<li>Java虚拟机启动时被标明为启动类的类（ JavaTest ），还有就是<strong>Main方法</strong>的类会首先被初始化。</li>\n<li>访问某个类或接口的静态变量，或者对该静态变量赋值（在编译器把结果放入常量池的静态字段除外）。</li>\n<li>初始化某个类的子类，则其父类也会被初始化。</li>\n<li>创建类的实例，也就是new的方式。</li>\n<li>反射生成该类的字节码对象。</li>\n<li>调用类的静态方法 。</li>\n</ul>\n<p><strong>对象初始化</strong></p>\n<ul>\n<li>实例化一个对象的时候，会发生对象的初始化。</li>\n<li>如果一个类有父类，在实例化子类的时候，会先执行父类的构造函数，然后执行子类的构造函数。</li>\n</ul>\n<p><strong>类的初始化和对象初始化的区别</strong></p>\n<table>\n<thead>\n<tr>\n<th>类的初始化</th>\n<th>对象初始化</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>执行静态变量的赋值语句，静态代码块</td>\n<td>执行成员变量的赋值语句，普通代码块，构造函数代码</td>\n</tr>\n</tbody></table>\n<h2 id=\"思维导图\"><a href=\"#思维导图\" class=\"headerlink\" title=\"思维导图\"></a>思维导图</h2><p><img src=\"/images/2020/03/20200308160223597.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["Java"],"tags":["Java"]},{"title":"Java基础——运行时异常和非运行时异常","url":"/2020/02/02/java/Java%E5%9F%BA%E7%A1%80%E2%80%94%E2%80%94%E8%BF%90%E8%A1%8C%E6%97%B6%E5%BC%82%E5%B8%B8%E5%92%8C%E9%9D%9E%E8%BF%90%E8%A1%8C%E6%97%B6%E5%BC%82%E5%B8%B8/","content":"<h2 id=\"Java中异常机制的体系结构\"><a href=\"#Java中异常机制的体系结构\" class=\"headerlink\" title=\"Java中异常机制的体系结构\"></a>Java中异常机制的体系结构</h2><p>在Java中，万物皆对象，异常也不例外。<br>Exception（异常）是Java的一个类，它和它的兄弟类Error一起继承自它的父类——Throwable（可抛出的）。</p>\n<span id=\"more\"></span>\n<p>它们的详细的体系结构如下图所示：<br><img src=\"/images/2020/02/20200202200144534.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"Error（错误）\"><a href=\"#Error（错误）\" class=\"headerlink\" title=\"Error（错误）\"></a>Error（错误）</h2><p>Error一般是指和虚拟机有关的一些问题，一般是由于虚拟机运行错误，系统崩溃而引起的，这些问题不能被程序自动修复或着捕获，所以在Java代码中也无法对这些问题进行处理。Error一般不会出现，但是一旦出现了，就运行发生了重大错误。<br>对于初学者而言，最为常见的错误，应该就是<strong>StackOverflowError</strong>（栈溢出错误），一般发生在递归调用方法的时候，没有设置方法return的条件，导致过多的方法进入虚拟机栈中，造成栈空间溢出，从而使虚拟机线程终止运行。</p>\n<h2 id=\"Exception（异常）\"><a href=\"#Exception（异常）\" class=\"headerlink\" title=\"Exception（异常）\"></a>Exception（异常）</h2><p>Exception一般分为两类，也就是<strong>运行时异常</strong>和<strong>非运行时异常</strong>。</p>\n<p><strong>运行时异常</strong>，也被称作unchecked exception（不可查异常），它只包含一类，就是Exception的子类——RuntimeException，凡是该类或者该类的子类，都被称作运行时异常。<br>运行时异常，一般是由于程序的设计漏洞，代码逻辑错误而造成的，一旦发生，就会直接由虚拟机终止正在运行的程序。<br>常见的运行时异常有：</p>\n<ul>\n<li>NullPointerException(空指针异常)</li>\n<li>IndexOutOfBoundsException(数组下标越界异常)   </li>\n<li>ClassCastException(类型转换异常)</li>\n<li>ArrayStoreException(数据存储异常，操作数组时类型不一致)</li>\n</ul>\n<p><strong>非运行时异常</strong>，也被称作checked exception（可查异常，也被称作编译异常），Exception的子类中，除了RuntimeException之外的其它异常，都是非运行时异常，也就是编译异常。<br>如果是使用Eclipse或者IDEA等IDE开发工具进行开发Java代码的话，如果发生了编译异常，那么IDE会自动爆红提示。这个时候，开发者要么使用try{}catch(){}进行捕获，要么就使用throws关键字进行抛出，抛给调用该方法的那个方法，如果是main方法，则会直接由JVM处理该异常，处理机制为中断运行并打印异常信息。<br>常见的非运行时异常有：</p>\n<ul>\n<li>IOException（IO异常）</li>\n<li>SQLException（SQL异常）</li>\n<li>ClassNotFoundException（类没有找到异常）</li>\n</ul>\n<p>【注意】值得一提的是，Exception是可以被避免的，只要代码设计得足够完美，那么就可以避免异常的发生。</p>\n<h2 id=\"运行时异常和非运行时异常的区别\"><a href=\"#运行时异常和非运行时异常的区别\" class=\"headerlink\" title=\"运行时异常和非运行时异常的区别\"></a>运行时异常和非运行时异常的区别</h2><p>【处理机制】</p>\n<ul>\n<li>运行时异常直接由JVM进行处理，处理机制为中断运行并打印异常信息。</li>\n<li>非运行时异常由程序设计者进行处理，处理机制为try{}catch(){}或者throws。</li>\n</ul>\n<p>【编译】</p>\n<ul>\n<li><p>运行时异常可以直接通过编译。</p>\n</li>\n<li><p>非运行时异常如果不进行处理，那么编译无法通过，这也是我们为什么把非运行时异常称为编译异常的原因。</p>\n<p>【异常发生之后】</p>\n<ul>\n<li>运行时异常发生之后，调用代码就不能再继续执行了。</li>\n<li>非运行时异常发生之后，代码依然可以继续执行，比如finally中的代码。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"结束\"><a href=\"#结束\" class=\"headerlink\" title=\"结束\"></a>结束</h2><p>Throwable家族中，大致分为三大类：Error，RuntimeException，以及其它的Exception的子类。<br>这三种的问题的严重程度也是由深及浅，其中异常应该是我们尽量避免的，这是作为一个优秀的程序员应该思考是事情。</p>\n<p><strong>最后：</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> Lucky <span class=\"title function_\">In2020</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">\tSystem.out.println(<span class=\"string\">&quot;祝您好运！&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","categories":["Java"],"tags":["Java"]},{"title":"Java基础——集合框架","url":"/2020/03/08/java/Java%E5%9F%BA%E7%A1%80%E2%80%94%E2%80%94%E9%9B%86%E5%90%88%E6%A1%86%E6%9E%B6/","content":"<p>集合是用来存放数据的，大部分集合底层都是使用数组来进行实现的。但是数组有一个缺点，就是数组一旦初始化后，就无法改变数组的长度，那么我们在存放未知个数的数据的时候，数组就已经无法满足我们的需求了。<br>于是就有了集合，它的底层虽然是数组实现，但是却对底层数组进行了动态维护，使得集合可以动态进行扩容操作，而且提供公有的操作数组的方法，免去了使用索引下标在操作数组时而引起的各种问题。</p>\n<span id=\"more\"></span>\n<h2 id=\"Java集合框架结构\"><a href=\"#Java集合框架结构\" class=\"headerlink\" title=\"Java集合框架结构\"></a>Java集合框架结构</h2><p><img src=\"/images/2020/03/20200307175007919.png\" alt=\"在这里插入图片描述\"></p>\n<p><strong>为什么要有集合？</strong></p>\n<p>集合主要有Collection和Map两种体系。</p>\n<p><strong>Collection</strong><br>Collection是java.util包下的集合类的顶级接口，它的子类有List和Set。Java中的集合框架都是围绕这一个接口标准而设计实现的。</p>\n<p><strong>Map</strong><br>Map是Java.util包下的集合类顶级接口，和Collection同级，它的实现类主要有HashMap，HashTable，ConcurrentHashMap。它存放的数据是key-value形式的。</p>\n<h2 id=\"List集合\"><a href=\"#List集合\" class=\"headerlink\" title=\"List集合\"></a>List集合</h2><p>List是Collection接口下的一个集合接口，是所有List类的规范接口，它的实现类主要有ArrayList，LinkedList，Vector等实现类。</p>\n<ul>\n<li><strong>List集合存放元素有顺序，可以存放重复的元素。</strong></li>\n</ul>\n<p><strong>ArrayList</strong></p>\n<ul>\n<li>ArrayList是最为常用的集合之一，底层使用数组实现，线程不安全，查找效率快，增删效率慢。</li>\n<li>扩容机制：ArrayList扩容后的容量为原来的容量的1.5倍。</li>\n<li>ArrayList在使用无参构造创建对象的时候，不会开辟数组空间，在进行第一次添加操作的时候，才进行数组空间的开辟，默认初始化值为10。</li>\n</ul>\n<p><strong>LinkedList</strong></p>\n<ul>\n<li>LinkedList底层使用的是Node节点的链表实现，线程不安全，查找效率慢，增删效率快。</li>\n</ul>\n<p><strong>Vector</strong></p>\n<ul>\n<li>Vector的功能和ArrayList基本相似，不过Vector是线程安全的集合，底层使用synchronized关键字进行同步。</li>\n<li>扩容机制：Vector扩容后的容量为原来的容量的2倍。</li>\n</ul>\n<p><strong>List集合实现类的区别</strong></p>\n<table>\n    <tr>\n        <td></td>\n        <td>ArrayList</td>        \n        <td>Vector</td>\n        <td>LinkedList</td>\n    </tr>\n    <tr>\n        <td>相同之处</td>\n        <td colspan=\"3\">存放元素有顺序，元素可重复 </td>\n    </tr>\n    <tr>\n        <td>底层实现</td>\n        <td>数组</td>\n        <td>数组</td>\n        <td>链表</td>\n    </tr>\n    <tr>\n        <td>是否同步</td>\n        <td>不同步，线程不安全</td>\n        <td>同步，线程安全</td>\n        <td>不同步，线程不安全</td>\n    </tr>\n    <tr>\n        <td>效率</td>\n        <td>查找快，增删慢</td>\n        <td>查找快，增删慢</td>\n        <td>查找慢，增删快</td>\n    </tr>\n    <tr>\n        <td>扩容机制</td>\n        <td>扩容后的容量为原来的容量的1.5倍</td>\n        <td>扩容后的容量为原来的容量的2倍</td>\n        <td>链表，不需要扩容</td>\n    </tr>\n</table>\n\n<h2 id=\"Set集合\"><a href=\"#Set集合\" class=\"headerlink\" title=\"Set集合\"></a>Set集合</h2><p>Set接口的实现类主要有HashSet和TreeSet。</p>\n<p><strong>HashSet</strong></p>\n<ul>\n<li>HashSet底层使用的是HashMap实现，元素存取无顺序，元素不可重复，可以存放null值。</li>\n</ul>\n<p><strong>TreeSet</strong></p>\n<ul>\n<li>TreeSet底层使用的是二叉树实现。</li>\n</ul>\n<p><strong>List集合和Set集合的区别</strong></p>\n<table>\n<thead>\n<tr>\n<th>List</th>\n<th>Set</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>元素可重复</td>\n<td>元素不可重复</td>\n</tr>\n<tr>\n<td>元素存取有顺序</td>\n<td>元素存取无顺序</td>\n</tr>\n</tbody></table>\n<h2 id=\"Map集合\"><a href=\"#Map集合\" class=\"headerlink\" title=\"Map集合\"></a>Map集合</h2><p>Map集合是哈希类型的集合，也就是散列表结构，用于存放key-value类型的键值对，保证key唯一性。</p>\n<p><strong>HashMap（重点）</strong></p>\n<ul>\n<li>HashMap存放key-value键值对，可以存放null值 ，线程不安全。</li>\n<li>HashMap默认初始化容量大小为16，默认负载因子为0.75。</li>\n<li>HashMap第一次创建的时候不会开辟数组空间，只有第一次进行put操作的时候，才会进行数组空间的开辟。</li>\n<li>HashMap的链表长度大于等于8，会转换为红黑树，红黑树长度小于等于6，会转换为链表。</li>\n<li>HashMap在扩容的时候，JDK7及以前的版本先扩容再插入元素，JDK8之后先插入元素再扩容。</li>\n<li>HashMap在JDK7及以前版本的时候，使用数组+链表实现，JDK8之后使用数组+链表+红黑树实现。</li>\n<li>HashMap在JDK7及以前版本，在发生哈希碰撞的时候，使用头插法插入元素，JDK8之后，使用尾插法插入元素。</li>\n</ul>\n<p><strong>HashTable</strong></p>\n<ul>\n<li>HashTable的功能基本和HashMap相似，不过HashTable是线程安全的，使用了synchronized关键字进行同步，HashTable的key-value值不可以存放null值。</li>\n</ul>\n<p><strong>ConcurrentHashMap</strong></p>\n<ul>\n<li>ConcurrentHashMap是HashTable的替代类，扩展性和性能比HashTable较好，线程安全。</li>\n</ul>\n<p><strong>HashMap和HashTable的区别</strong></p>\n<table>\n<thead>\n<tr>\n<th>HashMap</th>\n<th>HashTable</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>JDK1.2出现的集合类</td>\n<td>JDK1.1出现的集合类</td>\n</tr>\n<tr>\n<td>线程不安全，不同步</td>\n<td>线程安全，底层使用synchronized关键字同步</td>\n</tr>\n<tr>\n<td>key和value可以存放null值</td>\n<td>key和value不可以存放null值</td>\n</tr>\n</tbody></table>\n<p><strong>HashMap不同版本的区别</strong></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>JDK7及以前的版本</th>\n<th>JDK8</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>底层实现</td>\n<td>数组+链表</td>\n<td>数组+链表+红黑树</td>\n</tr>\n<tr>\n<td>扩容</td>\n<td>先扩容再插入键值对</td>\n<td>先插入键值对，再进行扩容</td>\n</tr>\n<tr>\n<td>链表插入的方法</td>\n<td>头插法</td>\n<td>尾插法</td>\n</tr>\n</tbody></table>\n<h2 id=\"思维导图\"><a href=\"#思维导图\" class=\"headerlink\" title=\"思维导图\"></a>思维导图</h2><p><img src=\"/images/2020/03/20200308121631677.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["Java"],"tags":["Java"]},{"title":"Java基础——面向对象：抽象，封装，继承，多态","url":"/2020/03/02/java/Java%E5%9F%BA%E7%A1%80%E2%80%94%E2%80%94%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%9A%E6%8A%BD%E8%B1%A1%EF%BC%8C%E5%B0%81%E8%A3%85%EF%BC%8C%E7%BB%A7%E6%89%BF%EF%BC%8C%E5%A4%9A%E6%80%81/","content":"<p>Java是一门面向对象的语言，那什么是面向对象？</p>\n<p><strong>面向对象</strong><br>面向对象，也被称作OOP(Object Oriented Programming)，面向对象是一种思想，是指将世界上的所有事物都看作是一个对象。</p>\n<span id=\"more\"></span>\n<p>面向对象有以下的优点：</p>\n<ul>\n<li>代码开发模块化，便于维护。</li>\n<li>代码具有可复用性，灵活性。</li>\n<li>代码可读性强。</li>\n</ul>\n<p>面向对象的主要思想是抽象，封装，继承，多态。</p>\n<ul>\n<li><strong>抽象</strong>：把一类事物的公有属性和行为提取出来，封装成一个物理模型，这种研究问题的方法就叫做抽象</li>\n<li><strong>封装</strong>：封装就是把抽象的数据和对数据的操作封装在一个类的内部，并提供对外的公有方法用于访问数据。</li>\n<li><strong>继承</strong>：继承是从已有类的中派生出新的类，新的类能够吸收已有类的数据属性和行为，并能拓展新的能力。</li>\n<li><strong>多态</strong>：多态就是一个引用数据类型，在不同的情况下可以有多种状态，指向父类的指针，来调用不同子类中的实现。</li>\n</ul>\n<p><img src=\"/images/2020/03/2020030209492748.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["Java"],"tags":["Java"]},{"title":"Java实现PDF文件转换为图片","url":"/2020/09/02/java/Java%E5%AE%9E%E7%8E%B0PDF%E6%96%87%E4%BB%B6%E8%BD%AC%E6%8D%A2%E4%B8%BA%E5%9B%BE%E7%89%87/","content":"<blockquote>\n<p>前几天写了一篇博客<a href=\"/2020/08/05/java/Java实现图片转换PDF文件/\">Java实现图片转换PDF文件</a>，在博客下方有同学评论是否能够将PDF文件转换为图片，所以今天就在这里写了一个将PDF文件转换为图片的简单系统。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h2 id=\"引入依赖\"><a href=\"#引入依赖\" class=\"headerlink\" title=\"引入依赖\"></a>引入依赖</h2><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.0.4.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">relativePath</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"comment\">&lt;!--SpringMVC的依赖，方便我们可以获取前端传递过来的文件信息--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--icepdf，用来将pdf文件转换为图片的依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.icepdf.os<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>icepdf-core<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>6.2.2<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"前端页面\"><a href=\"#前端页面\" class=\"headerlink\" title=\"前端页面\"></a>前端页面</h2><figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;en&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>PDf转换图片<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">style</span>&gt;</span><span class=\"language-css\"></span></span><br><span class=\"line\"><span class=\"language-css\">        <span class=\"selector-class\">.submitButton</span> &#123;</span></span><br><span class=\"line\"><span class=\"language-css\">            <span class=\"attribute\">margin-top</span>: <span class=\"number\">20px</span>;</span></span><br><span class=\"line\"><span class=\"language-css\">            <span class=\"attribute\">margin-left</span>: <span class=\"number\">150px</span>;</span></span><br><span class=\"line\"><span class=\"language-css\">            <span class=\"attribute\">background-color</span>: <span class=\"number\">#e37e10</span>;</span></span><br><span class=\"line\"><span class=\"language-css\">            <span class=\"attribute\">border-radius</span>: <span class=\"number\">10px</span>;</span></span><br><span class=\"line\"><span class=\"language-css\">            <span class=\"attribute\">border</span>: <span class=\"number\">1px</span> solid <span class=\"number\">#ff8300</span>;</span></span><br><span class=\"line\"><span class=\"language-css\">        &#125;</span></span><br><span class=\"line\"><span class=\"language-css\">    </span><span class=\"tag\">&lt;/<span class=\"name\">style</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;text-align: center&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>PDF转换图片工具<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">form</span> <span class=\"attr\">action</span>=<span class=\"string\">&quot;/pdf/to/image&quot;</span> <span class=\"attr\">enctype</span>=<span class=\"string\">&quot;multipart/form-data&quot;</span> <span class=\"attr\">method</span>=<span class=\"string\">&quot;post&quot;</span> <span class=\"attr\">onsubmit</span>=<span class=\"string\">&quot;return allowFileType()&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;file&quot;</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;file&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;file&quot;</span> <span class=\"attr\">placeholder</span>=<span class=\"string\">&quot;请选择PDF文件&quot;</span> <span class=\"attr\">onchange</span>=<span class=\"string\">&quot;allowFileType()&quot;</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;border: 1px solid black;&quot;</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;submit&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;一键转换图片&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;submitButton&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">function</span> <span class=\"title function_\">allowFileType</span>(<span class=\"params\"></span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">let</span> file = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">&quot;file&quot;</span>).<span class=\"property\">files</span>[<span class=\"number\">0</span>];</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">let</span> fileName = file.<span class=\"property\">name</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">let</span> suffix = fileName.<span class=\"title function_\">substring</span>(fileName.<span class=\"title function_\">lastIndexOf</span>(<span class=\"string\">&quot;.&quot;</span>),fileName.<span class=\"property\">length</span>).<span class=\"title function_\">toLowerCase</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">if</span>(<span class=\"string\">&#x27;.pdf&#x27;</span> != suffix) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"title function_\">alert</span>(<span class=\"string\">&quot;只允许传入PDF格式的文件！&quot;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"控制层接口\"><a href=\"#控制层接口\" class=\"headerlink\" title=\"控制层接口\"></a>控制层接口</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.hrp.controller;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.hrp.util.ImageUtils;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.stereotype.Controller;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.multipart.MultipartFile;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@description</span>: 用于处理Pdf相关的请求</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Controller</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;pdf&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">PdfController</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping(&quot;to/image&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">pdfToImage</span><span class=\"params\">(<span class=\"meta\">@RequestParam(&quot;file&quot;)</span> MultipartFile file,HttpServletResponse response)</span> <span class=\"keyword\">throws</span> Exception&#123;</span><br><span class=\"line\">        ImageUtils.pdfToImage(file,response);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"Image工具类\"><a href=\"#Image工具类\" class=\"headerlink\" title=\"Image工具类\"></a>Image工具类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.hrp.util;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.icepdf.core.pobjects.Document;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.icepdf.core.pobjects.Page;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.icepdf.core.util.GraphicsRenderingHints;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.stereotype.Component;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.multipart.MultipartFile;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.imageio.ImageIO;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.awt.image.BufferedImage;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.*;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.URLEncoder;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.ArrayList;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Arrays;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.zip.ZipEntry;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.zip.ZipOutputStream;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@description</span>: PDF转换为图片的工具类</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ImageUtils</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 图片文件格式</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">FORMAT_NAME</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;png&quot;</span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 图片文件后缀名</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">PNG_SUFFIX</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;.png&quot;</span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 压缩文件后缀名</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">ZIP_SUFFIX</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;.zip&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 对外的开放接口，用于将PDF文件转换为图片文件压缩包进行下载</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> file SpringMVC获取的图片文件</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> response</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">pdfToImage</span><span class=\"params\">(MultipartFile file, HttpServletResponse response)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"type\">File</span> <span class=\"variable\">zipFile</span> <span class=\"operator\">=</span> generateImageFile(file);</span><br><span class=\"line\">        downloadZipFile(zipFile, response);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 将PDF文件转换为多张图片并放入一个压缩包中</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> file SpringMVC获取的图片文件</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 图片文件压缩包</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception 抛出异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> File <span class=\"title function_\">generateImageFile</span><span class=\"params\">(MultipartFile file)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">fileName</span> <span class=\"operator\">=</span> file.getOriginalFilename();</span><br><span class=\"line\">        <span class=\"type\">Document</span> <span class=\"variable\">document</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Document</span>();</span><br><span class=\"line\">        document.setByteArray(file.getBytes(), <span class=\"number\">0</span>, file.getBytes().length, fileName);</span><br><span class=\"line\"></span><br><span class=\"line\">        List&lt;File&gt; fileList = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; document.getNumberOfPages(); i++) &#123;</span><br><span class=\"line\">            <span class=\"type\">BufferedImage</span> <span class=\"variable\">image</span> <span class=\"operator\">=</span> (BufferedImage) document.getPageImage(i, GraphicsRenderingHints.SCREEN,</span><br><span class=\"line\">                    Page.BOUNDARY_CROPBOX, <span class=\"number\">0F</span>, <span class=\"number\">2.5F</span>);</span><br><span class=\"line\">            <span class=\"type\">File</span> <span class=\"variable\">imageFile</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">File</span>((i + <span class=\"number\">1</span>) + PNG_SUFFIX);</span><br><span class=\"line\">            ImageIO.write(image, FORMAT_NAME, imageFile);</span><br><span class=\"line\">            image.flush();</span><br><span class=\"line\">            fileList.add(imageFile);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        document.dispose();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">directoryName</span> <span class=\"operator\">=</span> fileName.substring(<span class=\"number\">0</span>, fileName.lastIndexOf(<span class=\"string\">&quot;.&quot;</span>));</span><br><span class=\"line\">        <span class=\"type\">File</span> <span class=\"variable\">zipFile</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">File</span>(directoryName + ZIP_SUFFIX);</span><br><span class=\"line\">        <span class=\"type\">ZipOutputStream</span> <span class=\"variable\">zos</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ZipOutputStream</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">FileOutputStream</span>(zipFile));</span><br><span class=\"line\">        zipFile(fileList, zos);</span><br><span class=\"line\">        zos.close();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> zipFile;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 下载zip文件</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> zipFile  zip压缩文件</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> response HttpServletResponse</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> IOException IO异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">downloadZipFile</span><span class=\"params\">(File zipFile, HttpServletResponse response)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">        <span class=\"type\">FileInputStream</span> <span class=\"variable\">fis</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">FileInputStream</span>(zipFile);</span><br><span class=\"line\">        <span class=\"type\">byte</span>[] bytes = <span class=\"keyword\">new</span> <span class=\"title class_\">byte</span>[fis.available()];</span><br><span class=\"line\">        fis.read(bytes);</span><br><span class=\"line\">        fis.close();</span><br><span class=\"line\"></span><br><span class=\"line\">        response.reset();</span><br><span class=\"line\">        response.setCharacterEncoding(<span class=\"string\">&quot;UTF-8&quot;</span>);</span><br><span class=\"line\">        response.setHeader(<span class=\"string\">&quot;Content-Type&quot;</span>, <span class=\"string\">&quot;application/x-msdownload&quot;</span>);</span><br><span class=\"line\">        response.setHeader(<span class=\"string\">&quot;Content-Disposition&quot;</span>, <span class=\"string\">&quot;attachment; filename=&quot;</span> + URLEncoder.encode(zipFile.getName(), <span class=\"string\">&quot;UTF-8&quot;</span>));</span><br><span class=\"line\">        <span class=\"type\">OutputStream</span> <span class=\"variable\">out</span> <span class=\"operator\">=</span> response.getOutputStream();</span><br><span class=\"line\">        out.write(bytes);</span><br><span class=\"line\">        out.flush();</span><br><span class=\"line\">        out.close();</span><br><span class=\"line\">        zipFile.delete();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 压缩文件</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> inputFiles 具体需要压缩的文件集合</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> zos        ZipOutputStream对象</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> IOException IO异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">zipFile</span><span class=\"params\">(List&lt;File&gt; inputFiles, ZipOutputStream zos)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">        <span class=\"type\">byte</span>[] buffer = <span class=\"keyword\">new</span> <span class=\"title class_\">byte</span>[<span class=\"number\">1024</span>];</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (File file : inputFiles) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (file.exists()) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (file.isFile()) &#123;</span><br><span class=\"line\">                    <span class=\"type\">BufferedInputStream</span> <span class=\"variable\">bis</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">BufferedInputStream</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">FileInputStream</span>(file));</span><br><span class=\"line\">                    zos.putNextEntry(<span class=\"keyword\">new</span> <span class=\"title class_\">ZipEntry</span>(file.getName()));</span><br><span class=\"line\">                    <span class=\"type\">int</span> <span class=\"variable\">size</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">                    <span class=\"keyword\">while</span> ((size = bis.read(buffer)) &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                        zos.write(buffer, <span class=\"number\">0</span>, size);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    zos.closeEntry();</span><br><span class=\"line\">                    bis.close();</span><br><span class=\"line\">                    file.delete();</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    File[] files = file.listFiles();</span><br><span class=\"line\">                    List&lt;File&gt; childrenFileList = Arrays.asList(files);</span><br><span class=\"line\">                    zipFile(childrenFileList, zos);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"页面效果\"><a href=\"#页面效果\" class=\"headerlink\" title=\"页面效果\"></a>页面效果</h2><p><img src=\"/images/2020/09/20200902230305119.png\" alt=\"在这里插入图片描述\"></p>\n<blockquote>\n<p>作者简单测试了一下，该系统是可以顺利运行的，而且作者将后台生成的图片文件和压缩文件都进行了删除，这样就不会对后台系统产生不必要的资源浪费，节约了磁盘空间。</p>\n</blockquote>\n","categories":["Java"],"tags":["Java","PDF"]},{"title":"Java实现图片转换PDF文件","url":"/2020/08/25/java/Java%E5%AE%9E%E7%8E%B0%E5%9B%BE%E7%89%87%E8%BD%AC%E6%8D%A2PDF%E6%96%87%E4%BB%B6/","content":"<blockquote>\n<p>最近因为一些事情，需要将一张简单的图片转换为PDF的文件格式，在网上找了一些工具，但是这些工具不是需要注册账号，就是需要下载软件。<br>而对于只是转换一张图片的情况下，这些操作显然是非常繁琐的，所以作者就直接使用Java写了一个图片转换PDF的系统，现在将该系统分享在这里。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h2 id=\"引入依赖\"><a href=\"#引入依赖\" class=\"headerlink\" title=\"引入依赖\"></a>引入依赖</h2><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--该项目以SpringBoot为基础搭建--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.0.4.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">relativePath</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"comment\">&lt;!--SpringMVC的依赖，方便我们可以获取前端传递过来的文件信息--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--ITextPdf，操作PDF文件的工具类--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.itextpdf<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>itextpdf<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>5.4.2<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"前端页面\"><a href=\"#前端页面\" class=\"headerlink\" title=\"前端页面\"></a>前端页面</h2><figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;en&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>图片转换Pdf<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">style</span>&gt;</span><span class=\"language-css\"></span></span><br><span class=\"line\"><span class=\"language-css\">        <span class=\"selector-class\">.submitButton</span> &#123;</span></span><br><span class=\"line\"><span class=\"language-css\">            <span class=\"attribute\">margin-top</span>: <span class=\"number\">20px</span>;</span></span><br><span class=\"line\"><span class=\"language-css\">            <span class=\"attribute\">margin-left</span>: <span class=\"number\">150px</span>;</span></span><br><span class=\"line\"><span class=\"language-css\">            <span class=\"attribute\">background-color</span>: <span class=\"number\">#e37e10</span>;</span></span><br><span class=\"line\"><span class=\"language-css\">            <span class=\"attribute\">border-radius</span>: <span class=\"number\">10px</span>;</span></span><br><span class=\"line\"><span class=\"language-css\">            <span class=\"attribute\">border</span>: <span class=\"number\">1px</span> solid <span class=\"number\">#ff8300</span>;</span></span><br><span class=\"line\"><span class=\"language-css\">        &#125;</span></span><br><span class=\"line\"><span class=\"language-css\">    </span><span class=\"tag\">&lt;/<span class=\"name\">style</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;text-align: center&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>图片转换pdf工具<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">form</span> <span class=\"attr\">action</span>=<span class=\"string\">&quot;/pdf/image/to&quot;</span> <span class=\"attr\">enctype</span>=<span class=\"string\">&quot;multipart/form-data&quot;</span> <span class=\"attr\">method</span>=<span class=\"string\">&quot;post&quot;</span> <span class=\"attr\">onsubmit</span>=<span class=\"string\">&quot;return allowFileType()&quot;</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;file&quot;</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;file&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;file&quot;</span> <span class=\"attr\">placeholder</span>=<span class=\"string\">&quot;请选择图片&quot;</span> <span class=\"attr\">onchange</span>=<span class=\"string\">&quot;allowFileType()&quot;</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;border: 1px solid black;&quot;</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;submit&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;一键转换pdf文件&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;submitButton&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">function</span> <span class=\"title function_\">allowFileType</span>(<span class=\"params\"></span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">let</span> file = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">&quot;file&quot;</span>).<span class=\"property\">files</span>[<span class=\"number\">0</span>];</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">let</span> fileName = file.<span class=\"property\">name</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">let</span> fileSize = file.<span class=\"property\">size</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">let</span> suffix = fileName.<span class=\"title function_\">substring</span>(fileName.<span class=\"title function_\">lastIndexOf</span>(<span class=\"string\">&quot;.&quot;</span>),fileName.<span class=\"property\">length</span>).<span class=\"title function_\">toLowerCase</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">if</span>(<span class=\"string\">&#x27;.jpg&#x27;</span> != suffix &amp;&amp; <span class=\"string\">&#x27;.png&#x27;</span> != suffix) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"title function_\">alert</span>(<span class=\"string\">&quot;目前只允许传入.jpg或者.png格式的图片！&quot;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">if</span>(fileSize &gt; <span class=\"number\">2</span>*<span class=\"number\">1024</span>*<span class=\"number\">1024</span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"title function_\">alert</span>(<span class=\"string\">&quot;上传图片不允许超过2MB!&quot;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"控制层接口\"><a href=\"#控制层接口\" class=\"headerlink\" title=\"控制层接口\"></a>控制层接口</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.hrp.controller;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.hrp.util.PdfUtils;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.stereotype.Controller;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.multipart.MultipartFile;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@description</span>: 用于处理Pdf相关的请求</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Controller</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;pdf&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">PdfController</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping(&quot;image/to&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">imageToPdf</span><span class=\"params\">(<span class=\"meta\">@RequestParam(&quot;file&quot;)</span> MultipartFile file,HttpServletResponse response)</span> <span class=\"keyword\">throws</span> Exception&#123;</span><br><span class=\"line\">        PdfUtils.imageToPdf(file,response);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"PDF工具类\"><a href=\"#PDF工具类\" class=\"headerlink\" title=\"PDF工具类\"></a>PDF工具类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.hrp.util;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.itextpdf.text.Document;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.itextpdf.text.DocumentException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.itextpdf.text.Image;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.itextpdf.text.PageSize;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.itextpdf.text.pdf.PdfWriter;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.stereotype.Component;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.multipart.MultipartFile;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.*;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.URLEncoder;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@description</span>: pdf相关的工具类</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">PdfUtils</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 图片转换PDF的公共接口</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> file     SpringMVC获取的图片文件</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> response HttpServletResponse</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> IOException       IO异常</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> DocumentException PDF文档异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">imageToPdf</span><span class=\"params\">(MultipartFile file, HttpServletResponse response)</span> <span class=\"keyword\">throws</span> IOException, DocumentException &#123;</span><br><span class=\"line\">        <span class=\"type\">File</span> <span class=\"variable\">pdfFile</span> <span class=\"operator\">=</span> generatePdfFile(file);</span><br><span class=\"line\">        downloadPdfFile(pdfFile, response);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 将图片转换为PDF文件</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> file SpringMVC获取的图片文件</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> PDF文件</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> IOException       IO异常</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> DocumentException PDF文档异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> File <span class=\"title function_\">generatePdfFile</span><span class=\"params\">(MultipartFile file)</span> <span class=\"keyword\">throws</span> IOException, DocumentException &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">fileName</span> <span class=\"operator\">=</span> file.getOriginalFilename();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">pdfFileName</span> <span class=\"operator\">=</span> fileName.substring(<span class=\"number\">0</span>, fileName.lastIndexOf(<span class=\"string\">&quot;.&quot;</span>)) + <span class=\"string\">&quot;.pdf&quot;</span>;</span><br><span class=\"line\">        <span class=\"type\">Document</span> <span class=\"variable\">doc</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Document</span>(PageSize.A4, <span class=\"number\">20</span>, <span class=\"number\">20</span>, <span class=\"number\">20</span>, <span class=\"number\">20</span>);</span><br><span class=\"line\">        PdfWriter.getInstance(doc, <span class=\"keyword\">new</span> <span class=\"title class_\">FileOutputStream</span>(pdfFileName));</span><br><span class=\"line\">        doc.open();</span><br><span class=\"line\">        doc.newPage();</span><br><span class=\"line\">        <span class=\"type\">Image</span> <span class=\"variable\">image</span> <span class=\"operator\">=</span> Image.getInstance(file.getBytes());</span><br><span class=\"line\">        <span class=\"type\">float</span> <span class=\"variable\">height</span> <span class=\"operator\">=</span> image.getHeight();</span><br><span class=\"line\">        <span class=\"type\">float</span> <span class=\"variable\">width</span> <span class=\"operator\">=</span> image.getWidth();</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">percent</span> <span class=\"operator\">=</span> getPercent(height, width);</span><br><span class=\"line\">        image.setAlignment(Image.MIDDLE);</span><br><span class=\"line\">        image.scalePercent(percent);</span><br><span class=\"line\">        doc.add(image);</span><br><span class=\"line\">        doc.close();</span><br><span class=\"line\">        <span class=\"type\">File</span> <span class=\"variable\">pdfFile</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">File</span>(pdfFileName);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> pdfFile;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * 用于下载PDF文件</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> pdfFile  PDF文件</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> response HttpServletResponse</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> IOException IO异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">downloadPdfFile</span><span class=\"params\">(File pdfFile, HttpServletResponse response)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">        <span class=\"type\">FileInputStream</span> <span class=\"variable\">fis</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">FileInputStream</span>(pdfFile);</span><br><span class=\"line\">        <span class=\"type\">byte</span>[] bytes = <span class=\"keyword\">new</span> <span class=\"title class_\">byte</span>[fis.available()];</span><br><span class=\"line\">        fis.read(bytes);</span><br><span class=\"line\">        fis.close();</span><br><span class=\"line\"></span><br><span class=\"line\">        response.reset();</span><br><span class=\"line\">        response.setHeader(<span class=\"string\">&quot;Content-Type&quot;</span>, <span class=\"string\">&quot;application/pdf&quot;</span>);</span><br><span class=\"line\">        response.setHeader(<span class=\"string\">&quot;Content-Disposition&quot;</span>, <span class=\"string\">&quot;attachment; filename=&quot;</span> + URLEncoder.encode(pdfFile.getName(), <span class=\"string\">&quot;UTF-8&quot;</span>));</span><br><span class=\"line\">        <span class=\"type\">OutputStream</span> <span class=\"variable\">out</span> <span class=\"operator\">=</span> response.getOutputStream();</span><br><span class=\"line\">        out.write(bytes);</span><br><span class=\"line\">        out.flush();</span><br><span class=\"line\">        out.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 等比压缩，获取压缩百分比</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> height 图片的高度</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> weight 图片的宽度</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 压缩百分比</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">getPercent</span><span class=\"params\">(<span class=\"type\">float</span> height, <span class=\"type\">float</span> weight)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">float</span> <span class=\"variable\">percent</span> <span class=\"operator\">=</span> <span class=\"number\">0.0F</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (height &gt; weight) &#123;</span><br><span class=\"line\">            percent = PageSize.A4.getHeight() / height * <span class=\"number\">100</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            percent = PageSize.A4.getWidth() / weight * <span class=\"number\">100</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Math.round(percent);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"页面效果\"><a href=\"#页面效果\" class=\"headerlink\" title=\"页面效果\"></a>页面效果</h2><p><img src=\"/images/2020/08/20200825195615602.png\" alt=\"在这里插入图片描述\"></p>\n<blockquote>\n<p>这就是系统启动之后的页面效果，虽然页面比较简陋，但是功能却没有任何折扣，有兴趣或者有需要的同学可以自己搭建一下，试一试图片转换PDF文件的效果。</p>\n</blockquote>\n<blockquote>\n<p><strong>注意：作者自己测试了一下，普通图片基本是没有问题的，但是遇到一些特殊的图片可能会出现异常，毕竟只是一个比较简单的图片转换PDF系统，难以兼容所有图片。</strong></p>\n</blockquote>\n","categories":["Java"],"tags":["Java","PDF"]},{"title":"Java异常try{}catch{}中的return机制","url":"/2020/03/27/java/Java%E5%BC%82%E5%B8%B8try%7B%7Dcatch%7B%7D%E4%B8%AD%E7%9A%84return%E6%9C%BA%E5%88%B6/","content":"<blockquote>\n<p>什么是Java的异常体系？参考博客：<a href=\"/2020/02/02/java/Java基础——运行时异常和非运行时异常/\">Java基础——运行时异常和非运行时异常</a></p>\n</blockquote>\n<span id=\"more\"></span>\n<h1 id=\"Java异常的处理方式\"><a href=\"#Java异常的处理方式\" class=\"headerlink\" title=\"Java异常的处理方式\"></a>Java异常的处理方式</h1><h2 id=\"throw\"><a href=\"#throw\" class=\"headerlink\" title=\"throw\"></a>throw</h2><ul>\n<li><code>throw</code>是Java中的一个关键字，可以在方法上声明抛出一个异常，如果方法体中发生了异常，那么方法会通过<code>throw</code>关键字将异常抛出。</li>\n<li>Java使用throw关键字抛出异常后，会抛给调用该方法的上一层方法，如果该异常是非运行时异常，那么调用该方法的上一层方法，也需要进行异常处理，<code>throw</code>或者<code>try&#123;&#125;catch&#123;&#125;</code>。</li>\n<li>如果该方法声明抛出后，方法中发生了异常，而且该方法是最顶层的方法，没有其他方法调用该方法，那么异常就会被抛给JVM，由JVM进行异常处理。</li>\n</ul>\n<h2 id=\"try-catch\"><a href=\"#try-catch\" class=\"headerlink\" title=\"try{}catch{}\"></a>try{}catch{}</h2><ul>\n<li>在Java的异常体系之中，除了使用<code>throw</code>关键字将异常声明抛出之外，还可以使用<code>try&#123;&#125;catch&#123;&#125;</code>的方式将异常捕获。</li>\n<li>Java的异常中，非运行时异常，Java代码编译规定必须进行显式处理的，要么使用<code>throw</code>进行抛出，要么就使用<code>try&#123;&#125;catch&#123;&#125;</code>进行异常的捕获。</li>\n</ul>\n<h1 id=\"try-catch-的执行顺序\"><a href=\"#try-catch-的执行顺序\" class=\"headerlink\" title=\"try{}catch{}的执行顺序\"></a>try{}catch{}的执行顺序</h1><h2 id=\"正常情况\"><a href=\"#正常情况\" class=\"headerlink\" title=\"正常情况\"></a>正常情况</h2><ul>\n<li>如果是正常情况，代码中没有异常发生，那么代码只会执行try{}中的代码，而catch{}中的代码不会执行。<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">\tSystem.out.println(<span class=\"string\">&quot;代码正常执行......&quot;</span>);</span><br><span class=\"line\">&#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">\tSystem.out.println(<span class=\"string\">&quot;代码发生异常后执行......&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n正常情况下，以上代码的执行结果是：<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">代码正常执行......</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<h2 id=\"发生异常\"><a href=\"#发生异常\" class=\"headerlink\" title=\"发生异常\"></a>发生异常</h2><ul>\n<li>如果try{}中的代码发生了异常，那么发生异常前的代码会正常执行，而try{}中发生异常后的代码将不会再执行（除了<code>return</code>之外），而是执行catch{}中的代码。<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">\tSystem.out.println(<span class=\"string\">&quot;代码正常执行......&quot;</span>);</span><br><span class=\"line\">\t<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">1</span>/<span class=\"number\">0</span>;</span><br><span class=\"line\">\tSystem.out.println(<span class=\"string\">&quot;代码发生异常了......&quot;</span>);</span><br><span class=\"line\">&#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">\tSystem.out.println(<span class=\"string\">&quot;代码发生异常后执行......&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n发生异常的情况下，以上代码的执行结果是：<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">代码正常执行......</span><br><span class=\"line\">代码发生异常后执行......</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"finally代码块\"><a href=\"#finally代码块\" class=\"headerlink\" title=\"finally代码块\"></a>finally代码块</h2></li>\n<li><code>finally</code>是<code>try&#123;&#125;catch&#123;&#125;</code>体系中的一部分，全部代码书写为<code>try&#123;&#125;catch&#123;&#125;finally&#123;&#125;</code>。</li>\n<li>finally代码块的特点是，无论try{}中是否发生了异常，最后都会执行finally中的代码。</li>\n</ul>\n<p><strong>正常情况</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">\tSystem.out.println(<span class=\"string\">&quot;代码正常执行......&quot;</span>);</span><br><span class=\"line\">&#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">\tSystem.out.println(<span class=\"string\">&quot;代码发生异常后执行......&quot;</span>);</span><br><span class=\"line\">&#125;<span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">\tSystem.out.println(<span class=\"string\">&quot;finally代码块中的代码一定会执行......&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>正常情况下，以上代码的执行结果是：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">代码正常执行......</span><br><span class=\"line\"><span class=\"keyword\">finally</span>代码块中的代码一定会执行......</span><br></pre></td></tr></table></figure>\n<p><strong>发生异常</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">\tSystem.out.println(<span class=\"string\">&quot;代码正常执行......&quot;</span>);</span><br><span class=\"line\">\t<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">1</span>/<span class=\"number\">0</span>;</span><br><span class=\"line\">\tSystem.out.println(<span class=\"string\">&quot;代码发生异常了......&quot;</span>);</span><br><span class=\"line\">&#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">\tSystem.out.println(<span class=\"string\">&quot;代码发生异常后执行......&quot;</span>);</span><br><span class=\"line\">&#125;<span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">\tSystem.out.println(<span class=\"string\">&quot;finally代码块中的代码一定会执行......&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>发生异常的情况下，以上代码的执行结果是：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">代码正常执行......</span><br><span class=\"line\">代码发生异常后执行......</span><br><span class=\"line\"><span class=\"keyword\">finally</span>代码块中的代码一定会执行......</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"try-catch-finally-中的return\"><a href=\"#try-catch-finally-中的return\" class=\"headerlink\" title=\"try{}catch{}finally{}中的return\"></a>try{}catch{}finally{}中的return</h1><blockquote>\n<p>以上的情况都是方法是无返回值的情况，如果方法是有返回值的，并且在try{}catch{}finally{}中都有return，那么方法该return那个返回值呢？</p>\n</blockquote>\n<h2 id=\"return的位置\"><a href=\"#return的位置\" class=\"headerlink\" title=\"return的位置\"></a>return的位置</h2><p>在探索<code>try&#123;&#125;catch&#123;&#125;finally&#123;&#125;</code>中<code>return</code>的时机之前，我们先根据return的位置，定义一下<code>return</code>的类型。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> String <span class=\"title function_\">test</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t<span class=\"type\">String</span> <span class=\"variable\">str</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;start&quot;</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">return</span> <span class=\"variable\">str</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;try ruturn&quot;</span>;\t\t\t<span class=\"comment\">//这里定义为正常return</span></span><br><span class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">return</span> <span class=\"variable\">str</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;catch ruturn&quot;</span>;\t\t<span class=\"comment\">//这里定义为异常return</span></span><br><span class=\"line\">\t&#125;<span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">return</span> <span class=\"variable\">str</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;finally ruturn&quot;</span>;\t\t<span class=\"comment\">//这里定义为最终return</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"string\">&quot;method return&quot;</span>;\t\t\t\t\t<span class=\"comment\">//这里定义为方法return</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"return的规则\"><a href=\"#return的规则\" class=\"headerlink\" title=\"return的规则\"></a>return的规则</h2><ul>\n<li><code>最终return</code>和<code>方法return</code>是互斥的，即在一个方法中，<code>最终return</code>和<code>方法return</code>只能写一个，否则编译无法通过（或者IDE会报错）。</li>\n<li>当<code>正常return</code>和<code>异常return</code>都有的时候，<code>最终return</code>可有可无，但是<code>方法return</code>一定不能有，否则报错。</li>\n<li>当有<code>最终return</code>的时候，<code>正常return</code>和<code>异常return</code>可有可无。</li>\n<li>当没有<code>最终return</code>的时候，要么一定要有<code>正常return</code>和<code>异常return</code>，要么一定要有<code>方法return</code>。</li>\n</ul>\n<h2 id=\"return的执行顺序\"><a href=\"#return的执行顺序\" class=\"headerlink\" title=\"return的执行顺序\"></a>return的执行顺序</h2><p><strong>当方法中return的时候，那么<code>try&#123;&#125;catch&#123;&#125;finally&#123;&#125;</code>中的代码顺序又该怎么执行呢？</strong></p>\n<p>首先，我们来看一下代码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\tSystem.out.println(<span class=\"string\">&quot;main:&quot;</span>+test());</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> String <span class=\"title function_\">test</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t<span class=\"type\">String</span> <span class=\"variable\">str</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;start&quot;</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">\t\tSystem.out.println(<span class=\"string\">&quot;try:&quot;</span> + str);</span><br><span class=\"line\">\t\tSystem.out.println(<span class=\"string\">&quot;try is running......&quot;</span>);</span><br><span class=\"line\">\t\t<span class=\"type\">return</span> <span class=\"variable\">str</span> <span class=\"operator\">=</span> str + <span class=\"string\">&quot;-&gt;try return&quot;</span>;</span><br><span class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">\t\tSystem.out.println(<span class=\"string\">&quot;catch:&quot;</span> + str);</span><br><span class=\"line\">\t\tSystem.out.println(<span class=\"string\">&quot;catch is running......&quot;</span>);</span><br><span class=\"line\">\t\t<span class=\"type\">return</span> <span class=\"variable\">str</span> <span class=\"operator\">=</span> str + <span class=\"string\">&quot;-&gt;catch return&quot;</span>;</span><br><span class=\"line\">\t&#125;<span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">\t\tSystem.out.println(<span class=\"string\">&quot;finally:&quot;</span> + str);</span><br><span class=\"line\">\t\tstr = <span class=\"string\">&quot;finally:&quot;</span> + str;</span><br><span class=\"line\">\t\tSystem.out.println(<span class=\"string\">&quot;finally is running......&quot;</span>);</span><br><span class=\"line\">\t\t<span class=\"type\">return</span> <span class=\"variable\">str</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;-&gt;finally return&quot;</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>该段代码的执行结果是：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">try</span>:start</span><br><span class=\"line\"><span class=\"keyword\">try</span> is running......</span><br><span class=\"line\"><span class=\"keyword\">finally</span>:start-&gt;<span class=\"keyword\">try</span> <span class=\"keyword\">return</span>\t#这里是System.out.println(<span class=\"string\">&quot;finally:&quot;</span> + str);的输出结果，我们发现str变成了start-&gt;<span class=\"keyword\">try</span> <span class=\"keyword\">return</span></span><br><span class=\"line\"><span class=\"keyword\">finally</span> is running......</span><br><span class=\"line\">main:-&gt;<span class=\"keyword\">finally</span> <span class=\"keyword\">return</span></span><br></pre></td></tr></table></figure>\n\n<p>如果我们去掉finally中的return的话：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\tSystem.out.println(<span class=\"string\">&quot;main:&quot;</span>+test());</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> String <span class=\"title function_\">test</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">\t<span class=\"type\">String</span> <span class=\"variable\">str</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;start&quot;</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">\t\tSystem.out.println(<span class=\"string\">&quot;try:&quot;</span> + str);</span><br><span class=\"line\">\t\tSystem.out.println(<span class=\"string\">&quot;try is running......&quot;</span>);</span><br><span class=\"line\">\t\t<span class=\"type\">return</span> <span class=\"variable\">str</span> <span class=\"operator\">=</span> str + <span class=\"string\">&quot;-&gt;try return&quot;</span>;</span><br><span class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">\t\tSystem.out.println(<span class=\"string\">&quot;catch:&quot;</span> + str);</span><br><span class=\"line\">\t\tSystem.out.println(<span class=\"string\">&quot;catch is running......&quot;</span>);</span><br><span class=\"line\">\t\t<span class=\"type\">return</span> <span class=\"variable\">str</span> <span class=\"operator\">=</span> str + <span class=\"string\">&quot;-&gt;catch return&quot;</span>;</span><br><span class=\"line\">\t&#125;<span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">\t\tSystem.out.println(<span class=\"string\">&quot;finally:&quot;</span> + str);</span><br><span class=\"line\">\t\tstr = <span class=\"string\">&quot;finally:&quot;</span> + str;</span><br><span class=\"line\">\t\tSystem.out.println(<span class=\"string\">&quot;finally is running......&quot;</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>执行结果为：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">try</span>:start</span><br><span class=\"line\"><span class=\"keyword\">try</span> is running......</span><br><span class=\"line\"><span class=\"keyword\">finally</span>:start-&gt;<span class=\"keyword\">try</span> <span class=\"keyword\">return</span> #这里是System.out.println(<span class=\"string\">&quot;finally:&quot;</span> + str);的输出结果，我们发现str变成了start-&gt;<span class=\"keyword\">try</span> <span class=\"keyword\">return</span></span><br><span class=\"line\"><span class=\"keyword\">finally</span> is running......</span><br><span class=\"line\">main:start-&gt;<span class=\"keyword\">try</span> <span class=\"keyword\">return</span>\t#这里执行了<span class=\"keyword\">finally</span>的代码，但是<span class=\"keyword\">return</span>的结果依然是<span class=\"keyword\">try</span>中的返回结果。</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"return的执行顺序分析图\"><a href=\"#return的执行顺序分析图\" class=\"headerlink\" title=\"return的执行顺序分析图\"></a>return的执行顺序分析图</h2><p><img src=\"/images/2020/03/20200327214558729.png\" alt=\"在这里插入图片描述\"><br><img src=\"/images/2020/03/20200327215517426.png\" alt=\"在这里插入图片描述\"><br><strong>如果try中发生异常，代码跳转至<code>catch&#123;&#125;</code>中执行，那么<code>return</code>的执行顺序和原理是和<code>try&#123;&#125;</code>中是一致的。</strong></p>\n","categories":["Java"],"tags":["Java"]},{"title":"Java日志记录之Slf4j","url":"/2020/08/20/java/Java%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95%E4%B9%8BSlf4j/","content":"<blockquote>\n<p>日志记录是Java开发中一个非常重要的部分，一份详细精确的日志记录，能够让我们快速地排查系统运行中所出现的问题，大大地提升我们的开发效率。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h2 id=\"什么是Slf4j和Log4j\"><a href=\"#什么是Slf4j和Log4j\" class=\"headerlink\" title=\"什么是Slf4j和Log4j\"></a>什么是Slf4j和Log4j</h2><p>如果是初学者看到这两个名字，或者知道他们是和日志记录有关的类库，但是又搞不清楚两者之间的关系？</p>\n<p>首选，我们先从名字来说起，这两个类库的名字都有一个共同的地方，那就是<code>4j</code>，其实<code>4j</code>就是<code>for java</code>的缩写，这两个类库的全称其实是<code>Slf for java</code>和<code>Log for java</code>，简而言之，就是Java的日志记录类库。</p>\n<p>其中Slf4j是一个日志记录的API接口，而Log4j则是底层的具体实现，我们在一般使用的时候，都会直接使用Slf4j为我们提供的日志记录的接口，至于底层实现，我们只需要引入Log4j的依赖即可。</p>\n<ul>\n<li><strong>Slf4j的依赖</strong></li>\n</ul>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.slf4j<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>slf4j-log4j12<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.7.25<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>在这个依赖中，Slf4j又自动依赖了Log4j的依赖，所以我们只需要引入一个依赖即可。</p>\n<p><img src=\"/images/2020/08/20200820073650643.png#pic_left\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"Slf4j的初步使用\"><a href=\"#Slf4j的初步使用\" class=\"headerlink\" title=\"Slf4j的初步使用\"></a>Slf4j的初步使用</h2><ul>\n<li>在正是使用Slf4j记录日志之前，我们还需要了解一下Log4j的日志配置文件。</li>\n</ul>\n<p><strong>log4j.properties</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"># log4j的日志记录属性</span><br><span class=\"line\"># DEBUG, INOF，ERROR  第一个参数为日志记录级别</span><br><span class=\"line\"># Console, File, DailyRollingFile, RollingFile  第二个参数为日志记录的方式</span><br><span class=\"line\">log4j.rootLogger=debug, File</span><br><span class=\"line\"></span><br><span class=\"line\">#Console  控制台打印日志，该方式会将日志打印在控制台中</span><br><span class=\"line\">log4j.appender.Console=org.apache.log4j.ConsoleAppender</span><br><span class=\"line\">log4j.appender.Console.layout=org.apache.log4j.PatternLayout</span><br><span class=\"line\">log4j.appender.Console.layout.ConversionPattern=%d [%t] %-5p [%c] - %m%n</span><br><span class=\"line\"></span><br><span class=\"line\">#File\t文件记录方式，该方式会将日志记录在log4j.appender.File.File路径的文件中</span><br><span class=\"line\">log4j.appender.File = org.apache.log4j.FileAppender</span><br><span class=\"line\">log4j.appender.File.File = log/err.log</span><br><span class=\"line\">log4j.appender.File.layout = org.apache.log4j.PatternLayout</span><br><span class=\"line\">log4j.appender.File.layout.ConversionPattern =%d [%t] %-5p [%c] - %m%n</span><br><span class=\"line\"></span><br><span class=\"line\">#DailyRollingFile\t每天产生一个新的日志记录文件</span><br><span class=\"line\">log4j.appender.DailyRollingFile = org.apache.log4j.DailyRollingFileAppender</span><br><span class=\"line\">log4j.appender.DailyRollingFile.File = log/err.log</span><br><span class=\"line\">log4j.appender.DailyRollingFile.layout = org.apache.log4j.PatternLayout</span><br><span class=\"line\">log4j.appender.DailyRollingFile.layout.ConversionPattern =%d [%t] %-5p [%c] - %m%n</span><br><span class=\"line\"></span><br><span class=\"line\">#RollingFile\t文件达到指定大小的时候产生新的日志文件</span><br><span class=\"line\">log4j.appender.RollingFile = org.apache.log4j.RollingFileAppender</span><br><span class=\"line\">log4j.appender.RollingFile.File = log/err.log</span><br><span class=\"line\">log4j.appender.RollingFile.MaxFileSize=1KB</span><br><span class=\"line\">log4j.appender.RollingFile.MaxBackupIndex=<span class=\"number\">3</span></span><br><span class=\"line\">log4j.appender.RollingFile.layout = org.apache.log4j.PatternLayout</span><br><span class=\"line\">log4j.appender.RollingFile.layout.ConversionPattern =%d [%t] %-5p [%c] - %m%n</span><br></pre></td></tr></table></figure>\n<p><strong>LogTest</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">LogTest</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 使用LoggerFactory创建一个Logger对象</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"type\">Logger</span> <span class=\"variable\">logger</span> <span class=\"operator\">=</span> LoggerFactory.getLogger(<span class=\"built_in\">this</span>.getClass());</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">delete</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        logger.info(<span class=\"string\">&quot;记录信息日志&quot;</span>);</span><br><span class=\"line\">        logger.warn(<span class=\"string\">&quot;记录警告日志&quot;</span>);</span><br><span class=\"line\">        logger.error(<span class=\"string\">&quot;记录错误日志&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>我们运行该代码，发现日志文件已经被记录到指定的<code>log/err.log</code>文件中。</p>\n<h2 id=\"Lombox和Slf4j\"><a href=\"#Lombox和Slf4j\" class=\"headerlink\" title=\"Lombox和Slf4j\"></a>Lombox和Slf4j</h2><p>在每次记录日志的时候，我们都需要在每个类中使用<code>LoggerFactory</code>来创建一个日志记录对象，而在Lombox中，为我们提供了一个更为简便的方式来创建Logger对象记录日志。</p>\n<p><strong><code>@Slf4j</code></strong></p>\n<p>我们只需要在类上使用<code>@Slf4j</code>注解，那么Lombox就会自动为该类注入一个属性名为<code>log</code>的日志记录对象，我们就可以使用该对象来进行日志记录。</p>\n<ul>\n<li>首先，我们需要引入Lombox和Slf4j的依赖。</li>\n</ul>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.projectlombok<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>lombok<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.16.22<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.slf4j<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>slf4j-log4j12<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.7.25<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>Lombox除了需要引入相关依赖外，还需要安装Lombox插件才能够使用，其中IDEA自动集成了Lombox，我们可以直接通过IDEA的插件功能下载安装Lombox。</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">LogTest</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">delete</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        log.info(<span class=\"string\">&quot;记录信息日志&quot;</span>);</span><br><span class=\"line\">        log.warn(<span class=\"string\">&quot;记录警告日志&quot;</span>);</span><br><span class=\"line\">        log.error(<span class=\"string\">&quot;记录错误日志&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>注意：Lombox自动注入的log对象和我们自己使用LoggerFactory获取的logger对象都是Logger类的对象，只是对象名称不同而已。</strong></p>\n","categories":["Java"],"tags":["Java"]},{"title":"Java网络编程","url":"/2020/04/01/java/Java%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/","content":"<h2 id=\"软件结构\"><a href=\"#软件结构\" class=\"headerlink\" title=\"软件结构\"></a>软件结构</h2><p><strong>软件结构一般分为C/S和B/S结构。</strong></p>\n<ul>\n<li>C/S结构：全称为Client/Server结构，是指客户端和服务器端结构，常见程序有：QQ、微信等等。</li>\n<li>B/S结构：全称为Browser/Server结构，是指浏览器和服务器结构，常见的浏览器有：谷歌、火狐。<span id=\"more\"></span></li>\n</ul>\n<p><strong>两种架构各有优势，但是无论是哪种架构，都离不开网络的支持，网络编程，就是在一定的协议下，实现两台计算机的通信的程序。</strong></p>\n<h2 id=\"网络通信协议\"><a href=\"#网络通信协议\" class=\"headerlink\" title=\"网络通信协议\"></a>网络通信协议</h2><ul>\n<li>网络通信协议：通过计算机网络可以使多台计算机实现连接，位于同一个网络中的计算机在进行连接和通信时一定要遵守一定的规则。在计算机网络中，这些连接和通信的规则被称为网络通信协议。它对数据的传输格式、传输速率、传输步骤等做了统一规定，通信双方必须同时遵守才能完成数据交换。</li>\n<li>TCP/IP协议：传输控制协议/因特网互联协议，是Internet最基本的、最广泛的协议，它定义了计算机如何连入因特网，以及数据如何在它们之间传输的标准，它的内部包含了一系列的用于处理数据通信的协议，并采用了4层的分层模型，每一层都呼叫它的下一层所提供的协议来完成自己的请求。</li>\n</ul>\n<h2 id=\"传输层协议\"><a href=\"#传输层协议\" class=\"headerlink\" title=\"传输层协议\"></a>传输层协议</h2><p><strong>UDP</strong></p>\n<ul>\n<li>用户数据报协议，UDP是无连接通信协议，即在数据传输时，数据的发送端和接收端不建立逻辑连接。简单来说，当一台计算机向另外一台计算机发送数据的时候，发送端不会确认接收端是否存在，就会发出数据，同时接收端在收到数据时，也不会向发送端反馈是否收到数据。</li>\n<li>由于使用UDP协议消耗资源小，通信效率高，所以通常都会用于音频、视频和普通数据的传输。例如视频会议都是用UDP协议，因为这种情况即使是丢失一两个包，也不会对接收结果产生太大的影响。</li>\n<li>但是在使用UPD协议传送数据的时候，由于UDP协议的面向无连接特性，不能保证数据的完整性，因此在传输重要数据时，不建议使用UDP协议。</li>\n<li>特点：数据被限制在64kb以内，超出这个范围就不能发送了。</li>\n</ul>\n<p><strong>TCP</strong></p>\n<ul>\n<li>传输数据协议，TCP是面向连接的通信协议，即传输数据之前，在发送端和接收端建立逻辑连接，然后再传输数据，它提供了两台计算机之间可靠无差错的数据传输。</li>\n<li>在TCP连接中必须要明确客户端和服务器端，由客户端向服务器端发出连接请求，每次连接的创建都需要经过三次握手。</li>\n<li>TCP协议可以参考博客：<a href=\"/2020/03/22/computer/TCP协议的三次握手和四次挥手/\">TCP协议的三次握手和四次挥手</a>。</li>\n</ul>\n<h2 id=\"IP地址\"><a href=\"#IP地址\" class=\"headerlink\" title=\"IP地址\"></a>IP地址</h2><p><strong>IP地址：指互联网协议地址，IP地址是用来给一个网络中的计算机设备的唯一编号。</strong></p>\n<p><strong>IPv4：</strong> 指一个32位的二进制数，通常被分为4个字节，表示成a.b.c.d的形式，其中a、b、c、d都是0~255之间的十进制整数，那么最多可以表示42亿个。</p>\n<p><strong>IPv6：</strong> 由于互联网的蓬勃发展，IP地址的需求量愈来愈大，但是网络地址资源有限，使得IP的分配越发紧张，为了扩大地址空间，拟通过IPv6重新定义地址空间，采用128位地址长度，每16个字节一组，分成8组十六进制。IPv6号称可以给全世界的每一粒沙子编上一个网址，这样就解决了网络地址资源数量不足的问题。</p>\n<h2 id=\"端口号\"><a href=\"#端口号\" class=\"headerlink\" title=\"端口号\"></a>端口号</h2><p>端口号是一个逻辑端口，我们无法直接看到，可以使用一些软件查看端口号。</p>\n<p>端口号是由两个字节组成的，取值范围在0-65535之间。</p>\n<p><strong>【注意】1024之前的端口号不允许使用，因为这些端口号已经被系统分配给已知道的网络软件了。</strong><br><strong>【注意】端口号不能重复。</strong></p>\n<p><strong>常用端口号</strong></p>\n<ul>\n<li>80：网络端口</li>\n<li>8080：Tomcat</li>\n<li>3306：MySQL</li>\n</ul>\n<h2 id=\"Java程序实现TCP通信\"><a href=\"#Java程序实现TCP通信\" class=\"headerlink\" title=\"Java程序实现TCP通信\"></a>Java程序实现TCP通信</h2><p><strong>客户端</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">TCPClient</span> &#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">Socket</span> <span class=\"variable\">socket</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Socket</span>(<span class=\"string\">&quot;127.0.0.1&quot;</span>,<span class=\"number\">8888</span>);</span><br><span class=\"line\">\t\t<span class=\"type\">OutputStream</span> <span class=\"variable\">os</span> <span class=\"operator\">=</span> socket.getOutputStream();</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\tos.write(<span class=\"string\">&quot;您好，服务器&quot;</span>.getBytes());</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"type\">InputStream</span> <span class=\"variable\">is</span> <span class=\"operator\">=</span> socket.getInputStream();</span><br><span class=\"line\">\t\t<span class=\"type\">byte</span>[] bytes = <span class=\"keyword\">new</span> <span class=\"title class_\">byte</span>[<span class=\"number\">1024</span>];</span><br><span class=\"line\">\t\t<span class=\"type\">int</span> <span class=\"variable\">len</span> <span class=\"operator\">=</span> is.read(bytes);</span><br><span class=\"line\">\t\tSystem.out.println(<span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(bytes,<span class=\"number\">0</span>,len));</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\tsocket.close();</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>服务器端</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">TCPServer</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">\t\t<span class=\"type\">ServerSocket</span> <span class=\"variable\">server</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ServerSocket</span>(<span class=\"number\">8888</span>);</span><br><span class=\"line\">\t\t<span class=\"type\">Socket</span> <span class=\"variable\">socket</span> <span class=\"operator\">=</span> server.accept();</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"type\">InputStream</span> <span class=\"variable\">is</span> <span class=\"operator\">=</span> socket.getInputStream();</span><br><span class=\"line\">\t\t<span class=\"type\">byte</span>[] bytes = <span class=\"keyword\">new</span> <span class=\"title class_\">byte</span>[<span class=\"number\">1024</span>];</span><br><span class=\"line\">\t\t<span class=\"type\">int</span> <span class=\"variable\">len</span> <span class=\"operator\">=</span> is.read(bytes);</span><br><span class=\"line\">\t\tSystem.out.println(<span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(bytes,<span class=\"number\">0</span>,len));</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"type\">OutputStream</span> <span class=\"variable\">os</span> <span class=\"operator\">=</span> socket.getOutputStream();</span><br><span class=\"line\">\t\tos.write(<span class=\"string\">&quot;收到，谢谢&quot;</span>.getBytes());</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\tsocket.close();</span><br><span class=\"line\">\t\tserver.close();</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","categories":["Java"],"tags":["Java"]},{"title":"Java自定义异常","url":"/2020/03/23/java/Java%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%82%E5%B8%B8/","content":"<blockquote>\n<p>在Java中，异常是Java的一个类，所有的异常都是以Java对象的形式存在Java程序中，异常最顶层的类是Exception，Exception和它的所有子类构成了Java的异常体系。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h1 id=\"Java的异常体系\"><a href=\"#Java的异常体系\" class=\"headerlink\" title=\"Java的异常体系\"></a>Java的异常体系</h1><p>如果不了解Java的异常体系，可以参考我以前写的博客<a href=\"/2020/02/02/java/运行时异常和非运行时异常/\">Java基础——运行时异常和非运行时异常</a>。</p>\n<h1 id=\"自定义异常\"><a href=\"#自定义异常\" class=\"headerlink\" title=\"自定义异常\"></a>自定义异常</h1><p>在Java中，JDK已经帮我们定义了很多异常，例如IOException，SQLException等等，但是这并不意味着JDK已经把所有的异常囊括其中了，对于开发环境的各种需要，很多时候，可能需要我们自定义一些异常，以帮我们完成开发。</p>\n<h2 id=\"怎么自定义异常？\"><a href=\"#怎么自定义异常？\" class=\"headerlink\" title=\"怎么自定义异常？\"></a>怎么自定义异常？</h2><p>刚刚已经说过了，Exception类和它的子类构成了Java语言的异常体系。所以，如果我们想要自定义一个异常，那么就直接继承Exception类或者它的子类就可以了，凡是由Exception类和它的子类派生出来的类，都是一个异常类。</p>\n<h2 id=\"自定义异常的区别\"><a href=\"#自定义异常的区别\" class=\"headerlink\" title=\"自定义异常的区别\"></a>自定义异常的区别</h2><p>在Java的异常体系中，分为运行时异常和非运行时异常，所以我们自定义的异常也被区分在这两种异常类别中。</p>\n<ul>\n<li>其中凡是继承自RuntimeException的异常，都是运行时异常。</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyException</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">RuntimeException</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//运行时异常</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>继承Exception或者Exception的子类（非RuntimeException异常）的异常都是非运行时异常。</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyException</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Exception</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//非运行时异常</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>自定义的异常同样符合Java异常体系的所有特点，运行时异常我们可以不需要捕获，非运行时异常需要我们手动抛出或者捕获异常。</p>\n<h1 id=\"枚举\"><a href=\"#枚举\" class=\"headerlink\" title=\"枚举\"></a>枚举</h1><p>在自定义异常中，我们为了便于管理和实例化自定义异常类，一般会将异常信息定义在枚举类。</p>\n<h2 id=\"什么是枚举？\"><a href=\"#什么是枚举？\" class=\"headerlink\" title=\"什么是枚举？\"></a>什么是枚举？</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">enum</span>  <span class=\"title class_\">ExceptionEnum</span> &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>枚举类使用<code>enum</code>作为关键字，声明这是一个枚举类。</p>\n<p>枚举类其实就是一个普通的Java类，但是这个类默认继承了<code>java.lang.Enum</code>类，所以比起Java中的普通类，有了一些其他的特征，这就是枚举类的特征。</p>\n<ul>\n<li>非抽象的枚举类，默认使用<code>final</code>修饰，所以枚举类不能派生子类。</li>\n<li>枚举类只能定义一个<code>public</code>修饰的类，而且类名必须与文件名相同（和普通的Java类规则相同）。</li>\n<li>枚举类的构造器默认是<code>private</code>，所以外部无法创建枚举类的实例对象，只能由枚举类自身创建。</li>\n<li>枚举类的实例对象必须在枚举类的第一行显示标识出来，这些实例对象默认是<code>public static final</code>修饰的属性。</li>\n<li>枚举对象默认提供了一个<code>values()</code>方法，用于遍历该枚举类的所有实例对象，返回值是一个枚举类数组。</li>\n</ul>\n<h2 id=\"使用枚举定义异常信息\"><a href=\"#使用枚举定义异常信息\" class=\"headerlink\" title=\"使用枚举定义异常信息\"></a>使用枚举定义异常信息</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@AllArgsConstructor</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">enum</span>  <span class=\"title class_\">ExceptionEnum</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 代码错误异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    CODE_ERROR(<span class=\"number\">500</span>,<span class=\"string\">&quot;代码错误&quot;</span>),</span><br><span class=\"line\">    REQUEST_ERROR(<span class=\"number\">400</span>,<span class=\"string\">&quot;请求错误&quot;</span>),</span><br><span class=\"line\">    ;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer statusCode;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String message;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"自定义异常实战\"><a href=\"#自定义异常实战\" class=\"headerlink\" title=\"自定义异常实战\"></a>自定义异常实战</h1><h2 id=\"自定义运行时异常\"><a href=\"#自定义运行时异常\" class=\"headerlink\" title=\"自定义运行时异常\"></a>自定义运行时异常</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@AllArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@NoArgsConstructor</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyException</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">RuntimeException</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> ExceptionEnum exceptionEnum;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>功能测试</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Test</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyException</span>(ExceptionEnum.CODE_ERROR);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>结果</strong><br><img src=\"/images/2020/03/20200323003301480.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"自定义非运行时异常\"><a href=\"#自定义非运行时异常\" class=\"headerlink\" title=\"自定义非运行时异常\"></a>自定义非运行时异常</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@AllArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@NoArgsConstructor</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyException</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">Exception</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> ExceptionEnum exceptionEnum;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>功能测试</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Test</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> MyException &#123;</span><br><span class=\"line\">    <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MyException</span>(ExceptionEnum.REQUEST_ERROR);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>结果</strong><br><img src=\"/images/2020/03/20200323003410442.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["Java"],"tags":["Java"]},{"title":"Jwt封装工具类","url":"/2020/10/24/java/Jwt%E5%B0%81%E8%A3%85%E5%B7%A5%E5%85%B7%E7%B1%BB/","content":"<h2 id=\"一、引入依赖\"><a href=\"#一、引入依赖\" class=\"headerlink\" title=\"一、引入依赖\"></a>一、引入依赖</h2><p>首先，我们需要引入SpringBoot和Jwt相关的，其中jjwt是Java语言编写的一个Jwt实现依赖，里面封装了大量和Jwt相关的操作，我们可以直接使用。</p>\n<span id=\"more\"></span>\n\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class=\"tag\">&lt;/<span class=\"name\">project.build.sourceEncoding</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">project.reporting.outputEncoding</span>&gt;</span>UTF-8<span class=\"tag\">&lt;/<span class=\"name\">project.reporting.outputEncoding</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">java.version</span>&gt;</span>1.8<span class=\"tag\">&lt;/<span class=\"name\">java.version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">spring-boot.version</span>&gt;</span>2.3.2.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">spring-boot.version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">jjwt.version</span>&gt;</span>0.9.0<span class=\"tag\">&lt;/<span class=\"name\">jjwt.version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;spring-boot.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">relativePath</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--SpringMVC的启动器--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--jjwt，Java对JWT的封装工具依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>io.jsonwebtoken<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>jjwt<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;jjwt.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--Spring单元测试的启动器--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-test<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>test<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--lombox的依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.projectlombok<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>lombok<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"二、Jwt相关参数\"><a href=\"#二、Jwt相关参数\" class=\"headerlink\" title=\"二、Jwt相关参数\"></a>二、Jwt相关参数</h2><p>在封装Jwt工具类之前，我们先将一个属性配置在yml文件中，并使用SpringBoot的<code>@ConfigurationProperties</code>注解注入Java类的属性中。</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">zero:</span></span><br><span class=\"line\">  <span class=\"attr\">sys:</span></span><br><span class=\"line\">    <span class=\"attr\">security:</span></span><br><span class=\"line\">      <span class=\"attr\">jwt:</span></span><br><span class=\"line\">        <span class=\"attr\">secret:</span> <span class=\"string\">HdGkiOiI4ODgiLCJzdWIiOiLlsI</span></span><br><span class=\"line\">        <span class=\"attr\">ttl:</span> <span class=\"number\">3600000</span></span><br><span class=\"line\">        <span class=\"attr\">issuer:</span> <span class=\"string\">https://www.zero.com</span></span><br><span class=\"line\">        <span class=\"attr\">name:</span> <span class=\"string\">accessToken</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@NoArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@AllArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"meta\">@ConfigurationProperties(prefix = &quot;zero.sys.security.jwt&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">JwtProperties</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * JWT加密秘钥信息</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String secret;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Token过期时间，默认为1个小时</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Long ttl;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * token的签发者</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String issuer;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * token名称；accessToken</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"三、Jwt封装工具类\"><a href=\"#三、Jwt封装工具类\" class=\"headerlink\" title=\"三、Jwt封装工具类\"></a>三、Jwt封装工具类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">JwtUtils</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> JwtProperties jwtProperties;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">setJwtProperties</span><span class=\"params\">(JwtProperties jwtProperties)</span> &#123;</span><br><span class=\"line\">        JwtUtils.jwtProperties = jwtProperties;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> ObjectMapper objectMapper;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">setObjectMapper</span><span class=\"params\">(ObjectMapper objectMapper)</span> &#123;</span><br><span class=\"line\">        JwtUtils.objectMapper = objectMapper;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 由字符串生成加密key</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 返回一个加密的字符串数据</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception 抛出异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> SecretKey <span class=\"title function_\">generateKey</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">secret</span> <span class=\"operator\">=</span> jwtProperties.getSecret();</span><br><span class=\"line\">        <span class=\"comment\">// 本地的密码解码</span></span><br><span class=\"line\">        <span class=\"type\">byte</span>[] encodedKey = Base64.decodeBase64(secret);</span><br><span class=\"line\">        <span class=\"comment\">// 根据给定的字节数组使用AES加密算法构造一个密钥</span></span><br><span class=\"line\">        <span class=\"type\">SecretKey</span> <span class=\"variable\">key</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">SecretKeySpec</span>(encodedKey, <span class=\"number\">0</span>, encodedKey.length, <span class=\"string\">&quot;AES&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> key;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 创建JWT</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> id        JWT的ID</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> subject   JWT主体信息，一般以Json格式的数据存储</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> issuer    JWT签发者</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> ttlMillis JWT的有效时间，单位是毫秒</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> claims    创建payload的私有声明，也就是自定义的JWT信息</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 返回JWT</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception 抛出异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title function_\">createJWT</span><span class=\"params\">(String id, String subject, String issuer, Long ttlMillis, Map&lt;String, Object&gt; claims)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 指定签名的时候使用的签名算法，也就是header那部分，jjwt已经将这部分内容封装好了。</span></span><br><span class=\"line\">        <span class=\"type\">SignatureAlgorithm</span> <span class=\"variable\">signatureAlgorithm</span> <span class=\"operator\">=</span> SignatureAlgorithm.HS256;</span><br><span class=\"line\">        <span class=\"comment\">// 生成签名的时候使用的秘钥secret，切记这个秘钥不能外露哦。它就是你服务端的私钥，在任何场景都不应该流露出去，一旦客户端得知这个secret, 那就意味着客户端是可以自我签发jwt了。</span></span><br><span class=\"line\">        <span class=\"type\">SecretKey</span> <span class=\"variable\">key</span> <span class=\"operator\">=</span> generateKey();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 下面就是在为payload添加各种标准声明和私有声明了,这里其实就是new一个JwtBuilder，设置jwt的body</span></span><br><span class=\"line\">        <span class=\"type\">JwtBuilder</span> <span class=\"variable\">builder</span> <span class=\"operator\">=</span> Jwts.builder();</span><br><span class=\"line\">        <span class=\"comment\">// 设置签名使用的签名算法和签名使用的秘钥</span></span><br><span class=\"line\">        builder.signWith(signatureAlgorithm, key);</span><br><span class=\"line\">        <span class=\"comment\">// jti：设置JWT的ID，是JWT的唯一标识，根据业务需要，这个可以设置为一个不重复的值，主要用来作为一次性token,从而回避重放攻击</span></span><br><span class=\"line\">        builder.setId(id);</span><br><span class=\"line\">        <span class=\"comment\">// iat：JWT的签发时间，生成JWT的时间</span></span><br><span class=\"line\">        builder.setIssuedAt(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>());</span><br><span class=\"line\">        <span class=\"comment\">// iss：jwt签发人</span></span><br><span class=\"line\">        builder.setIssuer(issuer);</span><br><span class=\"line\">        <span class=\"comment\">// sub：代表这个JWT的主体，即它的所有人，这个是一个json格式的字符串，可以存放用户信息的，作为什么用户的唯一标志</span></span><br><span class=\"line\">        builder.setSubject(subject);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ObjectUtils.allNotNull(claims)) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 如果有私有声明，一定要先设置这个自己创建的私有的声明，这个是给builder的claim赋值，一旦写在标准的声明赋值之后，就是覆盖了那些标准的声明的</span></span><br><span class=\"line\">            builder.setClaims(claims);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// exp：设置过期时间</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ttlMillis &gt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"type\">Long</span> <span class=\"variable\">expiredMillis</span> <span class=\"operator\">=</span> System.currentTimeMillis() + ttlMillis;</span><br><span class=\"line\">            <span class=\"type\">Date</span> <span class=\"variable\">expiredDate</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>(expiredMillis);</span><br><span class=\"line\">            builder.setExpiration(expiredDate);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> builder.compact();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 创建JWT，默认配置了issuer（JWT签发者）</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> id        JWT的ID</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> subject   JWT主体信息，一般以Json格式的数据存储</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> ttlMillis JWT的有效时间，单位是毫秒</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> claims    创建payload的私有声明，也就是自定义的JWT信息</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 返回JWT</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception 抛出异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title function_\">createJWT</span><span class=\"params\">(String id, String subject, Long ttlMillis, Map&lt;String, Object&gt; claims)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> createJWT(id, subject, jwtProperties.getIssuer(), ttlMillis, claims);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 创建JWT，默认配置了issuer（JWT签发者），ttlMillis（有效时间）</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> id      JWT的ID</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> subject JWT主体信息，一般以Json格式的数据存储</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> claims  创建payload的私有声明，也就是自定义的JWT信息</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 返回JWT</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception 抛出异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title function_\">createJWT</span><span class=\"params\">(String id, String subject, Map&lt;String, Object&gt; claims)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> createJWT(id, subject, jwtProperties.getIssuer(), jwtProperties.getTtl(), claims);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 创建JWT，默认配置了issuer（JWT签发者），ttlMillis（有效时间）,默认claims为null</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> id      JWT的ID</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> subject JWT主体信息，一般以Json格式的数据存储</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 返回JWT</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception 抛出异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title function_\">createJWT</span><span class=\"params\">(String id, String subject)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> createJWT(id, subject, jwtProperties.getIssuer(), jwtProperties.getTtl(), <span class=\"literal\">null</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 解密JWT，如果秘钥错误，或者JWT被修改过，会直接抛出异常信息</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jwt JWT字符串信息</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 返回JWT载荷信息</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception 抛出异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Claims <span class=\"title function_\">parseJWT</span><span class=\"params\">(String jwt)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 签名秘钥，和生成的签名的秘钥一模一样</span></span><br><span class=\"line\">        <span class=\"type\">SecretKey</span> <span class=\"variable\">key</span> <span class=\"operator\">=</span> generateKey();</span><br><span class=\"line\">        <span class=\"comment\">// 得到DefaultJwtParser</span></span><br><span class=\"line\">        <span class=\"type\">Claims</span> <span class=\"variable\">claims</span> <span class=\"operator\">=</span> Jwts.parser()</span><br><span class=\"line\">                <span class=\"comment\">// 设置签名的秘钥</span></span><br><span class=\"line\">                .setSigningKey(key)</span><br><span class=\"line\">                <span class=\"comment\">// 设置需要解析的jwt</span></span><br><span class=\"line\">                .parseClaimsJws(jwt).getBody();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> claims;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 判断jwt是否已经过期</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jwt JWT字符串信息</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 如果jwt已经过期，返回true，否则返回false</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception 抛出异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">boolean</span> <span class=\"title function_\">isExpiration</span><span class=\"params\">(String jwt)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"type\">Claims</span> <span class=\"variable\">claims</span> <span class=\"operator\">=</span> JwtUtils.parseJWT(jwt);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> claims.getExpiration().before(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n","categories":["Java"],"tags":["Java","JWT"]},{"title":"Maven项目pom.xml project标签爆红解决方法","url":"/2020/08/19/java/Maven%E9%A1%B9%E7%9B%AEpom.xml%20project%E6%A0%87%E7%AD%BE%E7%88%86%E7%BA%A2%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/","content":"<p>今天在打开项目的时候，发现了一个Maven项目的问题，在Maven项目的pom.xml文件中，project标签爆出了一个错误。</p>\n<span id=\"more\"></span>\n\n<p><img src=\"/images/2020/08/20200819081650697.png\" alt=\"在这里插入图片描述\"></p>\n<blockquote>\n<p>‘parent.relativePath’ of POM com.hrp:springboot_jpa:1.0-SNAPSHOT (F:\\IdeaCode\\java-web\\springboot_jpa\\pom.xml) points at com.hrp:java-web instead of org.springframework.boot:spring-boot-starter-parent, please verify your project structure</p>\n</blockquote>\n<blockquote>\n<p>POM com.hrp：springboot_jpa：1.0-SNAPSHOT（F：\\ IdeaCode \\ java-web \\ springboot_jpa \\ pom.xml）的’parent.relativePath’指向com.hrp：java-web而不是org.springframework.boot：spring -boot-starter-parent，请验证您的项目结构</p>\n</blockquote>\n<p>总而言之，这个问题是说在project标签下的parent.relativePath标签指向的路径出现了错误，所以导致报错。</p>\n<p><strong>要解决这个问题的方法也很简单，在parent标签下添加一个<code>&lt;relativePath/&gt;</code>标签即可。</strong></p>\n<p><img src=\"/images/2020/08/20200819082030419.png\" alt=\"在这里插入图片描述\"><br><strong>添加该标签之后，我们重新更新Maven项目，爆错就会消失了</strong></p>\n<p><img src=\"/images/2020/08/20200819082324299.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["Java"],"tags":["Java","IDEA","Maven"]},{"title":"MyBatisPlus升级3.4.3.1版本报错：MybatisConfiguration$StrictMap$Ambiguity cannot be cast to ResultMap","url":"/2021/06/29/java/MyBatisPlus%E5%8D%87%E7%BA%A73.4.3.1%E7%89%88%E6%9C%AC%E6%8A%A5%E9%94%99/","content":"<h2 id=\"问题描述\"><a href=\"#问题描述\" class=\"headerlink\" title=\"问题描述\"></a>问题描述</h2><blockquote>\n<p>SpringBoot 版本：2.5.2<br>项目原本的 MyBatisPlus 版本为：3.4.0，项目可以正常启动运行，但是在将 MyBatisPlus 的版本升级至 3.4.3.1之后，项目启动 MyBatisPlus 就开始报错了。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<p>报错信息较多，在这里截取其中比较重要的几段：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">2021</span>-<span class=\"number\">06</span>-<span class=\"number\">29</span> <span class=\"number\">23</span>:<span class=\"number\">25</span>:<span class=\"number\">42.015</span> [main] ERROR org.mybatis.spring.mapper.MapperFactoryBean - Error <span class=\"keyword\">while</span> adding the mapper <span class=\"string\">&#x27;interface com.zero.auth.mapper.UserMapper&#x27;</span> to configuration.</span><br><span class=\"line\">org.apache.ibatis.builder.BuilderException: Error parsing Mapper XML. The XML location is <span class=\"string\">&#x27;com/zero/auth/mapper/UserMapper.xml&#x27;</span>. Cause: java.lang.ClassCastException: <span class=\"keyword\">class</span> <span class=\"title class_\">com</span>.baomidou.mybatisplus.core.MybatisConfiguration$StrictMap$Ambiguity cannot be cast to <span class=\"keyword\">class</span> <span class=\"title class_\">org</span>.apache.ibatis.mapping.ResultMap (com.baomidou.mybatisplus.core.MybatisConfiguration$StrictMap$Ambiguity and org.apache.ibatis.mapping.ResultMap are in unnamed <span class=\"keyword\">module</span> of loader <span class=\"string\">&#x27;app&#x27;</span>)</span><br><span class=\"line\">\tat org.apache.ibatis.builder.xml.XMLMapperBuilder.configurationElement(XMLMapperBuilder.java:<span class=\"number\">123</span>)</span><br><span class=\"line\">\tat org.apache.ibatis.builder.xml.XMLMapperBuilder.parse(XMLMapperBuilder.java:<span class=\"number\">95</span>)</span><br><span class=\"line\">\tat com.baomidou.mybatisplus.core.MybatisMapperAnnotationBuilder.loadXmlResource(MybatisMapperAnnotationBuilder.java:<span class=\"number\">172</span>)</span><br><span class=\"line\">\tat com.baomidou.mybatisplus.core.MybatisMapperAnnotationBuilder.parse(MybatisMapperAnnotationBuilder.java:<span class=\"number\">93</span>)</span><br><span class=\"line\">\tat com.baomidou.mybatisplus.core.MybatisMapperRegistry.addMapper(MybatisMapperRegistry.java:<span class=\"number\">83</span>)</span><br><span class=\"line\">\tat com.baomidou.mybatisplus.core.MybatisConfiguration.addMapper(MybatisConfiguration.java:<span class=\"number\">119</span>)</span><br><span class=\"line\">\tat org.mybatis.spring.mapper.MapperFactoryBean.checkDaoConfig(MapperFactoryBean.java:<span class=\"number\">80</span>)</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">Caused by: java.lang.ClassCastException: <span class=\"keyword\">class</span> <span class=\"title class_\">com</span>.baomidou.mybatisplus.core.MybatisConfiguration$StrictMap$Ambiguity cannot be cast to <span class=\"keyword\">class</span> <span class=\"title class_\">org</span>.apache.ibatis.mapping.ResultMap (com.baomidou.mybatisplus.core.MybatisConfiguration$StrictMap$Ambiguity and org.apache.ibatis.mapping.ResultMap are in unnamed <span class=\"keyword\">module</span> of loader <span class=\"string\">&#x27;app&#x27;</span>)</span><br><span class=\"line\">\tat com.baomidou.mybatisplus.core.MybatisConfiguration.checkGloballyForDiscriminatedNestedResultMaps(MybatisConfiguration.java:<span class=\"number\">318</span>)</span><br><span class=\"line\">\tat com.baomidou.mybatisplus.core.MybatisConfiguration.addResultMap(MybatisConfiguration.java:<span class=\"number\">222</span>)</span><br><span class=\"line\">\tat org.apache.ibatis.builder.MapperBuilderAssistant.addResultMap(MapperBuilderAssistant.java:<span class=\"number\">209</span>)</span><br><span class=\"line\">\tat org.apache.ibatis.builder.ResultMapResolver.resolve(ResultMapResolver.java:<span class=\"number\">47</span>)</span><br><span class=\"line\">\tat org.apache.ibatis.builder.xml.XMLMapperBuilder.resultMapElement(XMLMapperBuilder.java:<span class=\"number\">289</span>)</span><br><span class=\"line\">\tat org.apache.ibatis.builder.xml.XMLMapperBuilder.resultMapElement(XMLMapperBuilder.java:<span class=\"number\">254</span>)</span><br><span class=\"line\">\tat org.apache.ibatis.builder.xml.XMLMapperBuilder.resultMapElements(XMLMapperBuilder.java:<span class=\"number\">246</span>)</span><br><span class=\"line\">\tat org.apache.ibatis.builder.xml.XMLMapperBuilder.configurationElement(XMLMapperBuilder.java:<span class=\"number\">119</span>)</span><br><span class=\"line\">\t... <span class=\"number\">39</span> common frames omitted</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"报错信息分析\"><a href=\"#报错信息分析\" class=\"headerlink\" title=\"报错信息分析\"></a>报错信息分析</h2><p>在报错信息中，报告了一个 <code>java.lang.ClassCastException</code> 异常，这是 Java 中的类型转换异常。<br>具体的信息为<code>class com.baomidou.mybatisplus.core.MybatisConfiguration$StrictMap$Ambiguity cannot be cast to class org.apache.ibatis.mapping.ResultMap</code>。<br>一个 <code>MybatisConfiguration$StrictMap$Ambiguity</code> 类型的对象无法转换为 <code>ResultMap</code> 对象。</p>\n<h2 id=\"源码分析\"><a href=\"#源码分析\" class=\"headerlink\" title=\"源码分析\"></a>源码分析</h2><p>经过一段时间的 Debug，最终还是定位到了原因。具体的原因可以看 MyBatisPlus 中的 <code>com.baomidou.mybatisplus.core.MybatisConfiguration#checkGloballyForDiscriminatedNestedResultMaps</code> 方法。</p>\n<p><strong>以下是 MyBatisPlus 中该方法的源代码：</strong></p>\n<h3 id=\"MyBatisPlus-3-4-0\"><a href=\"#MyBatisPlus-3-4-0\" class=\"headerlink\" title=\"MyBatisPlus 3.4.0\"></a>MyBatisPlus 3.4.0</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title function_\">checkGloballyForDiscriminatedNestedResultMaps</span><span class=\"params\">(ResultMap rm)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (rm.hasNestedResultMaps()) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Map.Entry&lt;String, ResultMap&gt; entry : resultMaps.entrySet()) &#123;</span><br><span class=\"line\">            <span class=\"type\">Object</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> entry.getValue();</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (value <span class=\"keyword\">instanceof</span> ResultMap) &#123;</span><br><span class=\"line\">                <span class=\"type\">ResultMap</span> <span class=\"variable\">entryResultMap</span> <span class=\"operator\">=</span> (ResultMap) value;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!entryResultMap.hasNestedResultMaps() &amp;&amp; entryResultMap.getDiscriminator() != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                    Collection&lt;String&gt; discriminatedResultMapNames = entryResultMap.getDiscriminator().getDiscriminatorMap().values();</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (discriminatedResultMapNames.contains(rm.getId())) &#123;</span><br><span class=\"line\">                        entryResultMap.forceNestedResultMaps();</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"MyBatisPlus-3-4-3-1\"><a href=\"#MyBatisPlus-3-4-3-1\" class=\"headerlink\" title=\"MyBatisPlus 3.4.3.1\"></a>MyBatisPlus 3.4.3.1</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title function_\">checkGloballyForDiscriminatedNestedResultMaps</span><span class=\"params\">(ResultMap rm)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (rm.hasNestedResultMaps()) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Map.Entry&lt;String, ResultMap&gt; entry : resultMaps.entrySet()) &#123;</span><br><span class=\"line\">            <span class=\"type\">ResultMap</span> <span class=\"variable\">entryResultMap</span> <span class=\"operator\">=</span> entry.getValue();</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (entryResultMap != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!entryResultMap.hasNestedResultMaps() &amp;&amp; entryResultMap.getDiscriminator() != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                    Collection&lt;String&gt; discriminatedResultMapNames = entryResultMap.getDiscriminator().getDiscriminatorMap().values();</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (discriminatedResultMapNames.contains(rm.getId())) &#123;</span><br><span class=\"line\">                        entryResultMap.forceNestedResultMaps();</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>通过上面的代码可以看到，在 <code>3.4.0</code> 版本中，Map 循环里面 getValue() 方法获取的是 Object 对象，而后有一层 <code>instanceof</code> 的安全类型检查。<br>而在 <code>3.4.3.1</code> 版本中，Map 循环直接获取的就是 <code>ResultMap</code> 对象，但是在该 Map 中存放的并不全是 <code>ResultMap</code> 对象，最终导致类型转换异常。</p>\n<h3 id=\"泛型检查？\"><a href=\"#泛型检查？\" class=\"headerlink\" title=\"泛型检查？\"></a>泛型检查？</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">protected</span> <span class=\"keyword\">final</span> Map&lt;String, ResultMap&gt; resultMaps = <span class=\"keyword\">new</span> <span class=\"title class_\">StrictMap</span>&lt;&gt;(<span class=\"string\">&quot;Result Maps collection&quot;</span>);</span><br></pre></td></tr></table></figure>\n\n<p>上面的代码中 <code>resultMaps</code>的就是<code>checkGloballyForDiscriminatedNestedResultMaps</code> 方法中循环的 <code>resultMaps</code> 对象，可以看到该 Map 对象声明了泛型，但是最终在存放元素的时候还是绕过了泛型检查。</p>\n<p><code>resultMaps</code> 使用的是 MyBatisPlus 自己实现了一个 Map 类型 <code>StrictMap</code>，可以去检查一下这个类型的 <code>put</code> 方法。</p>\n<h3 id=\"StrictMap\"><a href=\"#StrictMap\" class=\"headerlink\" title=\"StrictMap\"></a>StrictMap</h3><p><strong>com.baomidou.mybatisplus.core.MybatisConfiguration.StrictMap</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">protected</span> <span class=\"keyword\">class</span> <span class=\"title class_\">StrictMap</span>&lt;V&gt; <span class=\"keyword\">extends</span> <span class=\"title class_\">HashMap</span>&lt;String, V&gt; &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">long</span> <span class=\"variable\">serialVersionUID</span> <span class=\"operator\">=</span> -<span class=\"number\">4950446264854982944L</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> String name;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> BiFunction&lt;V, V, String&gt; conflictMessageProducer;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">StrictMap</span><span class=\"params\">(String name)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">super</span>();</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.name = name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> StrictMap&lt;V&gt; <span class=\"title function_\">conflictMessageProducer</span><span class=\"params\">(BiFunction&lt;V, V, String&gt; conflictMessageProducer)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.conflictMessageProducer = conflictMessageProducer;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"meta\">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> V <span class=\"title function_\">put</span><span class=\"params\">(String key, V value)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (containsKey(key)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IllegalArgumentException</span>(name + <span class=\"string\">&quot; already contains value for &quot;</span> + key</span><br><span class=\"line\">                + (conflictMessageProducer == <span class=\"literal\">null</span> ? <span class=\"string\">&quot;&quot;</span> : conflictMessageProducer.apply(<span class=\"built_in\">super</span>.get(key), value)));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (useGeneratedShortKey) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (key.contains(<span class=\"string\">&quot;.&quot;</span>)) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">shortKey</span> <span class=\"operator\">=</span> getShortName(key);</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"built_in\">super</span>.get(shortKey) == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                    <span class=\"built_in\">super</span>.put(shortKey, value);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    <span class=\"built_in\">super</span>.put(shortKey, (V) <span class=\"keyword\">new</span> <span class=\"title class_\">Ambiguity</span>(shortKey));</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">super</span>.put(key, value);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> V <span class=\"title function_\">get</span><span class=\"params\">(Object key)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">V</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> <span class=\"built_in\">super</span>.get(key);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (value == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IllegalArgumentException</span>(name + <span class=\"string\">&quot; does not contain value for &quot;</span> + key);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (useGeneratedShortKey &amp;&amp; value <span class=\"keyword\">instanceof</span> StrictMap.Ambiguity) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IllegalArgumentException</span>(((StrictMap.Ambiguity) value).getSubject() + <span class=\"string\">&quot; is ambiguous in &quot;</span> + name</span><br><span class=\"line\">                + <span class=\"string\">&quot; (try using the full name including the namespace, or rename one of the entries)&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Ambiguity</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> String subject;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"title function_\">Ambiguity</span><span class=\"params\">(String subject)</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">this</span>.subject = subject;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">public</span> String <span class=\"title function_\">getSubject</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> subject;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String <span class=\"title function_\">getShortName</span><span class=\"params\">(String key)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">final</span> String[] keyParts = key.split(<span class=\"string\">&quot;\\\\.&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> keyParts[keyParts.length - <span class=\"number\">1</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>在 <code>StrictMap</code> 重写的 <code>put</code> 方法中，有这么一段代码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">super</span>.put(shortKey, (V) <span class=\"keyword\">new</span> <span class=\"title class_\">Ambiguity</span>(shortKey));</span><br></pre></td></tr></table></figure>\n<p>将 <code>com.baomidou.mybatisplus.core.MybatisConfiguration.StrictMap.Ambiguity</code> 类型的对象强转为 Value 泛型。<br>于是，一个原本就不是 <code>ResultMap</code> 类型的对象，就这么绕过泛型检查，直接存放进入 Map 集合中。</p>\n<p>然后在 MyBatisPlus 3.4.3.1 版本中，不知道哪位同学将 <code>instanceof</code> 类型检查的代码去掉了，最终导致 MyBatisPlus 在升级至 3.4.3.1 版本中之后开始报错。</p>\n<h2 id=\"源码提交日志\"><a href=\"#源码提交日志\" class=\"headerlink\" title=\"源码提交日志\"></a>源码提交日志</h2><p>我去 GiHub 上查看了 MyBatisPlus 3.4.0 版本至 3.4.3.1 版本之间的升级日志，没有一条更新日志提到这个问题，我个人觉得这是一个 BUG。</p>\n<h3 id=\"6月3号\"><a href=\"#6月3号\" class=\"headerlink\" title=\"6月3号\"></a>6月3号</h3><p>一位 MyBatisPlus 的维护者提交了代码，对 <code>com.baomidou.mybatisplus.core.MybatisConfiguration#checkGloballyForDiscriminatedNestedResultMaps</code> 方法进行了优化，去掉了该方法中的  <code>instanceof</code> 的安全类型检查，具体如下：</p>\n<p><img src=\"/images/2021/06/20210630082030289.png\" alt=\"在这里插入图片描述\"></p>\n<p>从这位开发者的角度我觉得这段优化完全没有问题，毕竟这个 Map 容器使用了泛型，完全可以直接返回泛型类型对象，不需要多此一举使用   <code>instanceof</code> 进行安全类型检查。<br>但是这位开发者不知道的是，在这个 Map 容器里面，重写的 put 方法完全不讲武德，对非泛型类型的对象进行强转，放入 Map 容器中。</p>\n<p>这位开发者完全是遭受了无妄之灾，这应该是当初设置这个 Map 容器的这位大神的问题，既然使用了泛型进行类型编译检查，就不应该在 put 的时候进行类型强制转行。或者说，既然需要存放不一致的类型，当初设计的时候就应该将泛型设置为 <code>Object</code> 类型。</p>\n<h3 id=\"6月15日\"><a href=\"#6月15日\" class=\"headerlink\" title=\"6月15日\"></a>6月15日</h3><p>MyBatisPlus 发布了 <code>3.4.3.1</code> 版本，也就是包含这个 BUG 的版本。<br><img src=\"/images/2021/06/20210630082559561.png\" alt=\"在这里插入图片描述\"></p>\n<h3 id=\"6月16日\"><a href=\"#6月16日\" class=\"headerlink\" title=\"6月16日\"></a>6月16日</h3><p>另外一位维护者似乎意识到了这个 BUG，提交了代码对该问题进行了修复，也就是将原始代码进行了还原。</p>\n<p><img src=\"/images/2021/06/20210630082700362.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h2><p>根据 GitHub 上的提交记录，很明显发现，这个问题是一个版本 BUG，虽然在最新的 GiHub 仓库中问题已经被修复了，但是 <code>3.4.3.1</code> 版本中依然存在该 BUG。</p>\n<p>如果你在项目中使用 MyBatisPlus 3.4.3.1 版本，出现了我博客中描述的相关问题，那就只能通过修改版本来解决了。</p>\n<p>要么降回原来的版本，或者等 MyBatisPlus 发布更新的版本，解决该 BUG。</p>\n","categories":["Java"],"tags":["Java","MyBatisPlus"]},{"title":"MyBatisPlus逻辑删除组件","url":"/2020/10/08/java/MyBatisPlus%E9%80%BB%E8%BE%91%E5%88%A0%E9%99%A4%E7%BB%84%E4%BB%B6/","content":"<blockquote>\n<p>好久没有写博客了，今天我们来学习了一下MyBatisPlus的逻辑删除组件。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h2 id=\"什么是逻辑删除？\"><a href=\"#什么是逻辑删除？\" class=\"headerlink\" title=\"什么是逻辑删除？\"></a>什么是逻辑删除？</h2><p>在开发中，对数据的删除操作是我们经常会执行的一种操作，用于删除存储在数据库中的一些错误数据或者不需要的数据，但是正常的删除操作是无法撤回的，也就是说，如果我们在系统中删除了一条数据之后，这条数据库就从系统的数据库中彻底删除了，通过普通手段是无法找回这条数据的。</p>\n<p>于是这个时候，逻辑删除也就诞生了。</p>\n<ul>\n<li><strong>什么是逻辑删除？</strong></li>\n</ul>\n<p><strong>逻辑删除</strong>：就是不通过delete语句将数据从数据库删除， 而是通过一个字段的来标识数据是否被删除，这样被删除的数据并不是真的被删除了，而是通过字段的指进行了隐性删除，也被称作逻辑删除，或者软删除。</p>\n<p>与逻辑删除对应的，也就是通过delete语句将数据彻底删除的操作，我们一般也将其称作<strong>物理删除</strong>。</p>\n<p>在MyBatisPlus的BaseMapper接口中，也为我们实现了一些通用的删除操作，可以更加方便我们的开发。但是在MyBatisPlus为我们自动生成的删除接口，都是数据物理删除，而不是逻辑删除。</p>\n<p>当然，其实MyBatisPlus也为我们实现了逻辑删除的功能，只不过这个功能默认是不开启的，如果我们需要使用MyBatisPlus的逻辑删除功能，那么需要我们配置逻辑删除的组件。</p>\n<h2 id=\"逻辑删除的优点和缺点\"><a href=\"#逻辑删除的优点和缺点\" class=\"headerlink\" title=\"逻辑删除的优点和缺点\"></a>逻辑删除的优点和缺点</h2><ul>\n<li><strong>优点</strong>：数据操作更加安全，不会因为系统误删操作，而导致数据丢失，恢复数据更加容易。</li>\n<li><strong>缺点</strong>：使用删除标识会改变查找和删除的逻辑，使查找和删除的逻辑要稍微复杂一些。</li>\n</ul>\n<h2 id=\"MyBatisPlus逻辑删除组件\"><a href=\"#MyBatisPlus逻辑删除组件\" class=\"headerlink\" title=\"MyBatisPlus逻辑删除组件\"></a>MyBatisPlus逻辑删除组件</h2><p>MyBatisPlus的逻辑删除组件就是针对逻辑删除所带来的缺点而诞生的，使用MyBatisPlus的逻辑删除组件，能够无缝实现逻辑删除，而且对于简单的增删改查方法能够自动适应，而不需要我们另外编写SQL来实现逻辑删除。</p>\n<h2 id=\"MyBatisPlus实现逻辑删除\"><a href=\"#MyBatisPlus实现逻辑删除\" class=\"headerlink\" title=\"MyBatisPlus实现逻辑删除\"></a>MyBatisPlus实现逻辑删除</h2><ul>\n<li><strong>在数据库表上添加一个标识逻辑删除的字段</strong></li>\n</ul>\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\">`deleted` <span class=\"type\">int</span>(<span class=\"number\">1</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"string\">&#x27;0&#x27;</span> COMMENT <span class=\"string\">&#x27;逻辑删除标识，0为正常，1为逻辑删除&#x27;</span>,</span><br></pre></td></tr></table></figure>\n<p><img src=\"/images/2020/10/20201008194850822.png\" alt=\"在这里插入图片描述\"></p>\n<ul>\n<li><strong>在实体类上添加注解<code>@TableLogic</code></strong></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 数据库数据逻辑删除标识字段</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@TableLogic</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> Integer deleted;</span><br></pre></td></tr></table></figure>\n\n\n\n<ul>\n<li><strong>配置MyBatisPlus逻辑删除组件</strong></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"meta\">@MapperScan(&quot;com.zero.sys.mapper&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyBatisPlusConfig</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 逻辑删除组件</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> ISqlInjector <span class=\"title function_\">sqlInjector</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">LogicSqlInjector</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<ul>\n<li><strong>application.yml配置文件</strong><figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># MyBatisPlus的相关配置</span></span><br><span class=\"line\"><span class=\"attr\">mybatis-plus:</span></span><br><span class=\"line\">  <span class=\"comment\"># 配置逻辑删除字段</span></span><br><span class=\"line\">  <span class=\"attr\">global-config:</span></span><br><span class=\"line\">    <span class=\"attr\">db-config:</span></span><br><span class=\"line\">      <span class=\"comment\"># 删除状态为1</span></span><br><span class=\"line\">      <span class=\"attr\">logic-delete-value:</span> <span class=\"number\">1</span></span><br><span class=\"line\">      <span class=\"comment\"># 没有删除状态为0</span></span><br><span class=\"line\">      <span class=\"attr\">logic-not-delete-value:</span> <span class=\"number\">0</span></span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<h2 id=\"使用MyBatisPlus逻辑删除组件\"><a href=\"#使用MyBatisPlus逻辑删除组件\" class=\"headerlink\" title=\"使用MyBatisPlus逻辑删除组件\"></a>使用MyBatisPlus逻辑删除组件</h2><p>进行了上述配置之后，在使用MyBatisPlus内置的查找和删除方法时，会自动适配逻辑删除的配置，即在查找时，只会查找标识没有删除的记录，而在删除时，只会修改标识删除字段的值，而不会真的从数据库中删除数据。</p>\n","categories":["Java"],"tags":["Java","MyBatisPlus"]},{"title":"Netty4入门教程，搭建简单的Netty服务端和客户端","url":"/2021/08/25/java/Netty4%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B%EF%BC%8C%E6%90%AD%E5%BB%BA%E7%AE%80%E5%8D%95%E7%9A%84Netty%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%92%8C%E5%AE%A2%E6%88%B7%E7%AB%AF/","content":"<h1 id=\"什么是-Netty\"><a href=\"#什么是-Netty\" class=\"headerlink\" title=\"什么是 Netty?\"></a>什么是 Netty?</h1><blockquote>\n<p>Netty 是 jboss 提供的一个 Java 开源框架，Netty 提供异步的、事件驱动的网络应用程序框架和工具，用以快速开发高性能、高可用性的网络服务器和客户端程序。也就是说 Netty 是一个基于 NIO 的编程框架，使用 Netty 可以快速的开发出一个网络应用。<br>由于 Java 自带的 NIO API 使用起来非常复杂，并且还可能出现 Epoll Bug，这使得我们使用原生的 NIO 来进行网络编程存在很大的难度且非常耗时。但是 Netty 良好的设计可以使开发人员快速高效的进行网络应用开发。</p>\n</blockquote>\n<span id=\"more\"></span>\n<h1 id=\"Netty-入门\"><a href=\"#Netty-入门\" class=\"headerlink\" title=\"Netty 入门\"></a>Netty 入门</h1><h2 id=\"搭建项目\"><a href=\"#搭建项目\" class=\"headerlink\" title=\"搭建项目\"></a>搭建项目</h2><p>首先需要搭建一个普通的 Maven 项目，JDK 版本为 JDK8。</p>\n<h2 id=\"引入-Netty-依赖\"><a href=\"#引入-Netty-依赖\" class=\"headerlink\" title=\"引入 Netty 依赖\"></a>引入 Netty 依赖</h2><blockquote>\n<p>由于 Netty5 已经被废弃，目前最新的 Netty 版本是 Netty4。</p>\n</blockquote>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>io.netty<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>netty-all<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>4.1.67.Final<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"搭建-Netty-服务端\"><a href=\"#搭建-Netty-服务端\" class=\"headerlink\" title=\"搭建 Netty 服务端\"></a>搭建 Netty 服务端</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">NettyServer</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"type\">NettyServer</span> <span class=\"variable\">nettyServer</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">NettyServer</span>();</span><br><span class=\"line\">        nettyServer.start(<span class=\"number\">12345</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">start</span><span class=\"params\">(<span class=\"type\">int</span> port)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 1.定义执行线程组</span></span><br><span class=\"line\">        <span class=\"type\">EventLoopGroup</span> <span class=\"variable\">group</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">NioEventLoopGroup</span>();</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 2.定义服务类</span></span><br><span class=\"line\">            <span class=\"type\">ServerBootstrap</span> <span class=\"variable\">serverBootstrap</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ServerBootstrap</span>();</span><br><span class=\"line\">            <span class=\"comment\">// 3.设置线程池</span></span><br><span class=\"line\">            serverBootstrap.group(group);</span><br><span class=\"line\">            <span class=\"comment\">// 4.设置通道</span></span><br><span class=\"line\">            serverBootstrap.channel(NioServerSocketChannel.class);</span><br><span class=\"line\">            <span class=\"comment\">// 5.绑定端口</span></span><br><span class=\"line\">            serverBootstrap.localAddress(<span class=\"keyword\">new</span> <span class=\"title class_\">InetSocketAddress</span>(port));</span><br><span class=\"line\">            <span class=\"comment\">// 6.添加Handler</span></span><br><span class=\"line\">            serverBootstrap.childHandler(<span class=\"keyword\">new</span> <span class=\"title class_\">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;</span><br><span class=\"line\">                <span class=\"meta\">@Override</span></span><br><span class=\"line\">                <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">initChannel</span><span class=\"params\">(SocketChannel channel)</span> &#123;</span><br><span class=\"line\">                    <span class=\"type\">ChannelPipeline</span> <span class=\"variable\">pipeline</span> <span class=\"operator\">=</span> channel.pipeline();</span><br><span class=\"line\">                    pipeline.addLast(<span class=\"string\">&quot;StringDecoder&quot;</span>, <span class=\"keyword\">new</span> <span class=\"title class_\">StringDecoder</span>());</span><br><span class=\"line\">                    pipeline.addLast(<span class=\"string\">&quot;StringEncoder&quot;</span>, <span class=\"keyword\">new</span> <span class=\"title class_\">StringEncoder</span>());</span><br><span class=\"line\">                    pipeline.addLast(<span class=\"string\">&quot;ServerHandler&quot;</span>, <span class=\"keyword\">new</span> <span class=\"title class_\">ChannelInboundHandlerAdapter</span>() &#123;</span><br><span class=\"line\">                        <span class=\"meta\">@Override</span></span><br><span class=\"line\">                        <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">channelRead</span><span class=\"params\">(ChannelHandlerContext ctx, Object msg)</span> &#123;</span><br><span class=\"line\">                            <span class=\"type\">Channel</span> <span class=\"variable\">channel</span> <span class=\"operator\">=</span> ctx.channel();</span><br><span class=\"line\">                            System.out.println(<span class=\"string\">&quot;server receive UserToken[&quot;</span> + channel.id().asLongText() + <span class=\"string\">&quot;] msg ==&gt; &quot;</span> + msg);</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                        <span class=\"meta\">@Override</span></span><br><span class=\"line\">                        <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">channelActive</span><span class=\"params\">(ChannelHandlerContext ctx)</span> &#123;</span><br><span class=\"line\">                            <span class=\"type\">Channel</span> <span class=\"variable\">channel</span> <span class=\"operator\">=</span> ctx.channel();</span><br><span class=\"line\">                            System.out.println(<span class=\"string\">&quot;UserToken[&quot;</span> + channel.id().asLongText() + <span class=\"string\">&quot;] 创建链接&quot;</span>);</span><br><span class=\"line\">                            <span class=\"keyword\">final</span> <span class=\"type\">ByteBuf</span> <span class=\"variable\">buf</span> <span class=\"operator\">=</span> Unpooled.unreleasableBuffer(Unpooled.copiedBuffer(<span class=\"string\">&quot;The server created a link!&quot;</span>, StandardCharsets.UTF_8));</span><br><span class=\"line\">                            ctx.writeAndFlush(buf.duplicate());</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                        <span class=\"meta\">@Override</span></span><br><span class=\"line\">                        <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">channelInactive</span><span class=\"params\">(ChannelHandlerContext ctx)</span> &#123;</span><br><span class=\"line\">                            <span class=\"type\">Channel</span> <span class=\"variable\">channel</span> <span class=\"operator\">=</span> ctx.channel();</span><br><span class=\"line\">                            System.out.println(<span class=\"string\">&quot;UserToken[&quot;</span> + channel.id().asLongText() + <span class=\"string\">&quot;] 断开链接&quot;</span>);</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                        <span class=\"meta\">@Override</span></span><br><span class=\"line\">                        <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">exceptionCaught</span><span class=\"params\">(ChannelHandlerContext ctx, Throwable cause)</span> &#123;</span><br><span class=\"line\">                            <span class=\"type\">Channel</span> <span class=\"variable\">channel</span> <span class=\"operator\">=</span> ctx.channel();</span><br><span class=\"line\">                            System.out.println(<span class=\"string\">&quot;UserToken[&quot;</span> + channel.id().asLongText() + <span class=\"string\">&quot;] 发生异常&quot;</span>);</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">            <span class=\"type\">ChannelFuture</span> <span class=\"variable\">channelFuture</span> <span class=\"operator\">=</span> serverBootstrap.bind().sync();</span><br><span class=\"line\">            channelFuture.channel().closeFuture().sync();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            group.shutdownGracefully().sync();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"搭建-Netty-客户端\"><a href=\"#搭建-Netty-客户端\" class=\"headerlink\" title=\"搭建 Netty 客户端\"></a>搭建 Netty 客户端</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">NettyClient</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">NettyClient</span> <span class=\"variable\">nettyClient</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">NettyClient</span>();</span><br><span class=\"line\">        nettyClient.start(<span class=\"string\">&quot;127.0.0.1&quot;</span>, <span class=\"number\">12345</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">start</span><span class=\"params\">(String host, <span class=\"type\">int</span> port)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 1.定义执行线程组</span></span><br><span class=\"line\">        <span class=\"type\">EventLoopGroup</span> <span class=\"variable\">group</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">NioEventLoopGroup</span>();</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 2.定义客户端类</span></span><br><span class=\"line\">            <span class=\"type\">Bootstrap</span> <span class=\"variable\">clientBootstrap</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Bootstrap</span>();</span><br><span class=\"line\">            <span class=\"comment\">// 3.设置线程池</span></span><br><span class=\"line\">            clientBootstrap.group(group);</span><br><span class=\"line\">            <span class=\"comment\">// 4.设置通道</span></span><br><span class=\"line\">            clientBootstrap.channel(NioSocketChannel.class);</span><br><span class=\"line\">            <span class=\"comment\">// 5.添加Handler</span></span><br><span class=\"line\">            clientBootstrap.handler(<span class=\"keyword\">new</span> <span class=\"title class_\">ChannelInitializer</span>&lt;Channel&gt;() &#123;</span><br><span class=\"line\">                <span class=\"meta\">@Override</span></span><br><span class=\"line\">                <span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title function_\">initChannel</span><span class=\"params\">(Channel channel)</span> &#123;</span><br><span class=\"line\">                    <span class=\"type\">ChannelPipeline</span> <span class=\"variable\">pipeline</span> <span class=\"operator\">=</span> channel.pipeline();</span><br><span class=\"line\">                    pipeline.addLast(<span class=\"string\">&quot;StringDecoder&quot;</span>, <span class=\"keyword\">new</span> <span class=\"title class_\">StringDecoder</span>());</span><br><span class=\"line\">                    pipeline.addLast(<span class=\"string\">&quot;StringEncoder&quot;</span>, <span class=\"keyword\">new</span> <span class=\"title class_\">StringEncoder</span>());</span><br><span class=\"line\">                    pipeline.addLast(<span class=\"string\">&quot;ClientHandler&quot;</span>, <span class=\"keyword\">new</span> <span class=\"title class_\">ChannelInboundHandlerAdapter</span>() &#123;</span><br><span class=\"line\">                        <span class=\"meta\">@Override</span></span><br><span class=\"line\">                        <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">channelRead</span><span class=\"params\">(ChannelHandlerContext ctx, Object msg)</span> &#123;</span><br><span class=\"line\">                            System.out.println(<span class=\"string\">&quot;client receive msg ==&gt; &quot;</span> + msg.toString());</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// 6.建立连接</span></span><br><span class=\"line\">            <span class=\"type\">ChannelFuture</span> <span class=\"variable\">channelFuture</span> <span class=\"operator\">=</span> clientBootstrap.connect(host, port);</span><br><span class=\"line\">            <span class=\"comment\">// 7.测试输入</span></span><br><span class=\"line\">            <span class=\"type\">BufferedReader</span> <span class=\"variable\">bufferedReader</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">BufferedReader</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">InputStreamReader</span>(System.in));</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;Please enter:&quot;</span>);</span><br><span class=\"line\">                <span class=\"type\">String</span> <span class=\"variable\">msg</span> <span class=\"operator\">=</span> bufferedReader.readLine();</span><br><span class=\"line\">                channelFuture.channel().writeAndFlush(msg);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 8.关闭连接</span></span><br><span class=\"line\">            group.shutdownGracefully();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"启动项目\"><a href=\"#启动项目\" class=\"headerlink\" title=\"启动项目\"></a>启动项目</h2><p>分别启动 NettyServer 和 NettyClient 的 main 方法，服务器和客户端即可进行简单的通讯。</p>\n","categories":["Java"],"tags":["Java","Netty"]},{"title":"ProtoBuf入门","url":"/2022/02/14/java/ProtoBuf%E5%85%A5%E9%97%A8/","content":"<h2 id=\"什么是-ProtoBuf\"><a href=\"#什么是-ProtoBuf\" class=\"headerlink\" title=\"什么是 ProtoBuf\"></a>什么是 ProtoBuf</h2><p><code>protocol buffers</code> 是一种语言无关、平台无关、可扩展的序列化结构数据的方法，它可用于（数据）通信协议、数据存储等。</p>\n<p><code>Protocol Buffers</code> 是一种灵活，高效，自动化机制的结构数据序列化方法－可类比 <code>XML</code>，但是比 <code>XML</code>更小（3 ~ 10倍）、更快（20 ~ 100倍）、更为简单。</p>\n<p>你可以定义数据的结构，然后使用特殊生成的源代码轻松的在各种数据流中使用各种语言进行编写和读取结构数据。你甚至可以更新数据结构，而不破坏由旧数据结构编译的已部署程序。</p>\n<span id=\"more\"></span>\n\n<blockquote>\n<p><code>ProtoBuf</code> 是一种结构数据序列化的方法，类似于 <code>XML</code>、<code>Json</code> 等数据序列化格式，具有语言无关、平台无关、可扩展、灵活高效等特点。</p>\n</blockquote>\n<h2 id=\"怎么使用-ProtoBuf\"><a href=\"#怎么使用-ProtoBuf\" class=\"headerlink\" title=\"怎么使用 ProtoBuf\"></a>怎么使用 ProtoBuf</h2><h3 id=\"下载-protoc-编译器\"><a href=\"#下载-protoc-编译器\" class=\"headerlink\" title=\"下载 protoc 编译器\"></a>下载 protoc 编译器</h3><p>在使用 <code>ProtoBuf</code> 之前，需要先下载 <code>ProtoBuf</code> 编译器</p>\n<p><strong>下载地址：</strong><a href=\"https://github.com/protocolbuffers/protobuf/releases\">https://github.com/protocolbuffers/protobuf/releases</a></p>\n<p><img src=\"/images/2023/02/300001.png\" alt=\"\"></p>\n<p>下载之后将压缩包放置到工作目录下，并解压到当前文件夹，将 <code>bin</code> 目录下的 <code>protoc</code> 可执行文件复制到工作目录下即可。</p>\n<h3 id=\"定义数据结构\"><a href=\"#定义数据结构\" class=\"headerlink\" title=\"定义数据结构\"></a>定义数据结构</h3><p><code>ProtoBuf</code> 使用 <code>.proto</code> 文件来进行数据结构的定义。</p>\n<p>在 <code>protoc</code> 可执行文件的同级别目录下创建一个 <code>.proto</code> 文件，并在文件中定义数据结构。</p>\n<p>例如：编写一个 <code>user.proto</code> 文件</p>\n<figure class=\"highlight protobuf\"><table><tr><td class=\"code\"><pre><span class=\"line\">syntax = <span class=\"string\">&quot;proto3&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">package</span> user;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 编译生成的Java可读写文件是否多文件生成</span></span><br><span class=\"line\"><span class=\"keyword\">option</span> java_multiple_files = <span class=\"literal\">false</span>;</span><br><span class=\"line\"><span class=\"comment\">// 编译生成的Java文件的目录，该目录可以由protoc编译器自动生成</span></span><br><span class=\"line\"><span class=\"keyword\">option</span> java_package = <span class=\"string\">&quot;com.herenpeng.proto&quot;</span>;</span><br><span class=\"line\"><span class=\"comment\">// 编译生成的Java可读写文件名称，最终Java文件路径为 com.herenpeng.proto.UserProto</span></span><br><span class=\"line\"><span class=\"keyword\">option</span> java_outer_classname = <span class=\"string\">&quot;UserProto&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 定义一个User数据结构</span></span><br><span class=\"line\"><span class=\"keyword\">message </span><span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">  <span class=\"type\">int32</span> id = <span class=\"number\">1</span>;     <span class=\"comment\">// 定义一个int32类型的id属性</span></span><br><span class=\"line\">  <span class=\"type\">string</span> name = <span class=\"number\">2</span>;  <span class=\"comment\">// 定义一个string类型的name属性</span></span><br><span class=\"line\">  <span class=\"type\">string</span> email = <span class=\"number\">3</span>; <span class=\"comment\">// 定义一个string类型的email属性</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 定义一个枚举类型</span></span><br><span class=\"line\">  <span class=\"keyword\">enum </span><span class=\"title class_\">PhoneType</span> &#123;</span><br><span class=\"line\">    MOBILE = <span class=\"number\">0</span>;</span><br><span class=\"line\">    HOME = <span class=\"number\">1</span>;</span><br><span class=\"line\">    WORK = <span class=\"number\">2</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 定义一个手机号数据结构</span></span><br><span class=\"line\">  <span class=\"keyword\">message </span><span class=\"title class_\">PhoneNumber</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">string</span> number = <span class=\"number\">1</span>;</span><br><span class=\"line\">    PhoneType type = <span class=\"number\">2</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 定义一个PhoneNumber集合类型的phones属性</span></span><br><span class=\"line\">  <span class=\"keyword\">repeated</span> PhoneNumber phones = <span class=\"number\">4</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"protoc-编译可以读写的接口文件\"><a href=\"#protoc-编译可以读写的接口文件\" class=\"headerlink\" title=\"protoc 编译可以读写的接口文件\"></a>protoc 编译可以读写的接口文件</h3><p>进入当前工作目录下的命令行界面，直接 <code>protoc</code> 编译命令，即可生成 <code>ProtoBuf</code> 可读写的Java接口文件。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">protoc ./user.proto --java_out=./</span><br></pre></td></tr></table></figure>\n\n\n\n<ul>\n<li>第一个参数：<code>protoc</code> 编译器可编译的 <code>.proto</code> 文件的路径。</li>\n<li>第二个参数 <code>--java_out=</code>：为 <code>protoc</code> 编译器编译之后，生成的 <code>Java</code> 可读写文件的路径。（该路径需要手动创建，<code>protoc</code>无法自动创建）</li>\n</ul>\n<blockquote>\n<p>如果在开发中需要频繁进行编译生成工作，可以考虑将命令写成一个 <code>.bat</code> 或<code>.sh</code>脚本，将输出如今直接指向项目中的包路径。如果编译输出的路径不是在项目的包下，则需要自己手动将编译生成的接口文件复制到项目对应的目录下。</p>\n</blockquote>\n<p>例如：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">protoc ./*.proto --java_out=../src/main/java</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"引入-ProtoBuf-依赖\"><a href=\"#引入-ProtoBuf-依赖\" class=\"headerlink\" title=\"引入 ProtoBuf 依赖\"></a>引入 ProtoBuf 依赖</h3><p>在项目中使用 <code>ProtoBuf</code> ，需要引入 <code>ProtoBuf</code>相关的依赖。</p>\n<p>在引入依赖的时候需要注意一点，引入的 <code>ProtoBuf</code> 依赖的版本尽量与 <code>protoc</code> 编译器的版本保持一致，如果版本不同，可能会出现一些不兼容的情况。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.google.protobuf<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>protobuf-java<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.19.4<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>junit<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>junit<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>4.13.1<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>test<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"调用接口序列化数据\"><a href=\"#调用接口序列化数据\" class=\"headerlink\" title=\"调用接口序列化数据\"></a>调用接口序列化数据</h3><p><code>ProtoBuf</code>可以调用 <code>Builder</code> 接口进行属性设置，属性设置完成之后则使用 <code>build()</code> 方法进行数据构造，最后使用 <code>toByteArray()</code> 生成字节数组。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">UserProto.User.<span class=\"type\">Builder</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> UserProto.User.newBuilder();</span><br><span class=\"line\">user.setId(<span class=\"number\">1</span>);</span><br><span class=\"line\">user.setName(<span class=\"string\">&quot;小明&quot;</span>);</span><br><span class=\"line\">user.setEmail(<span class=\"string\">&quot;xiaoming@qq.com&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">UserProto.User.PhoneNumber.<span class=\"type\">Builder</span> <span class=\"variable\">phoneNumber</span> <span class=\"operator\">=</span> UserProto.User.PhoneNumber.newBuilder();</span><br><span class=\"line\">phoneNumber.setNumber(<span class=\"string\">&quot;18478524512&quot;</span>);</span><br><span class=\"line\">phoneNumber.setType(UserProto.User.PhoneType.HOME);</span><br><span class=\"line\">user.addPhones(phoneNumber);</span><br><span class=\"line\"></span><br><span class=\"line\">System.out.println(user.build());</span><br><span class=\"line\">System.out.println(Arrays.toString(user.build().toByteArray()));</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"ProtoBuf-的优缺点\"><a href=\"#ProtoBuf-的优缺点\" class=\"headerlink\" title=\"ProtoBuf 的优缺点\"></a>ProtoBuf 的优缺点</h2><p><code>ProtoBuf</code>与 <code>XML</code>、<code>Json</code>都是序列化数据的方式，但是这三者直接还是有一些差异的，所使用的场景也各不相同。</p>\n<ul>\n<li><p><code>ProtoBuf</code> 更加注重效率，序列化之后是字节数组，数据更小、传输速率更快，但是人类可读性差。</p>\n</li>\n<li><p><code>XML</code> 和 <code>Json</code> 序列化之后的数据人类可读性强。</p>\n</li>\n</ul>\n","categories":["Java"],"tags":["Java","ProtoBuf"]},{"title":"SSM框架整合","url":"/2020/02/01/java/SSM%E6%A1%86%E6%9E%B6%E6%95%B4%E5%90%88/","content":"<h1 id=\"SSM框架\"><a href=\"#SSM框架\" class=\"headerlink\" title=\"SSM框架\"></a>SSM框架</h1><p>所谓SSM，即SpringMVC+Spring+Mybatis三个框架的合称，也是目前国内最为流行的企业级开发框架。</p>\n<span id=\"more\"></span>\n<p>虽然目前国内的趋势是SpringBoot，但是SpringBoot只不过是将开发简单化了，使用约定大于配置的规则，对框架进行了自动配置，省略了SSM框架需要手动配置的麻烦。<br>所以，SpringBoot的底层依然还是Spring框架的那一套模式，那么我们学习SSM框架，利用Spring来整合SpringMVC和Mybatis框架依然还是有必要的，这可以让我们对SpringBoot有更深的了解。</p>\n<h1 id=\"搭建项目环境\"><a href=\"#搭建项目环境\" class=\"headerlink\" title=\"搭建项目环境\"></a>搭建项目环境</h1><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=<span class=\"string\">&quot;1.0&quot;</span> encoding=<span class=\"string\">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">project</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">xmlns:xsi</span>=<span class=\"string\">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">xsi:schemaLocation</span>=<span class=\"string\">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">modelVersion</span>&gt;</span>4.0.0<span class=\"tag\">&lt;/<span class=\"name\">modelVersion</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.hrp<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>my_first_ssm<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.0-SNAPSHOT<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--注意，这里将项目打成一个war包--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">packaging</span>&gt;</span>war<span class=\"tag\">&lt;/<span class=\"name\">packaging</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">&lt;!--统一管理版本--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class=\"tag\">&lt;/<span class=\"name\">project.build.sourceEncoding</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">spring.version</span>&gt;</span>5.0.2.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">spring.version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">mybatis.version</span>&gt;</span>3.4.6<span class=\"tag\">&lt;/<span class=\"name\">mybatis.version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">mybatis.spring.version</span>&gt;</span>1.3.2<span class=\"tag\">&lt;/<span class=\"name\">mybatis.spring.version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">mysql.version</span>&gt;</span>5.1.32<span class=\"tag\">&lt;/<span class=\"name\">mysql.version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">druid.version</span>&gt;</span>1.0.9<span class=\"tag\">&lt;/<span class=\"name\">druid.version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">slf4j.version</span>&gt;</span>1.6.6<span class=\"tag\">&lt;/<span class=\"name\">slf4j.version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">lombox.version</span>&gt;</span>1.16.22<span class=\"tag\">&lt;/<span class=\"name\">lombox.version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">jstl.version</span>&gt;</span>1.2<span class=\"tag\">&lt;/<span class=\"name\">jstl.version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">jsp-api.version</span>&gt;</span>2.0<span class=\"tag\">&lt;/<span class=\"name\">jsp-api.version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--springmvc的依赖,这个依赖同时也依赖着spring的其他集合核心依赖，所以引入了这个依赖，就可以不用引入spring的那几个核心依赖了--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-webmvc<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;spring.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--springjdbc的依赖，不在上面那个依赖的依赖范围，事务管理必须要的依赖jar包--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-jdbc<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;spring.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--spring整合aspects框架，后面基于xml配置的声明式事务管理需要用到--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-aspects<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;spring.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- Mybatis的依赖 --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.mybatis<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;mybatis.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">         <span class=\"comment\">&lt;!--spring整合Mybatis的依赖 --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.mybatis<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-spring<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;mybatis.spring.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- MySql的驱动 --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>mysql<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;mysql.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- druid连接池，阿里开源项目 --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.alibaba<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>druid<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;druid.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- 日志处理 --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.slf4j<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>slf4j-log4j12<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;slf4j.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--Lombox插件依赖，主要是用于自动生成getter和setter方法，没有也没关系，自己写getter和setter方法就可以了--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.projectlombok<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>lombok<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;lombox.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>provided<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--jstl表达式的依赖--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>jstl<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>jstl<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;jstl.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- JSP相关的依赖，依赖范围是provided，只在编译和测试时使用 --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>javax.servlet<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>jsp-api<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;jsp-api.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>provided<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\">   \t\t<span class=\"comment\">&lt;!--Maven插件--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">        \t<span class=\"comment\">&lt;!-- 编译环境，JDK8--&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.maven.plugins<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>maven-compiler-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.2<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">source</span>&gt;</span>1.8<span class=\"tag\">&lt;/<span class=\"name\">source</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">target</span>&gt;</span>1.8<span class=\"tag\">&lt;/<span class=\"name\">target</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">encoding</span>&gt;</span>UTF-8<span class=\"tag\">&lt;/<span class=\"name\">encoding</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">            <span class=\"comment\">&lt;!-- 运行环境，tomcat7--&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.tomcat.maven<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>tomcat7-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.2<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">port</span>&gt;</span>8080<span class=\"tag\">&lt;/<span class=\"name\">port</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">path</span>&gt;</span>/<span class=\"tag\">&lt;/<span class=\"name\">path</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">project</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"编写配置文件\"><a href=\"#编写配置文件\" class=\"headerlink\" title=\"编写配置文件\"></a>编写配置文件</h1><h2 id=\"log4j配置文件\"><a href=\"#log4j配置文件\" class=\"headerlink\" title=\"log4j配置文件\"></a>log4j配置文件</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"># Global logging configuration</span><br><span class=\"line\">log4j.rootLogger=INFO, stdout</span><br><span class=\"line\"># Console output...</span><br><span class=\"line\">log4j.appender.stdout=org.apache.log4j.ConsoleAppender</span><br><span class=\"line\">log4j.appender.stdout.layout=org.apache.log4j.PatternLayout</span><br><span class=\"line\">log4j.appender.stdout.layout.ConversionPattern=%5p [%t] - %m%n</span><br></pre></td></tr></table></figure>\n<h2 id=\"jdbc-properties，配置数据库连接属性\"><a href=\"#jdbc-properties，配置数据库连接属性\" class=\"headerlink\" title=\"jdbc.properties，配置数据库连接属性\"></a>jdbc.properties，配置数据库连接属性</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">jdbc.driver=com.mysql.jdbc.Driver</span><br><span class=\"line\">jdbc.url=jdbc:mysql:<span class=\"comment\">//localhost:3306/db_database08</span></span><br><span class=\"line\">jdbc.username=root</span><br><span class=\"line\">jdbc.password=admin</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"applicationContext-xml配置文件\"><a href=\"#applicationContext-xml配置文件\" class=\"headerlink\" title=\"applicationContext.xml配置文件\"></a>applicationContext.xml配置文件</h2><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=<span class=\"string\">&quot;1.0&quot;</span> encoding=<span class=\"string\">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">beans</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">xmlns:context</span>=<span class=\"string\">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">xmlns:aop</span>=<span class=\"string\">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">xmlns:tx</span>=<span class=\"string\">&quot;http://www.springframework.org/schema/tx&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">xmlns:xsi</span>=<span class=\"string\">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">xsi:schemaLocation</span>=<span class=\"string\">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">\thttp://www.springframework.org/schema/beans/spring-beans-4.0.xsd</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">\thttp://www.springframework.org/schema/context</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">\thttp://www.springframework.org/schema/context/spring-context-4.0.xsd</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">\thttp://www.springframework.org/schema/aop</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">\thttp://www.springframework.org/schema/aop/spring-aop-4.0.xsd</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">\thttp://www.springframework.org/schema/tx</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">\thttp://www.springframework.org/schema/tx/spring-tx-4.0.xsd&quot;</span>&gt;</span></span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">&lt;!--在application.xml文件中引入jdbc.properties文件--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">context:property-placeholder</span> <span class=\"attr\">location</span>=<span class=\"string\">&quot;classpath:jdbc.properties&quot;</span>/&gt;</span></span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">&lt;!--配置dataSource，属性为引入jdbc.properties内的属性--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;dataSource&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;driverClassName&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;$&#123;jdbc.driver&#125;&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;url&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;$&#123;jdbc.url&#125;&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;username&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;$&#123;jdbc.username&#125;&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;password&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;$&#123;jdbc.password&#125;&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">&lt;!--配置sqlSessionFactory，其中注入dataSource和实体类别名包扫描目录--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;sqlSessionFactory&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;dataSource&quot;</span> <span class=\"attr\">ref</span>=<span class=\"string\">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--实体类别名包扫描，所有的实体类放在com.hrp.domain包下--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;typeAliasesPackage&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;com.hrp.domain&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">&lt;!--配置mybatis和spring整合之后的持久层扫描--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;</span>&gt;</span></span><br><span class=\"line\">    \t<span class=\"comment\">&lt;!--所有的持久层类放在com.hrp.dao包下--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;basePackage&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;com.hrp.dao&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--Service层的配置，扫描service包下的所有注解，业务层放在com.hrp.service包下--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">context:component-scan</span> <span class=\"attr\">base-package</span>=<span class=\"string\">&quot;com.hrp.service&quot;</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--spring提供的事务管理器，注入dataSource--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;transactionManager&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;dataSource&quot;</span> <span class=\"attr\">ref</span>=<span class=\"string\">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--声明式事务管理，事务的通知--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">tx:advice</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;txAdvice&quot;</span> <span class=\"attr\">transaction-manager</span>=<span class=\"string\">&quot;transactionManager&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">tx:attributes</span>&gt;</span></span><br><span class=\"line\">            <span class=\"comment\">&lt;!--事务的传播行为，所有的保存方法使用save打头--&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">tx:method</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;save*&quot;</span> <span class=\"attr\">propagation</span>=<span class=\"string\">&quot;REQUIRED&quot;</span> /&gt;</span></span><br><span class=\"line\">            <span class=\"comment\">&lt;!--所有的删除方法使用delete打头--&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">tx:method</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;delete*&quot;</span> <span class=\"attr\">propagation</span>=<span class=\"string\">&quot;REQUIRED&quot;</span> /&gt;</span></span><br><span class=\"line\">            <span class=\"comment\">&lt;!--所有的更新方法使用update打头--&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">tx:method</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;update*&quot;</span> <span class=\"attr\">propagation</span>=<span class=\"string\">&quot;REQUIRED&quot;</span> /&gt;</span></span><br><span class=\"line\">            <span class=\"comment\">&lt;!--所有的查询方法使用find打头--&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">tx:method</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;find*&quot;</span> <span class=\"attr\">propagation</span>=<span class=\"string\">&quot;SUPPORTS&quot;</span> <span class=\"attr\">read-only</span>=<span class=\"string\">&quot;true&quot;</span> /&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">tx:attributes</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">tx:advice</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--配置切面，service.impl包下的所有类所有方法都进行切面拦截--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">aop:config</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">aop:pointcut</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;pointcut&quot;</span> <span class=\"attr\">expression</span>=<span class=\"string\">&quot;execution(* com.hrp.service.impl.*.*(..))&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">aop:advisor</span> <span class=\"attr\">advice-ref</span>=<span class=\"string\">&quot;txAdvice&quot;</span> <span class=\"attr\">pointcut-ref</span>=<span class=\"string\">&quot;pointcut&quot;</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">aop:config</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"springmvc-xml配置文件\"><a href=\"#springmvc-xml配置文件\" class=\"headerlink\" title=\"springmvc.xml配置文件\"></a>springmvc.xml配置文件</h2><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=<span class=\"string\">&quot;1.0&quot;</span> encoding=<span class=\"string\">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">beans</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">xmlns:xsi</span>=<span class=\"string\">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">xmlns:context</span>=<span class=\"string\">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">xmlns:mvc</span>=<span class=\"string\">&quot;http://www.springframework.org/schema/mvc&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">xsi:schemaLocation</span>=<span class=\"string\">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">    http://www.springframework.org/schema/beans/spring-beans-4.0.xsd</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">    http://www.springframework.org/schema/mvc</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">    http://www.springframework.org/schema/mvc/spring-mvc-4.0.xsd</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">    http://www.springframework.org/schema/context</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">    http://www.springframework.org/schema/context/spring-context-4.0.xsd&quot;</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 配置Controller注解扫描，所有的控制层放在com.hrp.controller下--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">context:component-scan</span> <span class=\"attr\">base-package</span>=<span class=\"string\">&quot;com.hrp.controller&quot;</span> /&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--处理器映射器，处理器适配器--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">mvc:annotation-driven</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 配置视图解析器--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;internalResourceViewResolver&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--前缀--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;prefix&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;/WEB-INF/jsp/&quot;</span> /&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--后缀--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;suffix&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;.jsp&quot;</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--释放静态资源--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">mvc:default-servlet-handler</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"web-xml配置文件\"><a href=\"#web-xml配置文件\" class=\"headerlink\" title=\"web.xml配置文件\"></a>web.xml配置文件</h2><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=<span class=\"string\">&quot;1.0&quot;</span> encoding=<span class=\"string\">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">web-app</span> <span class=\"attr\">xmlns:xsi</span>=<span class=\"string\">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span> <span class=\"attr\">xsi:schemaLocation</span>=<span class=\"string\">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;WebApp_ID&quot;</span> <span class=\"attr\">version</span>=<span class=\"string\">&quot;3.1&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">display-name</span>&gt;</span>Interview<span class=\"tag\">&lt;/<span class=\"name\">display-name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">welcome-file-list</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">welcome-file</span>&gt;</span>index.html<span class=\"tag\">&lt;/<span class=\"name\">welcome-file</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">welcome-file</span>&gt;</span>index.htm<span class=\"tag\">&lt;/<span class=\"name\">welcome-file</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">welcome-file</span>&gt;</span>index.jsp<span class=\"tag\">&lt;/<span class=\"name\">welcome-file</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">welcome-file</span>&gt;</span>default.html<span class=\"tag\">&lt;/<span class=\"name\">welcome-file</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">welcome-file</span>&gt;</span>default.htm<span class=\"tag\">&lt;/<span class=\"name\">welcome-file</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">welcome-file</span>&gt;</span>default.jsp<span class=\"tag\">&lt;/<span class=\"name\">welcome-file</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">welcome-file-list</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--编码过滤器 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">filter-name</span>&gt;</span>encoding<span class=\"tag\">&lt;/<span class=\"name\">filter-name</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class=\"tag\">&lt;/<span class=\"name\">filter-class</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>encoding<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>UTF-8<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>forceEncoding<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">filter</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">filter-mapping</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">filter-name</span>&gt;</span>encoding<span class=\"tag\">&lt;/<span class=\"name\">filter-name</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">url-pattern</span>&gt;</span>/*<span class=\"tag\">&lt;/<span class=\"name\">url-pattern</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">filter-mapping</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 配置spring核心监听器 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">listener</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class=\"tag\">&lt;/<span class=\"name\">listener-class</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">listener</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 重新指定spring配置文件的路径 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">context-param</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>contextConfigLocation<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>classpath:applicationContext.xml<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">context-param</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 配置springmvc的核心servlet --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">servlet</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">servlet-name</span>&gt;</span>springmvc<span class=\"tag\">&lt;/<span class=\"name\">servlet-name</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class=\"tag\">&lt;/<span class=\"name\">servlet-class</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>contextConfigLocation<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>classpath:springmvc.xml<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- 配置springmvc什么时候启动，参数必须为整数 --&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- 如果为0或者大于0，则springMVC随着容器启动而启动 --&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- 如果小于0，则在第一次请求进来的时候启动 --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">load-on-startup</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">load-on-startup</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">servlet</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">servlet-mapping</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">servlet-name</span>&gt;</span>springmvc<span class=\"tag\">&lt;/<span class=\"name\">servlet-name</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- 所有的请求都进入springMVC --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">url-pattern</span>&gt;</span>/<span class=\"tag\">&lt;/<span class=\"name\">url-pattern</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">servlet-mapping</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"编写代码\"><a href=\"#编写代码\" class=\"headerlink\" title=\"编写代码\"></a>编写代码</h1><h2 id=\"创建数据库\"><a href=\"#创建数据库\" class=\"headerlink\" title=\"创建数据库\"></a>创建数据库</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">CREATE TABLE `tb_user` (</span><br><span class=\"line\">  `id` <span class=\"type\">int</span>(<span class=\"number\">11</span>) NOT NULL AUTO_INCREMENT,</span><br><span class=\"line\">  `name` varchar(<span class=\"number\">11</span>) DEFAULT NULL,</span><br><span class=\"line\">  `password` varchar(<span class=\"number\">11</span>) DEFAULT NULL,</span><br><span class=\"line\">  PRIMARY <span class=\"title function_\">KEY</span> <span class=\"params\">(`id`)</span></span><br><span class=\"line\">) ENGINE=InnoDB AUTO_INCREMENT=<span class=\"number\">28</span> DEFAULT CHARSET=utf8;</span><br></pre></td></tr></table></figure>\n<h2 id=\"编写实体类\"><a href=\"#编写实体类\" class=\"headerlink\" title=\"编写实体类\"></a>编写实体类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"> <span class=\"keyword\">import</span> lombok.Data;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 实体类User</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> hrp</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String id;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String password;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"编写持久层，业务层和Web层\"><a href=\"#编写持久层，业务层和Web层\" class=\"headerlink\" title=\"编写持久层，业务层和Web层\"></a>编写持久层，业务层和Web层</h2><ul>\n<li><p>持久层</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">UserDao</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 查找所有用户</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Select(&quot;select * from tb_user&quot;)</span></span><br><span class=\"line\">    List&lt;User&gt; <span class=\"title function_\">findAll</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 根据id删除用户</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> id</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Delete(&quot;delete from tb_user where id = #&#123;id&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">deleteUser</span><span class=\"params\">(Integer id)</span> <span class=\"keyword\">throws</span> Exception;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 保存用户</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> user</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Insert(&quot;insert into tb_user(name,password) values(#&#123;name&#125;,#&#123;password&#125;)&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">saveUser</span><span class=\"params\">(User user)</span> <span class=\"keyword\">throws</span> Exception;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n<li><p>业务层</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">UserService</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 查找所有用户</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    List&lt;User&gt; <span class=\"title function_\">findAll</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 根据id删除用户</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> id</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">deleteUser</span><span class=\"params\">(Integer id)</span> <span class=\"keyword\">throws</span> Exception;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 保存用户</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> user</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">save</span><span class=\"params\">(User user)</span> <span class=\"keyword\">throws</span> Exception;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n<li><p>业务层接口实现</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Service</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserServiceImpl</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">UserService</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> UserDao userDao;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;User&gt; <span class=\"title function_\">findAll</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> userDao.findAll();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">deleteUser</span><span class=\"params\">(Integer id)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        userDao.deleteUser(id);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">save</span><span class=\"params\">(User user)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        userDao.saveUser(user);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Web控制层</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Controller</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;user&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserController</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> UserService userService;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping(&quot;list&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">findAll</span><span class=\"params\">(Model model)</span> <span class=\"keyword\">throws</span> Exception&#123;</span><br><span class=\"line\">        List&lt;User&gt; list = userService.findAll();</span><br><span class=\"line\">        model.addAttribute(<span class=\"string\">&quot;list&quot;</span>,list);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;list&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping(&quot;delete/&#123;id&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">deleteUser</span><span class=\"params\">(<span class=\"meta\">@PathVariable</span> Integer id)</span> <span class=\"keyword\">throws</span> Exception&#123;</span><br><span class=\"line\">        userService.deleteUser(id);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;forward:/user/list&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping(&quot;save&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">save</span><span class=\"params\">(User user)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        userService.save(user);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;forward:/user/list&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<h1 id=\"测试功能\"><a href=\"#测试功能\" class=\"headerlink\" title=\"测试功能\"></a>测试功能</h1><p>写到这里，Spring整合MVC和Mybatis就以及完成了，接下来就是测试了。<br>使用Maven集成的Tomcat插件启动项目，访问<strong>localhost:8080</strong><br>如果你在webapp目录下有index页面，就会直接跳转到inex页面中，如果没有，也可以直接访问Controller暴露出来的接口。<br><strong><a href=\"http://localhost:8080/user/list\">http://localhost:8080/user/list</a></strong><br>记得在WEB-INF下创建一个名为jsp的文件夹，将所有的jsp页面放在该文件夹下。</p>\n<p>例如：list.jsp</p>\n<figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\">&lt;%@ taglib prefix=&quot;c&quot; uri=&quot;http://java.sun.com/jsp/jstl/core&quot; %&gt;</span><br><span class=\"line\">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;</span><br><span class=\"line\">         pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>所有用户<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>所有用户<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">table</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>ID<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>用户名<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>密码<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">c:forEach</span> <span class=\"attr\">var</span>=<span class=\"string\">&quot;user&quot;</span> <span class=\"attr\">items</span>=<span class=\"string\">&quot;$&#123;list&#125;&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>$&#123;user.id&#125;<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>$&#123;user.name&#125;<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>$&#123;user.password&#125;<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;/user/delete/$&#123;user.id&#125;&quot;</span>&gt;</span>删除<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">c:forEach</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">table</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n","categories":["Java"],"tags":["Java","Spring","MyBatis"]},{"title":"ServiceLoader加载接口的所有实现","url":"/2021/06/27/java/ServiceLoader%E5%8A%A0%E8%BD%BD%E6%8E%A5%E5%8F%A3%E7%9A%84%E6%89%80%E6%9C%89%E5%AE%9E%E7%8E%B0/","content":"<h1 id=\"什么是ServiceLoader？\"><a href=\"#什么是ServiceLoader？\" class=\"headerlink\" title=\"什么是ServiceLoader？\"></a>什么是ServiceLoader？</h1><p>ServiceLoader 是由 JDK 提供的，在 <code>java.util</code> 包下的一个工具类，使用该工具类，可以加载一个接口的所有实现类。</p>\n<span id=\"more\"></span>\n<h1 id=\"getBeansOfType\"><a href=\"#getBeansOfType\" class=\"headerlink\" title=\"getBeansOfType()\"></a>getBeansOfType()</h1><p>在 Spring 框架中，<code>ApplicationContext</code> 类提供了 <code>getBeansOfType()</code> 方法，同样可以启到和 <code>ServiceLoader</code> 相同的效果，可以获取同一类接口的所有实现类。<br>不过这个方法仅限于被 Spring 管理的项目，如果一个项目没有被 Spring 管理，也就无法使用该方法，这时就可以考虑使用 <code>ServiceLoader</code>。</p>\n<h1 id=\"ServiceLoader的使用\"><a href=\"#ServiceLoader的使用\" class=\"headerlink\" title=\"ServiceLoader的使用\"></a>ServiceLoader的使用</h1><h2 id=\"接口和实现类\"><a href=\"#接口和实现类\" class=\"headerlink\" title=\"接口和实现类\"></a>接口和实现类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">IService</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">service</span><span class=\"params\">()</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserServiceImpl</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">IService</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">service</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;用户服务&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">RoleServiceImpl</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">IService</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">service</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;角色服务&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ResourcesServiceImpl</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">IService</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">service</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;资源服务&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"配置META-INF-services\"><a href=\"#配置META-INF-services\" class=\"headerlink\" title=\"配置META-INF/services\"></a>配置META-INF/services</h2><p>在项目的 <code>resources</code> 目录下，创建目录 <code>META-INF/services</code>，该目录为固定目录，<code>ServiceLoader</code>会默认读取该目录下的资源和文件。</p>\n<p>在 <code>META-INF/services</code> 目录下创建一个文件，文件名为接口的全限定类名。<br>例如上述的 <code>IService</code>接口，应该在 <code>META-INF/services</code> 目录下创建 <code>com.loader.IService</code> 文件。</p>\n<blockquote>\n<p>其中 <code>com.loader</code> 为自定义的包名称，并非定式包名。</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">resources</span><br><span class=\"line\">\t|_META-INF</span><br><span class=\"line\">\t\t|_services</span><br><span class=\"line\">\t\t\t|_com.loader.IService</span><br></pre></td></tr></table></figure>\n\n<p><strong>com.loader.IService</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"># 注释</span><br><span class=\"line\">com.loader.UserServiceImpl</span><br><span class=\"line\">com.loader.RoleServiceImpl</span><br><span class=\"line\">com.loader.ResourcesServiceImpl</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"load-方法\"><a href=\"#load-方法\" class=\"headerlink\" title=\"load()方法\"></a>load()方法</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ServiceMain</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        ServiceLoader&lt;IService&gt; services = ServiceLoader.load(IService.class);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (IService item : services) &#123;</span><br><span class=\"line\">            item.service();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"ServiceLoader的缺点\"><a href=\"#ServiceLoader的缺点\" class=\"headerlink\" title=\"ServiceLoader的缺点\"></a>ServiceLoader的缺点</h1><ul>\n<li><p>ServiceLoader 虽然可以加载一个接口的所有实现类，但是本质上还是通过 <code>META-INF/services</code> 目录下配置文件，通过 Java 反射功能进行加载的，并无法实现动态加载的效果。</p>\n</li>\n<li><p>ServiceLoader 因为是通过反射进行加载的，所有的接口实现类必须拥有一个无参构造函数，否则实现类无法被反射实例化。</p>\n</li>\n</ul>\n<h1 id=\"Spring和ServiceLoader\"><a href=\"#Spring和ServiceLoader\" class=\"headerlink\" title=\"Spring和ServiceLoader\"></a>Spring和ServiceLoader</h1><p>Spring 的 <code>getBeansOfType()</code> 方法和 JDK 的 <code>ServiceLoader</code> 都可以实现类似的功能，那么在项目中应该优先使用哪个呢？</p>\n<p>如果项目中使用了 Spring 框架，项目中的接口实现都已被 Spring 核心容器管理，那么建议优先使用 Spring 的 <code>getBeansOfType()</code> 方法，因为所有实现类被 Spring 核心容器管理的情况下，使用 <code>getBeansOfType()</code> 方法可以达到一种“伪动态”加载的效果，而且代码更具有扩展性。</p>\n<p>如果项目只是一个普通的项目，那么可以使用 <code>ServiceLoader</code> 来进行接口实现类的加载。</p>\n","categories":["Java"],"tags":["Java"]},{"title":"Spring AOP的两种实现方式","url":"/2020/03/12/java/Spring%20AOP%E7%9A%84%E4%B8%A4%E7%A7%8D%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F/","content":"<h2 id=\"什么是AOP？\"><a href=\"#什么是AOP？\" class=\"headerlink\" title=\"什么是AOP？\"></a>什么是AOP？</h2><p>AOP（Aspect Oriented Programming），面向切面编程，AOP不是单独指某一种技术，而是一种编程思想，AOP是OOP的一种补充，用于处理各个业务逻辑中的横切关注点，比如<strong>日志记录，事务处理，性能统计，异常处理</strong>等等。<br>AOP的主要功能是将大量的通用行为从业务逻辑中抽取出来，将这些行为封装成独立的非业务方法，用于横向切入，这些行为不会对已有的业务逻辑产生任何影响。</p>\n<span id=\"more\"></span>\n<p>AOP是一种设计思想，而Spring AOP则是符合AOP思想的一种框架实现。</p>\n<h2 id=\"Spring-AOP\"><a href=\"#Spring-AOP\" class=\"headerlink\" title=\"Spring AOP\"></a>Spring AOP</h2><p>Spring AOP主要有两种实现，分别的JDK动态代理和Cglib动态代理。</p>\n<p><strong>JDK动态代理</strong><br>JDK动态代理是JDK内置的一种动态代理模式，使用反射来接受被代理的类，但是被代理的类必须实现一个接口。</p>\n<p><strong>Cglib动态代理</strong><br>Cglib是一个代码生成的类库，可以在运行时动态生成某个类的子类，所以如果需要被Cglib动态代理，那么就需要被代理类不能被final修饰。</p>\n<ul>\n<li><strong>在Spring AOP中，如果一个类实现了接口，那么就使用JDK动态代理的方式进行AOP实现，而如果这个类没有实现接口，则使用Cglib动态代理的方式进行AOP实现。如果一个类既没有接口，同时又被final修饰，那么这个类不能进行AOP动态代理。</strong></li>\n</ul>\n<h2 id=\"JDK动态代理\"><a href=\"#JDK动态代理\" class=\"headerlink\" title=\"JDK动态代理\"></a>JDK动态代理</h2><p>JDK动态代理，由于是JDK内置的代理模式，所以我们不需要引入任何依赖，可以直接使用。</p>\n<p><strong>1、编写JDK动态代理代码</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">JDKProxy</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">InvocationHandler</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Object target;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">JDKProxy</span><span class=\"params\">(Object target)</span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.target = target;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Object <span class=\"title function_\">createProxy</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Object</span> <span class=\"variable\">proxy</span> <span class=\"operator\">=</span> Proxy.newProxyInstance(target.getClass().getClassLoader(),</span><br><span class=\"line\">                target.getClass().getInterfaces(), <span class=\"built_in\">this</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> proxy;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Object <span class=\"title function_\">invoke</span><span class=\"params\">(Object proxy, Method method, Object[] args)</span> <span class=\"keyword\">throws</span> Throwable &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;JDK动态代理前置通知......&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Object</span> <span class=\"variable\">object</span> <span class=\"operator\">=</span> method.invoke(target, args);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;JDK动态代理后置通知......&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> object;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>2、编写一个接口</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">UserDao</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">save</span><span class=\"params\">()</span>;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">update</span><span class=\"params\">()</span>;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">find</span><span class=\"params\">()</span>;</span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">delete</span><span class=\"params\">()</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>3、编写被代理类实现该接口。</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserDaoImpl</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">UserDao</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">save</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;保存用户......&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">update</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;修改用户......&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">find</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;查找用户......&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">delete</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;删除用户......&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>4、测试</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">JDKProxyTest</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">UserDao</span> <span class=\"variable\">userDao</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">UserDaoImpl</span>();</span><br><span class=\"line\">        <span class=\"type\">UserDao</span> <span class=\"variable\">proxy</span> <span class=\"operator\">=</span> (UserDao) <span class=\"keyword\">new</span> <span class=\"title class_\">JDKProxy</span>(userDao).createProxy();</span><br><span class=\"line\">        proxy.save();</span><br><span class=\"line\">        proxy.update();</span><br><span class=\"line\">        proxy.find();</span><br><span class=\"line\">        proxy.delete();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>5、测试结果</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">JDK动态代理前置通知......</span><br><span class=\"line\">保存用户......</span><br><span class=\"line\">JDK动态代理后置通知......</span><br><span class=\"line\">JDK动态代理前置通知......</span><br><span class=\"line\">修改用户......</span><br><span class=\"line\">JDK动态代理后置通知......</span><br><span class=\"line\">JDK动态代理前置通知......</span><br><span class=\"line\">查找用户......</span><br><span class=\"line\">JDK动态代理后置通知......</span><br><span class=\"line\">JDK动态代理前置通知......</span><br><span class=\"line\">删除用户......</span><br><span class=\"line\">JDK动态代理后置通知......</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Cglib动态代理\"><a href=\"#Cglib动态代理\" class=\"headerlink\" title=\"Cglib动态代理\"></a>Cglib动态代理</h2><p>Cglib动态代理，需要引入外部依赖，我们可以直接引入Spring的核心依赖即可，Spring中有Cglib的类库。</p>\n<p><strong>1、引入依赖</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">&lt;dependencies&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-context&lt;/artifactId&gt;</span><br><span class=\"line\">        &lt;version&gt;<span class=\"number\">5.0</span><span class=\"number\">.8</span>.RELEASE&lt;/version&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>\n<p><strong>2、编写Cglib动态代理代码</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">CglibProxy</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">MethodInterceptor</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Object target;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">CglibProxy</span><span class=\"params\">(Object target)</span>&#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.target = target;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Object <span class=\"title function_\">createProxy</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Enhancer</span> <span class=\"variable\">enhancer</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Enhancer</span>();</span><br><span class=\"line\">        enhancer.setSuperclass(target.getClass());</span><br><span class=\"line\">        enhancer.setCallback(<span class=\"built_in\">this</span>);</span><br><span class=\"line\">        <span class=\"type\">Object</span> <span class=\"variable\">proxy</span> <span class=\"operator\">=</span> enhancer.create();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> proxy;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Object <span class=\"title function_\">intercept</span><span class=\"params\">(Object proxy, Method method, Object[] args, MethodProxy methodProxy)</span> <span class=\"keyword\">throws</span> Throwable &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;Cglib动态代理前置通知......&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Object</span> <span class=\"variable\">object</span> <span class=\"operator\">=</span> method.invoke(target, args);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;Cglib动态代理后置通知......&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> object;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>3、编写被代理类</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">CustomerDao</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">save</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;保存客户......&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">update</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;修改客户......&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">find</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;查找客户......&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">delete</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;删除客户......&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>4、测试</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">CglibProxyTest</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">CustomerDao</span> <span class=\"variable\">customerDao</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">CustomerDao</span>();</span><br><span class=\"line\">        <span class=\"type\">CustomerDao</span> <span class=\"variable\">proxy</span> <span class=\"operator\">=</span> (CustomerDao) <span class=\"keyword\">new</span> <span class=\"title class_\">CglibProxy</span>(customerDao).createProxy();</span><br><span class=\"line\">        proxy.save();</span><br><span class=\"line\">        proxy.update();</span><br><span class=\"line\">        proxy.find();</span><br><span class=\"line\">        proxy.delete();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<p><strong>5、测试结果</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">Cglib动态代理前置通知......</span><br><span class=\"line\">保存客户......</span><br><span class=\"line\">Cglib动态代理后置通知......</span><br><span class=\"line\">Cglib动态代理前置通知......</span><br><span class=\"line\">修改客户......</span><br><span class=\"line\">Cglib动态代理后置通知......</span><br><span class=\"line\">Cglib动态代理前置通知......</span><br><span class=\"line\">查找客户......</span><br><span class=\"line\">Cglib动态代理后置通知......</span><br><span class=\"line\">Cglib动态代理前置通知......</span><br><span class=\"line\">删除客户......</span><br><span class=\"line\">Cglib动态代理后置通知......</span><br></pre></td></tr></table></figure>\n\n","categories":["Java"],"tags":["Java","SpringBoot","AOP"]},{"title":"Spring JdbcTemplate","url":"/2020/01/30/java/Spring%20JdbcTemplate/","content":"<p>Spring作为一个一站式框架，对开发中三层架构都有着企业级的解决方案，其中对应持久层的解决方案就是Spring JdbcTemplate。</p>\n<span id=\"more\"></span>\n<p>今天就详细讲解Spring JdbcTemplate的配置与使用。</p>\n<p><strong>项目结构图：</strong><br><img src=\"/images/2020/01/20200130215456625.png\" alt=\"在这里插入图片描述\"></p>\n<p>第一步，引入依赖。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"comment\">&lt;!--设定字符集为UTF-8--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class=\"tag\">&lt;/<span class=\"name\">project.build.sourceEncoding</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--统一管理版本号--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">spring.version</span>&gt;</span>4.2.4.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">spring.version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">mysql.version</span>&gt;</span>5.1.32<span class=\"tag\">&lt;/<span class=\"name\">mysql.version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">druid.version</span>&gt;</span>1.0.9<span class=\"tag\">&lt;/<span class=\"name\">druid.version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">slf4j.version</span>&gt;</span>1.6.6<span class=\"tag\">&lt;/<span class=\"name\">slf4j.version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--Lombox插件依赖，主要是用于自动生成getter和setter方法，没有也没关系，自己写getter和setter方法就可以了--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.projectlombok<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>lombok<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.16.22<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>provided<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- Spring的依赖，引入context之后，会根据依赖的传递性，自动引入spring的其他几个核心jar包 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-context<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;spring.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- Spring-jdbc的依赖，JdbcTemplate依赖的jar包 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-jdbc<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;spring.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- Spring-test的依赖，主要用于整合spring和junit环境 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-test<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;spring.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>test<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- MySql的驱动 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>mysql<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;mysql.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- druid连接池，阿里开源项目 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.alibaba<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>druid<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;druid.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">     <span class=\"comment\">&lt;!-- junit4的依赖 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>junit<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>junit<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>4.11<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>test<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- log4j日志 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.slf4j<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>slf4j-log4j12<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;slf4j.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">    \t<span class=\"comment\">&lt;!-- 编译环境，JDK8--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.maven.plugins<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>maven-compiler-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.2<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">source</span>&gt;</span>1.8<span class=\"tag\">&lt;/<span class=\"name\">source</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">target</span>&gt;</span>1.8<span class=\"tag\">&lt;/<span class=\"name\">target</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">encoding</span>&gt;</span>UTF-8<span class=\"tag\">&lt;/<span class=\"name\">encoding</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>第二步，编写Spring JdbcTemplate的配置文件。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=<span class=\"string\">&quot;1.0&quot;</span> encoding=<span class=\"string\">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">beans</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">xmlns:context</span>=<span class=\"string\">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">xmlns:xsi</span>=<span class=\"string\">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">       <span class=\"attr\">xsi:schemaLocation</span>=<span class=\"string\">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">\thttp://www.springframework.org/schema/beans/spring-beans-4.0.xsd</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">\thttp://www.springframework.org/schema/context</span></span></span><br><span class=\"line\"><span class=\"string\"><span class=\"tag\">\thttp://www.springframework.org/schema/context/spring-context-4.0.xsd&quot;</span>&gt;</span></span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">&lt;!-- 配置JdbcTemplate，并向其中注入dataSource--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;jdbcTemplate&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;org.springframework.jdbc.core.JdbcTemplate&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;dataSource&quot;</span> <span class=\"attr\">ref</span>=<span class=\"string\">&quot;dataSource&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">&lt;!-- 配置dataSource,其属性为连接数据库需要的4个连接信息--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;dataSource&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;driverClassName&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;url&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;jdbc:mysql:///db_database08&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;username&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;root&quot;</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;password&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;admin&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">&lt;!-- 配置注解扫描，我们将dao层的实现放在com.hrp.dao.impl包下--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">context:component-scan</span> <span class=\"attr\">base-package</span>=<span class=\"string\">&quot;com.hrp.dao.impl&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>第三步：准备log4j日志的配置文件。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"># Global logging configuration</span><br><span class=\"line\">log4j.rootLogger=info, stdout</span><br><span class=\"line\"># Console output...</span><br><span class=\"line\">log4j.appender.stdout=org.apache.log4j.ConsoleAppender</span><br><span class=\"line\">log4j.appender.stdout.layout=org.apache.log4j.PatternLayout</span><br><span class=\"line\">log4j.appender.stdout.layout.ConversionPattern=%5p [%t] - %m%n</span><br></pre></td></tr></table></figure>\n<p>第四步：编写实体类。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.hrp.domain;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.Data;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer id;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String password;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p> <strong>@Data是lombox的注解，用于生成getter和setter方法，如果没有安装这个插件的可以手写getter和setter方法，效果是一样的。</strong></p>\n<p>第五步：编写Dao层接口和实现类。</p>\n<p><strong>接口：</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.hrp.dao;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.hrp.domain.User;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> hrp</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">UserDao</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 查询所有用户</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    List&lt;User&gt; <span class=\"title function_\">findAll</span><span class=\"params\">()</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>实现类：</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.hrp.dao.impl;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.hrp.dao.UserDao;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.hrp.domain.User;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.jdbc.core.BeanPropertyRowMapper;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.jdbc.core.JdbcTemplate;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.stereotype.Repository;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> hrp</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Repository</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserDaoImpl</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">UserDao</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> JdbcTemplate jdbcTemplate;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;User&gt; <span class=\"title function_\">findAll</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> jdbcTemplate.query(<span class=\"string\">&quot;select * from tb_user&quot;</span>,<span class=\"keyword\">new</span> <span class=\"title class_\">BeanPropertyRowMapper</span>&lt;User&gt;(User.class));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>第六步：编写测试类，整合Spring和junit环境。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.hrp.test;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.hrp.dao.UserDao;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.hrp.domain.User;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.junit.Test;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.junit.runner.RunWith;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.test.context.ContextConfiguration;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@RunWith(SpringJUnit4ClassRunner.class)</span></span><br><span class=\"line\"><span class=\"meta\">@ContextConfiguration(locations = &quot;classpath:application.xml&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserDaoTest</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> UserDao userDao;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">findAllTest</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        List&lt;User&gt; list = userDao.findAll();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (User user : list) &#123;</span><br><span class=\"line\">            System.out.println(user);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>运行结果：<br><img src=\"/images/2020/01/20200130215709456.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["Java"],"tags":["Java","Spring"]},{"title":"Spring jackson转换日期格式时导致日期错误及解决方法","url":"/2020/02/21/java/Spring%20jackson%E8%BD%AC%E6%8D%A2%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8F%E6%97%B6%E5%AF%BC%E8%87%B4%E6%97%A5%E6%9C%9F%E9%94%99%E8%AF%AF%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/","content":"<p><strong>Jackson</strong>是SpringBoot中默认支持的Json数据格式的转换工具，但是使用Jackson转换日期格式的数据时，会导致json格式的数据的日期和原本的日期不一致，我们需要在配置文件中修改默认配置，来解决这个问题。</p>\n<span id=\"more\"></span>\n\n<p>我们先把问题列出来，因为只是涉及json数据格式的转换，所以我就不详细讲解SpringBoot的框架搭建了。<br>首先，在我的程序中，提供了这么一个接口：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">/user/&#123;id&#125;</span><br></pre></td></tr></table></figure>\n<p>使用restful风格的API来访问数据，这个接口的作用是，根据id来查询用户信息。<br>我们首先来看一下数据库中的信息。<br><img src=\"/images/2020/02/20200221144346916.png\" alt=\"在这里插入图片描述\">我们可以看到，在数据库中，有一个id为2，用户名为零的用户，它的生日日期是1997-10-02。</p>\n<p>那么我们再来看看使用浏览器访问这个数据，在浏览器中得到的又是什么？<br><img src=\"/images/2020/02/20200221144623770.png\" alt=\"在这里插入图片描述\"><br>我们可以看到，浏览器显示出来的数据，生日日期是1997-10-01。</p>\n<p>这就是jackson转换日期格式的json数据，导致的日期丢失的错误。<br>那么我们应该怎么解决这个问题呢？很简单，直接在application.yml配置文件中配置如下属性即可：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">spring:</span><br><span class=\"line\">\tjackson:</span><br><span class=\"line\">\t    <span class=\"keyword\">default</span>-property-inclusion: ALWAYS</span><br><span class=\"line\">\t    time-zone: GMT+<span class=\"number\">8</span></span><br><span class=\"line\">\t    date-format: yyyy-MM-dd</span><br></pre></td></tr></table></figure>\n\n<p>配置完成后，我们再次访问该数据：</p>\n<p><img src=\"/images/2020/02/20200221145005681.png\" alt=\"在这里插入图片描述\"></p>\n<p>如此，我们就发现，在浏览器中访问的日期格式的数据已经正常了。</p>\n","categories":["Java"],"tags":["Java","Spring","Jackson"]},{"title":"SpringBoot 3.0 升级之 Swagger 升级","url":"/2023/12/16/java/SpringBoot%203.0%20%E5%8D%87%E7%BA%A7%E4%B9%8B%20Swagger%20%E5%8D%87%E7%BA%A7/","content":"<p>最近想尝试一下最新的 <code>SpringBoot</code> 项目，于是将自己的开源项目进行了一些升级。</p>\n<ul>\n<li>JDK 版本从 <code>JDK8</code> 升级至 <code>JDK17</code>。</li>\n<li>SpringBoot 版本从 <code>SpringBoot 2.7.3</code> 升级到 <code>SpringBoot 3.2.0</code><span id=\"more\"></span>\n\n</li>\n</ul>\n<h2 id=\"SpringFox3-0-0\"><a href=\"#SpringFox3-0-0\" class=\"headerlink\" title=\"SpringFox3.0.0\"></a>SpringFox3.0.0</h2><p>在 <code>SpringBoot2.7.3</code> 版本的时候，项目使用的是 <code>SpringFox3.0.0</code> 的依赖，用于使用 <code>Swagger</code>，相关依赖如下：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>io.springfox<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>springfox-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.0.0<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>项目编译没有问题，但是启动运行的时候报错 javax.servlet.http.HttpServletRequest ClassNotFoundException 异常。</p>\n<p>这是因为 <code>SpringFox3.0.0</code> 底层有 Swagger2 和 Swagger3 两套一来，其中 Swagger2 底层依赖 javax 模块，但是在 <code>SpringBoox3</code> 的版本中已经彻底移除了 javax 模块，改为使用 jakarta ，所以才会报这个错误。</p>\n<h2 id=\"openapi3\"><a href=\"#openapi3\" class=\"headerlink\" title=\"openapi3\"></a>openapi3</h2><blockquote>\n<p>解决方案：移除 Swagger2，改为完全使用 Swagger3。</p>\n</blockquote>\n<p>在项目 pom.xml 中移除 <code>SpringFox3.0.0</code> 的依赖，改为使用 <code>openapi3</code> 的依赖，如下：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.github.xiaoymin<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>knife4j-openapi3-jakarta-spring-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>4.0.0<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Swagger-注解迁移\"><a href=\"#Swagger-注解迁移\" class=\"headerlink\" title=\"Swagger 注解迁移\"></a>Swagger 注解迁移</h2><p>Swagger2 和 Swagger3 使用的是完全不同的两套注解，所以原本使用 Swagger2 相关注解的代码页需要完全迁移，改为使用 Swagger3 的注解。</p>\n<table>\n<thead>\n<tr>\n<th>Swagger2</th>\n<th>Swagger3</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>@Api</td>\n<td>@Tag</td>\n</tr>\n<tr>\n<td>@ApiOperation</td>\n<td>@Operation</td>\n</tr>\n<tr>\n<td>@ApiImplicitParams</td>\n<td>@Parameters</td>\n</tr>\n<tr>\n<td>@ApiImplicitParam</td>\n<td>@Parameter</td>\n</tr>\n<tr>\n<td>@ApiModel</td>\n<td>@Schema</td>\n</tr>\n<tr>\n<td>@ApiModelProperty</td>\n<td>@Schema</td>\n</tr>\n<tr>\n<td>@ApiResponses</td>\n<td>@ApiResponses</td>\n</tr>\n<tr>\n<td>@ApiResponse</td>\n<td>@ApiResponse</td>\n</tr>\n<tr>\n<td>@ApiIgnore</td>\n<td>@Hidden 或者 其他注解的 hidden = true 属性</td>\n</tr>\n</tbody></table>\n<h3 id=\"Api\"><a href=\"#Api\" class=\"headerlink\" title=\"@Api\"></a>@Api</h3><ul>\n<li><p>Swagger2 代码</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Api(value = &quot;用户操作接口&quot;, tags = &quot;UserController&quot;)</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Swagger3 代码</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Tag(name = &quot;UserController&quot;, description = &quot;用户操作接口&quot;)</span></span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<h3 id=\"ApiOperation\"><a href=\"#ApiOperation\" class=\"headerlink\" title=\"@ApiOperation\"></a>@ApiOperation</h3><ul>\n<li><p>Swagger2 代码</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ApiOperation(value = &quot;分页查询用户数据&quot;)</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Swagger3 代码</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Operation(description = &quot;分页查询用户数据&quot;)</span></span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<h3 id=\"ApiImplicitParam\"><a href=\"#ApiImplicitParam\" class=\"headerlink\" title=\"@ApiImplicitParam\"></a>@ApiImplicitParam</h3><ul>\n<li><p>Swagger2 代码</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ApiImplicitParams(&#123;</span></span><br><span class=\"line\"><span class=\"meta\">     @ApiImplicitParam(name = &quot;currentPage&quot;, value = &quot;当前页码&quot;, dataTypeClass = Integer.class, required = true),</span></span><br><span class=\"line\"><span class=\"meta\">     @ApiImplicitParam(name = &quot;size&quot;, value = &quot;当前页大小&quot;, defaultValue = &quot;10&quot;, dataTypeClass = Integer.class),</span></span><br><span class=\"line\"><span class=\"meta\">     @ApiImplicitParam(name = &quot;queryUser&quot;, value = &quot;用户查询条件&quot;, dataTypeClass = User.class)</span></span><br><span class=\"line\"><span class=\"meta\">&#125;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Swagger3 代码</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Parameters(&#123;</span></span><br><span class=\"line\"><span class=\"meta\">    @Parameter(name = &quot;currentPage&quot;, description = &quot;当前页码&quot;, required = true),</span></span><br><span class=\"line\"><span class=\"meta\">    @Parameter(name = &quot;size&quot;, description = &quot;当前页大小&quot;, example = &quot;10&quot;),</span></span><br><span class=\"line\"><span class=\"meta\">    @Parameter(name = &quot;queryUser&quot;, description = &quot;用户查询条件&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">&#125;)</span></span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<h3 id=\"ApiModel\"><a href=\"#ApiModel\" class=\"headerlink\" title=\"@ApiModel\"></a>@ApiModel</h3><ul>\n<li><p>Swagger2 代码</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ApiModel(value = &quot;用户信息实体类&quot;)</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Swagger3 代码</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Schema(name = &quot;用户信息实体类&quot;)</span></span><br></pre></td></tr></table></figure>\n\n\n</li>\n</ul>\n<h3 id=\"ApiModelProperty\"><a href=\"#ApiModelProperty\" class=\"headerlink\" title=\"@ApiModelProperty\"></a>@ApiModelProperty</h3><ul>\n<li><p>Swagger2 代码</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ApiModelProperty(value = &quot;用户名称&quot;)</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Swagger3 代码</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Schema(name = &quot;用户名称&quot;)</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n","categories":["Java"],"tags":["Java","Spring","Swagger"]},{"title":"SpringBoot 3.2.0 版本 mysql 依赖下载错误","url":"/2023/12/16/java/SpringBoot%203.2.0%20%E7%89%88%E6%9C%AC%20mysql%20%E4%BE%9D%E8%B5%96%E4%B8%8B%E8%BD%BD%E9%94%99%E8%AF%AF/","content":"<p>最近想尝试一下最新的 <code>SpringBoot</code> 项目，于是将自己的开源项目进行了一些升级。</p>\n<ul>\n<li>JDK 版本从 <code>JDK8</code> 升级至 <code>JDK17</code>。</li>\n<li>SpringBoot 版本从 <code>SpringBoot 2.7.3</code> 升级到 <code>SpringBoot 3.2.0</code><span id=\"more\"></span>\n\n</li>\n</ul>\n<p>其中 JDK 的升级比较顺利，毕竟 JDK 的旧版本兼容性一直非常好。<br>但是在升级 SpringBoot 的时候依然发生了一些意外，修改 <code>pom.xml</code> 文件中，使用 Maven 更新最新的依赖，但是却报错了。</p>\n<blockquote>\n<p>mysql:mysql-connector-java:jar:unknown was not found in <a href=\"https://maven.aliyun.com/repository/public\">https://maven.aliyun.com/repository/public</a> during a previous attempt. This failure was cached in the local repository and resolution is not reattempted until the update interval of aliyunmaven has elapsed or updates are forced</p>\n</blockquote>\n<p>错误信息显示 <code>mysql:mysql-connector-java</code> 的这个 <code>jar</code> 包下载错误。</p>\n<p>找了一下 <code>pom.xml</code> 文件中的相关配置。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>mysql<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>配置没有问题，因为 SpringBoot 自动帮助我们管理了相关的依赖，于是通过 <code>spring-boot-starter-parent-3.2.0.pom</code> 向上寻找，找到 <code>spring-boot-dependencies-3.2.0.pom</code> 文件。</p>\n<p>在 <code>spring-boot-dependencies-3.2.0.pom</code> 文件中果然已经找不到 <code>mysql:mysql-connector-java</code> 相关的依赖，反而是找到了一个名为 <code>mysql-connector-j</code> 的依赖。</p>\n<p><img src=\"/images/2023/12/755b47d3423e4014adc1444f13adde37.png\" alt=\"在这里插入图片描述\"></p>\n<p>前往 <code>mysql-connector-java.jar</code> 依赖的官网查询一下，在官网的页面上写着：</p>\n<blockquote>\n<p>Note: This artifact was moved to:<br>com.mysql » mysql-connector-j</p>\n</blockquote>\n<p><img src=\"/images/2023/12/71e5c8a310444f5ca4e391d3655d95da.png\" alt=\"在这里插入图片描述\"><br>既然是官网行为，那么直接将项目的 <code>pom.xml</code> 文件修改为如下的配置：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.mysql<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mysql-connector-j<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>重新更新 Maven，果然正常下载相关的依赖文件。</p>\n","categories":["Java"],"tags":["Java","MySQL","Spring"]},{"title":"SpringBoot Cache 整合 Redis 缓存框架","url":"/2023/12/16/java/SpringBoot%20Cache%20%E6%95%B4%E5%90%88%20Redis%20%E7%BC%93%E5%AD%98%E6%A1%86%E6%9E%B6/","content":"<p><code>SpringBoot</code> 提供了 <code>SpringBootCache</code> 框架作为 <code>SpringBoot</code> 的缓存统一框架，使用 <code>SpringBootCache</code> ，我们可以使用注解的方式使用缓存，从而避免了写一些重复代码的问题。</p>\n<span id=\"more\"></span>\n<h2 id=\"引入依赖\"><a href=\"#引入依赖\" class=\"headerlink\" title=\"引入依赖\"></a>引入依赖</h2><p>首先我们需要引入相关的依赖，<code>Cache</code> 是缓存框架的核心依赖，不过该框架只提供了各种操作的接口集合，并没有具体的实现。</p>\n<p>而接口之外，<code>SpringBoot</code> 提供了各种具体的实现，比如：<code>RedisCache</code>,<code>EhCache</code>,<code>ConcurrentMapCache</code>等等。</p>\n<p><code>Redis</code> 依赖是为了使用 <code>Redis</code> 作为缓存而引入的，如果不使用 <code>Redis</code> 作为缓存，也可以将 <code>Redis</code> 的依赖替换为其他实现。</p>\n<p><code>Jackson</code> 是作为序列化工具。</p>\n<ul>\n<li>Maven</li>\n</ul>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-cache<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.7.3<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.7.3<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-test<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.7.3<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>jackson-databind<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.13.3<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>Gradle</li>\n</ul>\n<figure class=\"highlight groovy\"><table><tr><td class=\"code\"><pre><span class=\"line\">dependencies &#123;</span><br><span class=\"line\">    implementation <span class=\"string\">&#x27;org.springframework.boot:spring-boot-starter-cache:2.7.3&#x27;</span></span><br><span class=\"line\">    implementation <span class=\"string\">&#x27;org.springframework.boot:spring-boot-starter-data-redis:2.7.3&#x27;</span></span><br><span class=\"line\">    implementation <span class=\"string\">&#x27;org.springframework.boot:spring-boot-starter-test:2.7.3&#x27;</span></span><br><span class=\"line\">    implementation <span class=\"string\">&#x27;com.fasterxml.jackson.core:jackson-databind:2.13.3&#x27;</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"配置-Redis\"><a href=\"#配置-Redis\" class=\"headerlink\" title=\"配置 Redis\"></a>配置 Redis</h2><p>因为我们引入了 <code>SpringBootRedis</code> 的依赖，<code>Spring</code> 会默认使用 <code>Redis</code> 作为我们的缓存，所以需要配置 <code>Redis</code> 的信息。</p>\n<ul>\n<li>application.yaml</li>\n</ul>\n<figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">redis:</span></span><br><span class=\"line\">    <span class=\"attr\">host:</span> <span class=\"number\">127.0</span><span class=\"number\">.0</span><span class=\"number\">.1</span></span><br><span class=\"line\">    <span class=\"attr\">port:</span> <span class=\"number\">6379</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>RedisCacheManager<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">RedisCacheConfig</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> RedisCacheManager <span class=\"title function_\">cacheManager</span><span class=\"params\">(RedisConnectionFactory redisConnectionFactory)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 使用缓存的默认配置</span></span><br><span class=\"line\">        <span class=\"type\">RedisCacheConfiguration</span> <span class=\"variable\">config</span> <span class=\"operator\">=</span> RedisCacheConfiguration.defaultCacheConfig();</span><br><span class=\"line\">        <span class=\"comment\">// 使用 GenericJackson2JsonRedisSerializer 作为序列化器</span></span><br><span class=\"line\">        config = config.serializeValuesWith(</span><br><span class=\"line\">                RedisSerializationContext.SerializationPair.fromSerializer(</span><br><span class=\"line\">                        <span class=\"keyword\">new</span> <span class=\"title class_\">GenericJackson2JsonRedisSerializer</span>()));</span><br><span class=\"line\">        RedisCacheManager.<span class=\"type\">RedisCacheManagerBuilder</span> <span class=\"variable\">builder</span> <span class=\"operator\">=</span></span><br><span class=\"line\">                RedisCacheManager.builder(redisConnectionFactory).cacheDefaults(config);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> builder.build();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n</li>\n</ul>\n<h2 id=\"启动类注解\"><a href=\"#启动类注解\" class=\"headerlink\" title=\"启动类注解\"></a>启动类注解</h2><p>使用 <code>SpringBootCache</code> 作为缓存框架，我们需要在 <code>SpringBoot</code> 的启动类上添加 <code>@EnableCaching</code> 注解，这样才能够启用缓存框架。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@EnableCaching</span></span><br><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Main</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        SpringApplication.run(Main.class, args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"注解开发\"><a href=\"#注解开发\" class=\"headerlink\" title=\"注解开发\"></a>注解开发</h2><p>我们只需要在方法上面添加相关的注解，即可使用缓存逻辑，从而提升服务性能。</p>\n<h3 id=\"Cacheable\"><a href=\"#Cacheable\" class=\"headerlink\" title=\"@Cacheable\"></a>@Cacheable</h3><p>该注解可以注解在方法和类上，当被注解的类下的方法或者被注解的方法被调用时，会先去缓存中查看是否有缓存数据，有缓存数据则直接返回缓存数据，无缓存数据则调用该方法，获取该方法的返回值，并将该返回值存入缓存中。</p>\n<h3 id=\"CachePut\"><a href=\"#CachePut\" class=\"headerlink\" title=\"@CachePut\"></a>@CachePut</h3><p>该注解可以注解在方法和类上，当被注解的类下的方法或者被注解的方法被调用时，不管缓存中是否有对应的缓存数据，都会将该方法的返回值更新（插入或覆盖）到缓存中。</p>\n<h3 id=\"CacheEvict\"><a href=\"#CacheEvict\" class=\"headerlink\" title=\"@CacheEvict\"></a>@CacheEvict</h3><p>该注解可以注解在方法和类上，当被注解的类下的方法或者被注解的方法被调用时，会直接删除缓存中的缓存数据。</p>\n<h2 id=\"注解属性\"><a href=\"#注解属性\" class=\"headerlink\" title=\"注解属性\"></a>注解属性</h2><p><code>@Cacheable</code>,<code>@CachePut</code>,<code>@CacheEvict</code>三个注解都有一些属性。</p>\n<h3 id=\"cacheNames-value\"><a href=\"#cacheNames-value\" class=\"headerlink\" title=\"cacheNames/value\"></a>cacheNames/value</h3><p>用来指定缓存组件的名字。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Cacheable(cacheNames = &quot;user&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> User <span class=\"title function_\">selectById</span><span class=\"params\">(Integer id)</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>(id);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"key\"><a href=\"#key\" class=\"headerlink\" title=\"key\"></a>key</h3><p>缓存数据时使用的 key，可以用它来指定。默认是使用方法参数的值。（这个 key 你必须使用 spEL 表达式来编写）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Cacheable(cacheNames = &quot;user&quot;, key = &quot;#id&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> User <span class=\"title function_\">selectById</span><span class=\"params\">(Integer id)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>(id);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>使用以上的配置，如果入参的 <code>id</code> 值为 <code>1</code>，<code>Redis</code> 会存入一个 key 为 <code>user::1</code> 数据。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Cacheable(cacheNames = &quot;user&quot;, key = &quot;#root.methodName&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> User <span class=\"title function_\">selectById</span><span class=\"params\">(Integer id)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>(id);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>使用以上的配置，如果入参的 <code>id</code> 值为 <code>1</code>，<code>Redis</code> 会存入一个 key 为 <code>user::selectById</code> 数据。</p>\n<h3 id=\"keyGenerator\"><a href=\"#keyGenerator\" class=\"headerlink\" title=\"keyGenerator\"></a>keyGenerator</h3><p>key 的生成器。 key 和 keyGenerator 二选一使用。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Bean</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> KeyGenerator <span class=\"title function_\">keyGenerator</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (target, method, params) -&gt; Arrays.asList(params).toString();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>使用以上的配置，如果入参的 <code>id</code> 值为 <code>1</code>，<code>Redis</code> 会存入一个 key 为 <code>user::[1]</code> 数据。</p>\n<h3 id=\"condition\"><a href=\"#condition\" class=\"headerlink\" title=\"condition\"></a>condition</h3><p>可以用来指定符合条件的情况下才缓存。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Cacheable(cacheNames = &quot;user&quot;, key = &quot;#id&quot;, condition = &quot;#id &gt; 1&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> User <span class=\"title function_\">selectById</span><span class=\"params\">(Integer id)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>(id);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"unless\"><a href=\"#unless\" class=\"headerlink\" title=\"unless\"></a>unless</h3><p>否定缓存。当 unless 指定的条件为 true ，方法的返回值就不会被缓存。当然你也可以获取到结果进行判断。（通过 #result 获取方法结果）</p>\n<p>该属性相当于<code>!condition</code> 属性。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Cacheable(cacheNames = &quot;user&quot;, key = &quot;#id&quot;, unless = &quot;#id &gt; 1&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> User <span class=\"title function_\">selectById</span><span class=\"params\">(Integer id)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>(id);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"cacheManager\"><a href=\"#cacheManager\" class=\"headerlink\" title=\"cacheManager\"></a>cacheManager</h3><p>可以用来指定缓存管理器。从哪个缓存管理器里面获取缓存。</p>\n<h3 id=\"sync\"><a href=\"#sync\" class=\"headerlink\" title=\"sync\"></a>sync</h3><p>是否使用异步模式。</p>\n<h2 id=\"SpEL-表达式\"><a href=\"#SpEL-表达式\" class=\"headerlink\" title=\"SpEL 表达式\"></a>SpEL 表达式</h2><table>\n<thead>\n<tr>\n<th>名字</th>\n<th>位置</th>\n<th>描述</th>\n<th>示例</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>methodName</td>\n<td>root object</td>\n<td>当前被调用的方法名</td>\n<td>#root.methodName</td>\n</tr>\n<tr>\n<td>method</td>\n<td>root object</td>\n<td>当前被调用的方法</td>\n<td>#root.method.name</td>\n</tr>\n<tr>\n<td>target</td>\n<td>root object</td>\n<td>当前被调用的目标对象</td>\n<td>#root.target</td>\n</tr>\n<tr>\n<td>targetClass</td>\n<td>root object</td>\n<td>当前被调用的目标对象类</td>\n<td>#root.targetClass</td>\n</tr>\n<tr>\n<td>args</td>\n<td>root object</td>\n<td>当前被调用的方法的参数列表</td>\n<td>#root.args[0]</td>\n</tr>\n<tr>\n<td>caches</td>\n<td>root object</td>\n<td>当前方法调用使用的缓存列表(如 @Cacheable(value=[“cache1”,”cache2J)，则有两个 cache)</td>\n<td>#root.caches[0].name</td>\n</tr>\n<tr>\n<td>argument name</td>\n<td>evaluation context</td>\n<td>方法参数的名字，可以直接使用 #参数名，也可以使用 #p0 或 #a0 的形式，0代表参数的索引。</td>\n<td>#a0</td>\n</tr>\n<tr>\n<td>result</td>\n<td>evaluation context</td>\n<td>方法执行后的返回值 (仅当方法执行后的判断有效)</td>\n<td>#result</td>\n</tr>\n</tbody></table>\n","categories":["Java"],"tags":["Java","Spring","Redis"]},{"title":"SpringBoot+Freemarker基础入门","url":"/2020/05/01/java/SpringBoot+Freemarker%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8/","content":"<blockquote>\n<p>上一次我们讲了<a href=\"/2020/03/24/java/Thymeleaf静态模板引擎/\">Thymeleaf静态模板引擎</a>，今天我们来讲另一款Java静态模板引擎技术FreeMarker。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h2 id=\"什么是FreeMarker？\"><a href=\"#什么是FreeMarker？\" class=\"headerlink\" title=\"什么是FreeMarker？\"></a>什么是FreeMarker？</h2><p>FreeMarker是一款模板引擎：即一种基于模板和要改变的数据， 并用来生成输出文本（HTML网页、电子邮件、配置文件、源代码等）的通用工具。它不是面向最终用户的，而是一个Java类库，是一款程序员可以嵌入他们所开发产品的组件。</p>\n<p>FreeMarker是免费的，基于Apache许可证2.0版本发布。其模板编写为FreeMarker Template Language（FTL），属于简单、专用的语言。需要准备数据在真实编程语言中来显示，比如数据库查询和业务运算，之后模板显示已经准备好的数据。在模板中，主要用于如何展现数据，而在模板之外注意于要展示什么数据。</p>\n<h2 id=\"项目结构\"><a href=\"#项目结构\" class=\"headerlink\" title=\"项目结构\"></a>项目结构</h2><p><img src=\"/images/2020/05/20200501153425266.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"搭建项目环境\"><a href=\"#搭建项目环境\" class=\"headerlink\" title=\"搭建项目环境\"></a>搭建项目环境</h2><p>我们创建一个Maven项目，并在pom.xml文件中引入相关依赖。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.0.6.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--SpringMVC的启动器依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--SpringBoot整合FreeMarker模板引擎的依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-freemarker<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--Lombox依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.projectlombok<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>lombok<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"SpringBoot项目启动类\"><a href=\"#SpringBoot项目启动类\" class=\"headerlink\" title=\"SpringBoot项目启动类\"></a>SpringBoot项目启动类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyApplication</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        SpringApplication.run(MyApplication.class);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"application-yml配置文件\"><a href=\"#application-yml配置文件\" class=\"headerlink\" title=\"application.yml配置文件\"></a>application.yml配置文件</h2><figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">freemarker:</span></span><br><span class=\"line\">    <span class=\"attr\">charset:</span> <span class=\"string\">UTF-8</span></span><br><span class=\"line\"><span class=\"comment\">#    如果不配置模板文件后缀，默认是.ftl文件</span></span><br><span class=\"line\"><span class=\"comment\">#    suffix: &quot;.html&quot;  </span></span><br><span class=\"line\"><span class=\"comment\">#    默认就是在templates目录下，是一个数组对象，可以配置多个</span></span><br><span class=\"line\"><span class=\"comment\">#    template-loader-path: &quot;classpath:/templates/&quot;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"User类\"><a href=\"#User类\" class=\"headerlink\" title=\"User类\"></a>User类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@AllArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@NoArgsConstructor</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String password;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"UseController类\"><a href=\"#UseController类\" class=\"headerlink\" title=\"UseController类\"></a>UseController类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Controller</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserController</span> &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping(&quot;/user&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">findUser</span><span class=\"params\">(Model model)</span> &#123;</span><br><span class=\"line\">        List&lt;User&gt; users = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">        users.add(<span class=\"keyword\">new</span> <span class=\"title class_\">User</span>(<span class=\"string\">&quot;张三&quot;</span>,<span class=\"string\">&quot;123&quot;</span>));</span><br><span class=\"line\">        users.add(<span class=\"keyword\">new</span> <span class=\"title class_\">User</span>(<span class=\"string\">&quot;李四&quot;</span>,<span class=\"string\">&quot;123&quot;</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">        model.addAttribute(<span class=\"string\">&quot;users&quot;</span>, users);</span><br><span class=\"line\">        model.addAttribute(<span class=\"string\">&quot;hello&quot;</span>,<span class=\"string\">&quot;hello world&quot;</span>);</span><br><span class=\"line\">        model.addAttribute(<span class=\"string\">&quot;now&quot;</span>,<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>());</span><br><span class=\"line\">        model.addAttribute(<span class=\"string\">&quot;num&quot;</span>,<span class=\"number\">100</span>);</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;index&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"index-ftl\"><a href=\"#index-ftl\" class=\"headerlink\" title=\"index.ftl\"></a>index.ftl</h2><figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;en&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>FreeMarker入门<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>$&#123;hello&#125;<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>$&#123;now?date&#125;<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">table</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>姓名<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>密码<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">        &lt;#list users as user&gt;</span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>$&#123;user.username&#125;<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">td</span>&gt;</span>$&#123;user.password&#125;<span class=\"tag\">&lt;/<span class=\"name\">td</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">tr</span>&gt;</span></span><br><span class=\"line\">        &lt;/#list&gt;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">table</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;#if num == 100&gt;</span><br><span class=\"line\">        num的值是100</span><br><span class=\"line\">    &lt;#else&gt;</span><br><span class=\"line\">        num的值不是100</span><br><span class=\"line\">    &lt;/#if&gt;</span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"测试效果\"><a href=\"#测试效果\" class=\"headerlink\" title=\"测试效果\"></a>测试效果</h2><p>启动项目，我们访问<a href=\"http://localhost:8080/user路径，得到结果：\">http://localhost:8080/user路径，得到结果：</a></p>\n<p><img src=\"/images/2020/05/20200501154654345.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["Java"],"tags":["Java","SpringBoot","Freemarker"]},{"title":"SpringBoot+MyBatis+通用Mapper","url":"/2020/02/22/java/SpringBoot+MyBatis+%E9%80%9A%E7%94%A8Mapper/","content":"<h2 id=\"初步认识SpringBoot\"><a href=\"#初步认识SpringBoot\" class=\"headerlink\" title=\"初步认识SpringBoot\"></a>初步认识SpringBoot</h2><p>SpringBoot是Spring框架的一个快速启动的脚手架，使用SpringBoot，我们将省去Spring框架那些繁琐的配置，从而将我们的大脑和双手从配置工作中解放出来。使用SpringBoot，我们可以快速地搭建起一个基于Spring框架的Web项目。</p>\n<span id=\"more\"></span>\n<h2 id=\"创建项目，引入依赖\"><a href=\"#创建项目，引入依赖\" class=\"headerlink\" title=\"创建项目，引入依赖\"></a>创建项目，引入依赖</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">&lt;!--所有SpringBoot项目，都必须以spring-boot-starter-parent为父项目，也就是说，所有的SpringBoot项目，都是该项目的子项目。--&gt;</span><br><span class=\"line\">&lt;parent&gt;</span><br><span class=\"line\">   &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;<span class=\"number\">2.0</span><span class=\"number\">.4</span>.RELEASE&lt;/version&gt;</span><br><span class=\"line\">&lt;/parent&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;dependencies&gt;</span><br><span class=\"line\">\t&lt;!--web功能的启动器，里面是和SpringMVC等web层相关的依赖--&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;!--测试功能的启动器，用于整合junit测试功能--&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;</span><br><span class=\"line\">        &lt;scope&gt;test&lt;/scope&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;!--lombox插件的依赖，SpringBoot内置，无须标注版本号--&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;lombok&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;!--MySQL数据库驱动--&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;mysql&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">    &lt;!--通用mapper，基于MyBatis的一个通用Mapper，里面依赖了MyBatis--&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;tk.mybatis&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;mapper-spring-boot-starter&lt;/artifactId&gt;</span><br><span class=\"line\">        &lt;version&gt;<span class=\"number\">2.0</span><span class=\"number\">.3</span>&lt;/version&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">&lt;/dependencies&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;build&gt;</span><br><span class=\"line\">\t&lt;!--SpringBoot插件--&gt;</span><br><span class=\"line\">    &lt;plugins&gt;</span><br><span class=\"line\">        &lt;plugin&gt;</span><br><span class=\"line\">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</span><br><span class=\"line\">        &lt;/plugin&gt;</span><br><span class=\"line\">    &lt;/plugins&gt;</span><br><span class=\"line\">&lt;/build&gt;</span><br></pre></td></tr></table></figure>\n<h2 id=\"application-yml配置文件\"><a href=\"#application-yml配置文件\" class=\"headerlink\" title=\"application.yml配置文件\"></a>application.yml配置文件</h2><p>SpringBoot只是简化项目的配置文件，并不是真正没有了配置，最起码比如数据库连接信息，就需要我们自己手动配置。<br>我们在resources目录下创建一个application.yml的配置文件。</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">datasource:</span>   <span class=\"comment\">#配置数据库连接的四个信息，这里使用的是SpringBoot内置的数据库连接池Hikari</span></span><br><span class=\"line\">    <span class=\"attr\">driver-class-name:</span> <span class=\"string\">com.mysql.jdbc.Driver</span></span><br><span class=\"line\">    <span class=\"attr\">url:</span> <span class=\"string\">jdbc:mysql://localhost:3306/myshop</span></span><br><span class=\"line\">    <span class=\"attr\">username:</span> <span class=\"string\">root</span></span><br><span class=\"line\">    <span class=\"attr\">password:</span> <span class=\"string\">admin</span></span><br><span class=\"line\">  <span class=\"attr\">jackson:</span>\t\t<span class=\"comment\">#用来转换json数据格式的日期</span></span><br><span class=\"line\">    <span class=\"attr\">default-property-inclusion:</span> <span class=\"string\">ALWAYS</span></span><br><span class=\"line\">    <span class=\"attr\">time-zone:</span> <span class=\"string\">GMT+8</span></span><br><span class=\"line\">    <span class=\"attr\">date-format:</span> <span class=\"string\">yyyy-MM-dd</span></span><br><span class=\"line\"><span class=\"attr\">mybatis:</span></span><br><span class=\"line\">  <span class=\"attr\">type-aliases-package:</span> <span class=\"string\">com.hrp.domain</span>  <span class=\"comment\">#配置的是MyBatis的实体类包扫描</span></span><br></pre></td></tr></table></figure>\n<p>以上就是我们的所有配置，相比较于SSM框架中的配置，SpringBoot大大简化了配置的过程。</p>\n<h2 id=\"编写SpringBoot启动类\"><a href=\"#编写SpringBoot启动类\" class=\"headerlink\" title=\"编写SpringBoot启动类\"></a>编写SpringBoot启动类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.hrp;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.SpringApplication;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * SpringBoot启动类，SpringBoot应用程序入口</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> hrp</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@date</span> 2020/2/7 22:14</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyApplication</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        SpringApplication.run(MyApplication.class);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"编写实体类\"><a href=\"#编写实体类\" class=\"headerlink\" title=\"编写实体类\"></a>编写实体类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.hrp.domain;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.Data;</span><br><span class=\"line\"><span class=\"keyword\">import</span> tk.mybatis.mapper.annotation.KeySql;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.persistence.Id;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.persistence.Table;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Date;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> hrp</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@date</span> 2020/2/7 22:11</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@Table(name = &quot;user&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Id</span></span><br><span class=\"line\">    <span class=\"meta\">@KeySql(useGeneratedKeys = true)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Long id;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String password;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer gender;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Date birthday;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String phone;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String picture;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String address1;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String address2;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String address3;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer power;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>附上数据库建表语句（MySQL数据库）</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">CREATE TABLE `user` (</span><br><span class=\"line\">  `id` bigint(<span class=\"number\">10</span>) NOT NULL AUTO_INCREMENT,</span><br><span class=\"line\">  `username` varchar(<span class=\"number\">20</span>) DEFAULT NULL,</span><br><span class=\"line\">  `password` varchar(<span class=\"number\">20</span>) DEFAULT NULL,</span><br><span class=\"line\">  `name` varchar(<span class=\"number\">20</span>) DEFAULT NULL,</span><br><span class=\"line\">  `gender` <span class=\"type\">int</span>(<span class=\"number\">1</span>) DEFAULT NULL,</span><br><span class=\"line\">  `birthday` date DEFAULT NULL,</span><br><span class=\"line\">  `phone` varchar(<span class=\"number\">20</span>) DEFAULT NULL,</span><br><span class=\"line\">  `picture` varchar(<span class=\"number\">50</span>) DEFAULT NULL,</span><br><span class=\"line\">  `address1` varchar(<span class=\"number\">50</span>) DEFAULT NULL,</span><br><span class=\"line\">  `address2` varchar(<span class=\"number\">50</span>) DEFAULT NULL,</span><br><span class=\"line\">  `address3` varchar(<span class=\"number\">50</span>) DEFAULT NULL,</span><br><span class=\"line\">  `power` <span class=\"type\">int</span>(<span class=\"number\">1</span>) DEFAULT NULL,</span><br><span class=\"line\">  PRIMARY <span class=\"title function_\">KEY</span> <span class=\"params\">(`id`)</span></span><br><span class=\"line\">) ENGINE=InnoDB AUTO_INCREMENT=<span class=\"number\">15</span> DEFAULT CHARSET=utf8;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"编写Common类\"><a href=\"#编写Common类\" class=\"headerlink\" title=\"编写Common类\"></a>编写Common类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.hrp.common;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> tk.mybatis.mapper.additional.idlist.IdListMapper;</span><br><span class=\"line\"><span class=\"keyword\">import</span> tk.mybatis.mapper.additional.insert.InsertListMapper;</span><br><span class=\"line\"><span class=\"keyword\">import</span> tk.mybatis.mapper.annotation.RegisterMapper;</span><br><span class=\"line\"><span class=\"keyword\">import</span> tk.mybatis.mapper.common.Mapper;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 这是我们自己写的通用类，本质就是一个工具类，T为实体泛型，D为实体主键泛型</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> hrp</span></span><br><span class=\"line\"><span class=\"comment\"> * 2020/2/22 15:34</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@RegisterMapper</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">BaseMapper</span>&lt;T,D&gt; <span class=\"keyword\">extends</span> <span class=\"title class_\">Mapper</span>&lt;T&gt;, IdListMapper&lt;T,D&gt;, InsertListMapper&lt;T&gt; &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>【注意】在这个类中，我们需要注意一些包的引入，比如Mapper这个接口是tk.mybatis.mapper.common包下的，不要导错了。</p>\n<h2 id=\"编写数据访问层\"><a href=\"#编写数据访问层\" class=\"headerlink\" title=\"编写数据访问层\"></a>编写数据访问层</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.hrp.mapper;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.hrp.common.BaseMapper;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.hrp.domain.User;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 这里需要注意几个点，同样是导包问题</span></span><br><span class=\"line\"><span class=\"comment\"> *      第一：<span class=\"doctag\">@Mapper</span>注解的包是ibatis的</span></span><br><span class=\"line\"><span class=\"comment\"> *      第二：这里的BaseMapper是我们自己写的那个，不是tk.mybatis(通用Mapper)的</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> hrp</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@date</span> 2020/2/7 22:16</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Mapper</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">UserMapper</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">BaseMapper</span>&lt;User,Long&gt; &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>【注意】这里需要注意几个点，同样是导包问题</p>\n<ul>\n<li>@Mapper注解的包是ibatis的</li>\n<li>这里的BaseMapper是我们自己写的那个，不是tk.mybatis(通用Mapper)的</li>\n</ul>\n<h2 id=\"编写业务层\"><a href=\"#编写业务层\" class=\"headerlink\" title=\"编写业务层\"></a>编写业务层</h2><p><strong>业务层接口</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.hrp.service;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.hrp.domain.User;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> hrp</span></span><br><span class=\"line\"><span class=\"comment\"> * 2020/2/22 14:44</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">UserService</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 查找所有用户信息</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    List&lt;User&gt; <span class=\"title function_\">findAll</span><span class=\"params\">()</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>业务层实现</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.hrp.service.impl;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.hrp.domain.User;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.hrp.mapper.UserMapper;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.hrp.service.UserService;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.stereotype.Service;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> hrp</span></span><br><span class=\"line\"><span class=\"comment\"> * 2020/2/22 14:47</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Service</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserServiceImpl</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">UserService</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> UserMapper userMapper;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;User&gt; <span class=\"title function_\">findAll</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> userMapper.selectAll();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>【注意】没错，我们没有写任何的sql语句，只是在实体类上写了一些注解，持久层实现了一个Mapper接口，我们就可以直接使用一些简单的增删改查的方法，这就是通用Mapper的强大之处。</p>\n<h2 id=\"编写Web层\"><a href=\"#编写Web层\" class=\"headerlink\" title=\"编写Web层\"></a>编写Web层</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.hrp.web;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.hrp.domain.User;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.hrp.service.UserService;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.http.ResponseEntity;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> hrp</span></span><br><span class=\"line\"><span class=\"comment\"> * 2020/2/22 14:48</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;user&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserController</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> UserService userService;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping(&quot;list&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> ResponseEntity&lt;List&lt;User&gt;&gt; <span class=\"title function_\">findAll</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ResponseEntity.ok(userService.findAll());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h2><p>我们运行启动类的main方法，启动这个SpringBoot项目，访问/user/list接口。</p>\n<p><img src=\"/images/2020/02/20200222161215506.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["Java"],"tags":["Java","Spring","MyBatis"]},{"title":"SpringBoot+MyBatisPlus","url":"/2020/03/16/java/SpringBoot+MyBatisPlus/","content":"<h2 id=\"MyBatisPlus\"><a href=\"#MyBatisPlus\" class=\"headerlink\" title=\"MyBatisPlus\"></a>MyBatisPlus</h2><p>Mybatis-Plus（简称MP）是一个 Mybatis 的增强工具，在 Mybatis 的基础上只做增强不做改变，为简化开发、提高效率而生。<br>MyBatis-Plus可以自动为我们生成Dao层的简单CRUD操作，同时还内置了基于MyBatis的物理分页功能。</p>\n<span id=\"more\"></span>\n<p><strong>注意：MyBatisPlus的2.X版本和3.X版本有不兼容的现象，因为3.X改动了部分包名，还有分页插件也进行了较大的改动。</strong></p>\n<p><strong>本篇博客以MyBatisPlus-3.0.5版本为环境基础。</strong></p>\n<h2 id=\"搭建开发环境\"><a href=\"#搭建开发环境\" class=\"headerlink\" title=\"搭建开发环境\"></a>搭建开发环境</h2><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.0.4.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"comment\">&lt;!--web功能的启动器，里面是和SpringMVC等web层相关的依赖--&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">   <span class=\"comment\">&lt;!--测试功能的启动器，用于整合junit测试功能--&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-test<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>test<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">   <span class=\"comment\">&lt;!--lombox插件的依赖，SpringBoot内置，无须标注版本号--&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.projectlombok<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>lombok<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">   <span class=\"comment\">&lt;!--数据库驱动--&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>mysql<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">   <span class=\"comment\">&lt;!--mybatis-plus与springboot整合的启动器--&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.baomidou<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.0.5<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\">   <span class=\"comment\">&lt;!--SpringBoot插件--&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">           <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">           <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"application-yml配置\"><a href=\"#application-yml配置\" class=\"headerlink\" title=\"application.yml配置\"></a>application.yml配置</h2><figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">datasource:</span>   <span class=\"comment\">#配置数据库连接的四个信息，这里使用的是SpringBoot内置的数据库连接池Hikari</span></span><br><span class=\"line\">    <span class=\"attr\">driver-class-name:</span> <span class=\"string\">com.mysql.jdbc.Driver</span></span><br><span class=\"line\">    <span class=\"attr\">url:</span> <span class=\"string\">jdbc:mysql://localhost:3306/myshop</span></span><br><span class=\"line\">    <span class=\"attr\">username:</span> <span class=\"string\">root</span></span><br><span class=\"line\">    <span class=\"attr\">password:</span> <span class=\"string\">admin</span></span><br><span class=\"line\">  <span class=\"attr\">jackson:</span></span><br><span class=\"line\">    <span class=\"attr\">default-property-inclusion:</span> <span class=\"string\">ALWAYS</span></span><br><span class=\"line\">    <span class=\"attr\">time-zone:</span> <span class=\"string\">GMT+8</span></span><br><span class=\"line\">    <span class=\"attr\">date-format:</span> <span class=\"string\">yyyy-MM-dd</span></span><br><span class=\"line\"><span class=\"attr\">mybatis-plus:</span></span><br><span class=\"line\">  <span class=\"attr\">type-aliases-package:</span> <span class=\"string\">com.hrp.domain</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"MyBatisPlus配置\"><a href=\"#MyBatisPlus配置\" class=\"headerlink\" title=\"MyBatisPlus配置\"></a>MyBatisPlus配置</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"meta\">@MapperScan(&quot;com.hrp.dao&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyBatisPlusConfig</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 分页插件</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> PaginationInterceptor <span class=\"title function_\">paginationInterceptor</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">PaginationInterceptor</span>();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"实体类的编写\"><a href=\"#实体类的编写\" class=\"headerlink\" title=\"实体类的编写\"></a>实体类的编写</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@TableName(&quot;user&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@TableId(type = IdType.AUTO)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Long id;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String password;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer gender;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Date birthday;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String phone;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String picture;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String address1;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String address2;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String address3;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer power;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Dao层编写\"><a href=\"#Dao层编写\" class=\"headerlink\" title=\"Dao层编写\"></a>Dao层编写</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">UserDao</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">BaseMapper</span>&lt;User&gt; &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"测试类的编写\"><a href=\"#测试类的编写\" class=\"headerlink\" title=\"测试类的编写\"></a>测试类的编写</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SpringBootTest</span></span><br><span class=\"line\"><span class=\"meta\">@RunWith(SpringRunner.class)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserDaoTest</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> UserDao userDao;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 通过Id查找用户</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test01</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"type\">User</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> userDao.selectById(<span class=\"number\">1</span>);</span><br><span class=\"line\">        System.out.println(user);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 查找全部用户</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test02</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        List&lt;User&gt; list = userDao.selectList(<span class=\"literal\">null</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (User user : list) &#123;</span><br><span class=\"line\">            System.out.println(user);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 通过Map集合查找用户</span></span><br><span class=\"line\"><span class=\"comment\">     *      Map集合中key为数据库字段名，value为数据</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test03</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        Map&lt;String,Object&gt; map = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;();</span><br><span class=\"line\">        map.put(<span class=\"string\">&quot;username&quot;</span>,<span class=\"string\">&quot;zero&quot;</span>);</span><br><span class=\"line\">        map.put(<span class=\"string\">&quot;name&quot;</span>,<span class=\"string\">&quot;零&quot;</span>);</span><br><span class=\"line\">        List&lt;User&gt; list = userDao.selectByMap(map);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (User user : list) &#123;</span><br><span class=\"line\">            System.out.println(user);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 分页查找用户，current为当前页（索引从1开始），size为当前页大小</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test04</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        IPage&lt;User&gt; page = <span class=\"keyword\">new</span> <span class=\"title class_\">Page</span>&lt;&gt;(<span class=\"number\">2</span>,<span class=\"number\">3</span>);</span><br><span class=\"line\">        IPage&lt;User&gt; UserPage = userDao.selectPage(page, <span class=\"literal\">null</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (User user : UserPage.getRecords()) &#123;</span><br><span class=\"line\">            System.out.println(user);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 插入用户信息</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test05</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"type\">User</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>();</span><br><span class=\"line\">        user.setUsername(<span class=\"string\">&quot;阿部多瑞&quot;</span>);</span><br><span class=\"line\">        user.setPassword(<span class=\"string\">&quot;123&quot;</span>);</span><br><span class=\"line\">        user.setName(<span class=\"string\">&quot;宣墨&quot;</span>);</span><br><span class=\"line\">        user.setGender(<span class=\"number\">0</span>);</span><br><span class=\"line\">        user.setBirthday(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>());</span><br><span class=\"line\">        user.setPhone(<span class=\"string\">&quot;154845129875&quot;</span>);</span><br><span class=\"line\">        user.setPower(<span class=\"number\">2</span>);</span><br><span class=\"line\">        userDao.insert(user);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","categories":["Java"],"tags":["Java","SpringBoot","MyBatisPlus"]},{"title":"SpringBoot+SpringDataJPA","url":"/2020/02/23/java/SpringBoot+SpringDataJPA/","content":"<h2 id=\"SpringDataJPA\"><a href=\"#SpringDataJPA\" class=\"headerlink\" title=\"SpringDataJPA\"></a>SpringDataJPA</h2><p>SpringDataJPA是Spring全家桶中SpringData系列的一个分支，是SpringData对于JPA的封装和支持。<br>所谓JPA，即Java Persistence API，Java持久层API，是JDK对于ORM规范定义的一套接口，用于在数据持久层中面向对象编程，屏蔽数据库底层操作。<br>而在所有的JPA实现框架中，最为优秀的自然是Hibernate，所以，SpringDataJPA默认使用的底层实现就是Hibernate框架。而我们平常所说的JPA也默认是Hibernate实现的JPA。</p>\n<span id=\"more\"></span>\n<p>SpringDataJPA作为Spring大家庭的一个成员，自然也默认支持SpringBoot，我们也可以直接使用SpringBoot来搭建SpringDataJPA环境。</p>\n<h2 id=\"创建项目，引入依赖\"><a href=\"#创建项目，引入依赖\" class=\"headerlink\" title=\"创建项目，引入依赖\"></a>创建项目，引入依赖</h2><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=<span class=\"string\">&quot;1.0&quot;</span> encoding=<span class=\"string\">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">project</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">xmlns:xsi</span>=<span class=\"string\">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">xsi:schemaLocation</span>=<span class=\"string\">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">modelVersion</span>&gt;</span>4.0.0<span class=\"tag\">&lt;/<span class=\"name\">modelVersion</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.hrp<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>springboot_jpa<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.0-SNAPSHOT<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--SpringBoot为父项目--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.0.4.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--SpringBootweb开发的启动器--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--Spring-Data-JPA的启动器--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--测试功能的启动器，用于整合junit测试功能--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-test<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>test<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--lombox插件的依赖，SpringBoot内置，无须标注版本号--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.projectlombok<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>lombok<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--MySQL数据库驱动--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>mysql<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">project</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"application-yml配置文件\"><a href=\"#application-yml配置文件\" class=\"headerlink\" title=\"application.yml配置文件\"></a>application.yml配置文件</h2><figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">datasource:</span>   <span class=\"comment\">#配置数据库连接的四个信息，这里使用的是SpringBoot内置的数据库连接池Hikari</span></span><br><span class=\"line\">    <span class=\"attr\">driver-class-name:</span> <span class=\"string\">com.mysql.jdbc.Driver</span></span><br><span class=\"line\">    <span class=\"attr\">url:</span> <span class=\"string\">jdbc:mysql://localhost:3306/myshop</span></span><br><span class=\"line\">    <span class=\"attr\">username:</span> <span class=\"string\">root</span></span><br><span class=\"line\">    <span class=\"attr\">password:</span> <span class=\"string\">admin</span></span><br><span class=\"line\">  <span class=\"attr\">jpa:</span></span><br><span class=\"line\">    <span class=\"attr\">database:</span> <span class=\"string\">mysql</span>         <span class=\"comment\">#指定数据库</span></span><br><span class=\"line\">    <span class=\"attr\">show-sql:</span> <span class=\"literal\">true</span>          <span class=\"comment\">#是否显示SQL语句</span></span><br><span class=\"line\">    <span class=\"attr\">generate-ddl:</span> <span class=\"literal\">false</span>     <span class=\"comment\">#是否在启动时初始化schema，默认为false</span></span><br><span class=\"line\">    <span class=\"attr\">open-in-view:</span> <span class=\"literal\">false</span>     <span class=\"comment\">#是否注册OpenEntityManagerInViewInterceptor，绑定JPA EntityManager到请求线程中，默认为: true</span></span><br><span class=\"line\">    <span class=\"attr\">hibernate:</span></span><br><span class=\"line\">      <span class=\"attr\">ddl-auto:</span> <span class=\"string\">update</span>      <span class=\"comment\">#用于指定数据库表生成策略</span></span><br><span class=\"line\">  <span class=\"attr\">jackson:</span></span><br><span class=\"line\">    <span class=\"attr\">default-property-inclusion:</span> <span class=\"string\">ALWAYS</span></span><br><span class=\"line\">    <span class=\"attr\">time-zone:</span> <span class=\"string\">GMT+8</span></span><br><span class=\"line\">    <span class=\"attr\">date-format:</span> <span class=\"string\">yyyy-MM-dd</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"SpringBoot启动类\"><a href=\"#SpringBoot启动类\" class=\"headerlink\" title=\"SpringBoot启动类\"></a>SpringBoot启动类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyApplication</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        SpringApplication.run(MyApplication.class);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"编写实体类\"><a href=\"#编写实体类\" class=\"headerlink\" title=\"编写实体类\"></a>编写实体类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@Entity</span></span><br><span class=\"line\"><span class=\"meta\">@Table(name = &quot;user&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Id</span></span><br><span class=\"line\">    <span class=\"meta\">@GeneratedValue(strategy = GenerationType.IDENTITY)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Long id;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String password;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer gender;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Date birthday;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String phone;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String picture;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String address1;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String address2;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String address3;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer power;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>这个实体类对应的user表和上一篇博客<a href=\"/2020/02/22/java/SpringBoot+MyBatis+通用Mapper/\">SpringBoot+MyBatis+通用Mapper</a>是同一个数据库表，这里就不再写数据库建表语句，有需要的可以去上一篇博客中找。</p>\n<h2 id=\"编写数据访问层\"><a href=\"#编写数据访问层\" class=\"headerlink\" title=\"编写数据访问层\"></a>编写数据访问层</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">UserDao</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">JpaRepository</span>&lt;User,Long&gt;, JpaSpecificationExecutor&lt;User&gt; &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>同样，这里只需要继承一个JpaRepository和JpaSpecificationExecutor两个接口就可以了，SpringDataJPA会使用动态代理的方式，自动生成对应的简单访问方法。<br>JpaRepository中的两个泛型：</p>\n<ul>\n<li>第一个为实体类类型</li>\n<li>第二个为实体类主键类型</li>\n</ul>\n<h2 id=\"编写业务层\"><a href=\"#编写业务层\" class=\"headerlink\" title=\"编写业务层\"></a>编写业务层</h2><p><strong>业务层接口</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">UserService</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 分页查询用户数据</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> pageNum</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> pageSize</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    Page&lt;User&gt; <span class=\"title function_\">findByPage</span><span class=\"params\">(Integer pageNum, Integer pageSize)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>业务层实现</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Service</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserServiceImpl</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">UserService</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> UserDao userDao;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Page&lt;User&gt; <span class=\"title function_\">findByPage</span><span class=\"params\">(Integer pageNum, Integer pageSize)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Pageable</span> <span class=\"variable\">pageable</span> <span class=\"operator\">=</span> PageRequest.of(pageNum,pageSize);</span><br><span class=\"line\">        Page&lt;User&gt; page = userDao.findAll(pageable);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> page;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><strong>这里使用了SpringData中的一个分页工具Pageable。</strong></li>\n</ul>\n<h2 id=\"编写Web层\"><a href=\"#编写Web层\" class=\"headerlink\" title=\"编写Web层\"></a>编写Web层</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;user&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserController</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> UserService userService;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@GetMapping(&quot;page/&#123;pageNum&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> ResponseEntity&lt;Page&lt;User&gt;&gt; <span class=\"title function_\">findByPage</span><span class=\"params\">(</span></span><br><span class=\"line\"><span class=\"params\">            <span class=\"meta\">@PathVariable(&quot;pageNum&quot;)</span> Integer pageNum,</span></span><br><span class=\"line\"><span class=\"params\">            <span class=\"meta\">@RequestParam(defaultValue = &quot;5&quot;)</span> Integer pageSize)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ResponseEntity.ok(userService.findByPage(pageNum,pageSize));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h2><p>我们启动SpringBoot项目，然后在浏览器中访问<strong>/user/page/{pageNum}</strong>这个API。</p>\n<p><img src=\"/images/2020/02n/20200223105925173.png\" alt=\"在这里插入图片描述\"></p>\n<p>【注意】<strong>SpringData中的Pageable分页功能，索引是从0开始的，所以如果是正式开发中，我们应该自己维护这个索引，维护策略应该结合需求实际应用。</strong></p>\n","categories":["Java"],"tags":["Java","Spring","JPA"]},{"title":"SpringBoot任务定时功能","url":"/2020/05/04/java/SpringBoot%E4%BB%BB%E5%8A%A1%E5%AE%9A%E6%97%B6%E5%8A%9F%E8%83%BD/","content":"<blockquote>\n<p>SpringBoot中为我们提供了任务定时功能，我们可以通过注解的方式，设置定时任务，规定在指定时间间隔内循环执行任务。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h2 id=\"搭建项目环境\"><a href=\"#搭建项目环境\" class=\"headerlink\" title=\"搭建项目环境\"></a>搭建项目环境</h2><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.0.4.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"SpringBoot启动类\"><a href=\"#SpringBoot启动类\" class=\"headerlink\" title=\"SpringBoot启动类\"></a>SpringBoot启动类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyApplication</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        SpringApplication.run(MyApplication.class);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"SpringBoot定时任务\"><a href=\"#SpringBoot定时任务\" class=\"headerlink\" title=\"SpringBoot定时任务\"></a>SpringBoot定时任务</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"meta\">@EnableScheduling</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyTask</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 定时任务，每隔1秒钟执行一次该方法</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Scheduled(fixedRate = 1000)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">task01</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">SimpleDateFormat</span> <span class=\"variable\">sdf</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">SimpleDateFormat</span>(<span class=\"string\">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;定时任务&quot;</span>+ sdf.format(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 定时任务，循环执行该方法，但是在上一次方法结束和这一次方法开始之间间隔1秒</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Scheduled(fixedDelay = 1000)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">task02</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">SimpleDateFormat</span> <span class=\"variable\">sdf</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">SimpleDateFormat</span>(<span class=\"string\">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;定时任务&quot;</span>+ sdf.format(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>()));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","categories":["Java"],"tags":["Java","SpringBoot"]},{"title":"SpringBoot实现文件上传","url":"/2020/02/24/java/SpringBoot%E5%AE%9E%E7%8E%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/","content":"<p>我们使用SpringBoot来实现文件的上传，本文中的SpringBoot环境和<a href=\"/2020/02/22/java/SpringBoot+MyBatis+通用Mapper/\">SpringBoot+MyBatis+通用Mapper</a>中的环境基本一致，我们就不再重复造轮子了，而是直接上手这个功能。</p>\n<span id=\"more\"></span>\n<h2 id=\"依赖\"><a href=\"#依赖\" class=\"headerlink\" title=\"依赖\"></a>依赖</h2><p>在<a href=\"/2020/02/22/java/SpringBoot+MyBatis+通用Mapper/\">SpringBoot+MyBatis+通用Mapper</a>中我们已经引入了Web开发相关的依赖，所以这里就不需要再次引入了。</p>\n<h2 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h2><p>我们需要对SpringMVC的文件上传功能进行一些配置，比如MaxFileSize等等属性。<br>我们使用JavaConfig来进行配置，写一个配置类UploadConfig ，代码如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UploadConfig</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> MultipartConfigElement <span class=\"title function_\">multipartConfigElement</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">MultipartConfigFactory</span> <span class=\"variable\">factory</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MultipartConfigFactory</span>();</span><br><span class=\"line\">        <span class=\"comment\">//  单个数据大小</span></span><br><span class=\"line\">        factory.setMaxFileSize(<span class=\"string\">&quot;10240KB&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">/// 总上传数据大小</span></span><br><span class=\"line\">        factory.setMaxRequestSize(<span class=\"string\">&quot;102400KB&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> factory.createMultipartConfig();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>然后我们在application.yml文件中自定义一些配置：</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">file:</span></span><br><span class=\"line\">  <span class=\"attr\">upload:</span></span><br><span class=\"line\">    <span class=\"attr\">path:</span> <span class=\"string\">G:\\temp\\images\\</span>   <span class=\"comment\">#文件上传目标路径</span></span><br><span class=\"line\">    <span class=\"attr\">allowTypes:</span>             <span class=\"comment\">#文件上传允许的类型</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">image/jpeg</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">image/png</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">image/bmp</span></span><br></pre></td></tr></table></figure>\n<p>使用ConfigurationProperties将配置读取到Java文件中：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"meta\">@ConfigurationProperties(prefix = &quot;file.upload&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UploadProperties</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String path;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> List&lt;String&gt; allowTypes;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"代码\"><a href=\"#代码\" class=\"headerlink\" title=\"代码\"></a>代码</h2><p>在写文件上传的代码之前，我们还需要做一些准备工作，比如准备一些工具类，可以方便我们实现文件的上传功能。</p>\n<p><strong>编写工具类</strong></p>\n<ul>\n<li>唯一ID生成器，可以生成唯一ID。<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">IDUtils</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 唯一ID生成器，可以生成唯一ID</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title function_\">generateUniqueId</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> UUID.randomUUID().toString()+System.currentTimeMillis();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n<li>文件名称替换工具，用来替换文件名称，避免文件名称重复而导致名称相同的文件被覆盖掉。<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UploadUtils</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 文件名称替换工具，将文件名称替换为随机名称</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> oldName</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title function_\">generateFileName</span><span class=\"params\">(String oldName)</span>&#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">suffix</span> <span class=\"operator\">=</span> oldName.substring(oldName.lastIndexOf(<span class=\"string\">&quot;.&quot;</span>));</span><br><span class=\"line\">        <span class=\"keyword\">return</span> IDUtils.generateUniqueId()+suffix;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<p><strong>编写Web层</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;upload&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UploadController</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> UploadService uploadService;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping(&quot;image&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> ResponseEntity&lt;String&gt; <span class=\"title function_\">upload</span><span class=\"params\">(<span class=\"meta\">@RequestParam(&quot;file&quot;)</span> MultipartFile file)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ResponseEntity.ok(uploadService.uploadImage(file));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>编写Service层</strong></p>\n<ul>\n<li>Service层接口</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">UploadService</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 上传图片</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> file</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    String <span class=\"title function_\">uploadImage</span><span class=\"params\">(MultipartFile file)</span> <span class=\"keyword\">throws</span> Exception;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>Service层实现</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"> <span class=\"meta\">@Service</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UploadServiceImpl</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">UploadService</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> UploadProperties uploadProperties;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">uploadImage</span><span class=\"params\">(MultipartFile file)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!uploadProperties.getAllowTypes().contains(file.getContentType()))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">IOException</span>(<span class=\"string\">&quot;文件上传类型错误！&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">fileName</span> <span class=\"operator\">=</span> UploadUtils.generateFileName(file.getOriginalFilename());</span><br><span class=\"line\">        file.transferTo(<span class=\"keyword\">new</span> <span class=\"title class_\">File</span>(uploadProperties.getPath()+fileName));</span><br><span class=\"line\">        <span class=\"keyword\">return</span> fileName;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h2><p>由于我们也没有写html文件，所以我们直接使用<a href=\"/2020/02/23/tool/Postman的下载、安装与使用/\">Postman</a>这个软件来测试。</p>\n<p>第一步：我们使用POST请求，请求路径为<code>/upload/image</code>。<br>【注意，我们需要将请求头中的内容设置为空】<br>![在这里插入图片描述]/images/2020/02/20200224144201402.png)</p>\n<p>第二步：我们在请求体中将文件携带过去。<br>![在这里插入图片描述]/images/2020/02/20200224144746556.png)</p>\n<p>第三步，发出请求。<br>![在这里插入图片描述]/images/2020/02/20200224144953413.png)</p>\n","categories":["Java"],"tags":["Java","SpringBoot"]},{"title":"SpringBoot整合FreeMarker模板报错","url":"/2021/01/17/java/SpringBoot%E6%95%B4%E5%90%88FreeMarker%E6%A8%A1%E6%9D%BF%E6%8A%A5%E9%94%99/","content":"<blockquote>\n<p>DefaultObjectWrapper.incompatibleImprovements was set to the object returned by Configuration.getVersion(). That defeats the purpose of incompatibleImprovements, and makes upgrading FreeMarker a potentially breaking change. Also, this probably won’t be allowed starting from 2.4.0. Instead, set incompatibleImprovements to the highest concrete version that’s known to be compatible with your application.<br>Configuration.incompatibleImprovements was set to the object returned by Configuration.getVersion(). That defeats the purpose of incompatibleImprovements, and makes upgrading FreeMarker a potentially breaking change. Also, this probably won’t be allowed starting from 2.4.0. Instead, set incompatibleImprovements to the highest concrete version that’s known to be compatible with your application.</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<p>该报错的原因是因为没有指定对应的FreeMarker版本，而之前通过Configuration.getVersion()方式获取版本号已经不推荐使用，目前使用新的方式获取版本号。</p>\n<p>之前的版本号获取方式：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">Configuration</span> <span class=\"variable\">cfg</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Configuration</span>(Configuration.getVersion());</span><br></pre></td></tr></table></figure>\n<p>修改之后的版本号获取方式：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">Configuration</span> <span class=\"variable\">cfg</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Configuration</span>(Configuration.DEFAULT_INCOMPATIBLE_IMPROVEMENTS);</span><br></pre></td></tr></table></figure>\n<p>或者，如果开发者清楚知道项目中使用的FreeMarker版本的话，也可以直接指定版本号即可：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">Configuration</span> <span class=\"variable\">cfg</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Configuration</span>(Configuration.VERSION_2_3_30);</span><br></pre></td></tr></table></figure>\n\n<p>根据报错信息提示，该报错在2.4.0之前的版本中并不会对FreeMarker模板的功能有什么影响，但是在2.4.0版本之后可能会不推荐使用这种方法设置版本号。所以建议使用FreeMarker新的版本号获取方式。</p>\n","categories":["Java"],"tags":["Java","SpringBoot","FreeMarker"]},{"title":"SpringBoot整合Freemarker模板的两个错误","url":"/2021/04/06/java/SpringBoot%E6%95%B4%E5%90%88Freemarker%E6%A8%A1%E6%9D%BF%E7%9A%84%E4%B8%A4%E4%B8%AA%E9%94%99%E8%AF%AF/","content":"<p>之前的项目一直都在写 RESTFUL 风格的 API 接口，使用 Json 格式的数据和前端进行通信，但是最近因为一些特殊原因，需要在后端直接返回一个页面。</p>\n<p>结果在整合 Freemarker 模板引擎的时候发生了各种报错，在这里将报错原因和解决方法分享给各位同学。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"错误汇总\"><a href=\"#错误汇总\" class=\"headerlink\" title=\"错误汇总\"></a>错误汇总</h2><h3 id=\"一、无法找到对应的模板路径\"><a href=\"#一、无法找到对应的模板路径\" class=\"headerlink\" title=\"一、无法找到对应的模板路径\"></a>一、无法找到对应的模板路径</h3><p>请求到达服务后端之后，Controller 返回了对应的视图名称，但是 DispatcherServlet 却爆出 Completed 404 NOT_FOUND，显示无法找到对应的模板页面。</p>\n<p><strong>日志信息：</strong></p>\n<p><img src=\"/images/2021/04/20210406213919458.png\" alt=\"在这里插入图片描述\"></p>\n<p><strong>报错原因：</strong></p>\n<p>这个报错原因是因为 SpringBoot 版本导致的，我以前集成 Freemarker 模板，使用的 SpringBoot 版本是 2.0.6.RELEASE，但是现在项目中 SpringBoot 的版本是 2.3.8.RELEASE。而高版本的 SpringBoot 是不会自动注入 SpringMVC 相关的配置的，所以导致无法找到对应的模板资源路径。<br>最终报错 404。</p>\n<p><strong>解决方法：</strong></p>\n<p>如果使用 2.3.8.RELEASE 版本的 SpringBoot，需要在配置类中加上 @EnableWebMvc 注解，使用了该注解，则会自动配置 SpringMVC 相关的配置。</p>\n<p>例如：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@EnableWebMvc</span></span><br><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyApplication</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        SpringApplication.run(MyApplication.class, args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"二、无法解析-Freemarker-模板\"><a href=\"#二、无法解析-Freemarker-模板\" class=\"headerlink\" title=\"二、无法解析 Freemarker 模板\"></a>二、无法解析 Freemarker 模板</h3><p><strong>报错信息：</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">javax.servlet.ServletException: Could not resolve view with name <span class=\"string\">&#x27;oauth-login&#x27;</span> in servlet with name <span class=\"string\">&#x27;dispatcherServlet&#x27;</span></span><br><span class=\"line\">\tat org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:<span class=\"number\">1353</span>)</span><br><span class=\"line\">\tat org.springframework.web.servlet.DispatcherServlet.processDispatchResult(DispatcherServlet.java:<span class=\"number\">1118</span>)</span><br><span class=\"line\">\tat org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:<span class=\"number\">1057</span>)</span><br><span class=\"line\">\tat org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:<span class=\"number\">943</span>)</span><br><span class=\"line\">\tat org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:<span class=\"number\">1006</span>)</span><br><span class=\"line\">\tat org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:<span class=\"number\">898</span>)</span><br><span class=\"line\">\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:<span class=\"number\">626</span>)</span><br><span class=\"line\">\tat org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:<span class=\"number\">883</span>)</span><br><span class=\"line\">\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:<span class=\"number\">733</span>)</span><br></pre></td></tr></table></figure>\n\n<p>这个报错信息是因为无法找到 Freemarker 模板文件，导致无法解析正确的视图。</p>\n<p><strong>报错原因：</strong></p>\n<p>这个报错原因是因为，我的项目使用的是多模块开发，我通过 DEBUG，发现 Freemarker 视图解析的路径，是另一个模块的路径，而需要解析的 Freemarker 模板文件则在当前的模块。</p>\n<p><strong>解决方法：</strong></p>\n<p>配置 Freemarker 的 preferFileSystemAccess 属性为 false，该属性默认为 true。</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">freemarker:</span></span><br><span class=\"line\">    <span class=\"attr\">charset:</span> <span class=\"string\">UTF-8</span></span><br><span class=\"line\">    <span class=\"attr\">template-loader-path:</span> <span class=\"string\">classpath:/templates/</span></span><br><span class=\"line\">    <span class=\"attr\">content-type:</span> <span class=\"string\">text/html</span></span><br><span class=\"line\">    <span class=\"attr\">suffix:</span> <span class=\"string\">.ftlh</span></span><br><span class=\"line\">    <span class=\"attr\">prefer-file-system-access:</span> <span class=\"literal\">false</span></span><br></pre></td></tr></table></figure>\n\n","categories":["Java"],"tags":["Java","SpringBoot","FreeMarker"]},{"title":"SpringBoot自定义配置","url":"/2020/03/22/java/SpringBoot%E8%87%AA%E5%AE%9A%E4%B9%89%E9%85%8D%E7%BD%AE/","content":"<blockquote>\n<p>SpringBoot中为用户提供了自定义式配置的解析，我们只需要通过SpringBoot提供的注解，就可以直接将yml或properties配置文件中自定义的属性，以Java面向对象的理解方式解析出来。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h2 id=\"项目环境搭建\"><a href=\"#项目环境搭建\" class=\"headerlink\" title=\"项目环境搭建\"></a>项目环境搭建</h2><p>在此前的多篇博客中，我已经搭建过很多SpringBoot的项目环境，在这里就不重复搭建了，如果有需要的可以参考以前的博客：</p>\n<ul>\n<li><a href=\"/2020/02/22/java/SpringBoot+MyBatis+通用Mapper/\">SpringBoot+MyBatis+通用Mapper</a></li>\n<li><a href=\"/2020/02/23/java/SpringBoot+SpringDataJPA/\">SpringBoot+SpringDataJPA</a></li>\n<li><a href=\"/2020/03/16/java/SpringBoot+MyBatisPlus/\">SpringBoot+MyBatisPlus</a></li>\n</ul>\n<h2 id=\"自定义配置\"><a href=\"#自定义配置\" class=\"headerlink\" title=\"自定义配置\"></a>自定义配置</h2><p>SpringBoot的自定义配置非常简单，我们直接在配置文件中写符合配置文件的格式的内容即可。</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">my:</span></span><br><span class=\"line\">  <span class=\"attr\">properties:</span></span><br><span class=\"line\">    <span class=\"attr\">name:</span> <span class=\"string\">小小</span></span><br><span class=\"line\">    <span class=\"attr\">age:</span> <span class=\"number\">18</span></span><br><span class=\"line\">    <span class=\"attr\">hobby:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">写代码</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">运动</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">阅读</span></span><br><span class=\"line\">    <span class=\"attr\">family:</span></span><br><span class=\"line\">      <span class=\"attr\">father:</span> <span class=\"string\">爸爸</span></span><br><span class=\"line\">      <span class=\"attr\">mother:</span> <span class=\"string\">妈妈</span></span><br></pre></td></tr></table></figure>\n<p>在这里，我使用的application.yml配置文件，YML文件结构具有层次性，文件内容可读性高。</p>\n<blockquote>\n<p>YML文件的格式规定，缩进相同的配置为同一层次的内容，<strong>每个冒号后面都需要空一格</strong>。</p>\n</blockquote>\n<h2 id=\"编写Java类读取配置文件\"><a href=\"#编写Java类读取配置文件\" class=\"headerlink\" title=\"编写Java类读取配置文件\"></a>编写Java类读取配置文件</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"meta\">@ConfigurationProperties(prefix = &quot;my.properties&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Userproperties</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer age;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> List&lt;String&gt; hobby;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Map&lt;String,String&gt; family;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>SpringBoot中使用<code>@ConfigurationProperties</code>配置来表明这是一个读取配置文件内容的Java类。</li>\n<li><code>prefix</code>属性是配置文件配置的属性的前缀，Java类的属性名和配置文件中配置的属性名相同，即可自动注入到对应的属性中去。</li>\n<li>集合在配置文件中的书写方式是使用<code>-</code>来表示的，每个<code>-</code>后面都空有一个空格。</li>\n<li>Map集合的书写方式，是一个<code>key: value</code>形式。</li>\n</ul>\n<h2 id=\"功能测试\"><a href=\"#功能测试\" class=\"headerlink\" title=\"功能测试\"></a>功能测试</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RunWith(SpringRunner.class)</span></span><br><span class=\"line\"><span class=\"meta\">@SpringBootTest()</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserPropertiesTest</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Userproperties userproperties;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;用户的姓名是：&quot;</span>+userproperties.getName());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;用户的年龄是：&quot;</span>+userproperties.getAge());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;用户的爱好是：&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (String hobby : userproperties.getHobby()) &#123;</span><br><span class=\"line\">            System.out.println(hobby);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Map.Entry&lt;String, String&gt; entry : userproperties.getFamily().entrySet()) &#123;</span><br><span class=\"line\">            System.out.println(entry.getKey()+<span class=\"string\">&quot;:&quot;</span>+entry.getValue());</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"输出结果\"><a href=\"#输出结果\" class=\"headerlink\" title=\"输出结果\"></a>输出结果</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">用户的姓名是：小小</span><br><span class=\"line\">用户的年龄是：<span class=\"number\">18</span></span><br><span class=\"line\">用户的爱好是：</span><br><span class=\"line\">写代码</span><br><span class=\"line\">运动</span><br><span class=\"line\">阅读</span><br><span class=\"line\">father:爸爸</span><br><span class=\"line\">mother:妈妈</span><br></pre></td></tr></table></figure>\n\n","categories":["Java"],"tags":["Java","SpringBoot"]},{"title":"SpringBoot访问静态资源","url":"/2020/03/17/java/SpringBoot%E8%AE%BF%E9%97%AE%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90/","content":"<p>上一篇博客<a href=\"/2020/02/24/java/SpringBoot配置虚拟路径映射访问磁盘中的文件/\">SpringBoot配置虚拟路径映射访问磁盘中的文件</a>中提供了一种可以访问磁盘中的静态资源的配置方式，只需要简单配置，就可以将访问静态资源的路径映射磁盘中，实现静态资源的访问。</p>\n<span id=\"more\"></span>\n<p>具体方式为在application.yml文件中配置如下属性：</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">\t<span class=\"attr\">resources:</span></span><br><span class=\"line\">    \t<span class=\"attr\">static-locations:</span> <span class=\"string\">file:G:\\temp\\images</span>   <span class=\"comment\">#访问系统外部资源，将该目录下的文件映射到系统下</span></span><br></pre></td></tr></table></figure>\n\n<p>其实只要我们使用IDE开发工具，进入<code>static-locations</code>属性中查看一下，就可以看到这些代码。</p>\n<p>在<code>org.springframework.boot.autoconfigure.web</code>包下，有一个<code>ResourceProperties</code>类，其中有一个属性即为<code>staticLocations</code> 属性。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> String[] CLASSPATH_RESOURCE_LOCATIONS = &#123;</span><br><span class=\"line\">\t\t\t<span class=\"string\">&quot;classpath:/META-INF/resources/&quot;</span>, <span class=\"string\">&quot;classpath:/resources/&quot;</span>,</span><br><span class=\"line\">\t\t\t<span class=\"string\">&quot;classpath:/static/&quot;</span>, <span class=\"string\">&quot;classpath:/public/&quot;</span> &#125;;</span><br><span class=\"line\"><span class=\"keyword\">private</span> String[] staticLocations = CLASSPATH_RESOURCE_LOCATIONS;</span><br></pre></td></tr></table></figure>\n<p>我们通过代码可以看到，这个属性其实是一个String类型的属性，其包括四个静态资源的访问路径，也就是说，只要是在这四个静态资源的访问路径下，SpringBoot项目就可以访问静态资源。</p>\n<p>这四个静态资源路径分别代表着<code>resources</code>包下的：</p>\n<ul>\n<li><code>META-INF/resources</code>文件</li>\n<li><code>resources</code>文件</li>\n<li><code>static</code>文件</li>\n<li><code>public</code>文件</li>\n</ul>\n<p>我们可以自己配置静态资源的放置路径，覆盖SpringBoot的默认配置。</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">\t<span class=\"attr\">resources:</span></span><br><span class=\"line\"> \t   <span class=\"attr\">static-locations:</span></span><br><span class=\"line\">     \t  <span class=\"bullet\">-</span> <span class=\"string\">file:G:\\temp\\images</span>   \t<span class=\"comment\">#访问系统外部资源，可以用来存放项目上传的图片</span></span><br><span class=\"line\">  \t   \t  <span class=\"bullet\">-</span> <span class=\"string\">classpath:/static/</span>\t\t<span class=\"comment\">#可以用来存放其他静态资源，比如html文件</span></span><br></pre></td></tr></table></figure>\n\n","categories":["Java"],"tags":["Java","SpringBoot"]},{"title":"SpringBoot配置虚拟路径映射访问磁盘中的文件","url":"/2020/02/24/java/SpringBoot%E9%85%8D%E7%BD%AE%E8%99%9A%E6%8B%9F%E8%B7%AF%E5%BE%84%E6%98%A0%E5%B0%84%E8%AE%BF%E9%97%AE%E7%A3%81%E7%9B%98%E4%B8%AD%E7%9A%84%E6%96%87%E4%BB%B6/","content":"<p>在我们使用SpringBoot搭建项目的时候，我们可能会把一些项目的文件放在其他服务器或者硬盘中，这样可以更好的存储和管理系统的文件。<br>但是如果放在其他服务器或者硬盘中，那么我们应该如何通过项目的路径来访问这些文件呢？</p>\n<span id=\"more\"></span>\n<p>很简单，我们直接在SpringBoot中配置一个虚拟路径，将硬盘的路径映射到项目路径下，这样就可以通过项目路径来访问硬盘中的资源了。</p>\n<ul>\n<li>项目环境请参考博文<a href=\"/2020/02/22/java/SpringBoot+MyBatis+通用Mapper/\">SpringBoot+MyBatis+通用Mapper</a>。</li>\n</ul>\n<p><strong>第一步</strong>：我们在G:\\temp\\images目录下，放置一个图片资源。<br><img src=\"/images/2020/02/20200224233637858.png\" alt=\"在这里插入图片描述\"></p>\n<p><strong>第二步</strong>：我们在application.yml文件中配置虚拟路径的映射。</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">\t<span class=\"attr\">resources:</span></span><br><span class=\"line\">    \t<span class=\"attr\">static-locations:</span> <span class=\"string\">file:G:\\temp\\images</span>   <span class=\"comment\">#访问系统外部资源，将该目录下的文件映射到系统下</span></span><br><span class=\"line\">    <span class=\"attr\">mvc:</span>\t\t\t</span><br><span class=\"line\">   \t\t<span class=\"attr\">static-path-pattern:</span> <span class=\"string\">/**</span>\t\t<span class=\"comment\">#如果你没有配置这个属性，也可以选择不配置，因为该属性的默认值就是/**</span></span><br></pre></td></tr></table></figure>\n<p><strong>第三步</strong>：我们启动项目，直接通过http请求访问资源。<br><img src=\"/images/2020/02/202002242343056.png\" alt=\"在这里插入图片描述\"></p>\n<p>我们可以在浏览器上，通过<a href=\"http://localhost:8080/79830b68-3936-4953-adcd-3bf39d4cb1941582526908297.jpg请求路径访问G:\\temp\\images下的图片资源。\">http://localhost:8080/79830b68-3936-4953-adcd-3bf39d4cb1941582526908297.jpg请求路径访问G:\\temp\\images下的图片资源。</a></p>\n","categories":["Java"],"tags":["Java","SpringBoot"]},{"title":"SpringBoot项目中的启动logo修改","url":"/2020/06/26/java/SpringBoot%E9%A1%B9%E7%9B%AE%E4%B8%AD%E7%9A%84%E5%90%AF%E5%8A%A8logo%E4%BF%AE%E6%94%B9/","content":"<p>每当SpringBoot项目启动的时候，在打印台会自动打印一个SpringBoot的启动logo。</p>\n<span id=\"more\"></span>\n<p><img src=\"/images/2020/06/20200626210402451.png\" alt=\"在这里插入图片描述\"></p>\n<p><strong>这个logo其实是可以我们自己自定义的。</strong></p>\n<p>我们在resources目录下创建一个banner.txt文件，那么SpringBoot项目启动的时候，就会自动打印该文件中的内容作为logo。</p>\n<p>推荐几个SpringBoot的logo生成网站：</p>\n<ul>\n<li><p><a href=\"https://www.bootschool.net/ascii\">https://www.bootschool.net/ascii</a></p>\n</li>\n<li><p><a href=\"http://www.network-science.de/ascii/\">http://www.network-science.de/ascii/</a></p>\n</li>\n<li><p><a href=\"http://patorjk.com/software/taag\">http://patorjk.com/software/taag</a></p>\n</li>\n<li><p><a href=\"http://www.makepic.net/tool/image2ascii.html\">http://www.makepic.net/tool/image2ascii.html</a>（可以转换图片）</p>\n</li>\n</ul>\n<p>推荐几个转换为ASCII艺术形式比较好看优雅的字体：</p>\n<ul>\n<li>big</li>\n<li>doh</li>\n<li>doom</li>\n</ul>\n","categories":["Java"],"tags":["Java","SpringBoot"]},{"title":"SpringBoot项目使用devtools工具实现热部署","url":"/2020/07/25/java/SpringBoot%E9%A1%B9%E7%9B%AE%E4%BD%BF%E7%94%A8devtools%E5%B7%A5%E5%85%B7%E5%AE%9E%E7%8E%B0%E7%83%AD%E9%83%A8%E7%BD%B2/","content":"<blockquote>\n<p>我们在开发SpringBoot项目的时候，由于需要经常进行代码的改动，如果我们频繁地重启项目，这毫无疑问是极其浪费时间和电脑性能的，所以我们可以使用devtools工具来实现SpringBoot项目的热部署效果，代码改动后即时生效，节省大量的开发时间。</p>\n</blockquote>\n<span id=\"more\"></span>\n<h2 id=\"一、引入devtools工具的依赖\"><a href=\"#一、引入devtools工具的依赖\" class=\"headerlink\" title=\"一、引入devtools工具的依赖\"></a>一、引入devtools工具的依赖</h2><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--devtools热部署--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-devtools<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">optional</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">optional</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>该工具是和SpringBoot集成使用的，所以引入该依赖的项目必须是一个SpirngBoot项目才可以使用。</li>\n</ul>\n<h2 id=\"二、配置devtools工具参数\"><a href=\"#二、配置devtools工具参数\" class=\"headerlink\" title=\"二、配置devtools工具参数\"></a>二、配置devtools工具参数</h2><figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">devtools:</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span></span><br><span class=\"line\">      <span class=\"attr\">enabled:</span> <span class=\"literal\">true</span>  <span class=\"comment\">#设置开启热部署</span></span><br><span class=\"line\">      <span class=\"attr\">additional-paths:</span> <span class=\"string\">src/main/java</span> <span class=\"comment\">#重启目录</span></span><br><span class=\"line\">  <span class=\"attr\">freemarker:</span></span><br><span class=\"line\">    <span class=\"attr\">cache:</span> <span class=\"literal\">false</span>    <span class=\"comment\">#页面不加载缓存，修改即时生效</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>由于devtools和SpringBoot项目集成，所以我们可以直接在SpringBoot项目的yml文件中对devtools进行配置。</li>\n</ul>\n<h2 id=\"三、配置IDEA参数\"><a href=\"#三、配置IDEA参数\" class=\"headerlink\" title=\"三、配置IDEA参数\"></a>三、配置IDEA参数</h2><p><strong>第一步：File-&gt;Settings-&gt;Build、Execution、Deployment-&gt;Compiler</strong></p>\n<p><strong>勾选Build project automatically-&gt;点击OK</strong></p>\n<p><img src=\"/images/2020/07/20200725121308910.png\" alt=\"在这里插入图片描述\"></p>\n<p><strong>第二步：Ctrl+Shift+Alt+/（快捷键）</strong></p>\n<p><strong>点击Registry-&gt;勾选compiler.automake.allow.when.app.running-&gt;关闭即可</strong></p>\n<p><img src=\"/images/2020/07/20200725121712533.png\" alt=\"在这里插入图片描述\"><br><img src=\"/images/2020/07/20200725121957523.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["Java"],"tags":["Java","SpringBoot"]},{"title":"SpringBoot（一）：项目概述","url":"/2021/02/22/java/SpringBoot%EF%BC%88%E4%B8%80%EF%BC%89%EF%BC%9A%E9%A1%B9%E7%9B%AE%E6%A6%82%E8%BF%B0/","content":"<h1 id=\"zero-admin\"><a href=\"#zero-admin\" class=\"headerlink\" title=\"zero-admin\"></a>zero-admin</h1><blockquote>\n<p>zero-admin管理系统是作者在github上面的一个开源项目，这个开源项目使用了如今市场上Web开发的各种常用技术，包括但不限于SpringBoot，MyBatisPlus，Jwt，Swagger等等，作者会通过SpringBoot的系列博客的方式，将项目中使用的技术一一展示出来，供同学们学习。<br>该项目作者已经托管至github开源平台，有兴趣的同学可以前往github平台浏览，也欢迎每一个同学给该项目一个<code>star</code>。  </p>\n</blockquote>\n<span id=\"more\"></span>\n\n<blockquote>\n<p>项目演示地址：<a href=\"http://zeroadmin.herenpeng.com\">http://zeroadmin.herenpeng.com</a> （用户名/密码：user/111111）<br>github下载地址：<a href=\"https://github.com/herenpeng/zero-admin.git\">https://github.com/herenpeng/zero-admin.git</a><br>gitee地址：<a href=\"https://gitee.com/herenpeng/zero-admin.git\">https://gitee.com/herenpeng/zero-admin.git</a></p>\n</blockquote>\n<h2 id=\"项目特点\"><a href=\"#项目特点\" class=\"headerlink\" title=\"项目特点\"></a>项目特点</h2><ul>\n<li>项目基于前后端分离开发，前后端使用JSON格式的数据进行通信。</li>\n<li>基于用户-角色-权限进行系统权限管理，可以自由进行用户，角色，权限的添加，修改，删除。</li>\n<li>系统权限管理粒度精细至接口，每一个后台接口都可以通过系统进行权限管理。</li>\n<li>系统级别启动触发事件，系统资源接口自动扫描，无需手动添加，系统事件可自由配置开关。</li>\n<li>系统静态资源文件管理功能，系统静态资源文件自由管理。</li>\n<li>基于注解的AOP日志管理功能，记录每一个接口请求的详细信息。</li>\n<li>逻辑删除数据，及数据回收站功能。</li>\n</ul>\n<h2 id=\"项目开发环境\"><a href=\"#项目开发环境\" class=\"headerlink\" title=\"项目开发环境\"></a>项目开发环境</h2><ul>\n<li>JDK 1.8</li>\n<li>Maven 3.6.3</li>\n<li>MySQL 5.7.30</li>\n<li>Redis(Windows) 3.2.100</li>\n</ul>\n<h2 id=\"项目技术栈\"><a href=\"#项目技术栈\" class=\"headerlink\" title=\"项目技术栈\"></a>项目技术栈</h2><ul>\n<li>SpringBoot</li>\n<li>MyBatisPlus</li>\n<li>JWT</li>\n<li>WebSocket</li>\n<li>Swagger</li>\n<li>FreeMarker</li>\n<li>SpringDataRedis</li>\n<li>easyPoi</li>\n<li>oshi</li>\n</ul>\n<h2 id=\"运行项目\"><a href=\"#运行项目\" class=\"headerlink\" title=\"运行项目\"></a>运行项目</h2><p>1、从github地址上将项目下载下来。</p>\n<p>2、将项目设置为Maven项目，并使用Maven下载相关依赖。</p>\n<p>3、修改application-dev.yml里面的MySQL数据库和Redis数据库的连接信息。</p>\n<p>4、启动MySQL数据库，并导入sql脚本文件。</p>\n<p>5、启动Redis数据库。</p>\n<p>6、运行MyApplication的main()方法，启动项目。</p>\n<p>【备注】如果需要使用项目的邮件发送功能，需要修改application.yml文件中的spring.mail.username和spring.mail.password配置。</p>\n<h2 id=\"项目开发约束\"><a href=\"#项目开发约束\" class=\"headerlink\" title=\"项目开发约束\"></a>项目开发约束</h2><h3 id=\"代码规范\"><a href=\"#代码规范\" class=\"headerlink\" title=\"代码规范\"></a>代码规范</h3><p>本项目代码开发规范遵循《阿里巴巴Java开发手册》，在进行开发前，请下载阿里巴巴Java代码开发约束插件，保证项目代码质量。<br>链接：<a href=\"https://github.com/alibaba/p3c\">《阿里巴巴Java开发手册——嵩山版》</a></p>\n<h3 id=\"模块规范\"><a href=\"#模块规范\" class=\"headerlink\" title=\"模块规范\"></a>模块规范</h3><p>本项目功能使用分模块开发，如果需要在本项目的基础上进行开发，请按照以下的三个步骤进行：</p>\n<ul>\n<li>请在zero-admin项目下新建模块，并以zero-admin为父项目，需要的第三方依赖，请在zero-admin父模块的pom.xml文件中添加。</li>\n<li>在新建模块的pom.xml文件中添加zero-sys模块的依赖。</li>\n<li>在zero-web模块的pom.xml文件中添加新建模块的依赖。</li>\n</ul>\n<h3 id=\"数据库规范\"><a href=\"#数据库规范\" class=\"headerlink\" title=\"数据库规范\"></a>数据库规范</h3><p>所有数据库表的设计，除数据库的业务字段外，都必须包含以下6个通用字段。</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 这是通用的表数据结构字段</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> `base_table` (</span><br><span class=\"line\">  `id` <span class=\"type\">int</span>(<span class=\"number\">11</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> AUTO_INCREMENT COMMENT <span class=\"string\">&#x27;主键&#x27;</span>,</span><br><span class=\"line\">\t<span class=\"comment\">-- 在这里添加表数据业务功能字段</span></span><br><span class=\"line\">  `create_time` datetime <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"built_in\">CURRENT_TIMESTAMP</span> COMMENT <span class=\"string\">&#x27;数据库数据插入时间&#x27;</span>,</span><br><span class=\"line\">  `create_user_id` <span class=\"type\">int</span>(<span class=\"number\">11</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"string\">&#x27;0&#x27;</span> COMMENT <span class=\"string\">&#x27;数据库数据插入用户主键&#x27;</span>,</span><br><span class=\"line\">  `update_time` datetime <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"built_in\">CURRENT_TIMESTAMP</span> <span class=\"keyword\">ON</span> <span class=\"keyword\">UPDATE</span> <span class=\"built_in\">CURRENT_TIMESTAMP</span> COMMENT <span class=\"string\">&#x27;数据库数据更新时间&#x27;</span>,</span><br><span class=\"line\">  `update_user_id` <span class=\"type\">int</span>(<span class=\"number\">11</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"string\">&#x27;0&#x27;</span> COMMENT <span class=\"string\">&#x27;数据库数据更新用户主键&#x27;</span>,</span><br><span class=\"line\">  `deleted` tinyint(<span class=\"number\">1</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"string\">&#x27;0&#x27;</span> COMMENT <span class=\"string\">&#x27;逻辑删除标识，0为正常，1为逻辑删除，默认为0&#x27;</span>,</span><br><span class=\"line\">  <span class=\"keyword\">PRIMARY</span> KEY (`id`)</span><br><span class=\"line\">) ENGINE<span class=\"operator\">=</span>InnoDB <span class=\"keyword\">DEFAULT</span> CHARSET<span class=\"operator\">=</span>utf8mb4 ROW_FORMAT<span class=\"operator\">=</span>COMPACT COMMENT<span class=\"operator\">=</span><span class=\"string\">&#x27;数据库基本表&#x27;</span>;</span><br></pre></td></tr></table></figure>\n<h3 id=\"业务规范\"><a href=\"#业务规范\" class=\"headerlink\" title=\"业务规范\"></a>业务规范</h3><ul>\n<li>项目中的所有实体类统一继承<code>com.zero.common.base.entity.BaseEntity</code>类，<code>BaseEntity</code>中包含了数据库规范中包含的六个通用字段。</li>\n<li>所有<code>Mapper</code>接口统一继承<code>com.baomidou.mybatisplus.core.mapper.BaseMapper</code>接口。</li>\n<li>所有<code>Service</code>接口统一继承<code>com.zero.common.base.service.BaseService</code>接口，所有<code>ServiceImpl</code>类继承<code>com.zero.common.base.service.impl.BaseServiceImpl</code>类。</li>\n<li>所有<code>Controller</code>类统一继承<code>com.zero.common.base.controller.BaseController</code>类。</li>\n</ul>\n<h2 id=\"补充说明\"><a href=\"#补充说明\" class=\"headerlink\" title=\"补充说明\"></a>补充说明</h2><p>1、该项目为一个前后端分离项目，启动该项目只是一个纯后端系统，需要结合前端项目进行使用，具体说明可以参考前端项目说明。</p>\n<p>前端项目github下载地址：<a href=\"https://github.com/herenpeng/zero-admin-vue.git\">https://github.com/herenpeng/zero-admin-vue.git</a></p>\n<p>2、该项目的SpringBoot版本为2.3.8.RELEASE，请不要降低SpringBoot的依赖版本，否则可能会因为SpringAop的执行顺序变化问题，导致系统日志功能发生异常。<br>具体关于SpringAop执行顺序问题，可以参考作者博客：<a href=\"/2020/11/01/java/不同版本的SpringAop执行顺序变化/\">不同版本的SpringAop执行顺序变化</a></p>\n<p>3、系统内部集成了Swagger接口文档，直接通过项目系统【项目文档】菜单或者/swagger-ui/index.html路径，可以直接访问接口说明文档</p>\n<h2 id=\"项目效果图\"><a href=\"#项目效果图\" class=\"headerlink\" title=\"项目效果图\"></a>项目效果图</h2><ul>\n<li><p>系统首页<br><img src=\"/images/2021/02/20210222211741319.png\" alt=\"系统首页\"></p>\n</li>\n<li><p>用户管理<br><img src=\"/images/2021/02/20210222211748773.png\" alt=\"用户管理\"></p>\n</li>\n<li><p>新增用户<br><img src=\"/images/2021/02/20210222211756859.png\" alt=\"新增用户\"></p>\n</li>\n<li><p>账号管理<br><img src=\"/images/2021/02/20210222211805632.png\" alt=\"账号管理\"></p>\n</li>\n</ul>\n<ul>\n<li>菜单管理<br><img src=\"/images/2021/02/20210222211815182.png\" alt=\"菜单管理\"></li>\n</ul>\n<ul>\n<li>系统监控<br><img src=\"/images/2021/02/2021022221182287.png\" alt=\"系统监控\"></li>\n</ul>\n<ul>\n<li>登入日志<br><img src=\"/images/2021/02/20210222211830168.png\" alt=\"登入日志\"></li>\n</ul>\n<ul>\n<li>日志管理<br><img src=\"/images/2021/02/20210222211838192.png\" alt=\"日志管理\"></li>\n</ul>\n<ul>\n<li>密码重置<br><img src=\"/images/2021/02/20210222211845560.png\" alt=\"密码重置\"></li>\n</ul>\n<ul>\n<li>数据回收<br><img src=\"/images/2021/02/20210222211906318.png\" alt=\"数据回收\"></li>\n</ul>\n<ul>\n<li>代码生成<br><img src=\"/images/2021/02/20210222211912728.png\" alt=\"代码生成\"></li>\n</ul>\n<ul>\n<li>系统文档<br><img src=\"/images/2021/02/20210222211922632.png\" alt=\"系统文档\"></li>\n</ul>\n","categories":["Java"],"tags":["Java","SpringBoot"]},{"title":"SpringBoot（七）：JWT与Rsa非对称加密","url":"/2021/05/06/java/SpringBoot%EF%BC%88%E4%B8%83%EF%BC%89%EF%BC%9AJWT%E4%B8%8ERsa%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86/","content":"<h1 id=\"什么是JWT？\"><a href=\"#什么是JWT？\" class=\"headerlink\" title=\"什么是JWT？\"></a>什么是JWT？</h1><p>Json web token (JWT), 是为了在网络应用环境间传递声明而执行的一种基于JSON的开放标准（(RFC 7519)。该token被设计为紧凑且安全的，特别适用于分布式站点的单点登录（SSO）场景。JWT的声明一般被用来在身份提供者和服务提供者间传递被认证的用户身份信息，以便于从资源服务器获取资源，也可以增加一些额外的其它业务逻辑所必须的声明信息，该token也可直接被用于认证，也可被加密。</p>\n<span id=\"more\"></span>\n\n<h1 id=\"什么是Rsa非对称加密？\"><a href=\"#什么是Rsa非对称加密？\" class=\"headerlink\" title=\"什么是Rsa非对称加密？\"></a>什么是Rsa非对称加密？</h1><p>非对称加密算法需要两个密钥来进行加密和解密，这两个秘钥是公开密钥（public key，简称公钥）和私有密钥（private key，简称私钥）。</p>\n<p>公开密钥与私有密钥是一对，如果用公开密钥对数据进行加密，只有用对应的私有密钥才能解密；如果用私有密钥对数据进行加密，那么只有用对应的公开密钥才能解密。因为加密和解密使用的是两个不同的密钥，所以这种算法叫做非对称加密算法。</p>\n<h1 id=\"Java-实现\"><a href=\"#Java-实现\" class=\"headerlink\" title=\"Java 实现\"></a>Java 实现</h1><h2 id=\"引入依赖\"><a href=\"#引入依赖\" class=\"headerlink\" title=\"引入依赖\"></a>引入依赖</h2><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">jjwt.version</span>&gt;</span>0.11.2<span class=\"tag\">&lt;/<span class=\"name\">jjwt.version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--jjwt，Java对JWT的封装工具依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>io.jsonwebtoken<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>jjwt-api<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;jjwt.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>io.jsonwebtoken<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>jjwt-impl<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;jjwt.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>runtime<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>io.jsonwebtoken<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>jjwt-jackson<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;jjwt.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>runtime<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"application-yml配置文件\"><a href=\"#application-yml配置文件\" class=\"headerlink\" title=\"application.yml配置文件\"></a>application.yml配置文件</h2><figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">zero:</span></span><br><span class=\"line\">  <span class=\"attr\">auth:</span></span><br><span class=\"line\">    <span class=\"attr\">security:</span></span><br><span class=\"line\">      <span class=\"attr\">jwt:</span></span><br><span class=\"line\">        <span class=\"attr\">ttl:</span> <span class=\"number\">3600000</span></span><br><span class=\"line\">        <span class=\"attr\">issuer:</span> <span class=\"string\">$&#123;zero.domain-name&#125;</span></span><br><span class=\"line\">        <span class=\"attr\">key:</span> <span class=\"string\">accessToken</span></span><br><span class=\"line\">        <span class=\"attr\">rsa:</span></span><br><span class=\"line\">          <span class=\"attr\">secret:</span> <span class=\"string\">HdGkiOiI4ODgiLCJzdWIiOiLlsIdkdusdmnwlsYdfDSkpqlzelqJhdSKDxljHlNKKjds</span></span><br><span class=\"line\">          <span class=\"attr\">private-file:</span> <span class=\"string\">G:\\\\tmp\\\\rsa\\\\rsa.pri</span></span><br><span class=\"line\">          <span class=\"attr\">public-file:</span> <span class=\"string\">G:\\\\tmp\\\\rsa\\\\rsa.pub</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"JwtProperties\"><a href=\"#JwtProperties\" class=\"headerlink\" title=\"JwtProperties\"></a>JwtProperties</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@NoArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@AllArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"meta\">@ConfigurationProperties(prefix = &quot;zero.auth.security.jwt&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">JwtProperties</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Token过期时间，单位为毫秒，默认为1个小时</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Long ttl;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * token的签发者</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String issuer;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * token名称；accessToken</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String key;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"RsaProperties\"><a href=\"#RsaProperties\" class=\"headerlink\" title=\"RsaProperties\"></a>RsaProperties</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@NoArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@AllArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"meta\">@ConfigurationProperties(prefix = &quot;zero.auth.security.jwt.rsa&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">RsaProperties</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 加密秘钥信息</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String secret;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 私钥存放路径</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String privateFile;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 公钥存放路径</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String publicFile;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"RsaUtils-工具类\"><a href=\"#RsaUtils-工具类\" class=\"headerlink\" title=\"RsaUtils 工具类\"></a>RsaUtils 工具类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"meta\">@RequiredArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">RsaUtils</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> RsaProperties rsaProperties;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 默认的密文长度，在默认的密文长度和指定的密文长度之间选择最大的值，即密文长度不可以小于默认的密文长度</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">DEFAULT_KEY_SIZE</span> <span class=\"operator\">=</span> <span class=\"number\">2048</span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 默认的加密算法</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">DEFAULT_KEY_ALGORITHM</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;RSA&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 私钥对象</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Getter</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> PrivateKey privateKey;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 公钥对象</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Getter</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> PublicKey publicKey;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 在创建对象之后生成秘钥和公钥文件</span></span><br><span class=\"line\"><span class=\"comment\">     * 该方法用于初始化公钥和私钥的内容，在对象创建之后加载，之间使用属性缓存起来，这样就不需要每次都进行读取</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@PostConstruct</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">initRsaKey</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 生成私钥和公钥文件</span></span><br><span class=\"line\">        generateKey(rsaProperties.getPublicFile(), rsaProperties.getPrivateFile(), rsaProperties.getSecret());</span><br><span class=\"line\">        <span class=\"comment\">// 读取私钥对象</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (StringUtils.isNotBlank(rsaProperties.getPrivateFile())) &#123;</span><br><span class=\"line\">            privateKey = getPrivateKey(rsaProperties.getPrivateFile());</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 读取公钥对象</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (StringUtils.isNotBlank(rsaProperties.getPublicFile())) &#123;</span><br><span class=\"line\">            publicKey = getPublicKey(rsaProperties.getPublicFile());</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 从文件中读取公钥</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> filePath 公钥保存路径，相对于classpath</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 公钥对象</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception 抛出异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> PublicKey <span class=\"title function_\">getPublicKey</span><span class=\"params\">(String filePath)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"type\">byte</span>[] bytes = readFile(filePath);</span><br><span class=\"line\">        bytes = Base64.getDecoder().decode(bytes);</span><br><span class=\"line\">        <span class=\"type\">X509EncodedKeySpec</span> <span class=\"variable\">spec</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">X509EncodedKeySpec</span>(bytes);</span><br><span class=\"line\">        <span class=\"type\">KeyFactory</span> <span class=\"variable\">factory</span> <span class=\"operator\">=</span> KeyFactory.getInstance(DEFAULT_KEY_ALGORITHM);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> factory.generatePublic(spec);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 从文件中读取密钥</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> filePath 私钥保存路径，相对于classpath</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 私钥对象</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> PrivateKey <span class=\"title function_\">getPrivateKey</span><span class=\"params\">(String filePath)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"type\">byte</span>[] bytes = readFile(filePath);</span><br><span class=\"line\">        bytes = Base64.getDecoder().decode(bytes);</span><br><span class=\"line\">        <span class=\"type\">PKCS8EncodedKeySpec</span> <span class=\"variable\">spec</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">PKCS8EncodedKeySpec</span>(bytes);</span><br><span class=\"line\">        <span class=\"type\">KeyFactory</span> <span class=\"variable\">factory</span> <span class=\"operator\">=</span> KeyFactory.getInstance(DEFAULT_KEY_ALGORITHM);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> factory.generatePrivate(spec);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 根据密文，生成 rsa 公钥和私钥，并写入指定文件</span></span><br><span class=\"line\"><span class=\"comment\">     * 重载方法，使用默认的密文长度</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> publicKeyFilePath  公钥文件路径</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> privateKeyFilePath 私钥文件路径</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> secret             生成密钥的密文</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception 抛出异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">generateKey</span><span class=\"params\">(String publicKeyFilePath, String privateKeyFilePath, String secret)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        generateKey(publicKeyFilePath, privateKeyFilePath, secret, DEFAULT_KEY_SIZE);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 根据密文，生成 rsa 公钥和私钥，并写入指定文件</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> publicKeyFilePath  公钥文件路径</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> privateKeyFilePath 私钥文件路径</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> secret             生成密钥的密文</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> keySize            密文文长度</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception 抛出异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">generateKey</span><span class=\"params\">(String publicKeyFilePath, String privateKeyFilePath, String secret, <span class=\"type\">int</span> keySize)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"type\">KeyPairGenerator</span> <span class=\"variable\">keyPairGenerator</span> <span class=\"operator\">=</span> KeyPairGenerator.getInstance(<span class=\"string\">&quot;RSA&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">SecureRandom</span> <span class=\"variable\">secureRandom</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">SecureRandom</span>(secret.getBytes());</span><br><span class=\"line\">        keyPairGenerator.initialize(Math.max(keySize, DEFAULT_KEY_SIZE), secureRandom);</span><br><span class=\"line\">        <span class=\"type\">KeyPair</span> <span class=\"variable\">keyPair</span> <span class=\"operator\">=</span> keyPairGenerator.genKeyPair();</span><br><span class=\"line\">        <span class=\"comment\">// 获取公钥并写出</span></span><br><span class=\"line\">        <span class=\"type\">byte</span>[] publicKeyBytes = keyPair.getPublic().getEncoded();</span><br><span class=\"line\">        publicKeyBytes = Base64.getEncoder().encode(publicKeyBytes);</span><br><span class=\"line\">        writeFile(publicKeyFilePath, publicKeyBytes);</span><br><span class=\"line\">        <span class=\"comment\">// 获取私钥并写出</span></span><br><span class=\"line\">        <span class=\"type\">byte</span>[] privateKeyBytes = keyPair.getPrivate().getEncoded();</span><br><span class=\"line\">        privateKeyBytes = Base64.getEncoder().encode(privateKeyBytes);</span><br><span class=\"line\">        writeFile(privateKeyFilePath, privateKeyBytes);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 读取对应文件的数据，并返回字节数组</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> filePath 文件路径</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 文件字节数组</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception 抛出异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">byte</span>[] readFile(String filePath) <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Files.readAllBytes(<span class=\"keyword\">new</span> <span class=\"title class_\">File</span>(filePath).toPath());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 将一个字节数组写入到一个文件中</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> destPath 写入文件路径</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> bytes    字节数组</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> IOException IO异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">writeFile</span><span class=\"params\">(String destPath, <span class=\"type\">byte</span>[] bytes)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">        <span class=\"type\">File</span> <span class=\"variable\">dest</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">File</span>(destPath);</span><br><span class=\"line\">        <span class=\"type\">File</span> <span class=\"variable\">parentFile</span> <span class=\"operator\">=</span> dest.getParentFile();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!parentFile.exists()) &#123;</span><br><span class=\"line\">            parentFile.mkdirs();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!dest.exists()) &#123;</span><br><span class=\"line\">            dest.createNewFile();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        Files.write(dest.toPath(), bytes);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"JwtUtils-工具类\"><a href=\"#JwtUtils-工具类\" class=\"headerlink\" title=\"JwtUtils 工具类\"></a>JwtUtils 工具类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"meta\">@RequiredArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">JwtUtils</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> JwtProperties jwtProperties;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> RsaUtils rsaUtils;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 创建JWT</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> id        JWT的ID</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> subject   JWT主体信息，一般以Json格式的数据存储</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> issuer    JWT签发者</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> ttlMillis JWT的有效时间，单位是毫秒</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> claims    创建payload的私有声明，也就是自定义的JWT信息</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 返回JWT</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception 抛出异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">createJWT</span><span class=\"params\">(String id, String subject, String issuer, Long ttlMillis, Map&lt;String, Object&gt; claims)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 指定签名的时候使用的签名算法，也就是header那部分，jjwt已经将这部分内容封装好了。</span></span><br><span class=\"line\">        <span class=\"type\">SignatureAlgorithm</span> <span class=\"variable\">signatureAlgorithm</span> <span class=\"operator\">=</span> SignatureAlgorithm.RS256;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 下面就是在为payload添加各种标准声明和私有声明了,这里其实就是new一个JwtBuilder，设置jwt的body</span></span><br><span class=\"line\">        <span class=\"type\">JwtBuilder</span> <span class=\"variable\">builder</span> <span class=\"operator\">=</span> Jwts.builder();</span><br><span class=\"line\">        <span class=\"comment\">// 设置签名使用的签名算法和签名使用的秘钥</span></span><br><span class=\"line\">        builder.signWith(rsaUtils.getPrivateKey(), signatureAlgorithm);</span><br><span class=\"line\">        <span class=\"comment\">// jti：设置JWT的ID，是JWT的唯一标识，根据业务需要，这个可以设置为一个不重复的值，主要用来作为一次性token,从而回避重放攻击</span></span><br><span class=\"line\">        builder.setId(id);</span><br><span class=\"line\">        <span class=\"comment\">// iat：JWT的签发时间，生成JWT的时间</span></span><br><span class=\"line\">        builder.setIssuedAt(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>());</span><br><span class=\"line\">        <span class=\"comment\">// iss：jwt签发人</span></span><br><span class=\"line\">        builder.setIssuer(issuer);</span><br><span class=\"line\">        <span class=\"comment\">// sub：代表这个JWT的主体，即它的所有人，这个是一个json格式的字符串，可以存放用户信息的，作为什么用户的唯一标志</span></span><br><span class=\"line\">        builder.setSubject(subject);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ObjectUtils.allNotNull(claims)) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 如果有私有声明，一定要先设置这个自己创建的私有的声明，这个是给builder的claim赋值，一旦写在标准的声明赋值之后，就是覆盖了那些标准的声明的</span></span><br><span class=\"line\">            builder.setClaims(claims);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// exp：设置过期时间</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ttlMillis &gt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"type\">long</span> <span class=\"variable\">expiredMillis</span> <span class=\"operator\">=</span> System.currentTimeMillis() + ttlMillis;</span><br><span class=\"line\">            <span class=\"type\">Date</span> <span class=\"variable\">expiredDate</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>(expiredMillis);</span><br><span class=\"line\">            builder.setExpiration(expiredDate);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> builder.compact();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 创建JWT，默认配置了issuer（JWT签发者）</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> id        JWT的ID</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> subject   JWT主体信息，一般以Json格式的数据存储</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> ttlMillis JWT的有效时间，单位是毫秒</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> claims    创建payload的私有声明，也就是自定义的JWT信息</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 返回JWT</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception 抛出异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">createJWT</span><span class=\"params\">(String id, String subject, Long ttlMillis, Map&lt;String, Object&gt; claims)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> createJWT(id, subject, jwtProperties.getIssuer(), ttlMillis, claims);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 创建JWT，默认配置了issuer（JWT签发者），ttlMillis（有效时间）</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> id      JWT的ID</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> subject JWT主体信息，一般以Json格式的数据存储</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> claims  创建payload的私有声明，也就是自定义的JWT信息</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 返回JWT</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception 抛出异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">createJWT</span><span class=\"params\">(String id, String subject, Map&lt;String, Object&gt; claims)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> createJWT(id, subject, jwtProperties.getIssuer(), jwtProperties.getTtl(), claims);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 创建JWT，默认配置了issuer（JWT签发者），ttlMillis（有效时间）,默认claims为null</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> id      JWT的ID</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> subject JWT主体信息，一般以Json格式的数据存储</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 返回JWT</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception 抛出异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">createJWT</span><span class=\"params\">(String id, String subject)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> createJWT(id, subject, jwtProperties.getIssuer(), jwtProperties.getTtl(), <span class=\"literal\">null</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 解密JWT，如果秘钥错误，或者JWT被修改过，会直接抛出异常信息</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jwt JWT字符串信息</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 返回JWT载荷信息</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Claims <span class=\"title function_\">parseJWT</span><span class=\"params\">(String jwt)</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 得到DefaultJwtParser</span></span><br><span class=\"line\">        <span class=\"type\">Claims</span> <span class=\"variable\">claims</span> <span class=\"operator\">=</span> Jwts.parserBuilder()</span><br><span class=\"line\">                <span class=\"comment\">// 设置签名的秘钥</span></span><br><span class=\"line\">                .setSigningKey(rsaUtils.getPublicKey())</span><br><span class=\"line\">                .build()</span><br><span class=\"line\">                <span class=\"comment\">// 设置需要解析的jwt</span></span><br><span class=\"line\">                .parseClaimsJws(jwt).getBody();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> claims;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 判断jwt是否已经过期</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> jwt JWT字符串信息</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 如果jwt已经过期，返回true，否则返回false</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">isExpiration</span><span class=\"params\">(String jwt)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">Claims</span> <span class=\"variable\">claims</span> <span class=\"operator\">=</span> parseJWT(jwt);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> claims.getExpiration().before(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h1><blockquote>\n<p>本文<strong>GitHub</strong> <a href=\"https://github.com/herenpeng/code-learn\">https://github.com/herenpeng/code-learn</a> 已收录，欢迎<strong>Star</strong>。</p>\n</blockquote>\n","categories":["Java"],"tags":["Java","SpringBoot","JWT"]},{"title":"SpringBoot（三）：Lombok","url":"/2021/03/07/java/SpringBoot%EF%BC%88%E4%B8%89%EF%BC%89%EF%BC%9ALombok/","content":"<h1 id=\"Lombok\"><a href=\"#Lombok\" class=\"headerlink\" title=\"Lombok\"></a>Lombok</h1><p>Lombok是一个可以让Java代码变得更加“简洁”、“快速”的第三方工具。</p>\n<p>Lombok一般来说分为两部分，分别是Lombok插件和Lombok依赖，这两者需要配合使用才可以生效，缺一不可。<br>值得一提的是，Lombok插件和Lombok依赖，在最新版的IDEA和SpringBoot中分别进行了内置，可以让开发者直接使用Lombok。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"Lombok插件\"><a href=\"#Lombok插件\" class=\"headerlink\" title=\"Lombok插件\"></a>Lombok插件</h2><p>Lombok插件在<code>IDEA 2020.3</code>版本中成为了官方内置插件，开发者无需再进行Lombok插件的安装操作了。</p>\n<p>如果如果的IDEA版本低于<code>2020.3</code>，可以自己手动在IDEA上进行Lombok插件的安装。</p>\n<p><strong>Lombok插件的安装</strong></p>\n<p>File -&gt; Settings -&gt; Plugins -&gt; Marketplace -&gt; 在搜索栏中输入Lombok。</p>\n<p><img src=\"/images/2021/03/20210307214302529.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"Lombok依赖\"><a href=\"#Lombok依赖\" class=\"headerlink\" title=\"Lombok依赖\"></a>Lombok依赖</h2><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.projectlombok<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>lombok<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.18.16<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>provided<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Lombok使用\"><a href=\"#Lombok使用\" class=\"headerlink\" title=\"Lombok使用\"></a>Lombok使用</h1><p>Lombok通过注解的方式，在Java程序编译的时候，为Java代码生成get/set等通用方法，我们可以通过反编译class文件的方法，来查看Lombok的效果。</p>\n<h2 id=\"Getter\"><a href=\"#Getter\" class=\"headerlink\" title=\"@Getter\"></a>@Getter</h2><p>将该注解标识在类上，将会为该类生成get方法。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Getter</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>反编译class文件，得到的java文件：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">User</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">getUsername</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.username;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"Setter\"><a href=\"#Setter\" class=\"headerlink\" title=\"@Setter\"></a>@Setter</h2><p>将该注解标识在类上，将会为该类生成set方法。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Setter</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>反编译class文件，得到的java文件：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">User</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">setUsername</span><span class=\"params\">(<span class=\"keyword\">final</span> String username)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.username = username;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"NonNull\"><a href=\"#NonNull\" class=\"headerlink\" title=\"@NonNull\"></a>@NonNull</h2><p>将该注解标识在类成员变量上，对该成员变量赋值时，不允许使用null值，如果赋值为null，则抛出异常。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Setter</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@NonNull</span> <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>反编译class文件，得到的java文件：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@NonNull</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">User</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">setUsername</span><span class=\"params\">(<span class=\"meta\">@NonNull</span> <span class=\"keyword\">final</span> String username)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (username == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">NullPointerException</span>(<span class=\"string\">&quot;username is marked non-null but is null&quot;</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">this</span>.username = username;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"NoArgsConstructor\"><a href=\"#NoArgsConstructor\" class=\"headerlink\" title=\"@NoArgsConstructor\"></a>@NoArgsConstructor</h2><p>将该注解标识在类上，将会为该类生成无参构造方法。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@NoArgsConstructor</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>反编译class文件，得到的java文件：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">User</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"AllArgsConstructor\"><a href=\"#AllArgsConstructor\" class=\"headerlink\" title=\"@AllArgsConstructor\"></a>@AllArgsConstructor</h2><p>将该注解标识在类上，将会为该类生成全参构造方法，如果使用了该注解，类将不会有无参构造方法。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@AllArgsConstructor</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>反编译class文件，得到的java文件：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">User</span><span class=\"params\">(<span class=\"keyword\">final</span> String username)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.username = username;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"RequiredArgsConstructor\"><a href=\"#RequiredArgsConstructor\" class=\"headerlink\" title=\"@RequiredArgsConstructor\"></a>@RequiredArgsConstructor</h2><p>将该注解标识在类上，将会为该类生成含有被@NonNull注解的属性的构造方法。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RequiredArgsConstructor</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@NonNull</span> <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String password;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>反编译class文件，得到的java文件：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@NonNull</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String password;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">User</span><span class=\"params\">(<span class=\"meta\">@NonNull</span> <span class=\"keyword\">final</span> String username)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (username == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">NullPointerException</span>(<span class=\"string\">&quot;username is marked non-null but is null&quot;</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">this</span>.username = username;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"ToString\"><a href=\"#ToString\" class=\"headerlink\" title=\"@ToString\"></a>@ToString</h2><p>将该注解标识在类上，将会为该类覆写toString()方法。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ToString</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>反编译class文件，得到的java文件：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">User</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">toString</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;User(username=&quot;</span> + <span class=\"built_in\">this</span>.username + <span class=\"string\">&quot;)&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"EqualsAndHashCode\"><a href=\"#EqualsAndHashCode\" class=\"headerlink\" title=\"@EqualsAndHashCode\"></a>@EqualsAndHashCode</h2><p>将该注解标识在类上，将会为该类覆写equals()方法和hashCode()。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@EqualsAndHashCode</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>反编译class文件，得到的java文件：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">User</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">equals</span><span class=\"params\">(<span class=\"keyword\">final</span> Object o)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (o == <span class=\"built_in\">this</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (!(o <span class=\"keyword\">instanceof</span> User)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"type\">User</span> <span class=\"variable\">other</span> <span class=\"operator\">=</span> (User)o;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!other.canEqual(<span class=\"built_in\">this</span>)) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"type\">Object</span> <span class=\"variable\">this$username</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.username;</span><br><span class=\"line\">                <span class=\"type\">Object</span> <span class=\"variable\">other$username</span> <span class=\"operator\">=</span> other.username;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"built_in\">this</span>$username == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (other$username != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (!<span class=\"built_in\">this</span>$username.equals(other$username)) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"type\">boolean</span> <span class=\"title function_\">canEqual</span><span class=\"params\">(<span class=\"keyword\">final</span> Object other)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> other <span class=\"keyword\">instanceof</span> User;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">hashCode</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">PRIME</span> <span class=\"operator\">=</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">result</span> <span class=\"operator\">=</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">Object</span> <span class=\"variable\">$username</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.username;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">result</span> <span class=\"operator\">=</span> result * <span class=\"number\">59</span> + ($username == <span class=\"literal\">null</span> ? <span class=\"number\">43</span> : $username.hashCode());</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"Data\"><a href=\"#Data\" class=\"headerlink\" title=\"@Data\"></a>@Data</h2><p>@Data注解是一个复合注解，将该注解标识在类上，相当于在类上标注了@Getter、@Setter、@ToString、@EqualsAndHashCode、@RequiredArgsConstructor五个注解。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@NonNull</span> <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String password;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>反编译class文件，得到的java文件：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@NonNull</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String password;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">User</span><span class=\"params\">(<span class=\"meta\">@NonNull</span> <span class=\"keyword\">final</span> String username)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (username == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">NullPointerException</span>(<span class=\"string\">&quot;username is marked non-null but is null&quot;</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">this</span>.username = username;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@NonNull</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">getUsername</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.username;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">getPassword</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.password;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">setUsername</span><span class=\"params\">(<span class=\"meta\">@NonNull</span> <span class=\"keyword\">final</span> String username)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (username == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">NullPointerException</span>(<span class=\"string\">&quot;username is marked non-null but is null&quot;</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">this</span>.username = username;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">setPassword</span><span class=\"params\">(<span class=\"keyword\">final</span> String password)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.password = password;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">equals</span><span class=\"params\">(<span class=\"keyword\">final</span> Object o)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (o == <span class=\"built_in\">this</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (!(o <span class=\"keyword\">instanceof</span> User)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"type\">User</span> <span class=\"variable\">other</span> <span class=\"operator\">=</span> (User)o;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!other.canEqual(<span class=\"built_in\">this</span>)) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                <span class=\"type\">Object</span> <span class=\"variable\">this$username</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.getUsername();</span><br><span class=\"line\">                <span class=\"type\">Object</span> <span class=\"variable\">other$username</span> <span class=\"operator\">=</span> other.getUsername();</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"built_in\">this</span>$username == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (other$username != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (!<span class=\"built_in\">this</span>$username.equals(other$username)) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"type\">Object</span> <span class=\"variable\">this$password</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.getPassword();</span><br><span class=\"line\">                <span class=\"type\">Object</span> <span class=\"variable\">other$password</span> <span class=\"operator\">=</span> other.getPassword();</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"built_in\">this</span>$password == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (other$password != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (!<span class=\"built_in\">this</span>$password.equals(other$password)) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"type\">boolean</span> <span class=\"title function_\">canEqual</span><span class=\"params\">(<span class=\"keyword\">final</span> Object other)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> other <span class=\"keyword\">instanceof</span> User;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">hashCode</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">PRIME</span> <span class=\"operator\">=</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">result</span> <span class=\"operator\">=</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"type\">Object</span> <span class=\"variable\">$username</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.getUsername();</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">result</span> <span class=\"operator\">=</span> result * <span class=\"number\">59</span> + ($username == <span class=\"literal\">null</span> ? <span class=\"number\">43</span> : $username.hashCode());</span><br><span class=\"line\">        <span class=\"type\">Object</span> <span class=\"variable\">$password</span> <span class=\"operator\">=</span> <span class=\"built_in\">this</span>.getPassword();</span><br><span class=\"line\">        result = result * <span class=\"number\">59</span> + ($password == <span class=\"literal\">null</span> ? <span class=\"number\">43</span> : $password.hashCode());</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">toString</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;User(username=&quot;</span> + <span class=\"built_in\">this</span>.getUsername() + <span class=\"string\">&quot;, password=&quot;</span> + <span class=\"built_in\">this</span>.getPassword() + <span class=\"string\">&quot;)&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Slf4j\"><a href=\"#Slf4j\" class=\"headerlink\" title=\"@Slf4j\"></a>@Slf4j</h2><p>将该注解标识在类上，会给该类注入一个Logger对象。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>反编译class文件，得到的java文件：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">Logger</span> <span class=\"variable\">log</span> <span class=\"operator\">=</span> LoggerFactory.getLogger(User.class);</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">User</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"SneakyThrows\"><a href=\"#SneakyThrows\" class=\"headerlink\" title=\"@SneakyThrows\"></a>@SneakyThrows</h2><p>将该注解标识在方法上，可以对受检异常进行捕捉并抛出。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">App</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@SneakyThrows</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        Class.forName(<span class=\"string\">&quot;com.herenpeng.entity.User&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>反编译class文件，得到的java文件：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">App</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">App</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Class.forName(<span class=\"string\">&quot;com.herenpeng.entity.User&quot;</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Throwable var2) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> var2;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h1><blockquote>\n<p>本文<strong>Github</strong> <a href=\"https://github.com/herenpeng/code-learn\">https://github.com/herenpeng/code-learn</a> 已收录，欢迎<strong>Star</strong>。</p>\n</blockquote>\n","categories":["Java"],"tags":["Java","SpringBoot"]},{"title":"SpringBoot（二）：项目搭建","url":"/2021/03/07/java/SpringBoot%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA/","content":"<h1 id=\"zero-admin\"><a href=\"#zero-admin\" class=\"headerlink\" title=\"zero-admin\"></a>zero-admin</h1><blockquote>\n<p>zero-admin管理系统是作者在github上面的一个开源项目，这个开源项目使用了如今市场上Web开发的各种常用技术，包括但不限于SpringBoot，MyBatisPlus，Jwt，Swagger等等，作者会通过SpringBoot的系列博客的方式，将项目中使用的技术一一展示出来，供同学们学习。<br>该项目作者已经托管至github开源平台，有兴趣的同学可以前往github平台浏览，也欢迎每一个同学给该项目一个<code>star</code>。  </p>\n</blockquote>\n<span id=\"more\"></span>\n\n<blockquote>\n<p>项目演示地址：<a href=\"http://zeroadmin.herenpeng.com\">http://zeroadmin.herenpeng.com</a> （用户名/密码：user/111111）<br>github下载地址：<a href=\"https://github.com/herenpeng/zero-admin.git\">https://github.com/herenpeng/zero-admin.git</a><br>gitee地址：<a href=\"https://gitee.com/herenpeng/zero-admin.git\">https://gitee.com/herenpeng/zero-admin.git</a></p>\n</blockquote>\n<h2 id=\"项目模块\"><a href=\"#项目模块\" class=\"headerlink\" title=\"项目模块\"></a>项目模块</h2><p>zero-admin是传统的单体架构，多模块开发，该项目一共分为一下模块：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">-- zero-admin</span><br><span class=\"line\">\t|--zero-web</span><br><span class=\"line\">\t|--zero-sys</span><br><span class=\"line\">\t|--zero-common</span><br><span class=\"line\">\t|--zero-code-generation</span><br><span class=\"line\">\t|--zero-upload</span><br><span class=\"line\">\t|--zero-mail</span><br><span class=\"line\">\t|--zero-auth</span><br></pre></td></tr></table></figure>\n\n\n\n<ul>\n<li><strong>zero-admin</strong> 项目的父项目，管理了项目的依赖及依赖版本</li>\n<li><strong>zero-web</strong> 启动模块，该模块包含了SpringBoot的启动类，以及一些系统级别的功能。</li>\n<li><strong>zero-sys</strong> 系统模块，该模块包含了一些系统底层功能，例如菜单控制，系统日志等等。</li>\n<li><strong>zero-common</strong> 通用模块，该模块包含了项目的通用功能，比如一些功能配置，通用工具类，统一响应结构，统一异常等等。</li>\n<li><strong>zero-code-generation</strong> 通用代码生成模块，包含了系统的通用代码生成功能。</li>\n<li><strong>zero-upload</strong> 系统资源上传模块，该模块用于上传系统的静态资源。</li>\n<li><strong>zero-mail</strong> 系统邮件服务模块，该模块用于系统邮件的发送。</li>\n<li><strong>zero-auth</strong> 系统授权模块，该模块包含了系统的授权，鉴权等功能。</li>\n</ul>\n<h2 id=\"项目依赖\"><a href=\"#项目依赖\" class=\"headerlink\" title=\"项目依赖\"></a>项目依赖</h2><h3 id=\"项目依赖版本\"><a href=\"#项目依赖版本\" class=\"headerlink\" title=\"项目依赖版本\"></a>项目依赖版本</h3><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class=\"tag\">&lt;/<span class=\"name\">project.build.sourceEncoding</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">project.reporting.outputEncoding</span>&gt;</span>UTF-8<span class=\"tag\">&lt;/<span class=\"name\">project.reporting.outputEncoding</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">maven.compiler.encoding</span>&gt;</span>UTF-8<span class=\"tag\">&lt;/<span class=\"name\">maven.compiler.encoding</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">maven.compiler.source</span>&gt;</span>1.8<span class=\"tag\">&lt;/<span class=\"name\">maven.compiler.source</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">maven.compiler.target</span>&gt;</span>1.8<span class=\"tag\">&lt;/<span class=\"name\">maven.compiler.target</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">java.version</span>&gt;</span>1.8<span class=\"tag\">&lt;/<span class=\"name\">java.version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">zero-admin.version</span>&gt;</span>1.0-SNAPSHOT<span class=\"tag\">&lt;/<span class=\"name\">zero-admin.version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">spring-boot.version</span>&gt;</span>2.3.8.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">spring-boot.version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">mybatis-plus.version</span>&gt;</span>3.4.0<span class=\"tag\">&lt;/<span class=\"name\">mybatis-plus.version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">jjwt.version</span>&gt;</span>0.9.0<span class=\"tag\">&lt;/<span class=\"name\">jjwt.version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">easypoi.version</span>&gt;</span>4.0.0<span class=\"tag\">&lt;/<span class=\"name\">easypoi.version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">commons-lang3.version</span>&gt;</span>3.7<span class=\"tag\">&lt;/<span class=\"name\">commons-lang3.version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">commons-io.version</span>&gt;</span>2.6<span class=\"tag\">&lt;/<span class=\"name\">commons-io.version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">springfox.version</span>&gt;</span>3.0.0<span class=\"tag\">&lt;/<span class=\"name\">springfox.version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">oshi-core.version</span>&gt;</span>5.1.1<span class=\"tag\">&lt;/<span class=\"name\">oshi-core.version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">httpclient.version</span>&gt;</span>4.5.6<span class=\"tag\">&lt;/<span class=\"name\">httpclient.version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n<h3 id=\"SpringBoot版本\"><a href=\"#SpringBoot版本\" class=\"headerlink\" title=\"SpringBoot版本\"></a>SpringBoot版本</h3><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.3.8.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">relativePath</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"项目依赖-1\"><a href=\"#项目依赖-1\" class=\"headerlink\" title=\"项目依赖\"></a>项目依赖</h3><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--SpringMVC的启动器--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--SpringSecurity的依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-security<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--SpringWebSocket的依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-websocket<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--SpringMail发送邮件的依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-mail<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--freemarker模板引擎--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-freemarker<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--jjwt，Java对JWT的封装工具依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>io.jsonwebtoken<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>jjwt<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;jjwt.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--SpringDataRedis的启动器--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--Spring AOP的启动器依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-aop<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--Spring单元测试的启动器--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-test<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>test<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--lombok的依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.projectlombok<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>lombok<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--MySQL数据库驱动--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>mysql<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--MyBatis-Plus的依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.baomidou<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;mybatis-plus.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--easypoi相关依赖，用于操作Excel文件--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>cn.afterturn<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>easypoi-spring-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;easypoi.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--apache-lang3的通用工具类--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.commons<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>commons-lang3<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;commons-lang3.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--用来处理文件上传的一个通用工具类--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>commons-io<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>commons-io<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;commons-io.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--swagger的依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>io.springfox<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>springfox-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;springfox.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--oshi的依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.github.oshi<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>oshi-core<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;oshi-core.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--httpclient，用于发送http请求--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.httpcomponents<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>httpclient<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;httpclient.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n<h1 id=\"项目技术\"><a href=\"#项目技术\" class=\"headerlink\" title=\"项目技术\"></a>项目技术</h1><h2 id=\"SpringBoot\"><a href=\"#SpringBoot\" class=\"headerlink\" title=\"SpringBoot\"></a>SpringBoot</h2><p>Spring Boot是由Pivotal团队提供的全新框架，其设计目的是用来简化新Spring应用的初始搭建以及开发过程。该框架使用了特定的方式来进行配置，从而使开发人员不再需要定义样板化的配置。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.3.8.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">relativePath</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"MyBatisPlus\"><a href=\"#MyBatisPlus\" class=\"headerlink\" title=\"MyBatisPlus\"></a>MyBatisPlus</h2><p>MyBatis-Plus（简称 MP）是一个 MyBatis 的增强工具，在 MyBatis 的基础上只做增强不做改变，为简化开发、提高效率而生。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--MyBatis-Plus的依赖--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.baomidou<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;mybatis-plus.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"JWT\"><a href=\"#JWT\" class=\"headerlink\" title=\"JWT\"></a>JWT</h2><p>Json web token (JWT)，是为了在网络应用环境间传递声明而执行的一种基于JSON的开放标准（(RFC 7519).该token被设计为紧凑且安全的，特别适用于分布式站点的单点登录（SSO）场景。JWT的声明一般被用来在身份提供者和服务提供者间传递被认证的用户身份信息，以便于从资源服务器获取资源，也可以增加一些额外的其它业务逻辑所必须的声明信息，该token也可直接被用于认证，也可被加密。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--jjwt，Java对JWT的封装工具依赖--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>io.jsonwebtoken<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>jjwt<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;jjwt.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"WebSocket\"><a href=\"#WebSocket\" class=\"headerlink\" title=\"WebSocket\"></a>WebSocket</h2><p>WebSocket 是 HTML5 开始提供的一种在单个 TCP 连接上进行全双工通讯的协议。<br>WebSocket 使得客户端和服务器之间的数据交换变得更加简单，允许服务端主动向客户端推送数据。在 WebSocket API 中，浏览器和服务器只需要完成一次握手，两者之间就直接可以创建持久性的连接，并进行双向数据传输。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--SpringWebSocket的依赖--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-websocket<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Swagger\"><a href=\"#Swagger\" class=\"headerlink\" title=\"Swagger\"></a>Swagger</h2><p>Swagger 是一个规范和完整的框架，用于生成、描述、调用和可视化 restful 风格的 Web 服务。<br>目标是使客户端和文件系统作为服务器以同样的速度来更新。文件的方法、参数和模型紧密集成到服务器端的代码，允许 API 来始终保持同步。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--swagger的依赖--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>io.springfox<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>springfox-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;springfox.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"FreeMarker\"><a href=\"#FreeMarker\" class=\"headerlink\" title=\"FreeMarker\"></a>FreeMarker</h2><p>FreeMarker 是一款 模板引擎： 即一种基于模板和要改变的数据， 并用来生成输出文本(HTML网页，电子邮件，配置文件，源代码等)的通用工具。 它不是面向最终用户的，而是一个Java类库，是一款程序员可以嵌入他们所开发产品的组件。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--freemarker模板引擎--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-freemarker<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"SpringDataRedis\"><a href=\"#SpringDataRedis\" class=\"headerlink\" title=\"SpringDataRedis\"></a>SpringDataRedis</h2><p>SpringDataRedis是spring大家族中的一部分，提供了在spring应用中通过简单的配置访问redis服务，对redis底层开发包(Jedis,JRedis,andRJC)进行了高度封装，RedisTemplate提供了redis各种操作，异常处理及序列化，支持发布订阅。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--SpringDataRedis的启动器--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"easyPoi\"><a href=\"#easyPoi\" class=\"headerlink\" title=\"easyPoi\"></a>easyPoi</h2><p>easypoi功能如同名字easy，主打的功能就是容易，让一个没见接触过poi的人员就可以方便的写出Excel导出，Excel模板导出，Excel导入，Word模板导出，通过简单的注解和模板语言(熟悉的表达式语法)，完成以前复杂的写法。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--easypoi相关依赖，用于操作Excel文件--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>cn.afterturn<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>easypoi-spring-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;easypoi.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"oshi\"><a href=\"#oshi\" class=\"headerlink\" title=\"oshi\"></a>oshi</h2><p>一款用于获取服务器主机的CPU、内存、磁盘、网络、线程、JVM内存、JVM GC 等维度的监控框架，兼容Windows和Linux操作系统。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--oshi的依赖--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.github.oshi<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>oshi-core<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;oshi-core.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"其他\"><a href=\"#其他\" class=\"headerlink\" title=\"其他\"></a>其他</h2><h3 id=\"lombok\"><a href=\"#lombok\" class=\"headerlink\" title=\"lombok\"></a>lombok</h3><p>Lombok能通过注解的方式，在编译时自动为属性生成构造器、getter/setter、equals、hashcode、toString方法。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--lombok的依赖--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.projectlombok<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>lombok<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"commons-lang3\"><a href=\"#commons-lang3\" class=\"headerlink\" title=\"commons-lang3\"></a>commons-lang3</h3><p>Apache Commons 团队提供的一个通用的工具类框架。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--apache-lang3的通用工具类--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.commons<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>commons-lang3<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;commons-lang3.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"SpringMail\"><a href=\"#SpringMail\" class=\"headerlink\" title=\"SpringMail\"></a>SpringMail</h3><p>Spring提供的一个邮件发送服务的API框架。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--SpringMail发送邮件的依赖--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-mail<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h1><blockquote>\n<p>本文<strong>Github</strong> <a href=\"https://github.com/herenpeng/code-learn\">https://github.com/herenpeng/code-learn</a> 已收录，欢迎<strong>Star</strong>。</p>\n</blockquote>\n","categories":["Java"],"tags":["Java","SpringBoot"]},{"title":"SpringBoot（五）：Swagger接口文档","url":"/2021/03/23/java/SpringBoot%EF%BC%88%E4%BA%94%EF%BC%89%EF%BC%9ASwagger%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3/","content":"<h1 id=\"什么是Swagger\"><a href=\"#什么是Swagger\" class=\"headerlink\" title=\"什么是Swagger\"></a>什么是Swagger</h1><p>Swagger 是一个用于解决接口文档问题的框架，主要是通过一些 Swagger 提供的注解，为开发者自动生成相应的接口文档，让开发者从接口文档的编写工作中解放出来。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"Swagger的依赖\"><a href=\"#Swagger的依赖\" class=\"headerlink\" title=\"Swagger的依赖\"></a>Swagger的依赖</h2><ul>\n<li>Maven</li>\n</ul>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--swagger的依赖--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>io.springfox<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>springfox-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.0.0<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"Swagger的配置\"><a href=\"#Swagger的配置\" class=\"headerlink\" title=\"Swagger的配置\"></a>Swagger的配置</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@EnableOpenApi</span></span><br><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">SwaggerConfig</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Docket <span class=\"title function_\">createRestApi</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Docket</span>(DocumentationType.OAS_30)</span><br><span class=\"line\">                <span class=\"comment\">// 在正式开发中，可以将该属性放置在yal文件中配置，开发环境启用，生产环境禁用</span></span><br><span class=\"line\">                .enable(<span class=\"literal\">true</span>)</span><br><span class=\"line\">                .pathMapping(<span class=\"string\">&quot;/&quot;</span>)</span><br><span class=\"line\">                .apiInfo(apiInfo())</span><br><span class=\"line\">                .select()</span><br><span class=\"line\">                .apis(RequestHandlerSelectors.withMethodAnnotation(ApiOperation.class))</span><br><span class=\"line\">                .paths(PathSelectors.any())</span><br><span class=\"line\">                .build();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> ApiInfo <span class=\"title function_\">apiInfo</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ApiInfoBuilder</span>()</span><br><span class=\"line\">                <span class=\"comment\">// 标题信息</span></span><br><span class=\"line\">                .title(<span class=\"string\">&quot;zero-admin通用后台管理系统接口文档&quot;</span>)</span><br><span class=\"line\">                <span class=\"comment\">// 描述信息</span></span><br><span class=\"line\">                .description(<span class=\"string\">&quot;该篇接口文档是关于zero-admin通用后台管理系统的接口说明文档，对于该系统中的所有接口进行了详细的描述！&quot;</span>)</span><br><span class=\"line\">                <span class=\"comment\">// 系统版本</span></span><br><span class=\"line\">                .version(<span class=\"string\">&quot;1.0.0&quot;</span>)</span><br><span class=\"line\">                .contact(<span class=\"keyword\">new</span> <span class=\"title class_\">Contact</span>(<span class=\"string\">&quot;herenpeng&quot;</span>, <span class=\"string\">&quot;https://blog.csdn.net/qq_45193304&quot;</span>, <span class=\"string\">&quot;xxxxxxxxxx@qq.com&quot;</span>))</span><br><span class=\"line\">                .license(<span class=\"string\">&quot;前往系统&quot;</span>)</span><br><span class=\"line\">                .licenseUrl(<span class=\"string\">&quot;http://zeroadmin.herenpeng.com&quot;</span>)</span><br><span class=\"line\">                .build();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"Swagger的注解\"><a href=\"#Swagger的注解\" class=\"headerlink\" title=\"Swagger的注解\"></a>Swagger的注解</h2><ul>\n<li>@ApiModel：该注解用于实体类上，value 属性为对该实体类的描述信息</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ApiModel(value = &quot;用户信息实体类&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Serializable</span> &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>@ApiModelProperty：该注解用于类属性上，value 属性为对该属性的描述信息</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ApiModelProperty(value = &quot;主键ID&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> Integer id;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>@Api：该注解用于类上，一般注解在 Controller 上，value 属性为对该 Controller 的描述信息，tags 属性为对应的标签</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Api(value = &quot;用户操作接口&quot;, tags = &quot;UserController&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;user&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserController</span> &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>@ApiOperation：该注解用于被 @Api 注解的 Controller 的方法上，value 属性为对该方法（接口）的描述信息</li>\n</ul>\n<ul>\n<li>@ApiImplicitParams：该注解一般和 @ApiOperation 注解配合使用，用于描述方法（接口）的参数信息</li>\n</ul>\n<ul>\n<li>@ApiImplicitParam：该注解与 @ApiImplicitParams 注解为一个整体，name 属性为参数名称，value 属性为参数的描述信息，dataTypeClass 属性为参数的类型字节码对象，required 属性为是否必须</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ApiOperation(value = &quot;分页查询用户数据&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@ApiImplicitParams(&#123;</span></span><br><span class=\"line\"><span class=\"meta\">        @ApiImplicitParam(name = &quot;id&quot;, value = &quot;用户主键&quot;, dataTypeClass = Integer.class, required = true)</span></span><br><span class=\"line\"><span class=\"meta\">&#125;)</span></span><br><span class=\"line\"><span class=\"meta\">@GetMapping(&quot;&#123;id&#125;&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> User <span class=\"title function_\">get</span><span class=\"params\">(<span class=\"meta\">@PathVariable(&quot;id&quot;)</span> Integer id)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">User</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>();</span><br><span class=\"line\">    user.setId(id);</span><br><span class=\"line\">    user.setUsername(<span class=\"string\">&quot;Hello&quot;</span>);</span><br><span class=\"line\">    user.setPassword(<span class=\"string\">&quot;111111&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> user;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<ul>\n<li>@ApiIgnore：该注解用于类上，被该注解标识的类，不会被 Swagger 扫描进入接口文档信息中</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ApiIgnore</span></span><br><span class=\"line\"><span class=\"meta\">@Api(value = &quot;用户操作接口&quot;, tags = &quot;UserController&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;user&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserController</span> &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"Swagger效果图\"><a href=\"#Swagger效果图\" class=\"headerlink\" title=\"Swagger效果图\"></a>Swagger效果图</h2><p><img src=\"/images/2021/03/20210323221411434.png\" alt=\"在这里插入图片描述\"></p>\n<h1 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h1><blockquote>\n<p>本文<strong>Github</strong> <a href=\"https://github.com/herenpeng/code-learn\">https://github.com/herenpeng/code-learn</a> 已收录，欢迎<strong>Star</strong>。</p>\n</blockquote>\n","categories":["Java"],"tags":["Java","SpringBoot"]},{"title":"SpringBoot（八）：基于MyBatisPlus的基类抽取","url":"/2021/06/27/java/SpringBoot%EF%BC%88%E5%85%AB%EF%BC%89%EF%BC%9A%E5%9F%BA%E4%BA%8EMyBatisPlus%E7%9A%84%E5%9F%BA%E7%B1%BB%E6%8A%BD%E5%8F%96/","content":"<h1 id=\"什么是基类？\"><a href=\"#什么是基类？\" class=\"headerlink\" title=\"什么是基类？\"></a>什么是基类？</h1><p>在 Web 项目中，基于实体类衍生出来的 Mapper 接口，Service 业务层， Controller 层等等，在一些功能上都会有一些基础的通用的代码。这些代码通用性强，重复率高，在每个类中写这些代码的意义不大。</p>\n<p>而基类就是在这些通用代码的基础上，进行重复代码的抽取，从而实现了代码的复用，其它 Java 类只需要继承基类，就可以拥有这些通用代码的功能。</p>\n<span id=\"more\"></span>\n\n<h1 id=\"基类的抽取原则\"><a href=\"#基类的抽取原则\" class=\"headerlink\" title=\"基类的抽取原则\"></a>基类的抽取原则</h1><ul>\n<li><p>重复性和通用性高的代码</p>\n</li>\n<li><p>对业务没有太大影响的代码</p>\n</li>\n</ul>\n<h1 id=\"Java-代码实现\"><a href=\"#Java-代码实现\" class=\"headerlink\" title=\"Java 代码实现\"></a>Java 代码实现</h1><h2 id=\"实体基类\"><a href=\"#实体基类\" class=\"headerlink\" title=\"实体基类\"></a>实体基类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">BaseEntity</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Serializable</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 主键ID</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value = &quot;主键ID&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@TableId(value = &quot;id&quot;, type = IdType.AUTO)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer id;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 数据库数据创建时间</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@JsonIgnore</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value = &quot;数据库数据创建时间&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;create_time&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Date createTime;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 数据库数据插入用户主键，由MyBatisPlus拦截器处理，在数据插入时更新</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@JsonIgnore</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value = &quot;数据库数据插入用户主键&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;create_user_id&quot;, fill = FieldFill.INSERT)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer createUserId;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 数据库数据更新时间</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@JsonIgnore</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value = &quot;数据库数据更新时间&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;update_time&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Date updateTime;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 数据库数据更新用户主键，由MyBatisPlus拦截器处理，在数据更新时更新</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@JsonIgnore</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value = &quot;数据库数据更新用户主键&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;update_user_id&quot;, fill = FieldFill.INSERT_UPDATE)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer updateUserId;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 数据库数据标识逻辑删除字段，0(false)为正常，1(true)为逻辑删除，默认为0(false)</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@JsonIgnore</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value = &quot;数据库数据标识逻辑删除字段&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@TableLogic</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Boolean deleted;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Mapper-接口基类\"><a href=\"#Mapper-接口基类\" class=\"headerlink\" title=\"Mapper 接口基类\"></a>Mapper 接口基类</h2><blockquote>\n<p>本篇博客中的基类抽取本身就是基于 MyBatisPlus，在 MyBatisPlus 中 Mapper 层接口有一个通用基类：<code>com.baomidou.mybatisplus.core.mapper.BaseMapper</code>。</p>\n<p>本篇博客以该 Mapper 基类为主，不进行二次包装。</p>\n</blockquote>\n<h2 id=\"Service-基类\"><a href=\"#Service-基类\" class=\"headerlink\" title=\"Service 基类\"></a>Service 基类</h2><p>在 MyBatisPlus 中有一个 Service 层的基类<code>com.baomidou.mybatisplus.extension.service.IService</code>，本篇博客对该基类进行了一个二次包装，嵌入了部分项目相关的代码。</p>\n<h4 id=\"BaseService\"><a href=\"#BaseService\" class=\"headerlink\" title=\"BaseService\"></a>BaseService</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">BaseService</span>&lt;T&gt; <span class=\"keyword\">extends</span> <span class=\"title class_\">IService</span>&lt;T&gt; &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"BaseServiceImpl\"><a href=\"#BaseServiceImpl\" class=\"headerlink\" title=\"BaseServiceImpl\"></a>BaseServiceImpl</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">BaseServiceImpl</span>&lt;M <span class=\"keyword\">extends</span> <span class=\"title class_\">BaseMapper</span>&lt;T&gt;, T&gt; <span class=\"keyword\">extends</span> <span class=\"title class_\">ServiceImpl</span>&lt;M, T&gt; &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">protected</span> HttpServletRequest request;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Controller-基类\"><a href=\"#Controller-基类\" class=\"headerlink\" title=\"Controller 基类\"></a>Controller 基类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">BaseController</span>&lt;S <span class=\"keyword\">extends</span> <span class=\"title class_\">BaseService</span>&lt;E&gt;, E&gt; &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">protected</span> S baseService;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@LogOperation</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(value = &quot;[通用方法]通过主键获取一条对应实体类的数据库记录&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiImplicitParams(&#123;</span></span><br><span class=\"line\"><span class=\"meta\">            @ApiImplicitParam(name = &quot;id&quot;, value = &quot;实体主键&quot;, dataTypeClass = Integer.class, required = true)</span></span><br><span class=\"line\"><span class=\"meta\">    &#125;)</span></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping(&quot;&#123;id&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> ResponseData&lt;E&gt; <span class=\"title function_\">getById</span><span class=\"params\">(<span class=\"meta\">@PathVariable(&quot;id&quot;)</span> Integer id)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"type\">E</span> <span class=\"variable\">entity</span> <span class=\"operator\">=</span> baseService.getById(id);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ResponseData.ok(entity);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@LogOperation</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(value = &quot;[通用方法]插入一条对应实体类的数据库记录&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiImplicitParams(&#123;</span></span><br><span class=\"line\"><span class=\"meta\">            @ApiImplicitParam(name = &quot;entity&quot;, value = &quot;实体对象&quot;, dataTypeClass = Object.class, required = true)</span></span><br><span class=\"line\"><span class=\"meta\">    &#125;)</span></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> ResponseData&lt;Void&gt; <span class=\"title function_\">save</span><span class=\"params\">(<span class=\"meta\">@RequestBody</span> E entity)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        baseService.save(entity);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ResponseData.ok().message(<span class=\"string\">&quot;添加成功&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@LogOperation</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(value = &quot;[通用方法]更新一条对应实体类的数据库记录&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiImplicitParams(&#123;</span></span><br><span class=\"line\"><span class=\"meta\">            @ApiImplicitParam(name = &quot;entity&quot;, value = &quot;实体对象&quot;, dataTypeClass = Object.class, required = true)</span></span><br><span class=\"line\"><span class=\"meta\">    &#125;)</span></span><br><span class=\"line\">    <span class=\"meta\">@PutMapping</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> ResponseData&lt;Void&gt; <span class=\"title function_\">updateById</span><span class=\"params\">(<span class=\"meta\">@RequestBody</span> E entity)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        baseService.updateById(entity);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ResponseData.ok().message(<span class=\"string\">&quot;更新成功&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@LogOperation</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiOperation(value = &quot;[通用方法]通过主键删除一条对应实体类的数据库记录&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiImplicitParams(&#123;</span></span><br><span class=\"line\"><span class=\"meta\">            @ApiImplicitParam(name = &quot;id&quot;, value = &quot;实体主键&quot;, dataTypeClass = Integer.class, required = true)</span></span><br><span class=\"line\"><span class=\"meta\">    &#125;)</span></span><br><span class=\"line\">    <span class=\"meta\">@DeleteMapping(&quot;&#123;id&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> ResponseData&lt;Void&gt; <span class=\"title function_\">deleteById</span><span class=\"params\">(<span class=\"meta\">@PathVariable(&quot;id&quot;)</span> Integer id)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        baseService.removeById(id);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ResponseData.ok().message(<span class=\"string\">&quot;删除成功&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"基类的使用\"><a href=\"#基类的使用\" class=\"headerlink\" title=\"基类的使用\"></a>基类的使用</h2><p>在这些基类中，抽取了一些通用的代码，我们在写一个类的时候，只需要简单的继承对应的基类，就可以自动基础这些通用的代码和 API 接口，可以省下这些简单代码的编写时间。</p>\n<p>例如：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Api(value = &quot;用户操作接口&quot;, tags = &quot;UserController&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;user&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserController</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">BaseController</span>&lt;UserService, User&gt; &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">UserService</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">BaseService</span>&lt;User&gt; &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"meta\">@RequiredArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@Service</span></span><br><span class=\"line\"><span class=\"meta\">@Transactional(rollbackFor = Exception.class)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserServiceImpl</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">BaseServiceImpl</span>&lt;UserMapper, User&gt; <span class=\"keyword\">implements</span> <span class=\"title class_\">UserService</span> &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Mapper</span></span><br><span class=\"line\"><span class=\"meta\">@Repository</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">UserMapper</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">BaseMapper</span>&lt;User&gt; &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ApiModel(value = &quot;用户信息实体类&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@EqualsAndHashCode(callSuper = false)</span></span><br><span class=\"line\"><span class=\"meta\">@NoArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@AllArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@TableName(&quot;auth_user&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">BaseEntity</span> &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h1><blockquote>\n<p>本文<strong>GitHub</strong> <a href=\"https://github.com/herenpeng/code-learn\">https://github.com/herenpeng/code-learn</a> 已收录，欢迎<strong>Star</strong>。</p>\n</blockquote>\n","categories":["Java"],"tags":["Java","SpringBoot","MyBatisPlus"]},{"title":"SpringBoot（六）：统一响应结构体","url":"/2021/04/12/java/SpringBoot%EF%BC%88%E5%85%AD%EF%BC%89%EF%BC%9A%E7%BB%9F%E4%B8%80%E5%93%8D%E5%BA%94%E7%BB%93%E6%9E%84%E4%BD%93/","content":"<blockquote>\n<p>作为一个前后端分离项目，必须要和前端规定统一的数据交互结构，这样可以更加清晰地进行前后端数据的通信。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h1 id=\"统一响应结构体\"><a href=\"#统一响应结构体\" class=\"headerlink\" title=\"统一响应结构体\"></a>统一响应结构体</h1><p>在项目中，应该对响应给前端的 JSON 数据的格式进行统一的规定，在很多响应结构中，一般会包含 code、message、data 三个属性。</p>\n<p>其中 code 代表状态码，这个不是 HTTP 的响应状态码，而是后端系统的业务状态码，代表了后端响应给前端的业务状态。</p>\n<p>message 代表了后端给前端的响应信息，如果发生异常，或者系统错误，会将错误信息存储在 message 中，响应给前端。</p>\n<p>data 代表了后端响应给前端的数据，如果请求获取了数据，会将数据放入 data 域中。</p>\n<h2 id=\"JsonUtils\"><a href=\"#JsonUtils\" class=\"headerlink\" title=\"JsonUtils\"></a>JsonUtils</h2><blockquote>\n<p>JsonUtils 是对 Json 格式化工具的封装，这样封装的好处在于，一个是可以使 API 更加直观，另外则是可以在封装的工具类中添加系统自身的操作，尽可能地兼容本身的系统业务。</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"meta\">@RequiredArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">JsonUtils</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> ObjectMapper objectMapper;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 将对象格式化为 JSON 格式的字符串</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> object 对象</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> JSON 格式的字符串</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">toJson</span><span class=\"params\">(<span class=\"keyword\">final</span> Object object)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ObjectUtils.isEmpty(object)) &#123;</span><br><span class=\"line\">            log.info(<span class=\"string\">&quot;[Json工具类]对象&#123;&#125;为空&quot;</span>, object);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (object.getClass() == String.class) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> object.toString();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> objectMapper.writeValueAsString(object);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (JsonProcessingException e) &#123;</span><br><span class=\"line\">            log.error(<span class=\"string\">&quot;[Json工具类]将对象&#123;&#125;格式化为JSON格式的字符串失败&quot;</span>, object);</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 将 JSON 格式的字符串转换为 Java 对象</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> json      JSON 格式的字符串</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> classType Java 字节码对象</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> &lt;T&gt;       Java 对象的泛型</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> Java 对象</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> &lt;T&gt; T <span class=\"title function_\">toObject</span><span class=\"params\">(<span class=\"keyword\">final</span> String json, <span class=\"keyword\">final</span> Class&lt;T&gt; classType)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (StringUtils.isBlank(json)) &#123;</span><br><span class=\"line\">            log.info(<span class=\"string\">&quot;[Json工具类]JSON字符串&#123;&#125;为空&quot;</span>, json);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> objectMapper.readValue(json, classType);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (JsonProcessingException e) &#123;</span><br><span class=\"line\">            log.error(<span class=\"string\">&quot;[Json工具类]将JSON格式的字符串&#123;&#125;格式化为&#123;&#125;类型的Java对象失败&quot;</span>, json, classType);</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 将指定输入流解析为指定类型 Java 对象</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> request HttpServletRequest对象</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> classType   Java 字节码对象</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> Java 对象的泛型</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> &lt;T&gt; T <span class=\"title function_\">toObject</span><span class=\"params\">(<span class=\"keyword\">final</span> HttpServletRequest request, <span class=\"keyword\">final</span> Class&lt;T&gt; classType)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> objectMapper.readValue(request.getInputStream(), classType);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</span><br><span class=\"line\">            log.error(<span class=\"string\">&quot;[Json工具类]将输入流&#123;&#125;格式化为&#123;&#125;类型的Java对象失败&quot;</span>, request, classType);</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 将指定输入流解析为指定类型 Java 对象</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> inputStream 输入流对象</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> classType   Java 字节码对象</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> Java 对象的泛型</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> &lt;T&gt; T <span class=\"title function_\">toObject</span><span class=\"params\">(<span class=\"keyword\">final</span> InputStream inputStream, <span class=\"keyword\">final</span> Class&lt;T&gt; classType)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> objectMapper.readValue(inputStream, classType);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</span><br><span class=\"line\">            log.error(<span class=\"string\">&quot;[Json工具类]将输入流&#123;&#125;格式化为&#123;&#125;类型的Java对象失败&quot;</span>, inputStream, classType);</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 将 JSON 格式的字符串转换为 Map 类型的对象</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> json JSON 格式的字符串</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> Map 类型的对象</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Map <span class=\"title function_\">toMap</span><span class=\"params\">(<span class=\"keyword\">final</span> String json)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (StringUtils.isBlank(json)) &#123;</span><br><span class=\"line\">            log.info(<span class=\"string\">&quot;[Json工具类]JSON字符串&#123;&#125;为空&quot;</span>, json);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> objectMapper.readValue(json, Map.class);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (JsonProcessingException e) &#123;</span><br><span class=\"line\">            log.error(<span class=\"string\">&quot;[Json工具类]将JSON格式的字符串&#123;&#125;格式化为Map类型的Java对象失败&quot;</span>, json);</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 将一个 Java 对象转换为 Map 类型的对象</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> object Java 对象</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> Map 类型的对象</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Map <span class=\"title function_\">toMap</span><span class=\"params\">(<span class=\"keyword\">final</span> Object object)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (ObjectUtils.isEmpty(object)) &#123;</span><br><span class=\"line\">            log.info(<span class=\"string\">&quot;[Json工具类]对象&#123;&#125;为空&quot;</span>, object);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">json</span> <span class=\"operator\">=</span> toJson(object);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> toMap(json);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ResponseUtils\"><a href=\"#ResponseUtils\" class=\"headerlink\" title=\"ResponseUtils\"></a>ResponseUtils</h2><blockquote>\n<p>ResponseUtils 工具类是对响应过程的封装，可以将一个 Java 对象转换为一个 JSON 格式的字符串响应给前端。</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"meta\">@RequiredArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ResponseUtils</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> JsonUtils jsonUtils;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * response对象返回json数据给前端的封装方法，将object参数转换为json数据，并返回给前台</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> response HttpServletResponse对象</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> object   需要返回给前端的对象，方法会将该对象转换为json数据返回给前端</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> IOException IO异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">responseJson</span><span class=\"params\">(HttpServletResponse response, Object object)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">        response.setContentType(MediaType.APPLICATION_JSON_VALUE);</span><br><span class=\"line\">        response.setCharacterEncoding(EncodingEnums.UTF_8.getValue());</span><br><span class=\"line\">        <span class=\"type\">PrintWriter</span> <span class=\"variable\">writer</span> <span class=\"operator\">=</span> response.getWriter();</span><br><span class=\"line\">        writer.write(jsonUtils.toJson(object));</span><br><span class=\"line\">        writer.flush();</span><br><span class=\"line\">        writer.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"响应状态码\"><a href=\"#响应状态码\" class=\"headerlink\" title=\"响应状态码\"></a>响应状态码</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Getter</span></span><br><span class=\"line\"><span class=\"meta\">@AllArgsConstructor</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">enum</span> <span class=\"title class_\">CodeEnum</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * code为20000，代表正常返回数据</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    OK(<span class=\"number\">20000</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> Integer value;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"响应结构体\"><a href=\"#响应结构体\" class=\"headerlink\" title=\"响应结构体\"></a>响应结构体</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ApiModel(value = &quot;响应数据实体类&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ResponseData</span>&lt;T&gt; <span class=\"keyword\">implements</span> <span class=\"title class_\">Serializable</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 业务状态码，区别于HTTP协议状态码，</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value = &quot;业务状态码&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer code;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 业务提示消息，一般在增删改操作的时候返回</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value = &quot;业务提示消息&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String message;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 返回前端的交互数据</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value = &quot;业务响应数据&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> T data;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> ResponseData responseData;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 私有构造方法，这样就只能够通过静态方法code()和ok()创建ResponseData对象</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"title function_\">ResponseData</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 静态方法</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> code 业务状态码</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> &lt;T&gt;  返回数据的泛型</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 返回一个业务状态为code的ResponseData对象</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> &lt;T&gt; ResponseData&lt;T&gt; <span class=\"title function_\">code</span><span class=\"params\">(Integer code)</span> &#123;</span><br><span class=\"line\">        responseData = <span class=\"keyword\">new</span> <span class=\"title class_\">ResponseData</span>();</span><br><span class=\"line\">        responseData.setCode(code);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> responseData;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 非静态方法，设置响应体的业务提示消息</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> message 业务提示消息</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> &lt;T&gt;     返回数据的泛型</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 返回一个返回数据为data的ResponseData对象</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> &lt;T&gt; ResponseData&lt;T&gt; <span class=\"title function_\">message</span><span class=\"params\">(String message)</span> &#123;</span><br><span class=\"line\">        responseData.setMessage(message);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> responseData;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 非静态方法</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> data 返回数据</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> &lt;T&gt;  返回数据的泛型</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 返回一个返回数据为data的ResponseData对象</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> &lt;T&gt; ResponseData&lt;T&gt; <span class=\"title function_\">data</span><span class=\"params\">(T data)</span> &#123;</span><br><span class=\"line\">        responseData.setData(data);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> responseData;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 静态方法</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> &lt;T&gt; 返回数据的泛型</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 返回一个业务状态为20000，返回数据为null的ResponseData对象</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> &lt;T&gt; ResponseData&lt;T&gt; <span class=\"title function_\">ok</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> code(CodeEnum.OK.getValue());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 静态方法</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> data 返回数据</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> &lt;T&gt;  返回数据的泛型</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 返回一个业务状态为20000，返回数据为data的ResponseData对象</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> &lt;T&gt; ResponseData&lt;T&gt; <span class=\"title function_\">ok</span><span class=\"params\">(T data)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ok().data(data);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"统一响应结构体代码示例\"><a href=\"#统一响应结构体代码示例\" class=\"headerlink\" title=\"统一响应结构体代码示例\"></a>统一响应结构体代码示例</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@GetMapping(&quot;page/&#123;currentPage&#125;&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> ResponseData&lt;IPage&lt;User&gt;&gt; <span class=\"title function_\">page</span><span class=\"params\">(</span></span><br><span class=\"line\"><span class=\"params\">        <span class=\"meta\">@PathVariable(&quot;currentPage&quot;)</span> Integer currentPage,</span></span><br><span class=\"line\"><span class=\"params\">        <span class=\"meta\">@RequestParam(value = &quot;size&quot;, defaultValue = &quot;10&quot;)</span> Integer size,</span></span><br><span class=\"line\"><span class=\"params\">        User queryUser)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">    IPage&lt;User&gt; page = baseService.page(currentPage, size, queryUser);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ResponseData.ok(page);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@PutMapping(&quot;enabled/&#123;id&#125;&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> ResponseData&lt;Void&gt; <span class=\"title function_\">enabled</span><span class=\"params\">(</span></span><br><span class=\"line\"><span class=\"params\">        <span class=\"meta\">@PathVariable(&quot;id&quot;)</span> Integer id,</span></span><br><span class=\"line\"><span class=\"params\">        <span class=\"meta\">@RequestParam(&quot;enabled&quot;)</span> Boolean enabled)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">    baseService.enabled(id, enabled);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ResponseData.ok().message(<span class=\"string\">&quot;更新用户状态成功&quot;</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h1 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h1><blockquote>\n<p>本文<strong>Github</strong> <a href=\"https://github.com/herenpeng/code-learn\">https://github.com/herenpeng/code-learn</a> 已收录，欢迎<strong>Star</strong>。</p>\n</blockquote>\n","categories":["Java"],"tags":["Java","SpringBoot"]},{"title":"SpringBoot（四）：MyBatisPlus","url":"/2021/03/21/java/SpringBoot%EF%BC%88%E5%9B%9B%EF%BC%89%EF%BC%9AMyBatisPlus/","content":"<h1 id=\"MyBatisPlus\"><a href=\"#MyBatisPlus\" class=\"headerlink\" title=\"MyBatisPlus\"></a>MyBatisPlus</h1><p>MyBatis-Plus （简称 MP）是一个 MyBatis 的增强工具，在 MyBatis 的基础上只做增强不做改变，为简化开发、提高效率而生。</p>\n<span id=\"more\"></span>\n\n<p>官方网站：<a href=\"https://mp.baomidou.com\">https://mp.baomidou.com</a></p>\n<p>在 MyBatisPlus 的官方网站上，已经对 MyBatisPlus 做了很多的详细介绍，在本篇文章中就不对 MyBatisPlus 做过多的介绍，有想要详细了解 MyBatisPlus 框架的同学可以访问 MyBatisPlus 官网。</p>\n<h2 id=\"引入依赖\"><a href=\"#引入依赖\" class=\"headerlink\" title=\"引入依赖\"></a>引入依赖</h2><blockquote>\n<p>本篇文章中 SpringBoot 版本为 2.3.8.RELEASE , MyBatisPlus 版本为 3.4.0 。</p>\n</blockquote>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.3.8.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">relativePath</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--SpringMVC的启动器--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--Spring单元测试的启动器--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-test<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>test<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--lombok的依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.projectlombok<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>lombok<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--MySQL数据库驱动--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>mysql<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--MyBatis-Plus的依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.baomidou<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.4.0<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"MyBatisPlus-相关配置\"><a href=\"#MyBatisPlus-相关配置\" class=\"headerlink\" title=\"MyBatisPlus 相关配置\"></a>MyBatisPlus 相关配置</h2><figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">server:</span></span><br><span class=\"line\">  <span class=\"comment\"># 项目启动端口</span></span><br><span class=\"line\">  <span class=\"attr\">port:</span> <span class=\"number\">8080</span></span><br><span class=\"line\">  <span class=\"comment\"># 项目请求前缀</span></span><br><span class=\"line\">  <span class=\"attr\">servlet:</span></span><br><span class=\"line\">    <span class=\"attr\">context-path:</span> <span class=\"string\">/api</span></span><br><span class=\"line\">  <span class=\"comment\"># tomcat字符编码</span></span><br><span class=\"line\">  <span class=\"attr\">tomcat:</span></span><br><span class=\"line\">    <span class=\"attr\">uri-encoding:</span> <span class=\"string\">UTF-8</span></span><br><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">application:</span></span><br><span class=\"line\">    <span class=\"comment\"># Spring应用名称</span></span><br><span class=\"line\">    <span class=\"attr\">name:</span> <span class=\"string\">zero-admin</span></span><br><span class=\"line\">  <span class=\"comment\"># Jackson相关配置</span></span><br><span class=\"line\">  <span class=\"attr\">jackson:</span></span><br><span class=\"line\">    <span class=\"comment\"># 常用，全局设置实体类或被@JsonInclude注解的属性的序列化方式</span></span><br><span class=\"line\">    <span class=\"attr\">default-property-inclusion:</span> <span class=\"string\">ALWAYS</span></span><br><span class=\"line\">    <span class=\"comment\"># 当地时区</span></span><br><span class=\"line\">    <span class=\"attr\">locale:</span> <span class=\"string\">zh</span></span><br><span class=\"line\">    <span class=\"comment\"># 设置全局时区</span></span><br><span class=\"line\">    <span class=\"attr\">time-zone:</span> <span class=\"string\">GMT+8</span></span><br><span class=\"line\">    <span class=\"comment\"># 全局设置@JsonFormat的格式pattern</span></span><br><span class=\"line\">    <span class=\"attr\">date-format:</span> <span class=\"string\">yyyy-MM-dd</span> <span class=\"string\">HH:mm:ss</span></span><br><span class=\"line\">  <span class=\"comment\"># 数据库连接信息</span></span><br><span class=\"line\">  <span class=\"attr\">datasource:</span></span><br><span class=\"line\">    <span class=\"attr\">driver-class-name:</span> <span class=\"string\">com.mysql.cj.jdbc.Driver</span></span><br><span class=\"line\">    <span class=\"attr\">url:</span> <span class=\"string\">jdbc:mysql://127.0.0.1:3306/zero-admin?characterEncoding=utf8&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai</span></span><br><span class=\"line\">    <span class=\"attr\">username:</span> <span class=\"string\">root</span></span><br><span class=\"line\">    <span class=\"attr\">password:</span> <span class=\"string\">admin</span></span><br><span class=\"line\"><span class=\"comment\"># MyBatisPlus的相关配置</span></span><br><span class=\"line\"><span class=\"attr\">mybatis-plus:</span></span><br><span class=\"line\">  <span class=\"comment\"># Mapper文件路径，如果Mapper.xml配置文件路径和Mapper接口路径一致，可以不配置</span></span><br><span class=\"line\">  <span class=\"attr\">mapper-locations:</span> <span class=\"string\">classpath:/com/herenpeng/**/*Mapper.xml</span></span><br><span class=\"line\">  <span class=\"attr\">configuration:</span></span><br><span class=\"line\">    <span class=\"comment\"># 下划线转驼峰命名</span></span><br><span class=\"line\">    <span class=\"attr\">map-underscore-to-camel-case:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">    <span class=\"comment\"># 打印sql语句，将mybatis-plus自带的SQL打印注释，使用logback记录日志</span></span><br><span class=\"line\">    <span class=\"attr\">log-impl:</span> <span class=\"string\">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br><span class=\"line\">  <span class=\"comment\"># 配置逻辑删除字段</span></span><br><span class=\"line\">  <span class=\"attr\">global-config:</span></span><br><span class=\"line\">    <span class=\"attr\">db-config:</span></span><br><span class=\"line\">      <span class=\"comment\"># 删除状态为1(true)</span></span><br><span class=\"line\">      <span class=\"attr\">logic-delete-value:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">      <span class=\"comment\"># 没有删除状态为0(false)</span></span><br><span class=\"line\">      <span class=\"attr\">logic-not-delete-value:</span> <span class=\"literal\">false</span></span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"MyBatisPlus-实体类注解\"><a href=\"#MyBatisPlus-实体类注解\" class=\"headerlink\" title=\"MyBatisPlus 实体类注解\"></a>MyBatisPlus 实体类注解</h2><ul>\n<li><p><code>@TableName</code>：表名称注解，value 属性为实体类对应的表名</p>\n</li>\n<li><p><code>@TableId</code>：表主键注解，value 属性为主键对应的数据库字段名，type 属性为主键的生成策略</p>\n</li>\n<li><p><code>@TableField</code>：表字段注解，value 属性为主键对应的数据库字段名</p>\n</li>\n<li><p><code>@TableLogic</code>：MyBatisPlus 逻辑删除字段标识注解</p>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@NoArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@AllArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@TableName(&quot;auth_user&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Serializable</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@TableId(value = &quot;id&quot;, type = IdType.AUTO)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer id;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;username&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;password&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String password;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;enabled&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Boolean enabled;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;locked&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Boolean locked;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;account_expire&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Boolean accountExpire;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;password_expire&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Boolean passwordExpire;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;create_time&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Date createTime;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;create_user_id&quot;, fill = FieldFill.INSERT)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer createUserId;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;update_time&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Date updateTime;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;update_user_id&quot;, fill = FieldFill.INSERT_UPDATE)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer updateUserId;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@TableLogic</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Boolean deleted;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>数据库建表语句</strong></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> `auth_user` (</span><br><span class=\"line\">  `id` <span class=\"type\">int</span>(<span class=\"number\">11</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> AUTO_INCREMENT COMMENT <span class=\"string\">&#x27;账号在线人数&#x27;</span>,</span><br><span class=\"line\">  `username` <span class=\"type\">varchar</span>(<span class=\"number\">50</span>) <span class=\"type\">CHARACTER</span> <span class=\"keyword\">SET</span> utf8 <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> COMMENT <span class=\"string\">&#x27;用户名称&#x27;</span>,</span><br><span class=\"line\">  `password` <span class=\"type\">varchar</span>(<span class=\"number\">255</span>) <span class=\"type\">CHARACTER</span> <span class=\"keyword\">SET</span> utf8 <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> COMMENT <span class=\"string\">&#x27;用户密码&#x27;</span>,</span><br><span class=\"line\">  `enabled` tinyint(<span class=\"number\">1</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"string\">&#x27;1&#x27;</span> COMMENT <span class=\"string\">&#x27;账号是否启用，1为启用，0为禁用，默认为1&#x27;</span>,</span><br><span class=\"line\">  `locked` tinyint(<span class=\"number\">1</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"string\">&#x27;0&#x27;</span> COMMENT <span class=\"string\">&#x27;账号是否锁定，1为锁定，0为未锁定，默认为0&#x27;</span>,</span><br><span class=\"line\">  `account_expire` tinyint(<span class=\"number\">1</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"string\">&#x27;0&#x27;</span> COMMENT <span class=\"string\">&#x27;账号是否过期，1为过期，0为未过期，默认为0&#x27;</span>,</span><br><span class=\"line\">  `password_expire` tinyint(<span class=\"number\">1</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"string\">&#x27;0&#x27;</span> COMMENT <span class=\"string\">&#x27;密码是否过期，1为过期，0为未过期，默认为0&#x27;</span>,</span><br><span class=\"line\">  `create_time` datetime <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"built_in\">CURRENT_TIMESTAMP</span> COMMENT <span class=\"string\">&#x27;数据库数据插入时间&#x27;</span>,</span><br><span class=\"line\">  `create_user_id` <span class=\"type\">int</span>(<span class=\"number\">11</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"string\">&#x27;0&#x27;</span> COMMENT <span class=\"string\">&#x27;数据库数据插入用户主键&#x27;</span>,</span><br><span class=\"line\">  `update_time` datetime <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"built_in\">CURRENT_TIMESTAMP</span> <span class=\"keyword\">ON</span> <span class=\"keyword\">UPDATE</span> <span class=\"built_in\">CURRENT_TIMESTAMP</span> COMMENT <span class=\"string\">&#x27;数据库数据更新时间&#x27;</span>,</span><br><span class=\"line\">  `update_user_id` <span class=\"type\">int</span>(<span class=\"number\">11</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"string\">&#x27;0&#x27;</span> COMMENT <span class=\"string\">&#x27;数据库数据更新用户主键&#x27;</span>,</span><br><span class=\"line\">  `deleted` tinyint(<span class=\"number\">1</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"string\">&#x27;0&#x27;</span> COMMENT <span class=\"string\">&#x27;逻辑删除标识，0为正常，1为逻辑删除，默认为0&#x27;</span>,</span><br><span class=\"line\">  <span class=\"keyword\">PRIMARY</span> KEY (`id`) <span class=\"keyword\">USING</span> BTREE</span><br><span class=\"line\">) ENGINE<span class=\"operator\">=</span>InnoDB AUTO_INCREMENT<span class=\"operator\">=</span><span class=\"number\">24</span> <span class=\"keyword\">DEFAULT</span> CHARSET<span class=\"operator\">=</span>utf8mb4 ROW_FORMAT<span class=\"operator\">=</span>COMPACT COMMENT<span class=\"operator\">=</span><span class=\"string\">&#x27;系统用户表&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"CRUD-通用接口\"><a href=\"#CRUD-通用接口\" class=\"headerlink\" title=\"CRUD 通用接口\"></a>CRUD 通用接口</h2><p>MyBatisPlus 提供了一个 BaseMapper 接口，实体类 Mapper 层接口只要继承该 BaseMapper 接口，MyBatisPlus 即可为 Mapper 层接口生成简单的 CRUD 操作</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Mapper</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">UserMapper</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">BaseMapper</span>&lt;User&gt; &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>相关操作</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Autowired</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> UserMapper userMapper;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Test</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test01</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    List&lt;User&gt; users = userMapper.selectList(<span class=\"literal\">null</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (User user : users) &#123;</span><br><span class=\"line\">        System.out.println(user);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<p>BaseMapper 接口是持久层的通用方法接口，MyBatisPlus 还提供了 Service 层的接口和具体实现</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">UserService</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">IService</span>&lt;User&gt; &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Service</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserServiceImpl</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">ServiceImpl</span>&lt;UserMapper, User&gt; <span class=\"keyword\">implements</span> <span class=\"title class_\">UserService</span> &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>相关操作</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Autowired</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> UserService userService;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Test</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test02</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    List&lt;User&gt; users = userService.list();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (User user : users) &#123;</span><br><span class=\"line\">        System.out.println(user);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"分页插件\"><a href=\"#分页插件\" class=\"headerlink\" title=\"分页插件\"></a>分页插件</h2><p>MyBatisPlus 内置了分页功能，只需要通过配置即可实现基于物理分页的分页功能。</p>\n<p><strong>分页配置</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyBatisPlusConfig</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 高版本的MyBatisPlus分页插件</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> MybatisPlusInterceptor <span class=\"title function_\">mybatisPlusInterceptor</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">MybatisPlusInterceptor</span> <span class=\"variable\">interceptor</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MybatisPlusInterceptor</span>();</span><br><span class=\"line\">        interceptor.addInnerInterceptor(<span class=\"keyword\">new</span> <span class=\"title class_\">PaginationInnerInterceptor</span>(DbType.MYSQL));</span><br><span class=\"line\">        <span class=\"keyword\">return</span> interceptor;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>相关操作</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Autowired</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> UserMapper userMapper;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Test</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test03</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    IPage&lt;User&gt; page = <span class=\"keyword\">new</span> <span class=\"title class_\">Page</span>&lt;&gt;(<span class=\"number\">1</span>, <span class=\"number\">10</span>);</span><br><span class=\"line\">    IPage&lt;User&gt; pageInfo = userMapper.selectPage(page, <span class=\"literal\">null</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 总条数</span></span><br><span class=\"line\">    System.out.println(pageInfo.getTotal());</span><br><span class=\"line\">    <span class=\"comment\">// 当前分页总页数</span></span><br><span class=\"line\">    System.out.println(pageInfo.getPages());</span><br><span class=\"line\">    <span class=\"comment\">// 当前页</span></span><br><span class=\"line\">    System.out.println(pageInfo.getCurrent());</span><br><span class=\"line\">    <span class=\"comment\">// 每页显示条数</span></span><br><span class=\"line\">    System.out.println(pageInfo.getSize());</span><br><span class=\"line\">    <span class=\"comment\">// 分页记录数据内容</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (User user : pageInfo.getRecords()) &#123;</span><br><span class=\"line\">        System.out.println(user);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"逻辑删除\"><a href=\"#逻辑删除\" class=\"headerlink\" title=\"逻辑删除\"></a>逻辑删除</h2><p>MyBatisPlus 支持逻辑删除功能，如果使用了逻辑删除功能，凡是使用 BaseMapper 或者 IService 生成的删除操作，均为逻辑删除，如果是自己写的 SQL ，则还是需要开发者手动进行逻辑删除操作。</p>\n<p><strong>逻辑删除配置</strong></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># MyBatisPlus的相关配置</span></span><br><span class=\"line\"><span class=\"attr\">mybatis-plus:</span></span><br><span class=\"line\">  <span class=\"comment\"># 配置逻辑删除字段</span></span><br><span class=\"line\">  <span class=\"attr\">global-config:</span></span><br><span class=\"line\">    <span class=\"attr\">db-config:</span></span><br><span class=\"line\">      <span class=\"comment\"># 删除状态为1(true)</span></span><br><span class=\"line\">      <span class=\"attr\">logic-delete-value:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">      <span class=\"comment\"># 没有删除状态为0(false)</span></span><br><span class=\"line\">      <span class=\"attr\">logic-not-delete-value:</span> <span class=\"literal\">false</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>逻辑删除字段标识注解</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@TableLogic</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> Boolean deleted;</span><br></pre></td></tr></table></figure>\n\n<p><strong>逻辑删除组件注册</strong></p>\n<p>在 MyBatisPlus v3.1.1 版本之后，MyBatisPlus 默认支持逻辑删除，无需进行其他配置，如果低于该版本，需要进行如下配置：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Bean</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> ISqlInjector <span class=\"title function_\">sqlInjector</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">LogicSqlInjector</span>();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>相关操作</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Autowired</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> UserMapper userMapper;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Test</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test04</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    userMapper.deleteById(<span class=\"number\">23</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>使用该删除方法之后，只是将被 @TableLogic 注解的属性值修改为了 true （在数据库中表现为字段值由 0 改为了 1）</p>\n</blockquote>\n<h1 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h1><blockquote>\n<p>本文<strong>Github</strong> <a href=\"https://github.com/herenpeng/code-learn\">https://github.com/herenpeng/code-learn</a> 已收录，欢迎<strong>Star</strong>。</p>\n</blockquote>\n","categories":["Java"],"tags":["Java","SpringBoot"]},{"title":"SpringMVC异常处理机制","url":"/2020/02/12/java/SpringMVC%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E6%9C%BA%E5%88%B6/","content":"<p>SpringMVC作为一个优秀的Web层开发框架，在框架中已经集成了异常处理机制，可以帮我们我们灵活地处理程序中发生的异常，提高了我们程序的稳定性，令我们对程序运行中发生的异常更加可以控制，今天我们讲的就是SpringMVC框架中的对于异常的处理机制。</p>\n<span id=\"more\"></span>\n<p>本文中的所有程序都是基于SSM框架环境，以上一篇博文<a href=\"/2020/02/01/java/SSM框架整合/\">SSM框架整合</a>为基础。</p>\n<h2 id=\"没有异常处理机制的时候\"><a href=\"#没有异常处理机制的时候\" class=\"headerlink\" title=\"没有异常处理机制的时候\"></a>没有异常处理机制的时候</h2><p>首先，我们在程序的Service层引入一个异常：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> List&lt;User&gt; <span class=\"title function_\">findAll</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> i= <span class=\"number\">1</span>/<span class=\"number\">0</span>;\t<span class=\"comment\">//java.lang.ArithmeticException: / by zero 算数运算异常</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> userDao.findAll();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>当我们运行程序，并调用该方法时，页面发生如下情况：</p>\n<p><img src=\"/images/2020/02/20200212200927902.png\" alt=\"在这里插入图片描述\"></p>\n<p>毫无疑问，对于不懂计算机知识的访问用户来说，这是一个极其不友好的界面，而我们在开发中应该尽量避免这种情况的发生，避免这种对用户不友好的情况发生。<br>SpringMVC中对于这种情况的处理机制，就被称作是异常处理机制。该机制可以让用户访问程序的时候，如果发生程序异常，那么会选择一种友好的方式提醒用户。<br><strong>SpringMVC中对于异常的处理机制一共有三种，分别是：</strong></p>\n<ul>\n<li>SpringMVC内置异常处理机制</li>\n<li>HandlerExceptionResolver自定义异常处理机制</li>\n<li>@ExceptionHandler异常处理机制<h2 id=\"1、SpringMVC内置异常处理机制\"><a href=\"#1、SpringMVC内置异常处理机制\" class=\"headerlink\" title=\"1、SpringMVC内置异常处理机制\"></a>1、SpringMVC内置异常处理机制</h2>SpringMVC框架内置的异常处理机制，可以直接在SpringMVC的配置文件中配置异常处理。<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;org.springframework.web.servlet.handler.SimpleMappingExceptionResolver&quot;</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;exceptionMappings&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">props</span>&gt;</span></span><br><span class=\"line\">        \t<span class=\"comment\">&lt;!--key是需要处理的异常类型，error是异常处理是跳转的页面，需要注意，该页面同样会经过视图解析器，所以直接配置页面的名字就可以了--&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">prop</span> <span class=\"attr\">key</span>=<span class=\"string\">&quot;java.lang.Exception&quot;</span>&gt;</span>error<span class=\"tag\">&lt;/<span class=\"name\">prop</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">props</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>\n配置完成之后，再次运行程序，发生异常之后就会出现如下界面：</li>\n</ul>\n<p><img src=\"/images/2020/02/20200212203540894.png\" alt=\"在这里插入图片描述\"></p>\n<p>这是页面是我们自己写的error页面，这个页面就比原生的异常页面要友好的多了，而且在正式开发中，完全可以由前端开发人员制作一个精美友好的错误页面，让用户可以获得良好的访问体验。</p>\n<h2 id=\"2、HandlerExceptionResolver自定义异常处理机制\"><a href=\"#2、HandlerExceptionResolver自定义异常处理机制\" class=\"headerlink\" title=\"2、HandlerExceptionResolver自定义异常处理机制\"></a>2、HandlerExceptionResolver自定义异常处理机制</h2><p>HandlerExceptionResolver自定义异常处理机制，需要我们自己写一个异常处理的类，并实现HandlerExceptionResolver接口，并重写其中的resolveException方法，需要注意的是，我们需要在这里类上加上@Component注解，表示它也是一个被Spring管理的JavaBean。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyException</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">HandlerExceptionResolver</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> ModelAndView <span class=\"title function_\">resolveException</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">ModelAndView</span> <span class=\"variable\">model</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ModelAndView</span>();</span><br><span class=\"line\">        model.addObject(<span class=\"string\">&quot;message&quot;</span>,ex.getMessage());</span><br><span class=\"line\">        model.setViewName(<span class=\"string\">&quot;error&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> model;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>当使用这种机制处理异常，程序发生异常时情况如下：<br><img src=\"/images/2020/02/20200212204659991.png\" alt=\"在这里插入图片描述\"></p>\n<p>不但有错误提示，还有错误的信息。</p>\n<h2 id=\"3、-ExceptionHandler异常处理机制\"><a href=\"#3、-ExceptionHandler异常处理机制\" class=\"headerlink\" title=\"3、@ExceptionHandler异常处理机制\"></a>3、@ExceptionHandler异常处理机制</h2><p>SpringMVC框架的第三种异常处理机制，就是使用@ExceptionHandler注解进行异常处理。<br>在Controller中写一个方法，并在该方法上使用@ExceptionHandler注解，当这个Controller中发生异常的时候，该注解的方法就会处理异常。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ExceptionHandler</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> String <span class=\"title function_\">myException</span><span class=\"params\">(HttpServletRequest request, Exception ex)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"string\">&quot;error&quot;</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>【注意】被@ExceptionHandler注解的方法的参数必须是固定的，否则运行时无法生效。</strong><br>使用这种异常处理机制，异常发生时页面如下：</p>\n<p><img src=\"/images/2020/02/20200212210851554.png\" alt=\"在这里插入图片描述\"></p>\n<p>当然，使用@ExceptionHandler注解处理异常的时候，也可以配置全局异常处理。<br>单独写一个类，并在该类上使用@ControllerAdvice注解，那么这个类就是全局异常处理类。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ControllerAdvice</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyException</span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 该注解的值为需要处理的异常类型的字节码对象数组，可以定义多个</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> request 固定参数HttpServletRequest，不写会报错</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> ex 固定参数Exception，不写会报错</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 自定义，可以是String，也可以是ModelAndView</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@ExceptionHandler(&#123;RuntimeException.class, FileNotFoundException.class&#125;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">myException</span><span class=\"params\">(HttpServletRequest request, Exception ex)</span> &#123;</span><br><span class=\"line\">        request.setAttribute(<span class=\"string\">&quot;message&quot;</span>,ex.getMessage());</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;error&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>使用@ExceptionHandler注解进行全局异常机制处理，当程序运行时发生异常，情况如下：<br><img src=\"/images/2020/02/20200212211711272.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"结束\"><a href=\"#结束\" class=\"headerlink\" title=\"结束\"></a>结束</h2><p>SpringMVC的三种异常处理机制各有优劣，各位在使用SpringMVC的异常处理机制的时候，可以根据实际需求和自身喜好来进行配置开发。</p>\n","categories":["Java"],"tags":["Java","Spring"]},{"title":"Spring的事务管理","url":"/2020/02/13/java/Spring%E7%9A%84%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86/","content":"<h1 id=\"什么是事务？\"><a href=\"#什么是事务？\" class=\"headerlink\" title=\"什么是事务？\"></a>什么是事务？</h1><p>所谓事务，就是指数据库中的一组操作，这些操作要么全部都执行成功，要么全部都执行失败，执行成功的事务提交到数据库中，执行失败的事务则回滚。</p>\n<span id=\"more\"></span>\n\n<h1 id=\"事务的四大特性\"><a href=\"#事务的四大特性\" class=\"headerlink\" title=\"事务的四大特性\"></a>事务的四大特性</h1><ul>\n<li>原子性（Atomicity）<br>原子是最小的单位，代表了不可分割。原子性表明，事务是数据库中操作的最小单元，事务中的操作要么全部成功，要么全部失败。</li>\n<li>一致性（Consistency）<br>事务的执行前后，数据库的状态必须保持一致。</li>\n<li>隔离性（Isolation）<br>一个事务的执行不能被另外的事务所干扰，事务执行的过程对于其他事务而言是隔离的。也就是说，另外的事务查看的数据，要么是一个事务提交前的数据，要么就是一个事务提交后的数据，事务执行的中间过程是隔离的。</li>\n<li>持久性（Durability）<br>一个事务成功提交后，那么这个事务所做的操作引起的数据变化，会被持久化到数据库中。</li>\n</ul>\n<h1 id=\"数据库的读问题\"><a href=\"#数据库的读问题\" class=\"headerlink\" title=\"数据库的读问题\"></a>数据库的读问题</h1><p>事务的四大特性中，隔离性是保证事务安全的一个重要特性，如果不考虑事务的隔离性，就会引发数据库的读问题。</p>\n<ul>\n<li>脏读：一个事务读到另一个事务未提交的数据。【解决方案：读已提交】</li>\n<li>不可重复读：一个事务读到另一个事务已提交的update数据，导致一个事务前后两次读取的数据不一致。【解决方案：重复读】</li>\n<li>幻读：一个事务读到另一个事务已提交的insert数据，导致一个事务中多次查询结果不一致。【解决方案：序列化读】</li>\n</ul>\n<h1 id=\"数据库的隔离级别\"><a href=\"#数据库的隔离级别\" class=\"headerlink\" title=\"数据库的隔离级别\"></a>数据库的隔离级别</h1><p>为了解决数据库的读问题，于是设立了数据的隔离级别。</p>\n<ul>\n<li>Read uncommitted：读未提交，任何读问题解决不了。 </li>\n<li>Read committed：读已提交，这个事务的隔离级别，在事务开启时，要等另一个事务提交后才能读取数据，可以<strong>解决脏读问题</strong>，但是不可重复读和幻读有可能发生。</li>\n<li>Repeatableread：重复读，这个的隔离级别，在事务开启式，不允许其它事务进行update操作，可以<strong>解决脏读和不可重复读</strong>，但是幻读有可能发生。</li>\n<li>Serializable：序列化读，所有事务串行化顺序执行，解决所有读问题。不过这个事务的隔离级别会严重拖慢数据库性能。</li>\n</ul>\n<h1 id=\"Spring的事务管理\"><a href=\"#Spring的事务管理\" class=\"headerlink\" title=\"Spring的事务管理\"></a>Spring的事务管理</h1><p>有了以上的事务知识，那么我们就可以来看一看Spring的事务管理了。<br>在Spring中，PlatformTransactionManager接口是事务平台管理器，是Spring中用于真正管理事务的对象，它有两个具体的实现类，底层分别使用不同的事务管理方式。</p>\n<ul>\n<li>DataSourceTransactionManager：底层使用JDBC管理事务</li>\n<li>HibernateTransactionManager：底层使用Hibernate管理事务</li>\n</ul>\n<p>Spring一共定义了七种事务的传播行为</p>\n<h2 id=\"保证多个操作在同一个事务中\"><a href=\"#保证多个操作在同一个事务中\" class=\"headerlink\" title=\"保证多个操作在同一个事务中\"></a>保证多个操作在同一个事务中</h2><ol>\n<li>PROPAGATION_REQUIRED：<strong>默认值</strong>，如果A中有事务，使用A中的事务，如果A没有，创建一个新的事务，将操作包含进来。</li>\n<li>PROPAGATION_SUPPORTS：支持事务，如果A中有事务，使用A中的事务。如果A没有事务，不使用事务。</li>\n<li>PROPAGATION_MANDATORY：如果A中有事务，使用A中的事务。如果A没有事务，抛出异常。</li>\n</ol>\n<h2 id=\"保证多个操作不在同一个事务中\"><a href=\"#保证多个操作不在同一个事务中\" class=\"headerlink\" title=\"保证多个操作不在同一个事务中\"></a>保证多个操作不在同一个事务中</h2><ol start=\"4\">\n<li>PROPAGATION_REQUIRES_NEW：如果A中有事务，将A的事务挂起（暂停），创建新事务，只包含自身操作。如果A中没有事务，创建一个新事务，包含自身操作。</li>\n<li>PROPAGATION_NOT_SUPPORTED    ：如果A中有事务，将A的事务挂起。不使用事务管理。</li>\n<li>PROPAGATION_NEVER                ：如果A中有事务，报异常。</li>\n</ol>\n<h2 id=\"嵌套式事务\"><a href=\"#嵌套式事务\" class=\"headerlink\" title=\"嵌套式事务\"></a>嵌套式事务</h2><ol start=\"7\">\n<li>PROPAGATION_NESTED：嵌套事务，如果A中有事务，按照A的事务执行，执行完成后，设置一个保存点，执行B中的操作，如果没有异常，执行通过，如果有异常，可以选择回滚到最初始位置，也可以回滚到保存点。</li>\n</ol>\n<h1 id=\"Spring编程式事务管理（了解）\"><a href=\"#Spring编程式事务管理（了解）\" class=\"headerlink\" title=\"Spring编程式事务管理（了解）\"></a>Spring编程式事务管理（了解）</h1><p>spring编程式事务管理，由于代码书写多，在正式开发中几乎不会使用，该知识点仅限于了解。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">&lt;!-- 第一步：在spring的配置文件中配置事务管理器 --&gt;</span><br><span class=\"line\">&lt;bean id=<span class=\"string\">&quot;transactionManager&quot;</span> class=<span class=\"string\">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span><br><span class=\"line\">    &lt;property name=<span class=\"string\">&quot;dataSource&quot;</span> ref=<span class=\"string\">&quot;dataSource&quot;</span>/&gt;</span><br><span class=\"line\">&lt;/bean&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;!-- 第二步：在spring的配置文件中配置事务模板 --&gt;</span><br><span class=\"line\">&lt;bean id=<span class=\"string\">&quot;transactionTemplate&quot;</span> class=<span class=\"string\">&quot;org.springframework.transaction.support.TransactionTemplate&quot;</span>&gt;</span><br><span class=\"line\">    &lt;property name=<span class=\"string\">&quot;transactionManager&quot;</span> ref=<span class=\"string\">&quot;transactionManager&quot;</span>&gt;&lt;/property&gt;</span><br><span class=\"line\">&lt;/bean&gt;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Autowired</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> UserDao userDao;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *第三步，在service层中注入事务模板</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Autowired</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> TransactionTemplate transactionTemplate;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">deleteUser</span><span class=\"params\">(Integer id)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t *第四步：使用事务模板中的execute方式，传入一个匿名内部借口，</span></span><br><span class=\"line\"><span class=\"comment\">\t *并实现接口中的方法，将所有代码放在这个方法中</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">    transactionTemplate.execute(<span class=\"keyword\">new</span> <span class=\"title class_\">TransactionCallbackWithoutResult</span>() &#123;</span><br><span class=\"line\">        <span class=\"meta\">@SneakyThrows</span></span><br><span class=\"line\">        <span class=\"meta\">@Override</span></span><br><span class=\"line\">        <span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title function_\">doInTransactionWithoutResult</span><span class=\"params\">(TransactionStatus status)</span> &#123;</span><br><span class=\"line\">            userDao.deleteUser(id);</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">1</span>/<span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"Spring的声明式事务管理\"><a href=\"#Spring的声明式事务管理\" class=\"headerlink\" title=\"Spring的声明式事务管理\"></a>Spring的声明式事务管理</h1><h2 id=\"基于xml配置文件的方式\"><a href=\"#基于xml配置文件的方式\" class=\"headerlink\" title=\"基于xml配置文件的方式\"></a>基于xml配置文件的方式</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">&lt;!--spring提供的事务管理器，注入dataSource--&gt;</span><br><span class=\"line\">&lt;bean id=<span class=\"string\">&quot;transactionManager&quot;</span> class=<span class=\"string\">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span><br><span class=\"line\">    &lt;property name=<span class=\"string\">&quot;dataSource&quot;</span> ref=<span class=\"string\">&quot;dataSource&quot;</span>/&gt;</span><br><span class=\"line\">&lt;/bean&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;!--声明式事务管理，事务的通知--&gt;</span><br><span class=\"line\">&lt;tx:advice id=<span class=\"string\">&quot;txAdvice&quot;</span> transaction-manager=<span class=\"string\">&quot;transactionManager&quot;</span>&gt;</span><br><span class=\"line\">    &lt;tx:attributes&gt;</span><br><span class=\"line\">        &lt;!--事务的传播行为，所有的保存方法使用save打头，事务的传播行为为REQUIRED--&gt;</span><br><span class=\"line\">        &lt;tx:method name=<span class=\"string\">&quot;save*&quot;</span> propagation=<span class=\"string\">&quot;REQUIRED&quot;</span> /&gt;</span><br><span class=\"line\">        &lt;!--所有的删除方法使用delete打头，事务的传播行为为REQUIRED--&gt;</span><br><span class=\"line\">        &lt;tx:method name=<span class=\"string\">&quot;delete*&quot;</span> propagation=<span class=\"string\">&quot;REQUIRED&quot;</span> /&gt;</span><br><span class=\"line\">        &lt;!--所有的更新方法使用update打头，事务的传播行为为REQUIRED--&gt;</span><br><span class=\"line\">        &lt;tx:method name=<span class=\"string\">&quot;update*&quot;</span> propagation=<span class=\"string\">&quot;REQUIRED&quot;</span> /&gt;</span><br><span class=\"line\">        &lt;!--所有的查询方法使用find打头，事务的传播行为为SUPPORTS，事务只读--&gt;</span><br><span class=\"line\">        &lt;tx:method name=<span class=\"string\">&quot;find*&quot;</span> propagation=<span class=\"string\">&quot;SUPPORTS&quot;</span> read-only=<span class=\"string\">&quot;true&quot;</span> /&gt;</span><br><span class=\"line\">    &lt;/tx:attributes&gt;</span><br><span class=\"line\">&lt;/tx:advice&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;!--配置切面，service.impl包下的所有类所有方法都进行切面拦截--&gt;</span><br><span class=\"line\">&lt;aop:config&gt;</span><br><span class=\"line\">    &lt;aop:pointcut id=<span class=\"string\">&quot;pointcut&quot;</span> expression=<span class=\"string\">&quot;execution(* com.hrp.service.impl.*.*(..))&quot;</span>/&gt;</span><br><span class=\"line\">    &lt;aop:advisor advice-ref=<span class=\"string\">&quot;txAdvice&quot;</span> pointcut-ref=<span class=\"string\">&quot;pointcut&quot;</span> /&gt;</span><br><span class=\"line\">&lt;/aop:config&gt;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"基于-Transactional注解方式\"><a href=\"#基于-Transactional注解方式\" class=\"headerlink\" title=\"基于@Transactional注解方式\"></a>基于@Transactional注解方式</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">&lt;!--开启spring的基于注解的的事务管理--&gt;</span><br><span class=\"line\">&lt;tx:annotation-driven transaction-manager=<span class=\"string\">&quot;transactionManager&quot;</span>/&gt;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Transactional(rollbackFor = Exception.class,propagation = Propagation.REQUIRED)</span></span><br><span class=\"line\"><span class=\"meta\">@Override</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">deleteUser</span><span class=\"params\">(Integer id)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">    userDao.deleteUser(id);</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">1</span>/<span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>基于@Transactional注解方式的事务管理，也可以通过注解中属性来定义事务管理的方式。</p>\n<ul>\n<li>rollbackFor ：（值为异常的字节码对象）遇到该异常时回滚</li>\n<li>noRollbackFor：（值为异常的字节码对象）遇到该异常时不回滚</li>\n<li>propagation ：（值为Propagation枚举对象）事务的传播行为</li>\n<li>readOnly：（值为true或者false）事务是否只读</li>\n</ul>\n<p><strong>Spring事务的回滚规则</strong>：在Spring的事务管理中，默认只有遇到运行时异常才会回滚事务，遇到编译期异常默认不回滚事务。<br>当然，开发者也可以通过自己指定遇到某种异常回滚或者不回滚。</p>\n","categories":["Java"],"tags":["Java","Spring"]},{"title":"Swagger报错：Unable to interpret the implicit parameter configuration with dataType","url":"/2021/01/10/java/Swagger%E6%8A%A5%E9%94%99%EF%BC%9AUnable%20to%20interpret%20the%20implicit%20parameter%20configuration%20with%20dataType/","content":"<p>在项目中使用了Swagger作为项目接口API说明文档，但是在启动项目的时候，启动日志中报了一个警告信息，虽然最终并不影响项目功能的使用，但是却依旧让人看得不舒服。</p>\n<span id=\"more\"></span>\n\n<p>项目在启动的时候报错：</p>\n<blockquote>\n<p>Unable to interpret the implicit parameter configuration with dataType: , dataTypeClass: class java.lang.Void。</p>\n</blockquote>\n<p>翻译：</p>\n<blockquote>\n<p>无法使用dataType：，dataTypeClass：class java.lang.Void解释隐式参数配置</p>\n</blockquote>\n<p>这是因为Swagger中的注解<code>@ApiImplicitParam</code>有一个属性为dataTypeClass，该属性的默认值为Void.class，因为没有指定dataTypeClass属性的值，所以报该警告信息。</p>\n<p><strong>解决方法：</strong></p>\n<p>在<code>@ApiImplicitParam</code>注解上加上dataTypeClass属性的值，例如：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@ApiImplicitParams(&#123;</span></span><br><span class=\"line\"><span class=\"meta\">        @ApiImplicitParam(name = &quot;username&quot;, value = &quot;用户名&quot;, dataTypeClass = String.class, required = true)</span></span><br><span class=\"line\"><span class=\"meta\">&#125;)</span></span><br></pre></td></tr></table></figure>\n","categories":["Java"],"tags":["Java","Swagger"]},{"title":"Thymeleaf静态模板引擎","url":"/2020/03/24/java/Thymeleaf%E9%9D%99%E6%80%81%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E/","content":"<h1 id=\"Thymeleaf\"><a href=\"#Thymeleaf\" class=\"headerlink\" title=\"Thymeleaf\"></a>Thymeleaf</h1><h2 id=\"什么是Thymeleaf静态模板引擎？\"><a href=\"#什么是Thymeleaf静态模板引擎？\" class=\"headerlink\" title=\"什么是Thymeleaf静态模板引擎？\"></a>什么是Thymeleaf静态模板引擎？</h2><p><strong>Thymeleaf</strong>是用来开发Web和独立环境项目的现代服务器端Java模板引擎。<br>Thymeleaf的主要目标是为您的开发工作流程带来优雅的自然模板- HTML。<br>可以在直接浏览器中正确显示，并且可以作为静态原型，从而在开发团队中实现更强大的协作。</p>\n<span id=\"more\"></span>\n\n<p>借助Spring Framework的模块，可以根据自己的喜好进行自由选择，可插拔功能组件，Thymeleaf是现代HTML5 JVM Web开发的理想选择 - 尽管它可以做的更多。</p>\n<p>Spring官方支持的服务的渲染模板中，并不包含jsp。而是Thymeleaf和Freemarker等，而Thymeleaf与SpringMVC的视图技术，及SpringBoot的自动化配置集成非常完美，几乎没有任何成本，你只用关注Thymeleaf的语法即可。</p>\n<h2 id=\"Thymeleaf的特点\"><a href=\"#Thymeleaf的特点\" class=\"headerlink\" title=\"Thymeleaf的特点\"></a>Thymeleaf的特点</h2><ul>\n<li><strong>动静结合：</strong> Thymeleaf 在有网络和无网络的环境下皆可运行，即它可以让美工在浏览器查看页面的静态效果，也可以让程序员在服务器查看带数据的动态页面效果。这是由于它支持 html 原型，然后在 html 标签里增加额外的属性来达到模板+数据的展示方式。浏览器解释 html 时会忽略未定义的标签属性，所以 thymeleaf 的模板可以静态地运行；当有数据返回到页面时，Thymeleaf 标签会动态地替换掉静态内容，使页面动态显示。</li>\n<li><strong>开箱即用：</strong> 它提供标准和spring标准两种方言，可以直接套用模板实现JSTL、 OGNL表达式效果，避免每天套模板、改jstl、改标签的困扰。同时开发人员也可以扩展和创建自定义的方言。</li>\n<li><strong>多方言支持：</strong> Thymeleaf 提供spring标准方言和一个与 SpringMVC 完美集成的可选模块，可以快速的实现表单绑定、属性编辑器、国际化等功能。</li>\n<li><strong>与SpringBoot完美整合：</strong> SpringBoot提供了Thymeleaf的默认配置，并且为Thymeleaf设置了视图解析器，我们可以像以前操作jsp一样来操作Thymeleaf。代码几乎没有任何区别，就是在模板语法上有区别。</li>\n</ul>\n<h1 id=\"SpringBoot-Thymeleaf\"><a href=\"#SpringBoot-Thymeleaf\" class=\"headerlink\" title=\"SpringBoot-Thymeleaf\"></a>SpringBoot-Thymeleaf</h1><h2 id=\"搭建项目环境\"><a href=\"#搭建项目环境\" class=\"headerlink\" title=\"搭建项目环境\"></a>搭建项目环境</h2><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.0.6.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--Thymeleaf模板引擎的启动器--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--SpringMVC的启动器--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--Spring单元测试的启动器--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-test<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>test<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"application-yml\"><a href=\"#application-yml\" class=\"headerlink\" title=\"application.yml\"></a>application.yml</h2><figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">thymeleaf:</span></span><br><span class=\"line\">    <span class=\"attr\">cache:</span> <span class=\"literal\">false</span>    <span class=\"comment\">#关闭thymeleaf模板引擎的缓存，否则修改页面会因为缓存无法刷新</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"SpringBoot-Thymeleaf的默认配置\"><a href=\"#SpringBoot-Thymeleaf的默认配置\" class=\"headerlink\" title=\"SpringBoot-Thymeleaf的默认配置\"></a>SpringBoot-Thymeleaf的默认配置</h2><p>SpringBoot-Thymeleaf为我们默认配置了视图解析器。<br><img src=\"/images/2020/0/20200324205909229.png\" alt=\"在这里插入图片描述\"><br>视图解析器的前缀是<code>classpath:/templates/</code>，后缀是<code>.html</code>，也就是说，Spring项目返回视图的时候，会自动拼接前缀后缀路径，完成视图解析。</p>\n<h2 id=\"SpringBoot的启动类\"><a href=\"#SpringBoot的启动类\" class=\"headerlink\" title=\"SpringBoot的启动类\"></a>SpringBoot的启动类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ThymeleafApplication</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        SpringApplication.run(ThymeleafApplication.class);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"项目结构\"><a href=\"#项目结构\" class=\"headerlink\" title=\"项目结构\"></a>项目结构</h2><p><img src=\"/images/2020/0/20200324210342491.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"Web层代码\"><a href=\"#Web层代码\" class=\"headerlink\" title=\"Web层代码\"></a>Web层代码</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Controller</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;user&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserController</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping(&quot;hello&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">hello</span><span class=\"params\">(Model model)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">User</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>(<span class=\"number\">1</span>,<span class=\"string\">&quot;张三&quot;</span>,<span class=\"number\">20</span>);</span><br><span class=\"line\">        model.addAttribute(<span class=\"string\">&quot;user&quot;</span>,user);</span><br><span class=\"line\">        model.addAttribute(<span class=\"string\">&quot;msg&quot;</span>, <span class=\"string\">&quot;Hello, Thymeleaf!&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;hello&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"hello-html\"><a href=\"#hello-html\" class=\"headerlink\" title=\"hello.html\"></a>hello.html</h2><p>hello.html文件放置在resources目录下的templates文件下，可以直接被Thymeleaf配置进行视图解析。<br>Thymeleaf的HTML文件需要修改名称空间为<code>&lt;html lang=&quot;en&quot; xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;</code>，语法为在HTML标签中使用<code>th:</code>进行数据绑定。</p>\n<figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;en&quot;</span> <span class=\"attr\">xmlns:th</span>=<span class=\"string\">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Hello页面<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h1</span> <span class=\"attr\">th:text</span>=<span class=\"string\">&quot;$&#123;user.name&#125;&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">h1</span> <span class=\"attr\">th:text</span>=<span class=\"string\">&quot;$&#123;msg&#125;&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"测试功能\"><a href=\"#测试功能\" class=\"headerlink\" title=\"测试功能\"></a>测试功能</h2><p>我们启动项目，访问<code>localhost:8080//user/hello</code>路径。</p>\n<p><img src=\"/images/2020/0/20200324210832982.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["Java"],"tags":["Java","Thymeleaf"]},{"title":"easypoi+SpringBoot导出Excel文件","url":"/2020/08/09/java/easypoi+SpringBoot%E5%AF%BC%E5%87%BAExcel%E6%96%87%E4%BB%B6/","content":"<blockquote>\n<p>导出Excel文件是Web系统中极为常见的一个操作，今天我们来学习使用easypoi+SpringBoot来实现Excel文件的导出功能。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h2 id=\"引入依赖\"><a href=\"#引入依赖\" class=\"headerlink\" title=\"引入依赖\"></a>引入依赖</h2><p>该项目既然是结合SpringBoot来进行开发的，那么我们直接导出easypoi的SpringBoot的启动器依赖，至于SpringBoot的其他依赖，可以参考我以前的SpringBoot项目依赖。</p>\n<ul>\n<li><a href=\"/2020/03/16/java/SpringBoot+MyBatisPlus/\">SpringBoot+MyBatisPlus</a></li>\n</ul>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--excel操作--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>cn.afterturn<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>easypoi-spring-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.3.0<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"注解实体类\"><a href=\"#注解实体类\" class=\"headerlink\" title=\"注解实体类\"></a>注解实体类</h2><p>我们可以使用@Excel注解来标注实体类属性，同时配置实体类属性的导出参数。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@TableName(&quot;user&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Serializable</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@TableId(type = IdType.AUTO)</span></span><br><span class=\"line\">    <span class=\"meta\">@Excel(name = &quot;ID&quot;, orderNum = &quot;0&quot;, width = 15)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer id;</span><br><span class=\"line\">    <span class=\"meta\">@Excel(name = &quot;用户名&quot;, orderNum = &quot;1&quot;, width = 15)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\">    <span class=\"meta\">@Excel(name = &quot;姓名&quot;, orderNum = &quot;2&quot;, width = 15)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\">\t<span class=\"meta\">@Excel(name = &quot;性别&quot;, orderNum = &quot;3&quot;, width = 15)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer gender;</span><br><span class=\"line\">    <span class=\"meta\">@Excel(name = &quot;出生日期&quot;, orderNum = &quot;4&quot;, width = 30, format = &quot;yyyy-MM-dd&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Date birthday;</span><br><span class=\"line\">    <span class=\"meta\">@Excel(name = &quot;手机号码&quot;, orderNum = &quot;5&quot;, width = 15)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String phone;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ExcelUtils\"><a href=\"#ExcelUtils\" class=\"headerlink\" title=\"ExcelUtils\"></a>ExcelUtils</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@description</span>: Excel导入导出工具类</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ExcelUtils</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 对外的导出excel方法，exportExcel重载方法</span></span><br><span class=\"line\"><span class=\"comment\">     * 该方法通过传入ExportParams对象参数指定标题和表名称</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> fileName     文件名称</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> exportParams ExportParams对象，导出参数</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> exportClass  导出对象的字节码对象</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> exportData   导出的数据</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> response     HttpServletResponse对象</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> IOException IO异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">exportExcel</span><span class=\"params\">(String fileName, ExportParams exportParams, Class&lt;?&gt; exportClass, List&lt;?&gt; exportData, HttpServletResponse response)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">        <span class=\"type\">Workbook</span> <span class=\"variable\">workbook</span> <span class=\"operator\">=</span> ExcelExportUtil.exportExcel(exportParams, exportClass, exportData);</span><br><span class=\"line\">        downloadExcel(fileName, workbook, response);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 对外的导出excel方法，exportExcel重载方法</span></span><br><span class=\"line\"><span class=\"comment\">     * 该方法可以指定文件名称、标题名称、表名称</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> fileName    文件名称</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> title       excel标题</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> sheetName   excel表名</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> exportClass 导出对象的字节码对象</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> exportData  导出的数据</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> response    HttpServletResponse对象</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> IOException IO异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">exportExcel</span><span class=\"params\">(String fileName, String title, String sheetName, Class&lt;?&gt; exportClass, List&lt;?&gt; exportData, HttpServletResponse response)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">        <span class=\"type\">ExportParams</span> <span class=\"variable\">exportParams</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ExportParams</span>();</span><br><span class=\"line\">        exportParams.setTitle(title);</span><br><span class=\"line\">        exportParams.setCreateHeadRows(<span class=\"literal\">true</span>);</span><br><span class=\"line\">        exportParams.setSheetName(sheetName);</span><br><span class=\"line\">        exportParams.setType(ExcelType.XSSF);</span><br><span class=\"line\">        defaultExport(fileName, exportParams, exportClass, exportData, response);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 对外的导出excel方法，exportExcel重载方法（简化方法）</span></span><br><span class=\"line\"><span class=\"comment\">     * 该方法可以指定文件名称，默认标题和表名称为文件名称</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> fileName    文件名称</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> exportClass 导出对象的字节码对象</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> exportData  导出的数据</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> response    HttpServletResponse对象</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> IOException IO异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">exportExcel</span><span class=\"params\">(String fileName, Class&lt;?&gt; exportClass, List&lt;?&gt; exportData, HttpServletResponse response)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">        <span class=\"type\">ExportParams</span> <span class=\"variable\">exportParams</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ExportParams</span>();</span><br><span class=\"line\">        exportParams.setTitle(fileName);</span><br><span class=\"line\">        exportParams.setCreateHeadRows(<span class=\"literal\">true</span>);</span><br><span class=\"line\">        exportParams.setSheetName(fileName);</span><br><span class=\"line\">        exportParams.setType(ExcelType.XSSF);</span><br><span class=\"line\">        defaultExport(fileName, exportParams, exportClass, exportData, response);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 默认导出方法，私有</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> fileName     文件名称</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> exportParams ExportParams对象，导出参数</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> exportClass  导出对象的字节码对象</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> exportData   导出的数据</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> response     HttpServletResponse对象</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> IOException IO异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">defaultExport</span><span class=\"params\">(String fileName, ExportParams exportParams, Class&lt;?&gt; exportClass, List&lt;?&gt; exportData, HttpServletResponse response)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">        <span class=\"type\">Workbook</span> <span class=\"variable\">workbook</span> <span class=\"operator\">=</span> ExcelExportUtil.exportExcel(exportParams, exportClass, exportData);</span><br><span class=\"line\">        downloadExcel(fileName, workbook, response);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 下载Excel，私有</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> fileName 文件名称</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> workbook Workbook对象</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> response HttpServletResponse对象</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> IOException IO异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">downloadExcel</span><span class=\"params\">(String fileName, Workbook workbook, HttpServletResponse response)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">        response.setCharacterEncoding(<span class=\"string\">&quot;UTF-8&quot;</span>);</span><br><span class=\"line\">        response.setHeader(<span class=\"string\">&quot;Content-Type&quot;</span>, <span class=\"string\">&quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;</span>);</span><br><span class=\"line\">        response.setHeader(<span class=\"string\">&quot;Content-Disposition&quot;</span>, <span class=\"string\">&quot;attachment;filename=&quot;</span> + URLEncoder.encode(fileName, <span class=\"string\">&quot;UTF-8&quot;</span>));</span><br><span class=\"line\">        workbook.write(response.getOutputStream());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"导出Excel\"><a href=\"#导出Excel\" class=\"headerlink\" title=\"导出Excel\"></a>导出Excel</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@GetMapping(&quot;export&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> ResponseEntity&lt;Void&gt; <span class=\"title function_\">export</span><span class=\"params\">(HttpServletResponse response)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">    List&lt;User&gt; exportData = userService.findList();</span><br><span class=\"line\">    ExcelUtils.exportExcel(<span class=\"string\">&quot;用户列表&quot;</span>,User.class,exportData,response);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ResponseEntity.ok().build();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>该ExcelUtils导出工具类，导出的是.xlsx后缀类型的Excel文件，如果需要导出.xls后缀类型的文件，需要将工具类中response设置的Content-Disposition属性修改为application/vnd.ms-excel即可。</p>\n</blockquote>\n","categories":["Java"],"tags":["Java","SpringBoot"]},{"title":"Hello World","url":"/2020/03/15/java/hello-world/","content":"<p>欢迎来到我的博客！</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">HelloWorld</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;Hello World!&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n","categories":["Java"],"tags":["Java"]},{"title":"【小剧场】Java注解：斩颜良诛文丑，插标卖首尔","url":"/2021/08/03/java/%E3%80%90%E5%B0%8F%E5%89%A7%E5%9C%BA%E3%80%91Java%E6%B3%A8%E8%A7%A3%EF%BC%9A%E6%96%A9%E9%A2%9C%E8%89%AF%E8%AF%9B%E6%96%87%E4%B8%91%EF%BC%8C%E6%8F%92%E6%A0%87%E5%8D%96%E9%A6%96%E5%B0%94/","content":"<blockquote>\n<p>关公举目一望，谓操曰：”吾观颜良，如插标卖首耳！”</p>\n</blockquote>\n<span id=\"more\"></span>\n<p>Java 注解并不是程序，只是 Java 程序中的一个标识，Java 程序可以通过这个标识进行一些判断，执行不同的计算和流程。</p>\n<p>在 <code>三国演义</code>中，关公说颜良是插标卖首，这个所谓的 <code>标</code> 其实和 Java 中的注解有异曲同工之意，都是在人或者代码的头上标注一个东西。</p>\n<p>现在，我们就用 Java 注解的功能模拟一下关公斩颜良诛文丑的过程吧。</p>\n<h2 id=\"人\"><a href=\"#人\" class=\"headerlink\" title=\"人\"></a>人</h2><p>首先，先创建一个 Person 类，该类代表了所有人，这个类的实例对象，可能是关公，也可能是颜良文丑，也可能只是一个普通的小兵。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Person</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 是否已死亡</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">boolean</span> <span class=\"variable\">die</span> <span class=\"operator\">=</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 是否死亡</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 是否死亡</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">isDie</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">this</span>.die;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 被杀</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">beKilled</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.die = <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 杀人</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> person 被杀的人</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">killed</span><span class=\"params\">(Person... persons)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Person person : persons) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (person != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                person.beKilled();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h2 id=\"标（注解）\"><a href=\"#标（注解）\" class=\"headerlink\" title=\"标（注解）\"></a>标（注解）</h2><p>其次，应该创建一个 Java 注解，这个注解也就是关公所谓的 <code>标</code> ，可以在这个标上添加姓名属性，这样就可以通过这个 <code>标</code> 找到对应的角色。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;- <span class=\"doctag\">@Target</span>(ElementType.FIELD) 该注解只允许在类属性上标注&lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;- <span class=\"doctag\">@Retention</span>(RetentionPolicy.RUNTIME) 该注解保留到运行时&lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;- <span class=\"doctag\">@Inherited</span> 该注解会被子类继承&lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;p&gt;- <span class=\"doctag\">@Documented</span> 该类会被 javadoc 生成的文档显示出来&lt;/p&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Target(ElementType.FIELD)</span></span><br><span class=\"line\"><span class=\"meta\">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class=\"line\"><span class=\"meta\">@Inherited</span></span><br><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> Name &#123;</span><br><span class=\"line\">    String <span class=\"title function_\">value</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> <span class=\"string\">&quot;小兵&quot;</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"战场\"><a href=\"#战场\" class=\"headerlink\" title=\"战场\"></a>战场</h2><p>既然一切准备就绪，那就可以布置战场了，创建一个战争 Java 类表示战场。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 关公举目一望，谓操曰：&quot;吾观颜良，如插标卖首耳！&quot;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">War</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">// 战场中的角色</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">Person</span> <span class=\"variable\">person1</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Person</span>();</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">Person</span> <span class=\"variable\">person2</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Person</span>();</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">Person</span> <span class=\"variable\">person3</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Person</span>();</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">Person</span> <span class=\"variable\">person4</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Person</span>();</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">Person</span> <span class=\"variable\">person5</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Person</span>();</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">Person</span> <span class=\"variable\">person6</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Person</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IllegalAccessException &#123;</span><br><span class=\"line\">        <span class=\"type\">War</span> <span class=\"variable\">war</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">War</span>();</span><br><span class=\"line\">        war.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 战争开始了</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">start</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> IllegalAccessException &#123;</span><br><span class=\"line\">        Person 关羽 = findPerson(<span class=\"string\">&quot;关羽&quot;</span>);</span><br><span class=\"line\">        Person 颜良 = findPerson(<span class=\"string\">&quot;颜良&quot;</span>);</span><br><span class=\"line\">        Person 文丑 = findPerson(<span class=\"string\">&quot;文丑&quot;</span>);</span><br><span class=\"line\">        System.out.println();</span><br><span class=\"line\">        checkStatus();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (关羽 != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            关羽.killed(颜良, 文丑);</span><br><span class=\"line\">            checkStatus();</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;关羽&quot;</span> + (颜良 == <span class=\"literal\">null</span> ? <span class=\"string\">&quot;&quot;</span> : <span class=\"string\">&quot;斩颜良&quot;</span>) + (文丑 == <span class=\"literal\">null</span> ? <span class=\"string\">&quot;&quot;</span> : <span class=\"string\">&quot;诛文丑&quot;</span>));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 通过姓名找到注解标识了姓名的对应角色</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> name 姓名</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 注解标识了姓名的对应角色</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Person <span class=\"title function_\">findPerson</span><span class=\"params\">(String name)</span> <span class=\"keyword\">throws</span> IllegalAccessException &#123;</span><br><span class=\"line\">        Field[] fields = War.class.getDeclaredFields();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Field field : fields) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (field.isAnnotationPresent(Name.class)) &#123;</span><br><span class=\"line\">                <span class=\"type\">Name</span> <span class=\"variable\">annotation</span> <span class=\"operator\">=</span> field.getAnnotation(Name.class);</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (annotation.value().equals(name)) &#123;</span><br><span class=\"line\">                    System.out.print(name + <span class=\"string\">&quot;在战场上\\t&quot;</span>);</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> (Person) field.get(<span class=\"built_in\">this</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.print(name + <span class=\"string\">&quot;不在在战场上\\t&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 检查当前战场上使用注解标注了姓名的角色的生死</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">checkStatus</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> IllegalAccessException &#123;</span><br><span class=\"line\">        Field[] fields = War.class.getDeclaredFields();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Field field : fields) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (field.isAnnotationPresent(Name.class)) &#123;</span><br><span class=\"line\">                <span class=\"type\">Name</span> <span class=\"variable\">annotation</span> <span class=\"operator\">=</span> field.getAnnotation(Name.class);</span><br><span class=\"line\">                <span class=\"type\">Person</span> <span class=\"variable\">person</span> <span class=\"operator\">=</span> (Person) field.get(<span class=\"built_in\">this</span>);</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (person.isDie()) &#123;</span><br><span class=\"line\">                    System.out.print(annotation.value() + <span class=\"string\">&quot;死了\\t&quot;</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    System.out.print(annotation.value() + <span class=\"string\">&quot;活着\\t&quot;</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"开战\"><a href=\"#开战\" class=\"headerlink\" title=\"开战\"></a>开战</h2><h3 id=\"战争开始\"><a href=\"#战争开始\" class=\"headerlink\" title=\"战争开始\"></a>战争开始</h3><p>模拟战争开始，直接先执行 <code>main</code> 方法。</p>\n<p>战争结果：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">关羽不在在战场上\t颜良不在在战场上\t文丑不在在战场上\t</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"颜良进入战场\"><a href=\"#颜良进入战场\" class=\"headerlink\" title=\"颜良进入战场\"></a>颜良进入战场</h3><p>在 <code>War</code> 类的某个 Person 类型的属性上，注解上 <code>@Name(&quot;颜良&quot;)</code>注解，标注姓名。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Name(&quot;颜良&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"type\">Person</span> <span class=\"variable\">person4</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Person</span>();</span><br></pre></td></tr></table></figure>\n\n<p>战争结果：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">关羽不在在战场上\t颜良在战场上\t文丑不在在战场上\t</span><br><span class=\"line\">颜良活着\t</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"关羽进入战场\"><a href=\"#关羽进入战场\" class=\"headerlink\" title=\"关羽进入战场\"></a>关羽进入战场</h3><p>在 <code>War</code> 类的某个 Person 类型的属性上，注解上 <code>@Name(&quot;关羽&quot;)</code>注解，标注姓名。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Name(&quot;关羽&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"type\">Person</span> <span class=\"variable\">person6</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Person</span>();</span><br></pre></td></tr></table></figure>\n\n<p>战争结果：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">关羽在战场上\t颜良在战场上\t文丑不在在战场上\t</span><br><span class=\"line\">颜良活着\t关羽活着\t</span><br><span class=\"line\">颜良死了\t关羽活着\t</span><br><span class=\"line\">关羽斩颜良</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"文丑进入战场\"><a href=\"#文丑进入战场\" class=\"headerlink\" title=\"文丑进入战场\"></a>文丑进入战场</h3><p>在 <code>War</code> 类的某个 Person 类型的属性上，注解上 <code>@Name(&quot;文丑&quot;)</code>注解，标注姓名。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Name(&quot;文丑&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"type\">Person</span> <span class=\"variable\">person5</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Person</span>();</span><br></pre></td></tr></table></figure>\n\n<p>战争结果：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">关羽在战场上\t颜良在战场上\t文丑在战场上\t</span><br><span class=\"line\">颜良活着\t文丑活着\t关羽活着\t</span><br><span class=\"line\">颜良死了\t文丑死了\t关羽活着\t</span><br><span class=\"line\">关羽斩颜良诛文丑</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"战争结束\"><a href=\"#战争结束\" class=\"headerlink\" title=\"战争结束\"></a>战争结束</h2><blockquote>\n<p>关公纵马上山，众将尽皆称贺。公献首级于操前。操曰：“将军真神人也！”</p>\n</blockquote>\n<p>在这段 Java 程序中，Java 代码始终没有任何改变，仅仅只是添加了一些注解，最后的运行结果就完全不一样。这就是 Java 注解的功能，虽然本身不是程序代码的一部分，但是却是代码的标识，可以在程序运行的时候，通过这个标识进行一些判断，执行不同的计算和流程。</p>\n<p>现在的大部分的 Java 框架，都有基于 Java 注解的使用版本，原理都是一样的。</p>\n<p>本身就是在框架中对框架自定义的注解进行了一些程序判断和处理，使用者只需要在一些代码上标识一些注解，程序就可以按照框架的处理逻辑对这些代码进行处理。</p>\n<p>Spring、MyBatis、Hibernate 等框架尽皆如此。</p>\n","categories":["Java"],"tags":["Java"]},{"title":"一篇博客教会你写序列化工具","url":"/2023/02/18/java/%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2%E6%95%99%E4%BC%9A%E4%BD%A0%E5%86%99%E5%BA%8F%E5%88%97%E5%8C%96%E5%B7%A5%E5%85%B7/","content":"<h2 id=\"什么是序列化？\"><a href=\"#什么是序列化？\" class=\"headerlink\" title=\"什么是序列化？\"></a>什么是序列化？</h2><p>总所周知，在Java语言中，所有的数据都是以对象的形式存在Java堆中。</p>\n<p>但是Java对象如果要存储在别的地方，那么单纯的Java对象就无法满足了，必须要将Java对象转为一种可以存储的格式，这个转换的过程就是序列化。</p>\n<p>同理而言，将一种存储的格式转换为Java对象的过程，就是反序列化。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"序列化格式\"><a href=\"#序列化格式\" class=\"headerlink\" title=\"序列化格式\"></a>序列化格式</h2><p>序列化是一种通用的称呼，对于序列化之后转成的数据格式并没有硬性的要求，但是一般都会将格式定为字节数组，或者字符串之类通用的数据格式。</p>\n<p>例如在Java中存在这样一个类：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">Serializable</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> id;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String password;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">float</span> money;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">User</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">User</span><span class=\"params\">(<span class=\"type\">int</span> id, String username, String password, <span class=\"type\">float</span> money)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.id = id;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.username = username;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.password = password;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.money = money;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// get、set、toString等方法省略……</span></span><br></pre></td></tr></table></figure>\n\n<p>使用JDK自带的序列化工具，可以将这样一个Java对象转为字节数组：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>(<span class=\"number\">1</span>, <span class=\"string\">&quot;次时代小羊&quot;</span>, <span class=\"string\">&quot;222222&quot;</span>, <span class=\"number\">99.44F</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">ByteArrayOutputStream</span> <span class=\"variable\">bos</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ByteArrayOutputStream</span>();</span><br><span class=\"line\"><span class=\"type\">ObjectOutputStream</span> <span class=\"variable\">oos</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ObjectOutputStream</span>(bos);</span><br><span class=\"line\">oos.writeObject(user);</span><br><span class=\"line\"><span class=\"type\">byte</span>[] bytes = bos.toByteArray();</span><br><span class=\"line\">System.out.println(<span class=\"string\">&quot;length:&quot;</span> + bytes.length);</span><br><span class=\"line\">System.out.println(<span class=\"string\">&quot;bytes:&quot;</span> + Arrays.toString(bytes));</span><br></pre></td></tr></table></figure>\n\n<p>Java对象序列化后得到的字节数组可以写入数据库，或者文件系统中，以后如果需要使用这个Java对象，可以从数据库或者文件中将字节数组读取出来，重新反序列化为Java对象：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">ByteArrayInputStream</span> <span class=\"variable\">bis</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ByteArrayInputStream</span>(bytes);</span><br><span class=\"line\"><span class=\"type\">ObjectInputStream</span> <span class=\"variable\">ois</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ObjectInputStream</span>(bis);</span><br><span class=\"line\"><span class=\"type\">Object</span> <span class=\"variable\">object</span> <span class=\"operator\">=</span> ois.readObject();</span><br><span class=\"line\">System.out.println(<span class=\"string\">&quot;object:&quot;</span> + object);</span><br></pre></td></tr></table></figure>\n\n<p>但是JDK自带的序列化工具虽然可以将Java对象转换为字节数组，但是这个字节数组是完全按照Java的格式来序列化的，反序列化也需要使用JDK的工具才行。</p>\n<p>所以这种序列化方式只能在Java语言中通用。</p>\n<p>（虽然理论上别的语言平台也可以按照JDK反序列化的方式实现这个工具，但是别人可不会惯着你！）</p>\n<p>即便是在Java平台内部，这种序列化方式也非常笨重，因为在这个序列化得到的字节数组中序列化了非常多的与用户数据无关的对象数据。</p>\n<p>例如上述的<code>user</code>对象中，用户真正关心的数据只有四个，分别是<code>id</code>、<code>username</code>、<code>password</code>、<code>money</code>，至于Java对象内部是一些数据，并不是用户真正关心的。</p>\n<p>这个时候，我们就追求一种简洁明了，而且跨平台通用的序列化格式。</p>\n<h2 id=\"JSON序列化\"><a href=\"#JSON序列化\" class=\"headerlink\" title=\"JSON序列化\"></a>JSON序列化</h2><p>在Java的早起，XML作为一种可扩展标记语言，因为它的平台无关性、可扩展性、数据遵循严格的格式，人类可读等优点，得到了Java开发者的青睐。</p>\n<p>早期XML在Java中大行其道，很多Java对象最终都会被序列化为XML文本存储或者转发。</p>\n<p>因为其具有平台无关性，很多语言平台或第三方库也纷纷实现了XML的标准。</p>\n<p>不过伴随着JSON格式的数据的崛起，JSON很快就取代了XML的地位，XML具有的优点JSON都具有，而且比XML更加简洁，文本更小。</p>\n<p>使用第三方类库Jackson，将一个Java对象序列化为字符串或者字节数组：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>(<span class=\"number\">1</span>, <span class=\"string\">&quot;次时代小羊&quot;</span>, <span class=\"string\">&quot;222222&quot;</span>, <span class=\"number\">99.44F</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">ObjectMapper</span> <span class=\"variable\">objectMapper</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ObjectMapper</span>();</span><br><span class=\"line\"><span class=\"type\">byte</span>[] bytes1 = objectMapper.writeValueAsBytes(user);</span><br><span class=\"line\">System.out.println(<span class=\"string\">&quot;length:&quot;</span> + bytes1.length);</span><br><span class=\"line\">System.out.println(<span class=\"string\">&quot;bytes:&quot;</span> + Arrays.toString(bytes1));</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">String</span> <span class=\"variable\">json</span> <span class=\"operator\">=</span> objectMapper.writeValueAsString(user);</span><br><span class=\"line\">System.out.println(<span class=\"string\">&quot;length:&quot;</span> + json.length());</span><br><span class=\"line\">System.out.println(<span class=\"string\">&quot;json:&quot;</span> + json);</span><br></pre></td></tr></table></figure>\n\n<p>Jackson序列化得到的字符串或者字节数组，同样可以存储到数据库，或者通过网络转发出去，并被支持JSON格式的语言平台解析。</p>\n<blockquote>\n<p>Jackson序列化为字符串和字节数组本质上并没有区别，序列化为字节数组，其实就是将序列化得到的字符串转为字节数组。</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user1</span> <span class=\"operator\">=</span> objectMapper.readValue(bytes1, User.class);</span><br><span class=\"line\">System.out.println(<span class=\"string\">&quot;user1:&quot;</span> + user1);</span><br><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user2</span> <span class=\"operator\">=</span> objectMapper.readValue(json, User.class);</span><br><span class=\"line\">System.out.println(<span class=\"string\">&quot;user2:&quot;</span> + user2);</span><br></pre></td></tr></table></figure>\n\n<p>JSON序列化是目前一种比较理想的序列化方式，各种语言平台，甚至是数据库都对JSON格式的数据有支持。</p>\n<h2 id=\"精简序列化数据\"><a href=\"#精简序列化数据\" class=\"headerlink\" title=\"精简序列化数据\"></a>精简序列化数据</h2><p>我们先来看一下使用Jackson序列化得到的字符串和字节数组数据：</p>\n<figure class=\"highlight json\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span><span class=\"attr\">&quot;id&quot;</span><span class=\"punctuation\">:</span><span class=\"number\">1</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;username&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;次时代小羊&quot;</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;password&quot;</span><span class=\"punctuation\">:</span><span class=\"string\">&quot;222222&quot;</span><span class=\"punctuation\">,</span><span class=\"attr\">&quot;money&quot;</span><span class=\"punctuation\">:</span><span class=\"number\">99.44</span><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n<table>\n    <tr>\n        <td>123</td>\n        <td>34</td>\n        <td>105</td>\n        <td>100</td>\n        <td>34</td>\n        <td>58</td>\n        <td>49</td>\n        <td>44</td>\n        <td>34</td>\n        <td>117</td>\n    </tr>\n    <tr>\n        <td>{</td>\n        <td>\"</td>\n        <td>i</td>\n        <td>d</td>\n        <td>\"</td>\n        <td>:</td>\n        <td>1</td>\n        <td>,</td>\n        <td>\"</td>\n        <td>u</td>\n    </tr>\n    <tr>\n        <td>115</td>\n        <td>101</td>\n        <td>114</td>\n        <td>110</td>\n        <td>97</td>\n        <td>109</td>\n        <td>101</td>\n        <td>34</td>\n        <td>58</td>\n        <td>34</td>\n    </tr>\n    <tr>\n        <td>s</td>\n        <td>e</td>\n        <td>r</td>\n        <td>n</td>\n        <td>a</td>\n        <td>m</td>\n        <td>e</td>\n        <td>\"</td>\n        <td>:</td>\n        <td>\"</td>\n    </tr>\n    <tr>\n        <td>-26</td>\n        <td>-84</td>\n        <td>-95</td>\n        <td>-26</td>\n        <td>-105</td>\n        <td>-74</td>\n        <td>-28</td>\n        <td>-69</td>\n        <td>-93</td>\n        <td>-27</td>\n    </tr>\n    <tr>\n        <td colspan=\"3\">次</td>\n        <td colspan=\"3\">时</td>\n        <td colspan=\"3\">代</td>\n        <td></td>\n    </tr>\n    <tr>\n        <td>-113</td>\n        <td>-84</td>\n        <td>-25</td>\n        <td>-66</td>\n        <td>-118</td>\n        <td>34</td>\n        <td>44</td>\n        <td>34</td>\n        <td>112</td>\n        <td>97</td>\n    </tr>\n    <tr>\n        <td colspan=\"2\">小</td>\n        <td colspan=\"3\">羊</td>\n        <td>\"</td>\n        <td>,</td>\n        <td>\"</td>\n        <td>p</td>\n        <td>a</td>\n    </tr>\n    <tr>\n        <td>115</td>\n        <td>115</td>\n        <td>119</td>\n        <td>111</td>\n        <td>114</td>\n        <td>100</td>\n        <td>34</td>\n        <td>58</td>\n        <td>34</td>\n        <td>50</td>\n    </tr>\n    <tr>\n        <td>s</td>\n        <td>s</td>\n        <td>w</td>\n        <td>o</td>\n        <td>r</td>\n        <td>d</td>\n        <td>\"</td>\n        <td>:</td>\n        <td>\"</td>\n        <td>2</td>\n    </tr>\n    <tr>\n        <td>50</td>\n        <td>50</td>\n        <td>50</td>\n        <td>50</td>\n        <td>50</td>\n        <td>34</td>\n        <td>44</td>\n        <td>34</td>\n        <td>109</td>\n        <td>111</td>\n    </tr>\n    <tr>\n        <td>2</td>\n        <td>2</td>\n        <td>2</td>\n        <td>2</td>\n        <td>2</td>\n        <td>\"</td>\n        <td>,</td>\n        <td>\"</td>\n        <td>m</td>\n        <td>o</td>\n    </tr>\n    <tr>\n        <td>110</td>\n        <td>101</td>\n        <td>121</td>\n        <td>34</td>\n        <td>58</td>\n        <td>57</td>\n        <td>57</td>\n        <td>46</td>\n        <td>52</td>\n        <td>52</td>\n    </tr>\n    <tr>\n        <td>n</td>\n        <td>e</td>\n        <td>y</td>\n        <td>\"</td>\n        <td>:</td>\n        <td>9</td>\n        <td>9</td>\n        <td>.</td>\n        <td>4</td>\n        <td>4</td>\n    </tr>\n    <tr>\n        <td>125</td>\n    </tr>\n    <tr>\n        <td>}</td>\n    </tr>\n</table>\n\n\n<p>以上就是使用Jackson序列化得到的字符串，以及字节数组和字符串字符的对应表，其中中文字符使用三个字节表示。</p>\n<p>按照上面的对照表，我们可以知道序列化为字节数组的时候，JSON格式的字符串都序列化了哪些内容。</p>\n<p>而我们前面也说过，用户真正关心的数据只有四个，分别是<code>id</code>、<code>username</code>、<code>password</code>、<code>money</code>，而这四个数据的名称（字段名）对于数据本身而言，只是做一个定位的作用。</p>\n<p>如果我们可以预先确定序列化数据的字段顺序，而后反序列化的时候也已同样的顺序进行解析，是否就能够抛弃JSON格式中的字段名称，只将数据本身进行序列化？</p>\n<p>比如将JSON格式的字符串缩减成下面的形式：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">1</span>次时代小羊<span class=\"number\">22222299.44</span></span><br></pre></td></tr></table></figure>\n\n<p>但是这也有一个问题，那就是我们无法确定每个数据的长度，比如<code>username</code>这个字段，它对应的值到底是<code>次时代小羊</code>，还是<code>次时代小羊222222</code>，甚至可能还是<code>次时代小羊22222299.44</code>？</p>\n<p>所以为了确定数据的长度，我们还必须加入数据的长度作为表示，因为数据的长度都可以使用整形类型的数据进行表示。</p>\n<p>比如我们可以约定，字符开始的第一个小于等于9的数字为数据长度，我们这样就可以很清晰的定位并分隔数据。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">115</span>次时代小羊<span class=\"number\">6222222599.44</span></span><br></pre></td></tr></table></figure>\n\n<p>当然，这只是字符串可以这样表示，如果使用字节数组，那么我们可以根据单个数据的最大字节数，约定<code>byte</code>或者<code>int</code>类型的数据来表示长度。</p>\n<blockquote>\n<p><code>byte</code>支持单个数据的字节数组长度为255（2 ^ 8-1），<code>int</code>支持单个数据的字节数组长度为4294967295（2 ^ 32-1），因为数据长度只可能为正整数，所以使用无符号数可以最大程度支持。</p>\n</blockquote>\n<p>而且一些特定类型的数据长度我们可以不需要确定，一些语言平台已经规定了这些数据类型的字节长度，比如在Java语言中，<code>int</code>、<code>float</code>类型的数据长度为4，那么我们只需要规定一些不确定的数据的字节长度即可，比如字符串类型，字节数组类型等等。</p>\n<p>我们可以重新设计简化格式：</p>\n<table>\n<thead>\n<tr>\n<th>长度</th>\n<th>数据</th>\n<th>类型</th>\n<th>是否需要确定数据长度</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>4</td>\n<td>1</td>\n<td>int</td>\n<td>语言平台规定，不需要</td>\n<td>int类型的数据字节长度为4</td>\n</tr>\n<tr>\n<td>15</td>\n<td>次时代小羊</td>\n<td>字符串</td>\n<td>需要</td>\n<td>UTF-8编码下一个中文字节长度为3（或者4）</td>\n</tr>\n<tr>\n<td>6</td>\n<td>222222</td>\n<td>字符串</td>\n<td>需要</td>\n<td>UTF-8编码兼容ASCII编码，所以长度为6</td>\n</tr>\n<tr>\n<td>4</td>\n<td>99.44</td>\n<td>float</td>\n<td>语言平台规定，不需要</td>\n<td>float类型的数据字节长度为4</td>\n</tr>\n</tbody></table>\n<p>数据总长度为29，加上一共四个数据，每个数据对应的字节数组长度各占一个<code>int</code>类型数据的字节长度，所以最终长度为37（29+4+4）。</p>\n<p>最终得到序列化后的字节数组：</p>\n<table>\n    <tr>\n        <td>1</td>\n        <td>0</td>\n        <td>0</td>\n        <td>0</td>\n        <td>15</td>\n        <td>0</td>\n        <td>0</td>\n        <td>0</td>\n    </tr>\n    <tr>\n        <td colspan=\"4\">1</td>\n        <td colspan=\"4\">15</td>\n    </tr>\n    <tr>\n        <td>-26</td>\n        <td>-84</td>\n        <td>-95</td>\n        <td>-26</td>\n        <td>-105</td>\n        <td>-74</td>\n        <td>-28</td>\n        <td>-69</td>\n    </tr>\n    <tr>\n        <td colspan=\"3\">次</td>\n        <td colspan=\"3\">时</td>\n        <td colspan=\"2\">代</td>\n    </tr>\n    <tr>\n        <td>-93</td>\n        <td>-27</td>\n        <td>-80</td>\n        <td>-113</td>\n        <td>-25</td>\n        <td>-66</td>\n        <td>-118</td>\n        <td>6</td>\n    </tr>\n    <tr>\n        <td></td>\n        <td colspan=\"3\">小</td>\n        <td colspan=\"3\">羊</td>\n        <td>6</td>\n    </tr>\n    <tr>\n        <td>0</td>\n        <td>0</td>\n        <td>0</td>\n        <td>50</td>\n        <td>50</td>\n        <td>50</td>\n        <td>50</td>\n        <td>50</td>\n    </tr>\n    <tr>\n        <td colspan=\"3\"></td>\n        <td>2</td>\n        <td>2</td>\n        <td>2</td>\n        <td>2</td>\n        <td>2</td>\n    </tr>\n    <tr>\n        <td>50</td>\n        <td>72</td>\n        <td>-31</td>\n        <td>-58</td>\n        <td>66</td>\n    </tr>\n    <tr>\n        <td>2</td>\n        <td colspan=\"4\">99.44</td>\n    </tr>\n</table>\n\n<p>得到序列化后的字节数组之后，反序列化只需要按照原定的顺序，即可正确读取数据。</p>\n<p>比如：</p>\n<ul>\n<li><p>1、读取int类型的字段<code>id</code>数据，得到数据值：1</p>\n</li>\n<li><p>2、读取字符串类型的字段<code>username</code>数据对应的字节数组长度，得到数据值：15</p>\n<ul>\n<li>2.1、向后读取长度为15的字节数组，得到数据值：次时代小羊</li>\n</ul>\n</li>\n<li><p>3、读取字符串类型的字段<code>password</code>数据对应的字节数组长度，得到数据值：6</p>\n<ul>\n<li>3.1、向后读取长度为6的字节数组，得到数据值：222222</li>\n</ul>\n</li>\n<li><p>4、读取float类型的字段<code>money</code>数据，得到数据值：99.44</p>\n</li>\n</ul>\n<p>至此，精简序列化数据的方式都可以正确序列化和反序列化，而且序列化得到的字节数组长度更小。</p>\n<p>Google的<code>ProtoBuf</code>和开源的<code>MessagePack</code>其实都是使用了类似的精简序列化的方式，不过这些开源的序列化框架更加成熟可靠，内部的实现细节也更加全面。</p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>以上三种序列化方式，各有优点，也各有缺点，我们在这里总结一下：</p>\n<table>\n<thead>\n<tr>\n<th>序列化方式</th>\n<th>JDK序列化</th>\n<th>JSON序列化</th>\n<th>精简序列化</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>序列化结果</td>\n<td>字节数组</td>\n<td>字符串或者字节数组</td>\n<td>字节数组</td>\n</tr>\n<tr>\n<td>是否支持跨平台</td>\n<td>不支持</td>\n<td>支持</td>\n<td>支持</td>\n</tr>\n<tr>\n<td>是否需要额外约定</td>\n<td>不需要</td>\n<td>不需要</td>\n<td>需要</td>\n</tr>\n<tr>\n<td>人类可读性</td>\n<td>差</td>\n<td>优秀</td>\n<td>差</td>\n</tr>\n<tr>\n<td>优点</td>\n<td>JDK自带，无需第三方依赖，对Java语言开发者友好</td>\n<td>全平台通用，序列化结果简洁工整，人类可读性强</td>\n<td>全平台通用，序列化结果精简</td>\n</tr>\n<tr>\n<td>缺点</td>\n<td>只支持JDK平台，序列化结果笨重</td>\n<td>一些语言平台不支持JSON格式，需要第三方库</td>\n<td>扩展性较差，在需要改动序列化对象的时候，序列化和反序列化方式也需要同时改动</td>\n</tr>\n</tbody></table>\n<p>以上三种序列化方式的优缺点已经一一列名，我们可以根据自身需要进行选择。</p>\n<p>如果你进行的是一些通信软件、游戏等等对网络性能要求高，且通信格式并不会发生重大改变的开发工作，那么可以考虑选择第三种精简序列化的方式，开源平台上也有很多这种类型的序列化框架的实现，比如前面提到过的<code>ProtoBuf</code>和<code>MessagePack</code>等等。</p>\n<p>如果你进行是一些Web网站等一些扩展性要求较高的开发工作，那么建议选择JSON序列化的方式，即便是一些不支持<code>JSON</code>格式的语言平台，同样有很多优秀的第三方库对其进行了支持，比如<code>Jackson</code>等等。</p>\n<p>至于JDK序列化的方式，如果你有兴趣，或者开发的项目本身不支持其他序列化方式，那么也是一个不错的选择<del>~</del></p>\n<h2 id=\"源码\"><a href=\"#源码\" class=\"headerlink\" title=\"源码\"></a>源码</h2><p>在文章的最后，我在这里附上一个本人使用<code>Java</code>写的简单的序列化工具，有兴趣的同学可以参考一下。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Bytes</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">ONE_LENGTH</span> <span class=\"operator\">=</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">TWO_LENGTH</span> <span class=\"operator\">=</span> ONE_LENGTH &lt;&lt; <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">FOUR_LENGTH</span> <span class=\"operator\">=</span> ONE_LENGTH &lt;&lt; <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">int</span> <span class=\"variable\">EIGHT_LENGTH</span> <span class=\"operator\">=</span> ONE_LENGTH &lt;&lt; <span class=\"number\">3</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">byte</span> <span class=\"variable\">BOOLEAN_TRUE</span> <span class=\"operator\">=</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">byte</span> <span class=\"variable\">BOOLEAN_FALSE</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">byte</span>[] data;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> readIndex;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"type\">int</span> writeIndex;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">Bytes</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.readIndex = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.writeIndex = <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">Bytes</span><span class=\"params\">(<span class=\"type\">byte</span>[] bytes)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.data = bytes;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.readIndex = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.writeIndex = bytes.length;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">byte</span>[] getData() &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> data;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">byte</span> <span class=\"title function_\">readByte</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">byte</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> data[readIndex];</span><br><span class=\"line\">        readIndex += ONE_LENGTH;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">short</span> <span class=\"title function_\">readShort</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">short</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; TWO_LENGTH; i++) &#123;</span><br><span class=\"line\">            value = (<span class=\"type\">short</span>) (value | (data[i + readIndex] &amp; <span class=\"number\">0xFF</span>) &lt;&lt; i * <span class=\"number\">8</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        readIndex += TWO_LENGTH;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">int</span> <span class=\"title function_\">readInt</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; FOUR_LENGTH; i++) &#123;</span><br><span class=\"line\">            value = value | (data[i + readIndex] &amp; <span class=\"number\">0xFF</span>) &lt;&lt; i * <span class=\"number\">8</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        readIndex += FOUR_LENGTH;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">long</span> <span class=\"title function_\">readLong</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; EIGHT_LENGTH; i++) &#123;</span><br><span class=\"line\">            value = value | (data[i + readIndex] &amp; <span class=\"number\">0xFFL</span>) &lt;&lt; i * <span class=\"number\">8</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        readIndex += EIGHT_LENGTH;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">boolean</span> <span class=\"title function_\">readBoolean</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">byte</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> data[readIndex];</span><br><span class=\"line\">        readIndex += ONE_LENGTH;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> value == BOOLEAN_TRUE;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">char</span> <span class=\"title function_\">readChar</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">char</span> <span class=\"variable\">value</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; TWO_LENGTH; i++) &#123;</span><br><span class=\"line\">            value += data[i + readIndex] &lt;&lt; i * <span class=\"number\">8</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        readIndex += TWO_LENGTH;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> value;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">float</span> <span class=\"title function_\">readFloat</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">intValue</span> <span class=\"operator\">=</span> readInt();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Float.intBitsToFloat(intValue);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">double</span> <span class=\"title function_\">readDouble</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">longValue</span> <span class=\"operator\">=</span> readLong();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Double.longBitsToDouble(longValue);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"type\">byte</span>[] readBytes(<span class=\"type\">int</span> length) &#123;</span><br><span class=\"line\">        <span class=\"type\">byte</span>[] tempBytes = <span class=\"keyword\">new</span> <span class=\"title class_\">byte</span>[length];</span><br><span class=\"line\">        System.arraycopy(data, readIndex, tempBytes, <span class=\"number\">0</span>, length);</span><br><span class=\"line\">        readIndex += length;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> tempBytes;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">writeByte</span><span class=\"params\">(<span class=\"type\">byte</span> value)</span> &#123;</span><br><span class=\"line\">        expansion(ONE_LENGTH);</span><br><span class=\"line\">        data[writeIndex] = value;</span><br><span class=\"line\">        writeIndex += ONE_LENGTH;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">writeShort</span><span class=\"params\">(<span class=\"type\">short</span> value)</span> &#123;</span><br><span class=\"line\">        expansion(TWO_LENGTH);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; TWO_LENGTH; i++) &#123;</span><br><span class=\"line\">            data[i + writeIndex] = (<span class=\"type\">byte</span>) (value &gt;&gt; i * <span class=\"number\">8</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        writeIndex += TWO_LENGTH;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">writeInt</span><span class=\"params\">(<span class=\"type\">int</span> value)</span> &#123;</span><br><span class=\"line\">        expansion(FOUR_LENGTH);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; FOUR_LENGTH; i++) &#123;</span><br><span class=\"line\">            data[i + writeIndex] = (<span class=\"type\">byte</span>) (value &gt;&gt; i * <span class=\"number\">8</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        writeIndex += FOUR_LENGTH;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">writeLong</span><span class=\"params\">(<span class=\"type\">long</span> value)</span> &#123;</span><br><span class=\"line\">        expansion(EIGHT_LENGTH);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; EIGHT_LENGTH; i++) &#123;</span><br><span class=\"line\">            data[i + writeIndex] = (<span class=\"type\">byte</span>) (value &gt;&gt; i * <span class=\"number\">8</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        writeIndex += EIGHT_LENGTH;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">writeBoolean</span><span class=\"params\">(<span class=\"type\">boolean</span> value)</span> &#123;</span><br><span class=\"line\">        expansion(ONE_LENGTH);</span><br><span class=\"line\">        data[writeIndex] = value ? BOOLEAN_TRUE : BOOLEAN_FALSE;</span><br><span class=\"line\">        writeIndex += ONE_LENGTH;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">writeChar</span><span class=\"params\">(<span class=\"type\">char</span> value)</span> &#123;</span><br><span class=\"line\">        expansion(TWO_LENGTH);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; TWO_LENGTH; i++) &#123;</span><br><span class=\"line\">            data[i + writeIndex] = (<span class=\"type\">byte</span>) (value &gt;&gt; i * <span class=\"number\">8</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        writeIndex += TWO_LENGTH;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">writeFloat</span><span class=\"params\">(<span class=\"type\">float</span> value)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">intValue</span> <span class=\"operator\">=</span> Float.floatToIntBits(value);</span><br><span class=\"line\">        writeInt(intValue);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">writeDouble</span><span class=\"params\">(<span class=\"type\">double</span> value)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">long</span> <span class=\"variable\">longValue</span> <span class=\"operator\">=</span> Double.doubleToLongBits(value);</span><br><span class=\"line\">        writeLong(longValue);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">writeBytes</span><span class=\"params\">(<span class=\"type\">byte</span>[] bytes)</span> &#123;</span><br><span class=\"line\">        expansion(bytes.length);</span><br><span class=\"line\">        System.arraycopy(bytes, <span class=\"number\">0</span>, data, writeIndex, bytes.length);</span><br><span class=\"line\">        writeIndex += bytes.length;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">expansion</span><span class=\"params\">(<span class=\"type\">int</span> length)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"built_in\">this</span>.data == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">            data = <span class=\"keyword\">new</span> <span class=\"title class_\">byte</span>[length];</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"type\">byte</span>[] tempBytes = <span class=\"keyword\">new</span> <span class=\"title class_\">byte</span>[data.length + length];</span><br><span class=\"line\">            System.arraycopy(data, <span class=\"number\">0</span>, tempBytes, <span class=\"number\">0</span>, data.length);</span><br><span class=\"line\">            data = tempBytes;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>再附带上一份序列化的代码。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>(<span class=\"number\">1</span>, <span class=\"string\">&quot;次时代小羊&quot;</span>, <span class=\"string\">&quot;222222&quot;</span>, <span class=\"number\">99.44F</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">Bytes</span> <span class=\"variable\">bytes3</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Bytes</span>();</span><br><span class=\"line\">bytes3.writeInt(user.getId());</span><br><span class=\"line\"><span class=\"type\">byte</span>[] usernameByte = user.getUsername().getBytes(StandardCharsets.UTF_8);</span><br><span class=\"line\">bytes3.writeInt(usernameByte.length);</span><br><span class=\"line\">bytes3.writeBytes(usernameByte);</span><br><span class=\"line\"><span class=\"type\">byte</span>[] passwordByte = user.getPassword().getBytes(StandardCharsets.UTF_8);</span><br><span class=\"line\">bytes3.writeInt(passwordByte.length);</span><br><span class=\"line\">bytes3.writeBytes(passwordByte);</span><br><span class=\"line\">bytes3.writeFloat(user.getMoney());</span><br><span class=\"line\">System.out.println(<span class=\"string\">&quot;length:&quot;</span> + bytes3.getData().length);</span><br><span class=\"line\">System.out.println(<span class=\"string\">&quot;bytes:&quot;</span> + Arrays.toString(bytes3.getData()));</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">User</span> <span class=\"variable\">user3</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>();</span><br><span class=\"line\">user3.setId(bytes3.readInt());</span><br><span class=\"line\"><span class=\"type\">int</span> <span class=\"variable\">usernameBytesLength</span> <span class=\"operator\">=</span> bytes3.readInt();</span><br><span class=\"line\">user3.setUsername(<span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(bytes3.readBytes(usernameBytesLength)));</span><br><span class=\"line\"><span class=\"type\">int</span> <span class=\"variable\">passwordBytesLength</span> <span class=\"operator\">=</span> bytes3.readInt();</span><br><span class=\"line\">user3.setPassword(<span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(bytes3.readBytes(passwordBytesLength)));</span><br><span class=\"line\">user3.setMoney(bytes3.readFloat());</span><br><span class=\"line\">System.out.println(<span class=\"string\">&quot;user3:&quot;</span> + user3);</span><br></pre></td></tr></table></figure>\n\n<p>最后的最后，瑞思拜<del>~</del></p>\n","categories":["Java"],"tags":["Java"]},{"title":"上班聊天，摸鱼神器，手写一款即时通讯工具（附源码！！！）","url":"/2021/08/07/java/%E4%B8%8A%E7%8F%AD%E8%81%8A%E5%A4%A9%EF%BC%8C%E6%91%B8%E9%B1%BC%E7%A5%9E%E5%99%A8%EF%BC%8C%E6%89%8B%E5%86%99%E4%B8%80%E6%AC%BE%E5%8D%B3%E6%97%B6%E9%80%9A%E8%AE%AF%E5%B7%A5%E5%85%B7%EF%BC%88%E9%99%84%E6%BA%90%E7%A0%81%EF%BC%81%EF%BC%81%EF%BC%81%EF%BC%89/","content":"<blockquote>\n<p>认真工作不叫做赚钱，那叫做用劳动换取报酬，上班摸鱼才是真的赚钱。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<p><img src=\"/images/2023/02/100002.gif\" alt=\"img\"></p>\n<h1 id=\"即时通讯工具\"><a href=\"#即时通讯工具\" class=\"headerlink\" title=\"即时通讯工具\"></a>即时通讯工具</h1><p>如果上班有空闲时间，最喜欢做的事情自然是和熟悉的朋友一起聊聊天，互相吐槽工作中遇到的人和事，缓解工作的压力。</p>\n<p>如果直接在桌面上打开 QQ 或者微信，那目标无疑是巨大的，QQ 和微信的桌面客户端明晃晃地占据整个电脑桌面，只要有同事或者领导从你身边经过，或是在你后面看一眼，就立刻能够知道你在上班摸鱼，那场面不亚于公开处刑…… (＠_＠)</p>\n<blockquote>\n<p>领导：看来工作还是不饱和啊 ┑(￣Д ￣)┍</p>\n</blockquote>\n<p>针对这种情况，技术人自然不甘落后，总是可以想出各种方法躲避同事和领导发现你在上班摸鱼 ≡ω≡</p>\n<p>思量再三，最终还是放弃了 IDEA 的各种插件，转而决定还是自己手写一款简易的即时通信工具。</p>\n<p>既然要自己动手，那自然也要先对这款即时通讯工具做个简单的规划。</p>\n<ul>\n<li>这款即时通讯工具分为客户端和服务端的，每个用户可以使用客户端进行即时通讯。</li>\n<li>通讯工具尽可能简单，只依赖于 JDK，即完全使用 Java 网络编程功能实现，不依赖其他的第三方库。</li>\n<li>通讯工具不需要桌面，使用 Java 自带的 Scanner 控制台输入即可。</li>\n</ul>\n<p>这样一款基于 Java 网络编程的即时通讯工具，只要在 IDEA 运行客户端代码，即可在控制台与其他朋友快乐地聊天。只要不是同事或者领导贴着你的电脑屏幕观看，他绝对想不到你是在使用 IDEA 上班摸鱼聊天。</p>\n<p><img src=\"/images/2023/02/100001.jpg\" alt=\"img\"></p>\n<h1 id=\"客户端\"><a href=\"#客户端\" class=\"headerlink\" title=\"客户端\"></a>客户端</h1><p>客户端是给使用这款即时通讯工具的用户使用的，从安全和用户体验的角度上来说，客户端应该尽可能精简，只负责发送和接受数据即可。</p>\n<p>因为这是一款即时通讯工具，客户端需要做的有两件事：</p>\n<ul>\n<li>监听客户端的输入和发送。</li>\n<li>监听服务端发送过来的消息。</li>\n</ul>\n<p>因为我们使用 JDK 自带的 Scanner 类来进行客户端的输入，而这个输入是一个阻塞的操作，所以我们需要创建一条额外的线程来进行服务端的监听工作。</p>\n<p>客户端需要两条用户线程：</p>\n<ul>\n<li>main 线程用来监听客户端的输入和发送。</li>\n<li>另外创建一条线程用来监听服务端的消息发送。</li>\n</ul>\n<p>思路已经设计好了，可以使用代码来实现了：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 聊天室客户端</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> herenpeng</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2021-07-09 12:00:00</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ChatClient</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> (<span class=\"type\">Socket</span> <span class=\"variable\">socket</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Socket</span>(<span class=\"string\">&quot;127.0.0.1&quot;</span>, <span class=\"number\">12345</span>)) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 读取服务端发的消息</span></span><br><span class=\"line\">            <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; readMsg(socket)).start();</span><br><span class=\"line\">            <span class=\"type\">OutputStream</span> <span class=\"variable\">os</span> <span class=\"operator\">=</span> socket.getOutputStream();</span><br><span class=\"line\">            <span class=\"type\">Scanner</span> <span class=\"variable\">scanner</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Scanner</span>(System.in);</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;请输入您的聊天室昵称：&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">                <span class=\"type\">String</span> <span class=\"variable\">chat</span> <span class=\"operator\">=</span> scanner.next();</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;---------------------------&quot;</span>);</span><br><span class=\"line\">                os.write(chat.getBytes());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;【系统消息】聊天室炸了，BUG之神降临了&quot;</span>);</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">            System.exit(<span class=\"number\">0</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">readMsg</span><span class=\"params\">(Socket socket)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">                <span class=\"type\">InputStream</span> <span class=\"variable\">is</span> <span class=\"operator\">=</span> socket.getInputStream();</span><br><span class=\"line\">                <span class=\"type\">byte</span>[] bytes = <span class=\"keyword\">new</span> <span class=\"title class_\">byte</span>[<span class=\"number\">1024</span>];</span><br><span class=\"line\">                <span class=\"type\">int</span> <span class=\"variable\">len</span> <span class=\"operator\">=</span> is.read(bytes);</span><br><span class=\"line\">                System.out.println(<span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(bytes, <span class=\"number\">0</span>, len));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;【系统消息】你已退出聊天室，开始认真工作吧&quot;</span>);</span><br><span class=\"line\">            System.exit(<span class=\"number\">0</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h1 id=\"服务端\"><a href=\"#服务端\" class=\"headerlink\" title=\"服务端\"></a>服务端</h1><p>服务端的设计比客户端要困难很多，为了便于开发和理解，我直接使用了 Java 阻塞式的网络 IO 来进行实现，即每一个客户端连接都创建一个线程来进行处理。</p>\n<p>这种阻塞式的网络 IO 的<strong>好处</strong>在于便于理解和开发，而<strong>缺点</strong>也非常明显，因为这是一个通讯工具，即每一个链接都是长链接。</p>\n<p>即每个客户端用户链接服务端后，都会在服务端专门有一个线程处理这个客户端相关的网络 IO 操作。如果用户量少的情况下还比较好，但是用户一旦多了起来，服务端将会创建 N 多个线程，而且在客户端不主动断开的情况下，服务器这些线程会一直占用服务器资源，服务器将会消费非常大的资源，而且很容易崩溃。</p>\n<blockquote>\n<p>基于这种情况，我后面也实现了一个 Java NIO 版本的客户端和服务端，在文章末尾也会一起附上源码。</p>\n</blockquote>\n<p><img src=\"/images/2023/02/100003.jpg\" alt=\"img\"></p>\n<p>我将服务端的操作分为两个步骤：</p>\n<h2 id=\"1、链接\"><a href=\"#1、链接\" class=\"headerlink\" title=\"1、链接\"></a>1、链接</h2><p>服务端阻塞地等待客户端的链接请求。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 聊天室服务端</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> herenpeng</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2021-07-09 12:00:00</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ChatServer</span> &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 启动类</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> args 启动参数</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> IOException 抛出IO异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">        <span class=\"type\">ServerSocket</span> <span class=\"variable\">server</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ServerSocket</span>(<span class=\"number\">12345</span>);</span><br><span class=\"line\">        <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; start(server)).start();</span><br><span class=\"line\">        <span class=\"comment\">// 加载配置</span></span><br><span class=\"line\">        CHAT_CFG_RELOAD_PASSWORD = UUID.randomUUID().toString();</span><br><span class=\"line\">        logInfo(<span class=\"string\">&quot;【系统消息】聊天室配置加载密钥：&quot;</span> + CHAT_CFG_RELOAD_PASSWORD);</span><br><span class=\"line\">        reloadChatCfg(args.length == <span class=\"number\">1</span> ? args[<span class=\"number\">0</span>] : <span class=\"literal\">null</span>, <span class=\"literal\">null</span>);</span><br><span class=\"line\">        logInfo(<span class=\"string\">&quot;【系统消息】聊天室启动成功了！&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 服务开始方法</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> server 服务对象</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">start</span><span class=\"params\">(ServerSocket server)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 链接操作</span></span><br><span class=\"line\">                <span class=\"type\">ChatSocket</span> <span class=\"variable\">chatSocket</span> <span class=\"operator\">=</span> connection(server);</span><br><span class=\"line\">                <span class=\"comment\">// 登录操作</span></span><br><span class=\"line\">                login(chatSocket);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            logInfo(<span class=\"string\">&quot;【系统消息】聊天室发生了异常……&quot;</span>);</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            logInfo(<span class=\"string\">&quot;【系统消息】正在关闭聊天室资源……&quot;</span>);</span><br><span class=\"line\">            close(server);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 链接客户端</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> server 服务对象</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> ChatSocket 对象</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> IOException 抛出异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> ChatSocket <span class=\"title function_\">connection</span><span class=\"params\">(ServerSocket server)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">        <span class=\"type\">Socket</span> <span class=\"variable\">socket</span> <span class=\"operator\">=</span> server.accept();</span><br><span class=\"line\">        <span class=\"type\">ChatSocket</span> <span class=\"variable\">chatSocket</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ChatSocket</span>(socket);</span><br><span class=\"line\">        userDB.add(chatSocket);</span><br><span class=\"line\">        sendMsgToUser(socket, <span class=\"string\">&quot;============================\\n&quot;</span> +</span><br><span class=\"line\">                      <span class=\"string\">&quot;1、本聊天室仅为娱乐，请勿在该聊天室内谈论敏感内容，比如涉政，涉黄，账号密码等等！\\n&quot;</span> +</span><br><span class=\"line\">                      <span class=\"string\">&quot;2、聊天室内容明文传输，聊天信息泄露本聊天室概不负责！\\n&quot;</span> +</span><br><span class=\"line\">                      <span class=\"string\">&quot;3、本聊天室内容后台不做任何存储，聊天信息如果需要请自行保留！\\n&quot;</span> +</span><br><span class=\"line\">                      <span class=\"string\">&quot;4、最终解释权归本聊天室所有！\\n&quot;</span> +</span><br><span class=\"line\">                      <span class=\"string\">&quot;============================&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> chatSocket;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 保存所有用户socket的集合</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> List&lt;ChatSocket&gt; userDB = <span class=\"keyword\">new</span> <span class=\"title class_\">LinkedList</span>&lt;&gt;();</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"2、登录\"><a href=\"#2、登录\" class=\"headerlink\" title=\"2、登录\"></a>2、登录</h2><p>服务端获取到客户端请求后，将 <code>Socket</code> 包装为我们自定义的 <code>ChatSocket</code>，便于我们进行登录操作。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 用户登录方法</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> chatSocket ChatSocket 对象</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">login</span><span class=\"params\">(ChatSocket chatSocket)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 给每个用户一个线程处理</span></span><br><span class=\"line\">    <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(() -&gt; &#123;</span><br><span class=\"line\">        <span class=\"type\">Socket</span> <span class=\"variable\">socket</span> <span class=\"operator\">=</span> chatSocket.getSocket();</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">username</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"type\">InputStream</span> <span class=\"variable\">is</span> <span class=\"operator\">=</span> socket.getInputStream();</span><br><span class=\"line\">            <span class=\"type\">byte</span>[] bytes = <span class=\"keyword\">new</span> <span class=\"title class_\">byte</span>[<span class=\"number\">1024</span>];</span><br><span class=\"line\">            <span class=\"type\">int</span> <span class=\"variable\">len</span> <span class=\"operator\">=</span> readMsg(is, bytes);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (len == -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                logout(chatSocket);</span><br><span class=\"line\">                <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            username = <span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(bytes, <span class=\"number\">0</span>, len);</span><br><span class=\"line\">            chatSocket.setUsername(username);</span><br><span class=\"line\">            <span class=\"comment\">// 刷新配置</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (CHAT_CFG_RELOAD_PASSWORD.equals(username)) &#123;</span><br><span class=\"line\">                reloadChatCfg(is, bytes, socket);</span><br><span class=\"line\">                <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            loginTip(username, socket);</span><br><span class=\"line\">            <span class=\"comment\">// 机器人欢迎</span></span><br><span class=\"line\">            robotWelcome(username);</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">                len = readMsg(is, bytes);</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (len == -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                    logout(chatSocket);</span><br><span class=\"line\">                    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"type\">String</span> <span class=\"variable\">msg</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(bytes, <span class=\"number\">0</span>, len);</span><br><span class=\"line\">                sendMsgToOtherUser(username, socket, msg);</span><br><span class=\"line\">                <span class=\"comment\">// 机器人回复消息</span></span><br><span class=\"line\">                randomRobotReply(msg);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                logout(chatSocket);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (Exception ex) &#123;</span><br><span class=\"line\">                remove(socket);</span><br><span class=\"line\">                ex.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;).start();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"3、其他方法\"><a href=\"#3、其他方法\" class=\"headerlink\" title=\"3、其他方法\"></a>3、其他方法</h2><h3 id=\"3-1、读取客户端的消息\"><a href=\"#3-1、读取客户端的消息\" class=\"headerlink\" title=\"3.1、读取客户端的消息\"></a>3.1、读取客户端的消息</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 读取消息的方法</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> is    输入流</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> bytes 字节数组</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> 读取的长度</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"title function_\">readMsg</span><span class=\"params\">(InputStream is, <span class=\"type\">byte</span>[] bytes)</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">int</span> len;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        len = is.read(bytes);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> -<span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> len;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"3-2、给客户端发送消息\"><a href=\"#3-2、给客户端发送消息\" class=\"headerlink\" title=\"3.2、给客户端发送消息\"></a>3.2、给客户端发送消息</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 给所有的用户发送系统消息</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> msg 系统消息</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@throws</span> IOException 抛出异常</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">sendSysMsg</span><span class=\"params\">(String msg)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (ChatSocket chatSocket : userDB) &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">sysMsg</span> <span class=\"operator\">=</span> getCurrentTime() + <span class=\"string\">&quot;\\n&quot;</span> + msg + <span class=\"string\">&quot;\\n&quot;</span> + chatSeparate;</span><br><span class=\"line\">        <span class=\"type\">Socket</span> <span class=\"variable\">socket</span> <span class=\"operator\">=</span> chatSocket.getSocket();</span><br><span class=\"line\">        sendMsgToUser(socket, sysMsg);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 发送消息给其他用户</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> username 消息发送用户名称</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> self     消息发送的用户socket</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> msg      消息</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@throws</span> IOException 抛出异常</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">sendMsgToOtherUser</span><span class=\"params\">(String username, Socket self, String msg)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (ChatSocket chatSocket : userDB) &#123;</span><br><span class=\"line\">        <span class=\"type\">Socket</span> <span class=\"variable\">socket</span> <span class=\"operator\">=</span> chatSocket.getSocket();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (socket.equals(self)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">sendMsg</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;（&quot;</span> + username + <span class=\"string\">&quot;） &quot;</span> + getCurrentTime() + <span class=\"string\">&quot;\\n&quot;</span> + msg + <span class=\"string\">&quot;\\n&quot;</span> + chatSeparate;</span><br><span class=\"line\">        sendMsgToUser(socket, sendMsg);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 给指定的用户发送消息，文本消息</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> socket  消息发送的用户socket</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> sendMsg 消息</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@throws</span> IOException 抛出异常</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">sendMsgToUser</span><span class=\"params\">(Socket socket, String sendMsg)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">    <span class=\"type\">OutputStream</span> <span class=\"variable\">os</span> <span class=\"operator\">=</span> socket.getOutputStream();</span><br><span class=\"line\">    os.write(sendMsg.getBytes());</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"3-3、日志记录\"><a href=\"#3-3、日志记录\" class=\"headerlink\" title=\"3.3、日志记录\"></a>3.3、日志记录</h3><p>虽然服务端不需要记录用户的聊天信息，但是还是需要记录一些服务器的日志信息。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 打印日志</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> message 日志信息</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">logInfo</span><span class=\"params\">(String message)</span> &#123;</span><br><span class=\"line\">    System.out.println(getCurrentDateTime() + <span class=\"string\">&quot; &quot;</span> + message);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"3-4、工具集合\"><a href=\"#3-4、工具集合\" class=\"headerlink\" title=\"3.4、工具集合\"></a>3.4、工具集合</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 获取当前在线的所有玩家名称</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> 当前在线的所有玩家名称</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> List&lt;String&gt; <span class=\"title function_\">getLoginUsernames</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> userDB.stream().map(ChatSocket::getUsername).filter(Objects::nonNull).collect(Collectors.toList());</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 判断时间是否是 11:00 - 04:59 晚上</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> 是返回true，否则返回false</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">boolean</span> <span class=\"title function_\">isNight</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"type\">Calendar</span> <span class=\"variable\">calendar</span> <span class=\"operator\">=</span> Calendar.getInstance();</span><br><span class=\"line\">    <span class=\"type\">int</span> <span class=\"variable\">hour</span> <span class=\"operator\">=</span> calendar.get(Calendar.HOUR_OF_DAY);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> hour &gt;= <span class=\"number\">23</span> || hour &lt;= <span class=\"number\">4</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 时间格式化对象</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">SimpleDateFormat</span> <span class=\"variable\">timeSdf</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">SimpleDateFormat</span>(<span class=\"string\">&quot;HH:mm:ss&quot;</span>);</span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">SimpleDateFormat</span> <span class=\"variable\">DateTimeSdf</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">SimpleDateFormat</span>(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 获取当前的时间的格式化字符串</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> 当前的时间的格式化字符串</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">synchronized</span> String <span class=\"title function_\">getCurrentTime</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> timeSdf.format(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>());</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 获取当前的日期时间的格式化字符串</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> 当前的日期时间的格式化字符串</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">synchronized</span> String <span class=\"title function_\">getCurrentDateTime</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> DateTimeSdf.format(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>());</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 判断一个字符串是否为空</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> string 字符串</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> 为空返回true，否则返回false</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">boolean</span> <span class=\"title function_\">isEmpty</span><span class=\"params\">(String string)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> string == <span class=\"literal\">null</span> || string.length() == <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 判断一个字符串是否不为空</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> string 字符串</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@return</span> 不为空返回true，否则返回false</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"type\">boolean</span> <span class=\"title function_\">isNotEmpty</span><span class=\"params\">(String string)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> !isEmpty(string);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"3-5、ChatSocket\"><a href=\"#3-5、ChatSocket\" class=\"headerlink\" title=\"3.5、ChatSocket\"></a>3.5、ChatSocket</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 封装的 ChatSocket</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ChatSocket</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> Socket socket;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"title function_\">ChatSocket</span><span class=\"params\">(Socket socket)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.socket = socket;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Socket <span class=\"title function_\">getSocket</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> socket;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">getUsername</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> username;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">setUsername</span><span class=\"params\">(String username)</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">this</span>.username = username;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"服务端部署\"><a href=\"#服务端部署\" class=\"headerlink\" title=\"服务端部署\"></a>服务端部署</h1><p>为了方便在服务器上运行服务端代码，我还特意写了一个 <code>Shell</code> 脚本用来处理服务端代码的运行、停止、重启、查找等操作。</p>\n<p><img src=\"/images/2023/02/100005.gif\" alt=\"img\"></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">CHAT_SERVER_DIR=/usr/app/chat</span><br><span class=\"line\">CHAT_SERVER=ChatServer</span><br><span class=\"line\">CHAT_LOG_FILE=$&#123;CHAT_SERVER_DIR&#125;/chat.log</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">聊天室启动参数</span></span><br><span class=\"line\">CHAT_CFG=$&#123;2&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">help() &#123;</span><br><span class=\"line\">\techo &quot;==================&quot;</span><br><span class=\"line\">\techo &quot;start 启动服务&quot;</span><br><span class=\"line\">\techo &quot;stop 停止服务&quot;</span><br><span class=\"line\">\techo &quot;restart 重启服务&quot;</span><br><span class=\"line\">\techo &quot;find 查找服务&quot;</span><br><span class=\"line\">\techo &quot;help 帮助&quot;</span><br><span class=\"line\">\techo &quot;==================&quot;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">start() &#123;</span><br><span class=\"line\">\tjavac -encoding UTF-8 $&#123;CHAT_SERVER&#125;\\.java</span><br><span class=\"line\">\tnohup java -Dfile.encoding=UTF-8 $&#123;CHAT_SERVER&#125; $&#123;CHAT_CFG&#125; &gt;&gt;$&#123;CHAT_LOG_FILE&#125; 2&gt;&amp;1 &amp;</span><br><span class=\"line\">\techo &quot;服务$&#123;CHAT_SERVER&#125;已启动&quot;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">stop() &#123;</span><br><span class=\"line\">\tPID=$(ps -ef | grep java | grep ChatServer | awk &#x27;&#123;print $2&#125;&#x27;)</span><br><span class=\"line\">\tif [ &quot;$&#123;PID&#125;&quot; == &quot;&quot; ]</span><br><span class=\"line\">\tthen</span><br><span class=\"line\">\t\techo &quot;服务$&#123;CHAT_SERVER&#125;已停止&quot;</span><br><span class=\"line\">\telse</span><br><span class=\"line\">\t\tkill $&#123;PID&#125;</span><br><span class=\"line\">\t\techo &quot;服务$&#123;CHAT_SERVER&#125;已停止&quot;</span><br><span class=\"line\">\tfi</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">restart() &#123;</span><br><span class=\"line\">  stop</span><br><span class=\"line\">\tsleep 3</span><br><span class=\"line\">\tstart</span><br><span class=\"line\">\techo &quot;服务$&#123;CHAT_SERVER&#125;已重启&quot;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">find() &#123;</span><br><span class=\"line\">  PID=$(ps -ef | grep java | grep ChatServer | awk &#x27;&#123;print $2&#125;&#x27;)</span><br><span class=\"line\">  if [ &quot;$&#123;PID&#125;&quot; == &quot;&quot; ]</span><br><span class=\"line\">\tthen</span><br><span class=\"line\">\t\techo &quot;服务$&#123;CHAT_SERVER&#125;已停止&quot;</span><br><span class=\"line\">\telse</span><br><span class=\"line\">\t\techo &quot;服务$&#123;CHAT_SERVER&#125;正在运行：PID=$&#123;PID&#125;&quot;</span><br><span class=\"line\">\tfi</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">case $&#123;1&#125; in</span><br><span class=\"line\">\t&quot;&quot;)</span><br><span class=\"line\">\t\techo &quot;=== 参数错误 ===&quot;</span><br><span class=\"line\">\t\t;;</span><br><span class=\"line\">\tstart)</span><br><span class=\"line\">\t\tstart</span><br><span class=\"line\">\t\t;;</span><br><span class=\"line\">\tstop)</span><br><span class=\"line\">\t\tstop</span><br><span class=\"line\">\t\t;;</span><br><span class=\"line\">\trestart)</span><br><span class=\"line\">\t\trestart</span><br><span class=\"line\">\t\t;;</span><br><span class=\"line\">\tfind)</span><br><span class=\"line\">\t\tfind</span><br><span class=\"line\">\t\t;;</span><br><span class=\"line\">\t*)</span><br><span class=\"line\">\t\thelp</span><br><span class=\"line\">\t\t;;</span><br><span class=\"line\">esac</span><br><span class=\"line\"></span><br><span class=\"line\">exit 0</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"优点与缺点\"><a href=\"#优点与缺点\" class=\"headerlink\" title=\"优点与缺点\"></a>优点与缺点</h1><p><strong>优点</strong></p>\n<ul>\n<li>简单便捷，无论是客户端还是服务端，都只依赖了 JDK 的环境，没有任何第三方依赖，客户端的代码只在复制到有 JDK 环境的电脑上即可运行，方便快捷。</li>\n<li>足够隐蔽，客户端在 CMD 或者 IDEA 环境下都可以运行，这样你身边的同事只要不仔细观察你的电脑屏幕，绝对想不到你是在和朋友聊天，只以为你是在认真工作。</li>\n</ul>\n<p><strong>缺点</strong></p>\n<ul>\n<li>服务端基于阻塞式网络 IO 开发，服务端只能够承受有限个的客户端链接。（Java NIO 版本可以解决这个缺点）</li>\n<li>太过简陋，因为只是单纯地进行网络 IO 的写入和读取，所以对于一些复杂的网络环境问题都没有进行处理，比如网络黏包的问题，在客户端连接较多的情况下，可能会发生网络黏包的问题，导致一些消息粘黏在一起，发送给客户端。</li>\n<li>需要一个服务器，因为这款即使通讯工具是 CS 模式，需要一个服务器运行服务端代码。</li>\n</ul>\n<h1 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h1><p>虽然这款即时通讯工具确实还不够完善，但是如果只是用于几个朋友之间简单地进行聊天，这款即时通讯工具还是非常给力的。</p>\n<p>这款即时通讯工具的源代码已经被托管到了 GitHub 上，同时还附带了这款即时通讯工具的 Java NIO 版本，有兴趣的同学的可以访问我的 GitHub 下载源码。</p>\n<blockquote>\n<p>GitHub：<a href=\"https://github.com/herenpeng/chat.git\">https://github.com/herenpeng/chat.git</a></p>\n</blockquote>\n<p>同时，我还在 Gitee 上提供了仓库镜像。</p>\n<blockquote>\n<p>Gitee：<a href=\"https://gitee.com/herenpeng/chat.git\">https://gitee.com/herenpeng/chat.git</a></p>\n</blockquote>\n<p>如果你喜欢这款即时通讯工具，希望各位同学可以给我的 GitHub 或者 Gitee 仓库点一个 <code>Star</code>，非常感谢！</p>\n<p><img src=\"/images/2023/02/100004.gif\" alt=\"img\"></p>\n","categories":["Java"],"tags":["Java","Netty"]},{"title":"不同版本的SpringAop执行顺序变化","url":"/2020/11/01/java/%E4%B8%8D%E5%90%8C%E7%89%88%E6%9C%AC%E7%9A%84SpringAop%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F%E5%8F%98%E5%8C%96/","content":"<blockquote>\n<p>今天在使用SpringAop的时候，在代码运行过程中，突然发生了异常，作者仔细检查了代码，最终发现，是因为SpringBoot所依赖的版本不同，导致SpringAop的执行顺序发生了变化导致的。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h2 id=\"低版本SpringBoot-Aop测试\"><a href=\"#低版本SpringBoot-Aop测试\" class=\"headerlink\" title=\"低版本SpringBoot Aop测试\"></a>低版本SpringBoot Aop测试</h2><h3 id=\"SpringBoot-2-0-4-RELEASE版本依赖\"><a href=\"#SpringBoot-2-0-4-RELEASE版本依赖\" class=\"headerlink\" title=\"SpringBoot 2.0.4.RELEASE版本依赖\"></a>SpringBoot 2.0.4.RELEASE版本依赖</h3><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.0.4.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">relativePath</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--SpringMVC的启动器--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--Spring AOP的启动器依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-aop<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n<h3 id=\"Controller层接口\"><a href=\"#Controller层接口\" class=\"headerlink\" title=\"Controller层接口\"></a>Controller层接口</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;user&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserController</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">user</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;[Controller]执行controller方法&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;正常执行&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping(&quot;e&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">e</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;[Controller]执行controller方法:异常之前&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">1</span> / <span class=\"number\">0</span>;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;[Controller]执行controller方法:异常之后&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;发生异常&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"AOP代码\"><a href=\"#AOP代码\" class=\"headerlink\" title=\"AOP代码\"></a>AOP代码</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Aspect</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">LogAop</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Pointcut(&quot;execution(public * com.hrp.controller.*.*(..))&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">logAop</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Before(&quot;logAop()&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">doBefore</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;[AOP]===================doBefore===================&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@AfterReturning(&quot;logAop()&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">doAfterReturning</span><span class=\"params\">(JoinPoint joinPoint)</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;[AOP]===================doAfterReturning===================&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@AfterThrowing(value = &quot;logAop()&quot;, throwing = &quot;e&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">doAfterThrowing</span><span class=\"params\">(JoinPoint joinPoint, Exception e)</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;[AOP]===================doAfterThrowing===================&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@After(&quot;logAop()&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">doAfter</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;[AOP]===================doAfter===================&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Around(&quot;logAop()&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Object <span class=\"title function_\">doAround</span><span class=\"params\">(ProceedingJoinPoint proceedingJoinPoint)</span> <span class=\"keyword\">throws</span> Throwable &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;[AOP]===================doAround before===================&quot;</span>);</span><br><span class=\"line\">        <span class=\"type\">Object</span> <span class=\"variable\">result</span> <span class=\"operator\">=</span> proceedingJoinPoint.proceed();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;[AOP]===================doAround after===================&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"AOP执行结果\"><a href=\"#AOP执行结果\" class=\"headerlink\" title=\"AOP执行结果\"></a>AOP执行结果</h3><ul>\n<li>正常执行</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">[AOP]===================doAround before===================</span><br><span class=\"line\">[AOP]===================doBefore===================</span><br><span class=\"line\">[Controller]执行controller方法</span><br><span class=\"line\">[AOP]===================doAround after===================</span><br><span class=\"line\">[AOP]===================doAfter===================</span><br><span class=\"line\">[AOP]===================doAfterReturning===================</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>发生异常</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">[AOP]===================doAround before===================</span><br><span class=\"line\">[AOP]===================doBefore===================</span><br><span class=\"line\">[Controller]执行controller方法:异常之前</span><br><span class=\"line\">[AOP]===================doAfter===================</span><br><span class=\"line\">[AOP]===================doAfterThrowing===================</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"更换高版本的SpringBoot依赖\"><a href=\"#更换高版本的SpringBoot依赖\" class=\"headerlink\" title=\"更换高版本的SpringBoot依赖\"></a>更换高版本的SpringBoot依赖</h2><h3 id=\"SpringBoot-2-3-2-RELEASE版本依赖\"><a href=\"#SpringBoot-2-3-2-RELEASE版本依赖\" class=\"headerlink\" title=\"SpringBoot 2.3.2.RELEASE版本依赖\"></a>SpringBoot 2.3.2.RELEASE版本依赖</h3><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.3.2.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">relativePath</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n<h3 id=\"AOP执行结果-1\"><a href=\"#AOP执行结果-1\" class=\"headerlink\" title=\"AOP执行结果\"></a>AOP执行结果</h3><ul>\n<li>正常执行</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">[AOP]===================doAround before===================</span><br><span class=\"line\">[AOP]===================doBefore===================</span><br><span class=\"line\">[Controller]执行controller方法</span><br><span class=\"line\">[AOP]===================doAfterReturning===================</span><br><span class=\"line\">[AOP]===================doAfter===================</span><br><span class=\"line\">[AOP]===================doAround after===================</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>发生异常</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">[AOP]===================doAround before===================</span><br><span class=\"line\">[AOP]===================doBefore===================</span><br><span class=\"line\">[Controller]执行controller方法:异常之前</span><br><span class=\"line\">[AOP]===================doAfterThrowing===================</span><br><span class=\"line\">[AOP]===================doAfter===================</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"测试结果\"><a href=\"#测试结果\" class=\"headerlink\" title=\"测试结果\"></a>测试结果</h2><ul>\n<li><strong>SpringBoot 2.0.4.RELEASE版本</strong></li>\n</ul>\n<p><img src=\"/images/2020/11/20201101174502527.png\" alt=\"在这里插入图片描述\"></p>\n<ul>\n<li><strong>SpringBoot 2.3.2.RELEASE版本</strong></li>\n</ul>\n<p><img src=\"/images/2020/11/20201106194339398.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["Java"],"tags":["Java","SpringBoot","AOP"]},{"title":"低代码开发，手写一款代码生成工具","url":"/2021/08/11/java/%E4%BD%8E%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91%EF%BC%8C%E6%89%8B%E5%86%99%E4%B8%80%E6%AC%BE%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90%E5%B7%A5%E5%85%B7/","content":"<blockquote>\n<p>低代码平台的一个核心就是，使用可视化的操作，生成项目系统中的非核心代码，从而大大降低了重复代码的编写工作，使开发者们可以更加专注于核心代码和业务功能的设计和开发工作。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h1 id=\"低代码平台\"><a href=\"#低代码平台\" class=\"headerlink\" title=\"低代码平台\"></a>低代码平台</h1><p>低代码平台有很多，强大的低代码平台基本上可以通过可视化操作来编写简单的业务逻辑，而一些简单的低代码平台主要是用来生成一些通用的 CRUD 操作，我们今天要写的就是一款比较简单的低代码平台，主要生成一些通用的后端 CRUD 操作，当然，也可以生成一些简单的前端数据管理页面等等。</p>\n<p>低代码平台的主要思路是，以数据库表结构为基础，获取数据库表的结构信息，从而生成后端对应的领域模型以及 CRUD 操作。</p>\n<p>本篇博客中，所有的功能都是基于 SpringBoot 的，所以在最开始，我们需要引入 SpringBoot 相关的依赖，数据库使用 MySQL，数据库操作使用 MyBatisPlus，所以在阅读本篇博客之前，我希望阅读的朋友对于这些相关的知识已经有所了解。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.5.2<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">relativePath</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--SpringMVC的启动器--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--lombok的依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.projectlombok<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>lombok<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--MySQL数据库驱动--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>mysql<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--MyBatis-Plus的依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.baomidou<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.4.0<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n\n<p>其实低代码平台的本质就是一个模板操作，将数据库表的结构信息填入对应的模板中，即可根据模板内容生成对应的模板页面。</p>\n<p>说到模板生成，其实 JSP 技术本质上就是一种模板，JavaEE 服务器将数据信息填入 JSP 模板中，从而生成对应的 HTML 静态页面，然后响应给前端。</p>\n<p>当然，目前的 Java 技术生态圈中，JSP 是一种比较老旧的技术了，学习和使用价值都不算太高，所以今天的低代码平台并不使用 JSP 技术来作为通用模板，而是使用 FreeMarker 模板引擎作为模板工具。</p>\n<h2 id=\"FreeMarker模板\"><a href=\"#FreeMarker模板\" class=\"headerlink\" title=\"FreeMarker模板\"></a>FreeMarker模板</h2><p>既然要使用 FreeMarker 模板引擎作为模板工具，自然需要对 FreeMarker 技术有所了解。</p>\n<p>我们来看一下 FreeMarker 中文官方参考手册的描述：</p>\n<blockquote>\n<p>FreeMarker 是一款 <em>模板引擎</em>： 即一种基于模板和要改变的数据， 并用来生成输出文本(HTML网页，电子邮件，配置文件，源代码等)的通用工具。 它不是面向最终用户的，而是一个Java类库，是一款程序员可以嵌入他们所开发产品的组件。</p>\n</blockquote>\n<p>简而言之，FreeMarker 就是一款类似于 JSP 的模板工具，但是比起 JSP 来，FreeMarker 效率更高，使用更加方便简单。</p>\n<p>如果需要使用 FreeMarker 技术，SpringBoot 中已经为我们集成了 FreeMarker 模板引擎，我们在已经引入 SpringBoot 的前提下，只需要再引入 FreeMarker 的依赖即可。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-freemarker<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n\n<p>可以先简单封装一下 FreeMarker 模板引擎的模板生成功能，使得我们可以在后面更加简便地使用 FreeMarker 模板引擎。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">FreeMarkerUtils</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 模板渲染并返回内容</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> object             模板参数对象</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> templateLoaderPath FreeMarker模板文件加载路径</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> ftlFileName        FreeMarker模板文件名称</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> FreeMarker模板内容内容字符串</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">getTemplateContent</span><span class=\"params\">(<span class=\"keyword\">final</span> Object object, <span class=\"keyword\">final</span> String templateLoaderPath, <span class=\"keyword\">final</span> String ftlFileName)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">StringWriter</span> <span class=\"variable\">out</span> <span class=\"operator\">=</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"type\">Configuration</span> <span class=\"variable\">cfg</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Configuration</span>(Configuration.DEFAULT_INCOMPATIBLE_IMPROVEMENTS);</span><br><span class=\"line\">            cfg.setClassForTemplateLoading(FreeMarkerUtils.class, templateLoaderPath);</span><br><span class=\"line\">            cfg.setDefaultEncoding(EncodingEnums.UTF_8.getValue());</span><br><span class=\"line\">            <span class=\"type\">Template</span> <span class=\"variable\">template</span> <span class=\"operator\">=</span> cfg.getTemplate(ftlFileName);</span><br><span class=\"line\">            out = <span class=\"keyword\">new</span> <span class=\"title class_\">StringWriter</span>();</span><br><span class=\"line\">            template.process(object, out);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> out.toString();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">            log.error(<span class=\"string\">&quot;[freemarker工具类]FreeMarker读取模板文件异常&quot;</span>);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (out != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    out.flush();</span><br><span class=\"line\">                    out.close();</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (IOException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                    log.error(<span class=\"string\">&quot;[freemarker工具类]FreeMarker读取模板文件输出流关闭异常&quot;</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"数据库表结构信息\"><a href=\"#数据库表结构信息\" class=\"headerlink\" title=\"数据库表结构信息\"></a>数据库表结构信息</h2><p>表结构信息是低代码平台的基础信息，其他的信息都是从表结构信息延伸出来的。</p>\n<p>在获取表结构信息上，需要解决几个问题。</p>\n<ul>\n<li>怎么获取数据库源对应的表信息。</li>\n<li>怎么获取数据库表对应的字段信息。</li>\n</ul>\n<p>其实数据库的表结构信息，也是存储在数据库表中的。这些信息存储在 MySQL 数据库默认的数据库 <code>information_schema</code> 中，我们可以使用 SQL 语句查询出当前使用的数据库的所有表信息。</p>\n<p><img src=\"/images/2023/02/200001.png\" alt=\"img\"></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> table_name <span class=\"keyword\">as</span> name,table_comment <span class=\"keyword\">as</span> comment</span><br><span class=\"line\"><span class=\"keyword\">from</span> information_schema.tables</span><br><span class=\"line\"><span class=\"keyword\">where</span> table_schema <span class=\"operator\">=</span> (<span class=\"keyword\">select</span> database())</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>查询结果</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>name</th>\n<th>comment</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>数据库表名称</td>\n<td>数据库表注释信息</td>\n</tr>\n</tbody></table>\n<p>同理，我们也可以用同样的方式获取数据库表字段的具体信息。</p>\n<p><img src=\"/images/2023/02/200002.png\" alt=\"img\"></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">select</span> column_name <span class=\"keyword\">as</span> name, ordinal_position <span class=\"keyword\">as</span> sort,</span><br><span class=\"line\">column_comment <span class=\"keyword\">as</span> comment, data_type <span class=\"keyword\">as</span> database_type</span><br><span class=\"line\"><span class=\"keyword\">from</span> information_schema.columns</span><br><span class=\"line\"><span class=\"keyword\">where</span> table_schema <span class=\"operator\">=</span> (<span class=\"keyword\">select</span> database())</span><br><span class=\"line\"><span class=\"keyword\">AND</span> table_name <span class=\"operator\">=</span> <span class=\"string\">&#x27;auth_role&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">order</span> <span class=\"keyword\">by</span> ordinal_position;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>查询结果</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>name</th>\n<th>sort</th>\n<th>comment</th>\n<th>database_type</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>表字段名称</td>\n<td>表字段排序</td>\n<td>表字段注释信息</td>\n<td>表字段数据库类型</td>\n</tr>\n</tbody></table>\n<h2 id=\"命名风格转换\"><a href=\"#命名风格转换\" class=\"headerlink\" title=\"命名风格转换\"></a>命名风格转换</h2><p>在 Java 代码中，我们一般会使用遵循 Java 代码规范的驼峰命名法，而在数据库中，则使用下划线命名法，即各个词语之间使用下划线隔开。驼峰命名法和下划线命名法都是遵循一定规范的命名方式，两者之间的命名风格可以相互转换。</p>\n<p>如果数据库的命名和 Java 代码的命名都遵循一定的规范，那么可以使用命名风格转换工具，将数据库的名称信息自动转换为 Java 代码风格的名称。</p>\n<p>当然，如果命名确实不具备相同的规范，无法自动转换，也可以考虑使用在可视化编程界面，由低代码平台的使用者自己对命名名称进行手动修正。</p>\n<ul>\n<li>命名风格转换工具</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 命名风格转换工具类</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> herenpeng</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020-11-15 15:58</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">CamelCaseUtils</span> &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 下划线分隔符 Underscore</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">char</span> <span class=\"variable\">UNDERSCORE_SEPARATOR</span> <span class=\"operator\">=</span> <span class=\"string\">&#x27;_&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 下划线命名，转换为小驼峰命名</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> string 下划线命名名称</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 小驼峰命名名称</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">toCamelCase</span><span class=\"params\">(String string)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (StringUtils.isBlank(string)) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        string = string.toLowerCase();</span><br><span class=\"line\">        <span class=\"type\">StringBuilder</span> <span class=\"variable\">sb</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">StringBuilder</span>(string.length());</span><br><span class=\"line\">        <span class=\"type\">boolean</span> <span class=\"variable\">upperCase</span> <span class=\"operator\">=</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; string.length(); i++) &#123;</span><br><span class=\"line\">            <span class=\"type\">char</span> <span class=\"variable\">ch</span> <span class=\"operator\">=</span> string.charAt(i);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (ch == UNDERSCORE_SEPARATOR) &#123;</span><br><span class=\"line\">                upperCase = <span class=\"literal\">true</span>;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (upperCase) &#123;</span><br><span class=\"line\">                sb.append(Character.toUpperCase(ch));</span><br><span class=\"line\">                upperCase = <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                sb.append(ch);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> sb.toString();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"数据类型转换\"><a href=\"#数据类型转换\" class=\"headerlink\" title=\"数据类型转换\"></a>数据类型转换</h2><p>从数据库中只能获取数据库表字段的数据类型，而在 Java 代码中，我们使用的是 Java 数据类型，在 MyBatisPlus 中，我们一般还会使用 jdbcType，为了能够把数据库类型转换为 Java 类型和 jdbcType，需要我们在后台对这三者直接的关系进行映射，从而实现数据库类型转换为 Java 类型和 jdbcType 类型。</p>\n<ul>\n<li>数据库类型映射</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 数据类型常量，能够通过数据库类型映射为JDBC类型和JAVA类型</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> herenpeng</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020-11-12 23:56</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DataBaseTypeConst</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Map&lt;String, String&gt; jdbcTypeMap = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;(<span class=\"number\">16</span>);</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Map&lt;String, String&gt; javaTypeMap = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;(<span class=\"number\">16</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@PostConstruct</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">init</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        initJdbcTypeMap();</span><br><span class=\"line\">        initJavaTypeMap();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 初始化数据库类型和Jdbc类型的映射关系</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">initJdbcTypeMap</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        jdbcTypeMap.put(<span class=\"string\">&quot;int&quot;</span>, <span class=\"string\">&quot;INTEGER&quot;</span>);</span><br><span class=\"line\">        jdbcTypeMap.put(<span class=\"string\">&quot;bigint&quot;</span>, <span class=\"string\">&quot;BIGINT&quot;</span>);</span><br><span class=\"line\">        jdbcTypeMap.put(<span class=\"string\">&quot;char&quot;</span>, <span class=\"string\">&quot;CHAR&quot;</span>);</span><br><span class=\"line\">        jdbcTypeMap.put(<span class=\"string\">&quot;varchar&quot;</span>, <span class=\"string\">&quot;VARCHAR&quot;</span>);</span><br><span class=\"line\">        jdbcTypeMap.put(<span class=\"string\">&quot;datetime&quot;</span>, <span class=\"string\">&quot;TIMESTAMP&quot;</span>);</span><br><span class=\"line\">        jdbcTypeMap.put(<span class=\"string\">&quot;timestamp&quot;</span>, <span class=\"string\">&quot;TIMESTAMP&quot;</span>);</span><br><span class=\"line\">        jdbcTypeMap.put(<span class=\"string\">&quot;date&quot;</span>, <span class=\"string\">&quot;DATE&quot;</span>);</span><br><span class=\"line\">        jdbcTypeMap.put(<span class=\"string\">&quot;time&quot;</span>, <span class=\"string\">&quot;TIME&quot;</span>);</span><br><span class=\"line\">        jdbcTypeMap.put(<span class=\"string\">&quot;tinyint&quot;</span>, <span class=\"string\">&quot;BOOLEAN&quot;</span>);</span><br><span class=\"line\">        jdbcTypeMap.put(<span class=\"string\">&quot;decimal&quot;</span>, <span class=\"string\">&quot;DECIMAL&quot;</span>);</span><br><span class=\"line\">        jdbcTypeMap.put(<span class=\"string\">&quot;numeric&quot;</span>, <span class=\"string\">&quot;NUMERIC&quot;</span>);</span><br><span class=\"line\">        jdbcTypeMap.put(<span class=\"string\">&quot;float&quot;</span>, <span class=\"string\">&quot;FLOAT&quot;</span>);</span><br><span class=\"line\">        jdbcTypeMap.put(<span class=\"string\">&quot;double&quot;</span>, <span class=\"string\">&quot;DOUBLE&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 初始化数据库类型和Java类型的映射关系</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">initJavaTypeMap</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        javaTypeMap.put(<span class=\"string\">&quot;int&quot;</span>, <span class=\"string\">&quot;Integer&quot;</span>);</span><br><span class=\"line\">        javaTypeMap.put(<span class=\"string\">&quot;bigint&quot;</span>, <span class=\"string\">&quot;Long&quot;</span>);</span><br><span class=\"line\">        javaTypeMap.put(<span class=\"string\">&quot;char&quot;</span>, <span class=\"string\">&quot;String&quot;</span>);</span><br><span class=\"line\">        javaTypeMap.put(<span class=\"string\">&quot;varchar&quot;</span>, <span class=\"string\">&quot;String&quot;</span>);</span><br><span class=\"line\">        javaTypeMap.put(<span class=\"string\">&quot;datetime&quot;</span>, <span class=\"string\">&quot;Date&quot;</span>);</span><br><span class=\"line\">        javaTypeMap.put(<span class=\"string\">&quot;timestamp&quot;</span>, <span class=\"string\">&quot;Date&quot;</span>);</span><br><span class=\"line\">        javaTypeMap.put(<span class=\"string\">&quot;date&quot;</span>, <span class=\"string\">&quot;Date&quot;</span>);</span><br><span class=\"line\">        javaTypeMap.put(<span class=\"string\">&quot;time&quot;</span>, <span class=\"string\">&quot;Date&quot;</span>);</span><br><span class=\"line\">        javaTypeMap.put(<span class=\"string\">&quot;tinyint&quot;</span>, <span class=\"string\">&quot;Boolean&quot;</span>);</span><br><span class=\"line\">        javaTypeMap.put(<span class=\"string\">&quot;decimal&quot;</span>, <span class=\"string\">&quot;BigDecimal&quot;</span>);</span><br><span class=\"line\">        javaTypeMap.put(<span class=\"string\">&quot;numeric&quot;</span>, <span class=\"string\">&quot;BigDecimal&quot;</span>);</span><br><span class=\"line\">        javaTypeMap.put(<span class=\"string\">&quot;float&quot;</span>, <span class=\"string\">&quot;Double&quot;</span>);</span><br><span class=\"line\">        javaTypeMap.put(<span class=\"string\">&quot;double&quot;</span>, <span class=\"string\">&quot;Double&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取数据库类型对应的JDBC类型</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> databaseType 数据库类型</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> JDBC类型</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">getJdbcType</span><span class=\"params\">(String databaseType)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> jdbcTypeMap.get(databaseType);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取数据库类型对应的Java类型</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> databaseType 数据库类型</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> Java类型</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">getJavaType</span><span class=\"params\">(String databaseType)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> javaTypeMap.get(databaseType);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h2 id=\"代码生成\"><a href=\"#代码生成\" class=\"headerlink\" title=\"代码生成\"></a>代码生成</h2><p>代码生成需要两部分数据：</p>\n<ul>\n<li>第一部分是代码模板，代码模板是固定的代码，在后台以 FreeMarker 的形式存在后台中。</li>\n<li>第二部分是代码模板参数，代码模板参数是可变的，在代码生成中，代码模板参数就是数据库表信息和数据库字段信息，以及由数据库延伸出来的 Java 名称信息。</li>\n</ul>\n<h3 id=\"代码模板\"><a href=\"#代码模板\" class=\"headerlink\" title=\"代码模板\"></a>代码模板</h3><p>代码模板由 FreeMarker 技术开发，例如实体类的代码模板，名称是 <code>entity.ftlh</code>，模板内容如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> $&#123;javaPackageName&#125;.entity;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> cn.afterturn.easypoi.excel.annotation.Excel;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.annotation.SqlCondition;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.annotation.TableField;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.baomidou.mybatisplus.annotation.TableName;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.zero.common.base.entity.BaseEntity;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.swagger.annotations.ApiModel;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.AllArgsConstructor;</span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.Data;</span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.EqualsAndHashCode;</span><br><span class=\"line\"><span class=\"keyword\">import</span> lombok.NoArgsConstructor;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;#<span class=\"type\">assign</span> <span class=\"variable\">HasBigDecimal</span> <span class=\"operator\">=</span> <span class=\"literal\">true</span>&gt;</span><br><span class=\"line\">&lt;#<span class=\"type\">assign</span> <span class=\"variable\">HasDate</span> <span class=\"operator\">=</span> <span class=\"literal\">true</span>&gt;</span><br><span class=\"line\">&lt;#list tableColumnList as column&gt;</span><br><span class=\"line\">    &lt;#<span class=\"keyword\">if</span> column.javaType == <span class=\"string\">&quot;BigDecimal&quot;</span> &amp;&amp; HasBigDecimal&gt;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.math.BigDecimal;</span><br><span class=\"line\">    &lt;#<span class=\"type\">assign</span> <span class=\"variable\">HasBigDecimal</span> <span class=\"operator\">=</span> <span class=\"literal\">false</span>&gt;</span><br><span class=\"line\">    &lt;/#<span class=\"keyword\">if</span>&gt;</span><br><span class=\"line\">    &lt;#<span class=\"keyword\">if</span> column.javaType == <span class=\"string\">&quot;Date&quot;</span> &amp;&amp; HasDate &amp;&amp; column.name != <span class=\"string\">&quot;create_time&quot;</span> &amp;&amp; column.name != <span class=\"string\">&quot;update_time&quot;</span>&gt;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Date;</span><br><span class=\"line\">    &lt;#<span class=\"type\">assign</span> <span class=\"variable\">HasDate</span> <span class=\"operator\">=</span> <span class=\"literal\">false</span>&gt;</span><br><span class=\"line\">    &lt;/#<span class=\"keyword\">if</span>&gt;</span><br><span class=\"line\">&lt;/#list&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * $&#123;comment&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> $&#123;codeAuthor&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> $&#123;.now?string(&quot;yyyy-MM-dd HH:mm&quot;)&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@ApiModel(value = &quot;$&#123;comment&#125;&quot;)</span></span><br><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@EqualsAndHashCode(callSuper = false)</span></span><br><span class=\"line\"><span class=\"meta\">@NoArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@AllArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@TableName(&quot;$&#123;name&#125;&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">$</span>&#123;entityName&#125; <span class=\"keyword\">extends</span> <span class=\"title class_\">BaseEntity</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;#list tableColumnList as column&gt;</span><br><span class=\"line\">&lt;#<span class=\"keyword\">if</span> column.name != <span class=\"string\">&quot;id&quot;</span> &amp;&amp; column.name != <span class=\"string\">&quot;create_time&quot;</span> &amp;&amp; column.name != <span class=\"string\">&quot;create_user_id&quot;</span> &amp;&amp; column.name != <span class=\"string\">&quot;update_time&quot;</span> &amp;&amp; column.name != <span class=\"string\">&quot;update_user_id&quot;</span> &amp;&amp; column.name != <span class=\"string\">&quot;deleted&quot;</span>&gt;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * $&#123;column.comment&#125;</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@ApiModelProperty(value = &quot;$&#123;column.comment&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"meta\">@Excel(name = &quot;$&#123;column.comment&#125;&quot;, width = 15, needMerge = true)</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;$&#123;column.name&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> $&#123;column.javaType&#125; $&#123;column.javaName&#125;;</span><br><span class=\"line\">&lt;/#<span class=\"keyword\">if</span>&gt;</span><br><span class=\"line\">&lt;/#list&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"代码模板参数\"><a href=\"#代码模板参数\" class=\"headerlink\" title=\"代码模板参数\"></a>代码模板参数</h3><p>代码模板参数都是由数据库相关的信息延伸出来的，主要分为数据库表信息和数据库表字段信息。</p>\n<ul>\n<li>TableInfo</li>\n</ul>\n<blockquote>\n<p>这里的 TableInfo 有一部分信息是和前端 vue 相关的，如果有不需要可以根据自己的需求进行代码改造。</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 系统数据库表信息实体类</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> herenpeng</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020-11-08 10:55</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@EqualsAndHashCode(callSuper = false)</span></span><br><span class=\"line\"><span class=\"meta\">@NoArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@AllArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@TableName(&quot;dev_table_info&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">TableInfo</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">BaseEntity</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 表名称</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;name&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 表注释</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;comment&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String comment;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 表名对应的实体类名称</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;entity_name&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String entityName;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 表名对应的实体类Controller请求路径</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;request_mapping&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String requestMapping;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Java包前缀名称</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;java_package_name&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String javaPackageName;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Java代码生成路径</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;java_code_path&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String javaCodePath;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Vue代码生成路径</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;vue_code_path&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String vueCodePath;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Vue包路径</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;vue_package&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String vuePackage;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 代码作者</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;code_author&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String codeAuthor;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 数据库表的字段信息</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(exist = false)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> List&lt;TableColumn&gt; tableColumnList;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<ul>\n<li>TableColumn</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 系统数据库表字段信息实体类</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> herenpeng</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020-11-11 23:11</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@EqualsAndHashCode(callSuper = false)</span></span><br><span class=\"line\"><span class=\"meta\">@NoArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@AllArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@TableName(&quot;dev_table_column&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">TableColumn</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">BaseEntity</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 数据库表字段名称</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;name&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Java属性名称</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;java_name&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String javaName;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 数据库表字段注释</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;comment&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String comment;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 数据库表字段类型</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;database_type&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String databaseType;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 数据库表字段对应的JDBC类型</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;jdbc_type&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String jdbcType;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 数据库表字段对应的JAVA类型</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;java_type&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String javaType;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 是否为查询字段</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;query&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Boolean query;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 数据库表字段排序顺序，数据库默认升序排序</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;sort&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer sort;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 表信息主键，关联dev_table_info表的主键</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@TableField(value = &quot;table_info_id&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Integer tableInfoId;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"模板类型枚举\"><a href=\"#模板类型枚举\" class=\"headerlink\" title=\"模板类型枚举\"></a>模板类型枚举</h3><p>为了能够区分不同的模板，以及不同模板之前的一些固定参数，我们可以写一些枚举类型，对这些不同模板的固定参数进行定义。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 代码类型，后续可以添加一些其他类型的代码，比如 VUE</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> herenpeng</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2021-03-29 20:43</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">enum</span> <span class=\"title class_\">CodeTypeEnum</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Java代码</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    JAVA;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * FreeMarker模板文件相关枚举</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> herenpeng</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020-11-15 13:07</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Getter</span></span><br><span class=\"line\"><span class=\"meta\">@AllArgsConstructor</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">enum</span> <span class=\"title class_\">TemplateEnum</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 实体类相关信息枚举</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    ENTITY(CodeTypeEnum.JAVA,</span><br><span class=\"line\">            <span class=\"string\">&quot;/templates/java&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;entity.ftlh&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;/src/main/java&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;.entity&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;.java&quot;</span>),</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Mapper层接口相关信息枚举</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    MAPPER(CodeTypeEnum.JAVA,</span><br><span class=\"line\">            <span class=\"string\">&quot;/templates/java&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;mapper.ftlh&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;/src/main/java&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;.mapper&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;Mapper&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;.java&quot;</span>),</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Mapper层XML文件相关信息枚举</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    MAPPER_XML(CodeTypeEnum.JAVA,</span><br><span class=\"line\">            <span class=\"string\">&quot;/templates/resources&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;mapperXml.ftlh&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;/src/main/resources&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;.mapper&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;Mapper&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;.xml&quot;</span>),</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Service层接口相关信息枚举</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    SERVICE(CodeTypeEnum.JAVA,</span><br><span class=\"line\">            <span class=\"string\">&quot;/templates/java&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;service.ftlh&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;/src/main/java&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;.service&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;Service&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;.java&quot;</span>),</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Service层接口实现类相关信息枚举</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    SERVICE_IMPL(CodeTypeEnum.JAVA,</span><br><span class=\"line\">            <span class=\"string\">&quot;/templates/java&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;serviceImpl.ftlh&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;/src/main/java&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;.service.impl&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;ServiceImpl&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;.java&quot;</span>),</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Controller层相关信息枚举</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    CONTROLLER(CodeTypeEnum.JAVA,</span><br><span class=\"line\">            <span class=\"string\">&quot;/templates/java&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;controller.ftlh&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;/src/main/java&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;.controller&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;Controller&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;.java&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 代码类型</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> CodeTypeEnum codeTypeEnum;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 模板文件加载路径</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> String templateLoaderPath;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * FreeMarker模板文件名称</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> String ftlTemplateFile;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 文件基本生成路径</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> String fileBasePath;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 包名称</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> String packageName;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 名称后缀</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> String suffix;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 文件后缀名称</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> String fileSuffix;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"生成代码\"><a href=\"#生成代码\" class=\"headerlink\" title=\"生成代码\"></a>生成代码</h3><p>拥有代码模板和代码模板参数之后，就可以使用之前写的 FreeMarkerUtils 直接生成代码，不过为了方便使用，我们可以再一次包装一个 CodeGenerationUtils 工具类。后续我们只需要调用 CodeGenerationUtils  工具类的 <code>generation</code> 方法即可。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 代码生成工具类</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> herenpeng</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@since</span> 2020-11-11 22:53</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Slf4j</span></span><br><span class=\"line\"><span class=\"meta\">@RequiredArgsConstructor</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">CodeGenerationUtils</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> TableInfoMapper tableInfoMapper;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> TableColumnMapper tableColumnMapper;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> FreeMarkerUtils freeMarkerUtils;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 代码生成方法</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> id 表信息主键</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">generation</span><span class=\"params\">(Integer id)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"type\">TableInfo</span> <span class=\"variable\">tableInfo</span> <span class=\"operator\">=</span> tableInfoMapper.selectById(id);</span><br><span class=\"line\">        List&lt;TableColumn&gt; tableColumnList = tableColumnMapper.getByTableInfoId(tableInfo.getId());</span><br><span class=\"line\">        tableInfo.setTableColumnList(tableColumnList);</span><br><span class=\"line\">        generationFile(tableInfo, TemplateEnum.ENTITY);</span><br><span class=\"line\">        generationFile(tableInfo, TemplateEnum.MAPPER);</span><br><span class=\"line\">        generationFile(tableInfo, TemplateEnum.SERVICE);</span><br><span class=\"line\">        generationFile(tableInfo, TemplateEnum.SERVICE_IMPL);</span><br><span class=\"line\">        generationFile(tableInfo, TemplateEnum.CONTROLLER);</span><br><span class=\"line\">        generationFile(tableInfo, TemplateEnum.MAPPER_XML);</span><br><span class=\"line\">        <span class=\"comment\">// 生成前端代码</span></span><br><span class=\"line\">        generationFile(tableInfo, TemplateEnum.VUE);</span><br><span class=\"line\">        generationFile(tableInfo, TemplateEnum.API);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 通过模板文件生成对应的文件</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> tableInfo    表信息，需要在模板文件中渲染的内容信息</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> templateEnum 需要生成的文件类型枚举，其中含有对应的生成信息</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> IOException IO异常</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">generationFile</span><span class=\"params\">(TableInfo tableInfo, TemplateEnum templateEnum)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 拼接文件的全路径</span></span><br><span class=\"line\">        <span class=\"type\">StringBuilder</span> <span class=\"variable\">generationFilePath</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">StringBuilder</span>();</span><br><span class=\"line\">        <span class=\"type\">CodeTypeEnum</span> <span class=\"variable\">codeTypeEnum</span> <span class=\"operator\">=</span> templateEnum.getCodeTypeEnum();</span><br><span class=\"line\">        <span class=\"keyword\">switch</span> (codeTypeEnum) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">case</span> JAVA:</span><br><span class=\"line\">                <span class=\"comment\">// 拼接文件的全路径</span></span><br><span class=\"line\">                generationFilePath.append(tableInfo.getJavaCodePath()).append(templateEnum.getFileBasePath())</span><br><span class=\"line\">                        .append(packageNameToPath(tableInfo.getJavaPackageName() + templateEnum.getPackageName()))</span><br><span class=\"line\">                        .append(File.separator).append(tableInfo.getEntityName()).append(templateEnum.getSuffix())</span><br><span class=\"line\">                        .append(templateEnum.getFileSuffix());</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            <span class=\"keyword\">default</span>:</span><br><span class=\"line\">                log.error(<span class=\"string\">&quot;[代码生成工具]系统当前不支持&#123;&#125;类型的代码生成功能&quot;</span>, codeTypeEnum);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">content</span> <span class=\"operator\">=</span> freeMarkerUtils.getTemplateContent(tableInfo, templateEnum.getTemplateLoaderPath(), templateEnum.getFtlTemplateFile());</span><br><span class=\"line\">        <span class=\"type\">File</span> <span class=\"variable\">generationFile</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">File</span>(generationFilePath.toString());</span><br><span class=\"line\">        generationFile.getParentFile().mkdirs();</span><br><span class=\"line\">        <span class=\"type\">OutputStreamWriter</span> <span class=\"variable\">out</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">OutputStreamWriter</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">FileOutputStream</span>(generationFile), EncodingEnums.UTF_8.getValue());</span><br><span class=\"line\">        <span class=\"type\">BufferedWriter</span> <span class=\"variable\">writer</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">BufferedWriter</span>(out);</span><br><span class=\"line\">        writer.write(content);</span><br><span class=\"line\">        writer.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 将包名转换为文件路径名，并在包文件路径的前后拼接上文件路径分隔符号</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> packageName 包名转</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> 文件路径名称</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String <span class=\"title function_\">packageNameToPath</span><span class=\"params\">(String packageName)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> File.separator + packageName.replace(StringConst.POINT, File.separator);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"可视化效果\"><a href=\"#可视化效果\" class=\"headerlink\" title=\"可视化效果\"></a>可视化效果</h2><ul>\n<li>代码生成</li>\n</ul>\n<p><img src=\"/images/2023/02/200003.png\" alt=\"img\"></p>\n<ul>\n<li>表信息配置</li>\n</ul>\n<p><img src=\"/images/2023/02/200004.png\" alt=\"img\"></p>\n<ul>\n<li>表字段配置</li>\n</ul>\n<p><img src=\"/images/2023/02/200005.png\" alt=\"img\"></p>\n<h1 id=\"优点和缺点\"><a href=\"#优点和缺点\" class=\"headerlink\" title=\"优点和缺点\"></a>优点和缺点</h1><p><strong>优点</strong></p>\n<ul>\n<li>使用便捷，开发者可以使用这款低代码工具生成简单重复的代码。</li>\n<li>代码简单，开发者可以根据自己的需求，对这款低代码工具进行定制化的修改。</li>\n</ul>\n<p><strong>缺点</strong></p>\n<ul>\n<li>功能单一，相比较其他成熟的低代码平台，这款低代码工具的功能还是比较单一的，无法承担比较复杂的业务场景。</li>\n<li>不支持多表关联，这款低代码工具目前只支持单表代码生成。</li>\n</ul>\n<blockquote>\n<p>有兴趣的小伙伴可以基于这个的基础上，对这款低代码工具进行扩展和升级，增加更多复杂，更加强大的功能。</p>\n</blockquote>\n<h1 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h1><p>这款低代码平台能够生成简单的 Java 和前端代码，对于基础的增删改查可以直接生成，开发者只需要在这个基础上进行一些简单的修改，这些代码就可以立即生效，从而大大节省开发者的时间，让开发者从无意义的重复代码中解放出来。</p>\n<p>这款低代码工具其实是我的开源项目 <code>zero-admin</code> 下的一个子模块 <code>zero-dev</code> ，这款低代码工具的所有的源码都在该模块中，有兴趣的可以前往我的 GitHub 进行相关的了解。</p>\n<blockquote>\n<p>GitHub：<a href=\"https://github.com/herenpeng/zero-admin.git\">https://github.com/herenpeng/zero-admin.git</a></p>\n</blockquote>\n<p>同时，我还在 Gitee 上提供了仓库镜像。</p>\n<blockquote>\n<p>Gitee：<a href=\"https://gitee.com/herenpeng/zero-admin.git\">https://gitee.com/herenpeng/zero-admin.git</a></p>\n</blockquote>\n<p>如果你喜欢这款低代码工具，希望各位同学可以给我的 GitHub 或者 Gitee 仓库点一个 <code>Star</code>，非常感谢！</p>\n<p><img src=\"/images/2023/02/200004.gif\" alt=\"img\"></p>\n","categories":["Java"],"tags":["Java","SpringBoot"]},{"title":"使用Spring AOP实现日志记录","url":"/2020/03/20/java/%E4%BD%BF%E7%94%A8Spring%20AOP%E5%AE%9E%E7%8E%B0%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95/","content":"<h1 id=\"什么是AOP，Spring-AOP？\"><a href=\"#什么是AOP，Spring-AOP？\" class=\"headerlink\" title=\"什么是AOP，Spring AOP？\"></a>什么是AOP，Spring AOP？</h1><ul>\n<li>AOP是面向切面编程，AOP不是单独指某一种技术，而是一种编程思想，AOP是OOP的补充，用于处理业务逻辑中的横切关注点，比如日志记录，事务控制，性能统计，异常处理等等。AOP的主要功能是将大量的通用行为从业务逻辑中抽取出来，封装成独立的非业务方法，用于横向切入，这些行为不会对已有的业务逻辑代码产生影响。</li>\n<li>AOP是一种设计思想，而Spring AOP则是符合AOP思想的一种框架实现。<span id=\"more\"></span>\n\n</li>\n</ul>\n<h1 id=\"为什么使用Spring-AOP实现日记记录？\"><a href=\"#为什么使用Spring-AOP实现日记记录？\" class=\"headerlink\" title=\"为什么使用Spring AOP实现日记记录？\"></a>为什么使用Spring AOP实现日记记录？</h1><ul>\n<li>Spring AOP是Spring框架的两大核心之一，是Spring框架的一部分，Spring AOP可以直接在Spring应用中直接使用。</li>\n<li>Spring AOP是一种极其优秀的AOP思想实现，对业务逻辑代码完全无侵入性，代码可维护性高。</li>\n</ul>\n<h1 id=\"使用Spring-AOP实现日志记录\"><a href=\"#使用Spring-AOP实现日志记录\" class=\"headerlink\" title=\"使用Spring AOP实现日志记录\"></a>使用Spring AOP实现日志记录</h1><h2 id=\"搭建项目环境\"><a href=\"#搭建项目环境\" class=\"headerlink\" title=\"搭建项目环境\"></a>搭建项目环境</h2><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.0.4.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"comment\">&lt;!--SpringMVC的启动器依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--Spring整合junit测试的启动器依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-test<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>test<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--Spring AOP的启动器依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-aop<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--lombck的依赖，用于生产getter和setter方法--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.projectlombok<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>lombok<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--数据库驱动--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>mysql<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--MyBatisPlus的启动器依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.baomidou<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.0.5<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建数据库日志表\"><a href=\"#创建数据库日志表\" class=\"headerlink\" title=\"创建数据库日志表\"></a>创建数据库日志表</h2><figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> `log` (</span><br><span class=\"line\">  `id` <span class=\"type\">int</span>(<span class=\"number\">10</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> AUTO_INCREMENT,</span><br><span class=\"line\">  `visit_time` datetime <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">  `username` <span class=\"type\">varchar</span>(<span class=\"number\">20</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">  `ip` <span class=\"type\">varchar</span>(<span class=\"number\">20</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">  `uri` <span class=\"type\">varchar</span>(<span class=\"number\">50</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">  `<span class=\"keyword\">method</span>` <span class=\"type\">varchar</span>(<span class=\"number\">100</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">  `execution_time` <span class=\"type\">bigint</span>(<span class=\"number\">20</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">  `exception_name` <span class=\"type\">varchar</span>(<span class=\"number\">50</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">  `exception_message` <span class=\"type\">varchar</span>(<span class=\"number\">20</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">  <span class=\"keyword\">PRIMARY</span> KEY (`id`)</span><br><span class=\"line\">) ENGINE<span class=\"operator\">=</span>InnoDB AUTO_INCREMENT<span class=\"operator\">=</span><span class=\"number\">19</span> <span class=\"keyword\">DEFAULT</span> CHARSET<span class=\"operator\">=</span>utf8;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建日志实体类\"><a href=\"#创建日志实体类\" class=\"headerlink\" title=\"创建日志实体类\"></a>创建日志实体类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@TableName(&quot;log&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Log</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@TableId(type = IdType.AUTO)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Long id;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Date visitTime;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String ip;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String uri;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String method;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Long executionTime;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String exceptionName;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String exceptionMessage;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Controller层的接口编写\"><a href=\"#Controller层的接口编写\" class=\"headerlink\" title=\"Controller层的接口编写\"></a>Controller层的接口编写</h2><ul>\n<li>Controller层的接口方法是建立在<a href=\"/2020/03/16/java/SpringBoot+MyBatisPlus/\">SpringBoot+MyBatisPlus</a>博客搭建的项目环境之上的。</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;user&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserController</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> UserService userService;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping(&quot;page/&#123;currentPage&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> ResponseEntity&lt;IPage&lt;User&gt;&gt; <span class=\"title function_\">findUserByPage</span><span class=\"params\">(</span></span><br><span class=\"line\"><span class=\"params\">            <span class=\"meta\">@PathVariable(&quot;currentPage&quot;)</span> Integer currentPage,</span></span><br><span class=\"line\"><span class=\"params\">            <span class=\"meta\">@RequestParam(defaultValue = &quot;5&quot;)</span> Integer size)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">1</span>/<span class=\"number\">0</span>;\t\t<span class=\"comment\">//这里设置一个异常，用于测试</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> ResponseEntity.ok(userService.findUserByPage(currentPage, size));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping(&quot;add&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> ResponseEntity&lt;Void&gt; <span class=\"title function_\">saveUser</span><span class=\"params\">(User user)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        userService.saveUser(user);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ResponseEntity.status(HttpStatus.OK).build();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@DeleteMapping(&quot;&#123;id&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> ResponseEntity&lt;Void&gt; <span class=\"title function_\">delUserById</span><span class=\"params\">(<span class=\"meta\">@PathVariable(&quot;id&quot;)</span> Long id)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        userService.delUserById(id);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ResponseEntity.status(HttpStatus.OK).build();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@PutMapping(&quot;update&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> ResponseEntity&lt;Void&gt; <span class=\"title function_\">updateUser</span><span class=\"params\">(User user)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        userService.updateUser(user);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ResponseEntity.status(HttpStatus.OK).build();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"AOP切面类的编写\"><a href=\"#AOP切面类的编写\" class=\"headerlink\" title=\"AOP切面类的编写\"></a>AOP切面类的编写</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Aspect</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">LogAop</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> HttpServletRequest request;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> LogDao logDao;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Log log;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Pointcut(&quot;execution(* com.hrp.web.*.*(..))&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">controllerAOP</span><span class=\"params\">()</span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Before(&quot;controllerAOP()&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">doBefore</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        log = <span class=\"keyword\">new</span> <span class=\"title class_\">Log</span>();</span><br><span class=\"line\">        log.setVisitTime(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@After(&quot;controllerAOP()&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">doAfter</span><span class=\"params\">(JoinPoint joinPoint)</span>&#123;</span><br><span class=\"line\">        log.setExecutionTime(System.currentTimeMillis() - log.getVisitTime().getTime());</span><br><span class=\"line\">        log.setIp(request.getRemoteAddr());</span><br><span class=\"line\">        log.setUri(request.getRequestURI());</span><br><span class=\"line\">        log.setMethod(<span class=\"string\">&quot;[类名]&quot;</span>+joinPoint.getTarget().getClass()+<span class=\"string\">&quot;[方法名]&quot;</span>+joinPoint.getSignature().getName());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@AfterReturning(&quot;controllerAOP()&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">doAfterReturning</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        logDao.insert(log);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@AfterThrowing(value = &quot;controllerAOP()&quot;,throwing = &quot;e&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">doException</span><span class=\"params\">(Exception e)</span>&#123;</span><br><span class=\"line\">        log.setExceptionName(e.getClass().getName());</span><br><span class=\"line\">        log.setExceptionMessage(e.getMessage());</span><br><span class=\"line\">        logDao.insert(log);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"功能测试\"><a href=\"#功能测试\" class=\"headerlink\" title=\"功能测试\"></a>功能测试</h2><p>启动项目，访问<code>/user/page/2</code>接口，分页查询用户数据。<br>访问<code>/user/2</code>接口，删除id为2的用户信息。<br>最终数据库中的日志记录数据如下：</p>\n<p><img src=\"/images/2020/03/20200320193915781.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["Java"],"tags":["Java","Spring","AOP"]},{"title":"启动SpringBoot报错：The bean ‘beanNameViewResolver‘ 无法注册","url":"/2021/03/24/java/%E5%90%AF%E5%8A%A8SpringBoot%E6%8A%A5%E9%94%99%EF%BC%9AThe%20bean%20%E2%80%98beanNameViewResolver%E2%80%98%20%E6%97%A0%E6%B3%95%E6%B3%A8%E5%86%8C/","content":"<h2 id=\"问题描述\"><a href=\"#问题描述\" class=\"headerlink\" title=\"问题描述\"></a>问题描述</h2><p>在引入 easypoi 的相关依赖之后，无法启动 SpringBootApplication 服务。</p>\n<span id=\"more\"></span>\n\n<p>easypoi 依赖：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>cn.afterturn<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>easypoi-spring-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;easypoi.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>启动SpringBootApplication报错，报错信息如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">Error starting ApplicationContext. To display the conditions report re-run your application with <span class=\"string\">&#x27;debug&#x27;</span> enabled.</span><br><span class=\"line\"><span class=\"number\">2021</span>-<span class=\"number\">03</span>-<span class=\"number\">24</span> <span class=\"number\">22</span>:<span class=\"number\">58</span>:<span class=\"number\">25.213</span> ERROR <span class=\"number\">8208</span> --- [           main] o.s.b.d.LoggingFailureAnalysisReporter   : </span><br><span class=\"line\"></span><br><span class=\"line\">***************************</span><br><span class=\"line\">APPLICATION FAILED TO START</span><br><span class=\"line\">***************************</span><br><span class=\"line\"></span><br><span class=\"line\">Description:</span><br><span class=\"line\"></span><br><span class=\"line\">The bean <span class=\"string\">&#x27;beanNameViewResolver&#x27;</span>, defined in <span class=\"keyword\">class</span> <span class=\"title class_\">path</span> resource [cn/afterturn/easypoi/configuration/EasyPoiAutoConfiguration.class], could not be registered. A bean with that name has already been defined in <span class=\"keyword\">class</span> <span class=\"title class_\">path</span> resource [org/springframework/boot/autoconfigure/web/servlet/error/ErrorMvcAutoConfiguration$WhitelabelErrorViewConfiguration.class] and overriding is disabled.</span><br><span class=\"line\"></span><br><span class=\"line\">Action:</span><br><span class=\"line\"></span><br><span class=\"line\">Consider renaming one of the beans or enabling overriding by setting spring.main.allow-bean-definition-overriding=<span class=\"literal\">true</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">Process finished with exit code <span class=\"number\">1</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"报错原因\"><a href=\"#报错原因\" class=\"headerlink\" title=\"报错原因\"></a>报错原因</h2><p>这是因为在 easypoi 的依赖中，有一个注册名称为 <code>beanNameViewResolver</code> 的 Bean 的名称与 SpringBoot 中的一个 Bean 的名称相同，发生了 Bean 名称注册冲突。</p>\n<p>easypoi 的 <code>beanNameViewResolver</code>：<br><img src=\"/images/2021/03/20210324231020985.png\" alt=\"在这里插入图片描述\"></p>\n<p>SpringBoot 的 <code>beanNameViewResolver</code>：<br><img src=\"/images/2021/03/20210324231042374.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"解决方法\"><a href=\"#解决方法\" class=\"headerlink\" title=\"解决方法\"></a>解决方法</h2><p>配置允许 Bean 的定义覆盖属性为 <code>true</code></p>\n<figure class=\"highlight yml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">main:</span></span><br><span class=\"line\">    <span class=\"attr\">allow-bean-definition-overriding:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n","categories":["Java"],"tags":["Java","SpringBoot"]},{"title":"启动SpringBoot项目报错","url":"/2021/01/19/java/%E5%90%AF%E5%8A%A8SpringBoot%E9%A1%B9%E7%9B%AE%E6%8A%A5%E9%94%99/","content":"<p>在启动SpringBoot项目的时候，项目却报错误信息：</p>\n<span id=\"more\"></span>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">2021</span>-<span class=\"number\">01</span>-<span class=\"number\">19</span> <span class=\"number\">17</span>:<span class=\"number\">27</span>:<span class=\"number\">38.735</span> ERROR <span class=\"number\">12308</span> --- [           main] o.s.b.d.LoggingFailureAnalysisReporter   : </span><br><span class=\"line\"></span><br><span class=\"line\">***************************</span><br><span class=\"line\">APPLICATION FAILED TO START</span><br><span class=\"line\">***************************</span><br><span class=\"line\"></span><br><span class=\"line\">Description:</span><br><span class=\"line\"></span><br><span class=\"line\">Failed to configure a DataSource: <span class=\"string\">&#x27;url&#x27;</span> attribute is not specified and no embedded datasource could be configured.</span><br><span class=\"line\"></span><br><span class=\"line\">Reason: Failed to determine a suitable driver class</span><br></pre></td></tr></table></figure>\n\n<p>这个报错原因是因为：在SpringBoot项目中引入了SpringDataJpa或者MyBatis等持久层框架，但是在项目的配置文件中却没有配置数据库的链接信息导致的。</p>\n<p><strong>解决方案：在SpringBoot的配置文件中配置数据库的链接信息。</strong></p>\n<p>例如：</p>\n<ul>\n<li>application.yml</li>\n</ul>\n<figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"comment\"># 数据库连接信息</span></span><br><span class=\"line\">  <span class=\"attr\">datasource:</span></span><br><span class=\"line\">    <span class=\"attr\">driver-class-name:</span> <span class=\"string\">com.mysql.cj.jdbc.Driver</span></span><br><span class=\"line\">    <span class=\"attr\">url:</span> <span class=\"string\">jdbc:mysql://127.0.0.1:3306/mybean?characterEncoding=utf8&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai</span></span><br><span class=\"line\">    <span class=\"attr\">username:</span> <span class=\"string\">root</span></span><br><span class=\"line\">    <span class=\"attr\">password:</span> <span class=\"string\">admin</span></span><br></pre></td></tr></table></figure>\n\n","categories":["Java"],"tags":["Java","SpringBoot"]},{"title":"基于Spring AOP和Java注解实现日志记录","url":"/2020/04/17/java/%E5%9F%BA%E4%BA%8ESpring%20AOP%E5%92%8CJava%E6%B3%A8%E8%A7%A3%E5%AE%9E%E7%8E%B0%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95/","content":"<blockquote>\n<p>我以前写过一篇博客，[使用Spring AOP实现日志记录](/2020/03/20/java/使用Spring AOP实现日志记录/)。<br>这篇博客中使用Spring AOP技术对应用中所有的的Controller进行横切，凡是访问Controller的请求都进行日志记录。<br>但是在真正的日常生产中，我们可能不会对所有的访问进行记录，而是对一部分特殊的请求进行日志记录，这就需要我们对AOP的切入点进行区别。<br>我们可以使用Java注解来对Controller进行区分，而Spring AOP也正好支持注解方式的切入点。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h2 id=\"搭建项目环境\"><a href=\"#搭建项目环境\" class=\"headerlink\" title=\"搭建项目环境\"></a>搭建项目环境</h2><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.0.4.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"comment\">&lt;!--SpringMVC的启动器依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--Spring整合junit测试的启动器依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-test<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>test<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--Spring AOP的启动器依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-aop<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--lombck的依赖，用于生产getter和setter方法--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.projectlombok<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>lombok<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--数据库驱动--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>mysql<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--MyBatisPlus的启动器依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.baomidou<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.0.5<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"创建数据库日志表\"><a href=\"#创建数据库日志表\" class=\"headerlink\" title=\"创建数据库日志表\"></a>创建数据库日志表</h2><figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> `log` (</span><br><span class=\"line\">  `id` <span class=\"type\">int</span>(<span class=\"number\">10</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> AUTO_INCREMENT,</span><br><span class=\"line\">  `visit_time` datetime <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">  `username` <span class=\"type\">varchar</span>(<span class=\"number\">20</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">  `ip` <span class=\"type\">varchar</span>(<span class=\"number\">20</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">  `uri` <span class=\"type\">varchar</span>(<span class=\"number\">50</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">  `<span class=\"keyword\">method</span>` <span class=\"type\">varchar</span>(<span class=\"number\">100</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">  `execution_time` <span class=\"type\">bigint</span>(<span class=\"number\">20</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">  `exception_name` <span class=\"type\">varchar</span>(<span class=\"number\">50</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">  `exception_message` <span class=\"type\">varchar</span>(<span class=\"number\">20</span>) <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">  <span class=\"keyword\">PRIMARY</span> KEY (`id`)</span><br><span class=\"line\">) ENGINE<span class=\"operator\">=</span>InnoDB AUTO_INCREMENT<span class=\"operator\">=</span><span class=\"number\">19</span> <span class=\"keyword\">DEFAULT</span> CHARSET<span class=\"operator\">=</span>utf8;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建日志实体类\"><a href=\"#创建日志实体类\" class=\"headerlink\" title=\"创建日志实体类\"></a>创建日志实体类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"meta\">@TableName(&quot;log&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Log</span> &#123;</span><br><span class=\"line\">    <span class=\"meta\">@TableId(type = IdType.AUTO)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Long id;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Date visitTime;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String ip;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String uri;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String method;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Long executionTime;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String exceptionName;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String exceptionMessage;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"创建日志记录注解\"><a href=\"#创建日志记录注解\" class=\"headerlink\" title=\"创建日志记录注解\"></a>创建日志记录注解</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target(ElementType.METHOD)</span></span><br><span class=\"line\"><span class=\"meta\">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> LogAnnotation &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"Controller层的接口编写\"><a href=\"#Controller层的接口编写\" class=\"headerlink\" title=\"Controller层的接口编写\"></a>Controller层的接口编写</h2><ul>\n<li>Controller层的接口方法是建立在<a href=\"/2020/03/16/java/SpringBoot+MyBatisPlus/\">SpringBoot+MyBatisPlus</a>博客搭建的项目环境之上的。</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;user&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserController</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> UserService userService;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping(&quot;page/&#123;currentPage&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> ResponseEntity&lt;IPage&lt;User&gt;&gt; <span class=\"title function_\">findUserByPage</span><span class=\"params\">(</span></span><br><span class=\"line\"><span class=\"params\">            <span class=\"meta\">@PathVariable(&quot;currentPage&quot;)</span> Integer currentPage,</span></span><br><span class=\"line\"><span class=\"params\">            <span class=\"meta\">@RequestParam(defaultValue = &quot;5&quot;)</span> Integer size)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ResponseEntity.ok(userService.findUserByPage(currentPage, size));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping(&quot;add&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> ResponseEntity&lt;Void&gt; <span class=\"title function_\">saveUser</span><span class=\"params\">(User user)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        userService.saveUser(user);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ResponseEntity.status(HttpStatus.OK).build();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@LogAnnotation</span></span><br><span class=\"line\">    <span class=\"meta\">@DeleteMapping(&quot;&#123;id&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> ResponseEntity&lt;Void&gt; <span class=\"title function_\">delUserById</span><span class=\"params\">(<span class=\"meta\">@PathVariable(&quot;id&quot;)</span> Integer id)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        userService.delUserById(id);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ResponseEntity.status(HttpStatus.OK).build();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"meta\">@LogAnnotation</span></span><br><span class=\"line\">    <span class=\"meta\">@PutMapping(&quot;update&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> ResponseEntity&lt;Void&gt; <span class=\"title function_\">updateUser</span><span class=\"params\">(User user)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        userService.updateUser(user);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ResponseEntity.status(HttpStatus.OK).build();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"AOP切面类的编写\"><a href=\"#AOP切面类的编写\" class=\"headerlink\" title=\"AOP切面类的编写\"></a>AOP切面类的编写</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Aspect</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">LogAop</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> HttpServletRequest request;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> LogDao logDao;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Log log;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">//切入点中的值使用@annotation，表示这是一个注解切入点，凡是被该注解标识的方法，都会被AOP切入</span></span><br><span class=\"line\">    <span class=\"meta\">@Pointcut(&quot;@annotation(com.hrp.annotation.LogAnnotation)&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">controllerAOP</span><span class=\"params\">()</span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Before(&quot;controllerAOP()&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">doBefore</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        log = <span class=\"keyword\">new</span> <span class=\"title class_\">Log</span>();</span><br><span class=\"line\">        log.setVisitTime(<span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@After(&quot;controllerAOP()&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">doAfter</span><span class=\"params\">(JoinPoint joinPoint)</span>&#123;</span><br><span class=\"line\">        log.setExecutionTime(System.currentTimeMillis() - log.getVisitTime().getTime());</span><br><span class=\"line\">        log.setIp(request.getRemoteAddr());</span><br><span class=\"line\">        log.setUri(request.getRequestURI());</span><br><span class=\"line\">        log.setMethod(<span class=\"string\">&quot;[类名]&quot;</span>+joinPoint.getTarget().getClass()+<span class=\"string\">&quot;[方法名]&quot;</span>+joinPoint.getSignature().getName());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@AfterReturning(&quot;controllerAOP()&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">doAfterReturning</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        logDao.insert(log);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@AfterThrowing(value = &quot;controllerAOP()&quot;,throwing = &quot;e&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">doException</span><span class=\"params\">(Exception e)</span>&#123;</span><br><span class=\"line\">        log.setExceptionName(e.getClass().getName());</span><br><span class=\"line\">        log.setExceptionMessage(e.getMessage());</span><br><span class=\"line\">        logDao.insert(log);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"功能测试\"><a href=\"#功能测试\" class=\"headerlink\" title=\"功能测试\"></a>功能测试</h2><p>我们启动项目，访问Controller层的四个路径，结果如下：<br>| RUI | 是否注解 | AOP是否切入 |<br>|–|–|–|<br>| /user/page/{currentPage} | 否 |  否 |<br>| /user/add | 否 | 否  |<br>| /user/{id} | 是 | 是  |<br>| /user/update | 是 | 是  |</p>\n","categories":["Java"],"tags":["Java","SpringBoot","AOP"]},{"title":"基于Spring JDBCTemplate的数据库读写分离和主从复制","url":"/2023/06/03/java/%E5%9F%BA%E4%BA%8ESpring%20JDBCTemplate%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB%E5%92%8C%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6/","content":"<p>数据库读写分离是很多互联网系统中用于提升访问性能的一种手段，其主要实现方式，便是将互联网系统对数据库的读操作和写操作分离在不同的数据库中，从而减少了数据库系统对锁资源的竞争，提升了系统数据库的性能。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"为什么要读写分离？\"><a href=\"#为什么要读写分离？\" class=\"headerlink\" title=\"为什么要读写分离？\"></a>为什么要读写分离？</h2><p>如果一个系统的数据量并不多，对系统性能要求也不是很高，那么单体数据库结构完全可以胜任系统对数据的操作需求。</p>\n<p>但是如果系统的数据量很多，且对数据库的并发操作很多，那么单体数据库结构就可能会成为系统性能降低的关键点。</p>\n<p>为什么？</p>\n<p>在考虑为什么的时候，我们首先要明白数据库并发情况下的锁操作。</p>\n<p>当数据库执行查询操作的时候，事务会对数据添加共享锁（读锁），一个数据在添加了共享锁（读锁）的情况下，可以由另外的事务继续对该数据添加共享锁（读锁），但是却不允许对该数据库添加排他锁（写锁）。</p>\n<p>当数据库执行更新操作的时候，事务会对数据添加排他锁（写锁），同时不允许其他事务对该数据库添加任意锁（读锁和写锁）。</p>\n<p>这就导致单体数据库结构在同时有事务执行查询操作和更新操作的时候，会不断对数据添加共享锁或者是排他锁。</p>\n<p>其中，数据库执行更新操作对资源的消耗远大于查询操作，更新操作耗时更长，且排他锁（写锁）导致查询操作无法获取锁而阻塞，从而导致了性能的降低。</p>\n<h2 id=\"怎么解决性能问题？\"><a href=\"#怎么解决性能问题？\" class=\"headerlink\" title=\"怎么解决性能问题？\"></a>怎么解决性能问题？</h2><p>我们可以使用读写分离的方式来解决单体数据库的性能问题。</p>\n<p>其主要思路为：</p>\n<p>1、将系统的读操作和写操作分别使用两个数据库来实现，其中主数据库用于执行写操作，从数据库用于读操作。</p>\n<p>2、使用脚本或者中间件从主数据库中同步数据到从数据库，从而保证了两个数据库的数据最终一致性。</p>\n<p>读写分离的好处显而易见，即便系统对主数据库进行写操作，也丝毫不影响系统对从数据库执行读操作，两个数据库之间并没有对数据的锁竞争，从而避免了大量的资源消耗。</p>\n<p>但是读写分离的缺点也很明显，因为从主数据库上同步数据到从数据库需要一定的时间，那么在对主数据库执行完成写操作后，可能无法立即从从数据库中读取到即时的信息，也就是数据的同步存在一定的时间延迟（这个时间延迟在系统上可能是以秒为单位），这就要求系统对数据的及时性要求不是那么高。</p>\n<h2 id=\"读写分离的具体实现\"><a href=\"#读写分离的具体实现\" class=\"headerlink\" title=\"读写分离的具体实现\"></a>读写分离的具体实现</h2><p>读写分离的实现机制非常简单，因为读写分离需要操作两个数据库，所以在系统中需要定义两个数据库源，写操作使用主数据库源，读操作使用从数据库源即可。</p>\n<p>我们可以使用 <code>Spring JdbcTemplate</code>来实现一个简单的读写分离系统。</p>\n<h3 id=\"相关依赖\"><a href=\"#相关依赖\" class=\"headerlink\" title=\"相关依赖\"></a>相关依赖</h3><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--Lombox--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.projectlombok<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>lombok<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.16.22<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>provided<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- Spring --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-context<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>5.3.23<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-jdbc<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>5.3.23<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-test<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>5.3.23<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>test<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- MySql --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>mysql<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>5.1.32<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- 连接池 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.alibaba<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>druid<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.0.9<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>junit<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>junit<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>4.12<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>test<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"Spring-配置\"><a href=\"#Spring-配置\" class=\"headerlink\" title=\"Spring 配置\"></a>Spring 配置</h3><p>简单的Spring项目使用 <code>application.xml</code> 作为配置文件</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--写操作JdbcTemplate对象，注入主数据库源对象--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;writeJdbc&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;org.springframework.jdbc.core.JdbcTemplate&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;dataSource&quot;</span> <span class=\"attr\">ref</span>=<span class=\"string\">&quot;dataSourceMaster&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">&lt;!--读操作JdbcTemplate对象，注入从数据库源对象--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;readJdbc&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;org.springframework.jdbc.core.JdbcTemplate&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;dataSource&quot;</span> <span class=\"attr\">ref</span>=<span class=\"string\">&quot;dataSourceSlave&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">&lt;!--定义主数据库源配置--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;dataSourceMaster&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;driverClassName&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;url&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;jdbc:mysql:///db_master&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;username&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;root&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;password&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;admin&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">&lt;!--定义从数据库源配置--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;dataSourceSlave&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;driverClassName&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;url&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;jdbc:mysql:///db_slaves&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;username&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;root&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;password&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;admin&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">&lt;!--包扫描--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">context:component-scan</span> <span class=\"attr\">base-package</span>=<span class=\"string\">&quot;com.hrp&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"DAO-层\"><a href=\"#DAO-层\" class=\"headerlink\" title=\"DAO 层\"></a>DAO 层</h3><p>由于篇幅有限，在这里省略了接口 <code>UserDao</code> 接口和 <code>User</code> 实体类的代码。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Repository</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserDaoImpl</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">UserDao</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired()</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> JdbcTemplate writeJdbc;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired()</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> JdbcTemplate readJdbc;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 从主数据库写入一个对象数据</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">saveUser</span><span class=\"params\">(User user)</span> &#123;</span><br><span class=\"line\">        writeJdbc.update(<span class=\"string\">&quot;insert into user(username,password,email) values(?,?,?)&quot;</span>, user.getUsername(),</span><br><span class=\"line\">                user.getPassword(), user.getEmail());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 从主数据库读取所有数据</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;User&gt; <span class=\"title function_\">selectList</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> writeJdbc.query(<span class=\"string\">&quot;select * from user&quot;</span>, <span class=\"keyword\">new</span> <span class=\"title class_\">BeanPropertyRowMapper</span>&lt;&gt;(User.class));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 从从数据库读取所有数据</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;User&gt; <span class=\"title function_\">findAll</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> readJdbc.query(<span class=\"string\">&quot;select * from user&quot;</span>, <span class=\"keyword\">new</span> <span class=\"title class_\">BeanPropertyRowMapper</span>&lt;&gt;(User.class));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>我们可以简单使用一个测试方式来测试主从数据库是否使用成功。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RunWith(SpringJUnit4ClassRunner.class)</span></span><br><span class=\"line\"><span class=\"meta\">@ContextConfiguration(locations = &quot;classpath:application.xml&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserDaoTest</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> UserDao userDao;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">demo01</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 给主数据库写入一条数据</span></span><br><span class=\"line\">        userDao.saveUser(<span class=\"keyword\">new</span> <span class=\"title class_\">User</span>(<span class=\"string\">&quot;hrp&quot;</span>, <span class=\"string\">&quot;111111&quot;</span>, <span class=\"string\">&quot;he@qq.com&quot;</span>));</span><br><span class=\"line\">        <span class=\"comment\">// 从从数据库读取数据</span></span><br><span class=\"line\">        List&lt;User&gt; list1 = userDao.findAll();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;从数据库中的数据：&quot;</span> + list1.size());</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (User user : list1) &#123;</span><br><span class=\"line\">            System.out.println(user);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 从主数据库读取数据</span></span><br><span class=\"line\">        List&lt;User&gt; list2 = userDao.selectList();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;主数据库中的数据：&quot;</span> + list2.size());</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (User user : list2) &#123;</span><br><span class=\"line\">            System.out.println(user);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>我们执行之后，可以看到写入到主数据的数据写入成功，但是从从数据库读取的数据依然为空（这是因为从数据库没有从主数据库同步数据的缘故），而从主数据库则能够读取到先前写入的数据。</p>\n<p>由此可见，系统使用两个数据源分别进行读写操作是成功了的。</p>\n<h2 id=\"面向切面编程\"><a href=\"#面向切面编程\" class=\"headerlink\" title=\"面向切面编程\"></a>面向切面编程</h2><p>在 <code>DAO</code>注入两个不同数据源的 <code>JdbcTemplate</code> 对象的实现方式非常简洁明了，但是缺点也很明显，必须由开发者自己指定数据源，对 业务代码逻辑有入侵。</p>\n<p>我们可以使用 <code>Spring AOP</code>面向切面编程，使系统底层在执行 <code>SQL</code> 的时候自动切换对应的数据库源，从而将数据库源的选择逻辑从业务代码中移除出去。</p>\n<h3 id=\"添加AOP依赖\"><a href=\"#添加AOP依赖\" class=\"headerlink\" title=\"添加AOP依赖\"></a>添加AOP依赖</h3><p>SpringAOP需要添加相关依赖，在上述的 <code>pom.xml</code> 文件中添加新的 <code>Maven</code> 依赖即可。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.aspectj<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>aspectjrt<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.5.4<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>compile<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.aspectj<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>aspectjweaver<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.9.7<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Spring-配置-1\"><a href=\"#Spring-配置-1\" class=\"headerlink\" title=\"Spring 配置\"></a>Spring 配置</h3><p>application.xml 文件也需要做一些简单的修改，主要是修改注入 <code>JdbcTemplate</code> 对象的数据源对象，以及开启 <code>aop</code>相关配置。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- 开启 AOP 注解支持 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">context:annotation-config</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">aop:aspectj-autoproxy</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">&lt;!--动态数据源、主从库选择--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;dynamicDataSource&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;com.hrp.DynamicDataSource&quot;</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- 配置Jdbc模板 --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;jdbcTemplate&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;org.springframework.jdbc.core.JdbcTemplate&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;dataSource&quot;</span> <span class=\"attr\">ref</span>=<span class=\"string\">&quot;dynamicDataSource&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;dataSourceMaster&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;driverClassName&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;url&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;jdbc:mysql:///db_master&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;username&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;root&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;password&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;admin&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;dataSourceSlave&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;driverClassName&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;com.mysql.jdbc.Driver&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;url&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;jdbc:mysql:///db_slaves&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;username&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;root&quot;</span>/&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;password&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;admin&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">context:component-scan</span> <span class=\"attr\">base-package</span>=<span class=\"string\">&quot;com.hrp&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"定义数据源注解\"><a href=\"#定义数据源注解\" class=\"headerlink\" title=\"定义数据源注解\"></a>定义数据源注解</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target(ElementType.METHOD)</span></span><br><span class=\"line\"><span class=\"meta\">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class=\"line\"><span class=\"meta\">@Documented</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> DataSource &#123;</span><br><span class=\"line\">    <span class=\"type\">boolean</span> <span class=\"title function_\">master</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"数据源路由选择器\"><a href=\"#数据源路由选择器\" class=\"headerlink\" title=\"数据源路由选择器\"></a>数据源路由选择器</h3><p>Spring 中提供了 <code>AbstractRoutingDataSource</code> 抽象类作为数据源路由的选择器，开发者可以重写其中的方法，实现自定义路由选择策略。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DynamicDataSource</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">AbstractRoutingDataSource</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 主库</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> DataSource dataSourceMaster;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 从库</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> DataSource dataSourceSlave;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">DEFAULT</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;default&quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"type\">String</span> <span class=\"variable\">SLAVE</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;slave&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> ThreadLocal&lt;LinkedList&lt;String&gt;&gt; dataSourceHolder = ThreadLocal.withInitial(LinkedList::<span class=\"keyword\">new</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">afterPropertiesSet</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        Map&lt;Object, Object&gt; dataSources = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;();</span><br><span class=\"line\">        dataSources.put(DEFAULT, dataSourceMaster);</span><br><span class=\"line\">        dataSources.put(SLAVE, dataSourceSlave);</span><br><span class=\"line\">        <span class=\"comment\">// 设置一个默认的数据源，保证路由选择器在无法选择的情况下可以使用默认数据源执行操作</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.setDefaultTargetDataSource(dataSourceMaster);</span><br><span class=\"line\">        <span class=\"comment\">// 设置一个 Map 结构的数据源集，后续使用重写 determineCurrentLookupKey 方法返回对应的 Key值，即可实现路由选择</span></span><br><span class=\"line\">        <span class=\"built_in\">this</span>.setTargetDataSources(dataSources);</span><br><span class=\"line\">        <span class=\"built_in\">super</span>.afterPropertiesSet();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">protected</span> Object <span class=\"title function_\">determineCurrentLookupKey</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 选择需要使用的路由 Key 值</span></span><br><span class=\"line\">        LinkedList&lt;String&gt; dataSourceKeys = dataSourceHolder.get();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> dataSourceKeys.pollFirst();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 选择使用主库，并把选择放到当前ThreadLocal的栈顶</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">useMaster</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        LinkedList&lt;String&gt; dataSourceKeys = dataSourceHolder.get();</span><br><span class=\"line\">        dataSourceKeys.offerFirst(DEFAULT);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 选择使用从库，并把选择放到当前ThreadLocal的栈顶</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">useSlave</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        LinkedList&lt;String&gt; dataSourceKeys = dataSourceHolder.get();</span><br><span class=\"line\">        dataSourceKeys.offerFirst(SLAVE);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"AOP切面\"><a href=\"#AOP切面\" class=\"headerlink\" title=\"AOP切面\"></a>AOP切面</h3><p>AOP 切面主要做的事情便是拦截所有有 <code>@DataSource</code> 注解的方法，并根据注解值选择相关的路由。</p>\n<p>没有 <code>@DataSource</code> 注解的方法则会使用默认的数据源。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Aspect</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DataSourceAspect</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Pointcut(value = &quot;@annotation(com.hrp.DataSource)&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title function_\">dataSource</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Around(value = &quot;dataSource() &quot;, argNames = &quot;point&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Object <span class=\"title function_\">doAround</span><span class=\"params\">(ProceedingJoinPoint point)</span> <span class=\"keyword\">throws</span> Throwable &#123;</span><br><span class=\"line\">        <span class=\"type\">MethodSignature</span> <span class=\"variable\">methodSignature</span> <span class=\"operator\">=</span> (MethodSignature) point.getSignature();</span><br><span class=\"line\">        <span class=\"type\">Method</span> <span class=\"variable\">method</span> <span class=\"operator\">=</span> methodSignature.getMethod();</span><br><span class=\"line\">        <span class=\"comment\">// 这个方法才是目标对象上有注解的方法</span></span><br><span class=\"line\">        <span class=\"type\">Method</span> <span class=\"variable\">realMethod</span> <span class=\"operator\">=</span> point.getTarget().getClass().getDeclaredMethod(methodSignature.getName(), method.getParameterTypes());</span><br><span class=\"line\">        <span class=\"type\">DataSource</span> <span class=\"variable\">annotation</span> <span class=\"operator\">=</span> realMethod.getAnnotation(DataSource.class);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (annotation != <span class=\"literal\">null</span> &amp;&amp; !annotation.master()) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 只有当注解指明使用从数据库的时候才使用</span></span><br><span class=\"line\">            DynamicDataSource.useSlave();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 否则优先使用主数据库进行读写操作</span></span><br><span class=\"line\">            DynamicDataSource.useMaster();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> point.proceed();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>最终我们使用同样的测试方法，可以得到同样的测试结果，说明我们使用注解来选择路由的方式成功了，从而将读写分离的代码从业务代码中隔离了开来，保证了代码的健壮和简洁。</p>\n<p>后续我们只需要保证从数据库能够实时同步主数据库的数据，即可实现主从数据库读写分离的完整版本。</p>\n<h2 id=\"MySQL-主从复制\"><a href=\"#MySQL-主从复制\" class=\"headerlink\" title=\"MySQL 主从复制\"></a>MySQL 主从复制</h2><p>我们可以使用 <code>Docker</code> 来快速部署 <code>MySQL</code>主从服务器，并实现主从复制。</p>\n<h3 id=\"配置文件\"><a href=\"#配置文件\" class=\"headerlink\" title=\"配置文件\"></a>配置文件</h3><p>在本地目录创建并编辑<code>docker.cnf</code> 文件并使用 <code>Docker</code>将配置文件复制到 <code>MySQL</code> 实例中。</p>\n<blockquote>\n<p>需要注意，有些<code>Docker</code>镜像的配置文件是 <code>my.cnf</code>，开发者需要根据具体情况自己判断 <code>MySQL</code>的配置文件</p>\n</blockquote>\n<ul>\n<li>1、设置主数据库配置</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">cd /tmp/mysql</span><br><span class=\"line\">mkdir master</span><br><span class=\"line\">vim /tmp/mysql/master/docker.cnf</span><br></pre></td></tr></table></figure>\n<p><code>/tmp/mysql/master/docker.cnf</code>文件内容</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">[mysqld]</span><br><span class=\"line\">server-id=1</span><br><span class=\"line\">log-bin=mysql-bin</span><br></pre></td></tr></table></figure>\n\n\n<ul>\n<li>2、设置从数据库配置</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">cd /tmp/mysql</span><br><span class=\"line\">mkdir slave</span><br><span class=\"line\">vim /tmp/mysql/slave/docker.cnf</span><br></pre></td></tr></table></figure>\n<p><code>/tmp/mysql/slave/docker.cnf</code>文件内容</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">[mysqld]</span><br><span class=\"line\">server-id=2</span><br><span class=\"line\">log-bin=mysql-slave-bin</span><br><span class=\"line\">relay_log=edu-mysql-relay-bin</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"启动数据库\"><a href=\"#启动数据库\" class=\"headerlink\" title=\"启动数据库\"></a>启动数据库</h3><p>我们首先使用 <code>Docker</code> 启动两个 <code>MySQL</code> 实例，并将端口设置为 <code>3307</code> 和 <code>3308</code>。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker run -p 3307:3306 --name master -v /tmp/mysql/master/docker.cnf:/etc/mysql/conf.d/docker.cnf -e TZ=Asia/Shanghai -e MYSQL_ROOT_PASSWORD=admin -d mysql:5.7</span><br><span class=\"line\"></span><br><span class=\"line\">docker run -p 3308:3306 --name slave -v /tmp/mysql/slave/docker.cnf:/etc/mysql/conf.d/docker.cnf -e TZ=Asia/Shanghai -e MYSQL_ROOT_PASSWORD=admin -d mysql:5.7</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"初始化数据库\"><a href=\"#初始化数据库\" class=\"headerlink\" title=\"初始化数据库\"></a>初始化数据库</h3><p>在两个数据库分别执行创建数据库和建表的 <code>SQL</code> 语句。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">CREATE DATABASE `db_ms`;</span><br><span class=\"line\">USE `db_ms`;</span><br><span class=\"line\">CREATE TABLE `user` (</span><br><span class=\"line\">  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT &#x27;唯一ID&#x27;,</span><br><span class=\"line\">  `username` varchar(255) NOT NULL COMMENT &#x27;账号&#x27;,</span><br><span class=\"line\">  `password` varchar(255) NOT NULL COMMENT &#x27;账号密码&#x27;,</span><br><span class=\"line\">  `email` varchar(255) DEFAULT NULL COMMENT &#x27;电子邮件&#x27;,</span><br><span class=\"line\">  PRIMARY KEY (`id`)</span><br><span class=\"line\">) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"主数据库-master\"><a href=\"#主数据库-master\" class=\"headerlink\" title=\"主数据库(master)\"></a>主数据库(master)</h3><p>登录 <code>master</code> 数据库，并使用授权语句创建一个新的账号，并授予权限。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">GRANT REPLICATION SLAVE, REPLICATION CLIENT ON *.* TO &#x27;slave&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;123456&#x27;;</span><br></pre></td></tr></table></figure>\n\n<p>登录 <code>master</code> 数据库，查询数据库具体信息。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">show master status;</span><br></pre></td></tr></table></figure>\n\n<p>使用 <code>Docker</code> 命令查看 <code>master</code> 数据库镜像的 <code>IP</code>。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker inspect --format=&#123;&#123;.NetworkSettings.IPAddress&#125;&#125; master</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"从数据库-slave\"><a href=\"#从数据库-slave\" class=\"headerlink\" title=\"从数据库(slave)\"></a>从数据库(slave)</h3><p>登录 <code>slave</code>数据库，设置主库信息，这里设置的相关信息，都是上面几个步骤设置或查询到的数据。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">CHANGE MASTER TO </span><br><span class=\"line\">MASTER_HOST = &#x27;172.17.0.3&#x27;,</span><br><span class=\"line\">MASTER_PORT = 3306,</span><br><span class=\"line\">MASTER_USER = &#x27;slave&#x27;,</span><br><span class=\"line\">MASTER_PASSWORD = &#x27;123456&#x27;,</span><br><span class=\"line\">MASTER_LOG_FILE = &#x27;mysql-bin.000003&#x27;,</span><br><span class=\"line\">MASTER_LOG_POS = 603;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>重点：MASTER_PORT = 3306，这个配置是并不是使用 <code>Docker</code>启动 <code>MySQL</code>实例的外部端口 3307，而是 <code>Docker</code>实例的内部端口，所以需要配置为 3306，同理，MASTER_HOST 配置是也是 <code>Docker</code> 对应的 IP 地址。</p>\n</blockquote>\n<p>登录 <code>slave</code>数据库，启动从库。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">START SLAVE;</span><br></pre></td></tr></table></figure>\n\n<p>启动后等<code>1-3</code>秒，使用命令查看从库状态。</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">show</span> slave status;</span><br></pre></td></tr></table></figure>\n\n<p>查询的数据中，两个字段对应的值如下，则说明启动成功：</p>\n<table>\n<thead>\n<tr>\n<th>Slave_IO_Running</th>\n<th>Slave_SQL_Running</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Yes</td>\n<td>Yes</td>\n</tr>\n</tbody></table>\n<h3 id=\"测试主从复制\"><a href=\"#测试主从复制\" class=\"headerlink\" title=\"测试主从复制\"></a>测试主从复制</h3><p>测试数据，在 <code>master</code> 数据库执行 <code>SQL</code> 语句，立刻就可以在 <code>slave</code> 数据库中查询到对应的数据信息。</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> `<span class=\"keyword\">user</span>`(username,password,email) <span class=\"keyword\">VALUES</span>(<span class=\"string\">&#x27;herenpeng&#x27;</span>,<span class=\"string\">&#x27;111111&#x27;</span>,<span class=\"string\">&#x27;he@qq.com&#x27;</span>);</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>Spring JdbcTemplate 实现读写分离并不困难，MySQL`数据库的主从配置也只需要修改一些配置文件即可简单实现。</p>\n<p>本文只设置了一个主数据库和一个从数据库，真实环境中，可能会设置一主多从的情况，同学们可以根据本文的思路，自己尝试一下一主多从的读写分离和数据库同步。</p>\n","categories":["Java"],"tags":["Java","MySQL","Spring"]},{"title":"守护线程和用户线程","url":"/2020/03/17/java/%E5%AE%88%E6%8A%A4%E7%BA%BF%E7%A8%8B%E5%92%8C%E7%94%A8%E6%88%B7%E7%BA%BF%E7%A8%8B/","content":"<blockquote>\n<p>Java是一门多线程的语言，其中Java的线程中有守护线程的概念，其中最为常见的守护线程就是<code>GC线程</code>。</p>\n</blockquote>\n<span id=\"more\"></span>\n<h2 id=\"什么是守护线程\"><a href=\"#什么是守护线程\" class=\"headerlink\" title=\"什么是守护线程\"></a>什么是守护线程</h2><p>守护线程其实也是一个线程，不过它和普通的用户线程的区别在于，如果JVM中只存在守护线程正在运行，那么JVM不会等待守护线程运行完毕，直接会结束程序的运行。</p>\n<h2 id=\"守护线程和用户线程的区别\"><a href=\"#守护线程和用户线程的区别\" class=\"headerlink\" title=\"守护线程和用户线程的区别\"></a>守护线程和用户线程的区别</h2><table>\n<thead>\n<tr>\n<th>守护线程</th>\n<th>用户线程</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>JVM不会等待守护线程执行完毕</td>\n<td>JVM会等待用户线程执行完毕</td>\n</tr>\n<tr>\n<td>在守护线程里面创建的线程也是一个守护线程</td>\n<td>在用户线程里面创建的线程是一个用户线程</td>\n</tr>\n<tr>\n<td>守护线程依赖于用户线程的存在，如果用户线程全部退出，那么守护线程也会退出</td>\n<td>用户线程不依赖于其他用户线程，用户线程的退出不会影响其他用户线程执行，同样其他用户线程退出也不会影响用户线程执行</td>\n</tr>\n</tbody></table>\n<h2 id=\"创建守护线程\"><a href=\"#创建守护线程\" class=\"headerlink\" title=\"创建守护线程\"></a>创建守护线程</h2><p>在Java中创建的线程默认都是用户线程，如果需要把一个线程设置为守护线程，那么需要调用该线程的<code>public final void setDaemon(boolean on)</code>方法，参数传入<code>true</code>则为守护线程，默认为<code>false</code>，为用户线程。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">Thread</span> <span class=\"variable\">thread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(()-&gt;System.out.println(Thread.currentThread().getName()+<span class=\"string\">&quot;线程&quot;</span>));</span><br><span class=\"line\">thread.setDaemon(<span class=\"literal\">true</span>);</span><br><span class=\"line\">thread.start();</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"代码示例\"><a href=\"#代码示例\" class=\"headerlink\" title=\"代码示例\"></a>代码示例</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DaemonThreadTest</span> &#123;\t</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(()-&gt;&#123;\t\t</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">try</span> &#123;\t\t</span><br><span class=\"line\">\t\t\t\tSystem.out.println(<span class=\"string\">&quot;用户线程正在运行……&quot;</span>);</span><br><span class=\"line\">\t\t\t\tThread.sleep(<span class=\"number\">5000</span>);</span><br><span class=\"line\">\t\t\t&#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">\t\t\t\te.printStackTrace();</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;).start();</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"type\">Thread</span> <span class=\"variable\">daemonThread</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(()-&gt;&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">new</span> <span class=\"title class_\">Thread</span>(()-&gt; &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">while</span>(<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">\t\t\t\t\t\tSystem.out.println(<span class=\"string\">&quot;守护线程创建的线程同样也是一个守护线程……&quot;</span>);</span><br><span class=\"line\">\t\t\t\t\t\tThread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t&#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">\t\t\t\t\te.printStackTrace();</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;).start();</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">while</span>(<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">\t\t\t\t\tSystem.out.println(<span class=\"string\">&quot;守护线程正在守护……&quot;</span>);</span><br><span class=\"line\">\t\t\t\t\tThread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">\t\t\t\te.printStackTrace();</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;);\t</span><br><span class=\"line\">\t\tdaemonThread.setDaemon(<span class=\"literal\">true</span>);\t\t</span><br><span class=\"line\">\t\tdaemonThread.start();</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>代码执行结果为：</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">用户线程正在运行……</span><br><span class=\"line\">守护线程正在守护……</span><br><span class=\"line\">守护线程创建的线程同样也是一个守护线程……</span><br><span class=\"line\">守护线程创建的线程同样也是一个守护线程……</span><br><span class=\"line\">守护线程正在守护……</span><br><span class=\"line\">守护线程创建的线程同样也是一个守护线程……</span><br><span class=\"line\">守护线程正在守护……</span><br><span class=\"line\">守护线程创建的线程同样也是一个守护线程……</span><br><span class=\"line\">守护线程正在守护……</span><br><span class=\"line\">守护线程创建的线程同样也是一个守护线程……</span><br><span class=\"line\">守护线程正在守护……</span><br></pre></td></tr></table></figure>\n\n","categories":["Java"],"tags":["Java"]},{"title":"手写一个属于自己的框架：mybean-framework","url":"/2020/12/25/java/%E6%89%8B%E5%86%99%E4%B8%80%E4%B8%AA%E5%B1%9E%E4%BA%8E%E8%87%AA%E5%B7%B1%E7%9A%84%E6%A1%86%E6%9E%B6%EF%BC%9Amybean-framework/","content":"<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>MyBean框架最早的时候是在今年2月份创建的，那个时候正值疫情期间无事可做，于是创建了MyBean框架这个项目，本意是模仿Spring框架，加深自己对Web框架和知识的了解，在二、三月份，MyBean框架只做了一个简单的IOC和DI功能。</p>\n<span id=\"more\"></span>\n<p>后来则因为一系列事情，MyBean框架项目就被暂时搁置，很长一段时间都没有继续开发和完善下去。直到最近一段时间，终于抽出时间来重新审视这个在半年多前做的项目，并对其进行了完善。</p>\n<p>在这次的MyBean框架中，几乎对之前的框架进行了完全的重构，并实现了一些Spring框架中开发者常用的功能。</p>\n<p>当然，MyBean框架还远远无法和Spring比较，MyBean框架只能算是一个闲暇之余的“玩具”项目，用来学习和娱乐尚可，但是还无法真正承担起生产中的Web开发的重任。</p>\n<h1 id=\"mybean-framework\"><a href=\"#mybean-framework\" class=\"headerlink\" title=\"mybean-framework\"></a>mybean-framework</h1><blockquote>\n<p>MyBean框架是一个类似于Spring的简化版本的轻量级框架。<br>github地址：<a href=\"https://github.com/herenpeng/mybean-framework.git\">https://github.com/herenpeng/mybean-framework.git</a><br>gitee地址：<a href=\"https://gitee.com/herenpeng/mybean-framework.git\">https://gitee.com/herenpeng/mybean-framework.git</a></p>\n</blockquote>\n<p><strong>mybean-framwork目前支持功能：</strong></p>\n<ul>\n<li>IOC和DI功能</li>\n<li>兼容Web开发</li>\n<li>HTTP请求路径映射</li>\n<li>控制层注解式绑定请求参数</li>\n<li>静态视图解析</li>\n<li>Json解析工具</li>\n<li>JDBC封装模板</li>\n</ul>\n<h2 id=\"Bean实例注册\"><a href=\"#Bean实例注册\" class=\"headerlink\" title=\"Bean实例注册\"></a>Bean实例注册</h2><p>MyBean框架可以通过注解、xml配置文件、properties配置文件三种方式注册一个Bean实例，被注册的Bean实例会进入MyBean框架的核心容器之中。</p>\n<ul>\n<li><p>注解</p>\n<p>1、在Java类上标注@MyBean注解，即可将JavaBean注入核心容器。</p>\n<p>2、使用@MyBean注解方式注册Bean实例，必须开启包扫描。</p>\n<p>3、@MyBean注解有一个属性值，如果该属性值为空，则注册的Bean实例id默认为对应的类的首字母小写名称，如果该属性不为空，则注册的Bean实例id则为属性值。</p>\n<p>例：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@MyBean</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Student</span> &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n<li><p>xml配置</p>\n<p>1、在application.xml配置文件中进行容器id值和Java全限定类名的对应配置，即可将JavaBean注入核心容器。</p>\n<p>2、bean节点必须放在<code>&lt;mybean&gt;</code> <code>&lt;beans&gt;</code>节点下面，否则bean实例无法注册。</p>\n<p>3、bean节点的id值为必填，id值即为Bean实例注册的id名称，class属性必填，class值即为Bean实例的全限定类名。</p>\n<p>例：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=<span class=\"string\">&quot;1.0&quot;</span> encoding=<span class=\"string\">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mybean</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">beans</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;person&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;com.mybean.test.Person&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;student&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;com.mybean.test.Student&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">beans</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mybean</span>&gt;</span></span><br></pre></td></tr></table></figure></li>\n<li><p>properties配置</p>\n<p>1、在application.properties配置文件中进行容器id值和Java全限定类名的对应配置，即可将JavaBean注入核心容器。</p>\n<p>例：</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">student</span>=<span class=\"string\">com.mybean.test.Student</span></span><br></pre></td></tr></table></figure>\n\n\n</li>\n</ul>\n<h2 id=\"Bean实例注入\"><a href=\"#Bean实例注入\" class=\"headerlink\" title=\"Bean实例注入\"></a>Bean实例注入</h2><p>MyBean框架目前允许通过注解的方式和xml配置的方式注入一个Bean实例属性。</p>\n<ul>\n<li>注解</li>\n</ul>\n<p>1、 在类属性上添加@SetBean注解，即可将对应的实例注入类属性中。</p>\n<p>2、注入属性的Java类必须是已经在MyBean框架核心容器注册的JavaBean，否则无法注入。</p>\n<p>3、@SetBean有一个属性值，如果属性值为空，则使用类型注入模式，如果属性值不为空，则使用id名称注入方式。</p>\n<p>4、MyBean框架的注解注入方式是默认开启的，如果在一个属性中，既使用了@SetBean注解注入，又使用了xml配置文件注入，默认使用@SetBean注解注入的方式，xml配置方式默认放弃注入。</p>\n<p> 例：<br> <figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@MyBean</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Person</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@SetBean</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Student student;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@SetBean(&quot;student&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Student student2;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li><p>xml配置</p>\n<p>1、注入属性的Java类必须是已经在xml配置文件中配置过的JavaBean，否则无法注入。</p>\n<p>2、<code>&lt;set&gt;</code>标签有两个属性，其中name属性为Java类中对应的属性名称，ref为已经在xml配置文件中注册，或者开启包扫描后使用@MyBean注解标识的JavaBean的Id。</p>\n<p>例：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=<span class=\"string\">&quot;1.0&quot;</span> encoding=<span class=\"string\">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mybean</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">beans</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;person&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;com.mybean.test.Person&quot;</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">set</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;student&quot;</span> <span class=\"attr\">ref</span>=<span class=\"string\">&quot;student&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">set</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;student&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;com.mybean.test.Student&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">beans</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mybean</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<h2 id=\"包扫描\"><a href=\"#包扫描\" class=\"headerlink\" title=\"包扫描\"></a>包扫描</h2><p>如果使用@MyBean注解的方式注册Bean实例，必须配置包扫描范围，这样MyBean框架核心容器才能够扫描被注解的Bean实例。</p>\n<p>包扫描方式分为三种，注解和xml配置文件和properties配置文件方式。</p>\n<ul>\n<li><p>注解</p>\n<p>1、在启动类或者测试类上添加@PackageScan注解，即可扫描对应包下的所有@MyBean注解实例。</p>\n<p>2、@PackageScan有一个value属性，为包扫描范围，如果该值为空，则默认扫描标识@PackageScan注解的包下的所有@MyBean实例。</p>\n<p>例：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@PackageScan(&quot;com.mybean.test&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ApplicationTest</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.mybean.test;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@PackageScan</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ApplicationTest</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>xml配置</li>\n</ul>\n<p>1、在application.xml配置文件中配置package-scan标签即可，range属性即为包扫描范围值。</p>\n<p>例：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=<span class=\"string\">&quot;1.0&quot;</span> encoding=<span class=\"string\">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mybean</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">package-scan</span> <span class=\"attr\">range</span>=<span class=\"string\">&quot;com.test&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">package-scan</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mybean</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>properties配置</li>\n</ul>\n<p>1、在application.properties配置文件中配置package.scan属性即可。</p>\n<p>例：</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">package.scan</span>=<span class=\"string\">com.mybean.test</span></span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<h2 id=\"Bean实例获取\"><a href=\"#Bean实例获取\" class=\"headerlink\" title=\"Bean实例获取\"></a>Bean实例获取</h2><p>MyBean框架可以通过注解、xml配置文件、properties配置文件三种方式注册一个Bean实例，也可以通过三种不同的方式获取一个Bean实例对象。</p>\n<ul>\n<li><p>注解</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">Application</span> <span class=\"variable\">application</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">AnnotationApplication</span>(<span class=\"built_in\">this</span>.getClass());</span><br><span class=\"line\"><span class=\"type\">Student</span> <span class=\"variable\">student</span> <span class=\"operator\">=</span> application.getBean(<span class=\"string\">&quot;student&quot;</span>);</span><br><span class=\"line\">student.study();</span><br></pre></td></tr></table></figure></li>\n<li><p>xml配置</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">Application</span> <span class=\"variable\">application</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">XmlApplication</span>();</span><br><span class=\"line\"><span class=\"type\">Student</span> <span class=\"variable\">student</span> <span class=\"operator\">=</span> application.getBean(<span class=\"string\">&quot;student&quot;</span>);</span><br><span class=\"line\">student.study();</span><br></pre></td></tr></table></figure></li>\n<li><p>properties配置</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">Application</span> <span class=\"variable\">application</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">PropertiesApplication</span>();</span><br><span class=\"line\"><span class=\"type\">Student</span> <span class=\"variable\">student</span> <span class=\"operator\">=</span> application.getBean(<span class=\"string\">&quot;student&quot;</span>);</span><br><span class=\"line\">student.study();</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<h1 id=\"mybean-mvc\"><a href=\"#mybean-mvc\" class=\"headerlink\" title=\"mybean-mvc\"></a>mybean-mvc</h1><p>MyBeanMVC是MyBean框架的Web开发部分，能够简化原生的Servlet开发。</p>\n<h2 id=\"RequestPath\"><a href=\"#RequestPath\" class=\"headerlink\" title=\"@RequestPath\"></a>@RequestPath</h2><p>@RequestPath为一个MVC层的注解，可以注解在类和方法上，有两个属性：</p>\n<ul>\n<li>value：value属性为请求路径，使用该属性可以将对应的类或方法映射到注解的类和方法上。</li>\n<li>type：type属性为一个ResponseTypeEnum枚举类型，该属性在类上无效，在方法上可以映射为响应数据的类型，该属性默认为ResponseTypeEnum.VIEW，默认解析返回值为视图。</li>\n</ul>\n<p>例：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@MyBean</span></span><br><span class=\"line\"><span class=\"meta\">@RequestPath(&quot;user&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserController</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestPath(&quot;index&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">index</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">username</span> <span class=\"operator\">=</span> request.getParameter(<span class=\"string\">&quot;username&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;index.html&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"RequestParam\"><a href=\"#RequestParam\" class=\"headerlink\" title=\"@RequestParam\"></a>@RequestParam</h2><p>@RequestParam是一个MVC层注解，用于解析HTTP请求上的参数，该注解只能标注在方法参数上。</p>\n<p>1、@RequestParam注解有一个value属性值，该值为对应的参数名称，如果请求中有对应名称和类型的参数值，该注解会自动将参数解析到方法参数中。</p>\n<p>2、@RequestParam注解目前只支持解析Java的八种基本数据类型和对应的包装类，以及Map类型，其余类型无法解析。Map类型入参，会将布尔类型参数和数字类型参数进行解析，并转换为Boolean，Integer，Long等类型。</p>\n<p>3、MyBeanMVC的控制层方法参数注入只支持10个参数，超过10个参数，框架会出现解析异常。</p>\n<p>4、如果控制层方法参数中有HttpServletRequest和HttpServletResponse类型，对应的参数会自动注入。</p>\n<p>例：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@MyBean</span></span><br><span class=\"line\"><span class=\"meta\">@RequestPath(&quot;user&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserController</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestPath(value = &quot;string&quot;, type = ResponseTypeEnum.JSON)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">string</span><span class=\"params\">(<span class=\"meta\">@RequestParam(&quot;username&quot;)</span> String username)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> username;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestPath(value = &quot;number&quot;, type = ResponseTypeEnum.JSON)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Integer <span class=\"title function_\">number</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response, <span class=\"meta\">@RequestParam(&quot;number&quot;)</span> Integer number)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> number;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"静态资源解析\"><a href=\"#静态资源解析\" class=\"headerlink\" title=\"静态资源解析\"></a>静态资源解析</h2><p>1、MyBeanMVC目前只支持静态资源文件，对于<code>.jsp</code>，<code>.ftl</code>等动态文件暂不支持。</p>\n<p>2、在MyBeanMVC中，所有的静态资源文件都需要放在resources包下的static文件夹中，否则无法解析。例如上述的案例代码中，返回的inex.html会默认解析为resources/static包下的index.html文件。</p>\n<p>3、在MyBeanMVC的静态文件中，如果需要引入其他静态文件，请使用绝对路径，或者MyBeanMVC专属的<code>@</code>符号解析路径。使用相对路径引入静态文件，会无法解析静态文件。</p>\n<p>4、其中的<code>@</code>符号为MyBean框架的静态资源解析符号，能够直接解析到resources/static文件下面。</p>\n<p>例：</p>\n<figure class=\"highlight text\"><table><tr><td class=\"code\"><pre><span class=\"line\">resources</span><br><span class=\"line\">    |__static</span><br><span class=\"line\">        |__index.css</span><br><span class=\"line\">        |__index.html</span><br></pre></td></tr></table></figure>\n\n<p>在上述的文件目录层级中，在index.html文件中，应该使用如下方式引入index.css文件。</p>\n<p>正确：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">&quot;stylesheet&quot;</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text/css&quot;</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;/index.css&quot;</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">&quot;stylesheet&quot;</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text/css&quot;</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;@index.css&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>错误：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">rel</span>=<span class=\"string\">&quot;stylesheet&quot;</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text/css&quot;</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;index.css&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ResponseTypeEnum枚举类型\"><a href=\"#ResponseTypeEnum枚举类型\" class=\"headerlink\" title=\"ResponseTypeEnum枚举类型\"></a>ResponseTypeEnum枚举类型</h2><p>@RequestPath注解的type属性为ResponseTypeEnum枚举类型，该枚举有三个属性值。</p>\n<ul>\n<li>VIEW：该值为@RequestPath注解type属性的默认值，默认为视图解析，会将返回值作为路径解析，会自动寻找resources/static包下的静态文件。</li>\n</ul>\n<p>例：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@MyBean</span></span><br><span class=\"line\"><span class=\"meta\">@RequestPath(&quot;user&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserController</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestPath(&quot;index&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">index</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">username</span> <span class=\"operator\">=</span> request.getParameter(<span class=\"string\">&quot;username&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 会跳转到resources/static包的index.html文件</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">&quot;index.html&quot;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>TEXT：该值会将方法返回值作为普通文本解析，如果返回值为String类型，会直接输出字符串，如果返回值为其他类型，会默认调用返回对象的toString()方法输出字符串。</li>\n</ul>\n<p>例：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@MyBean</span></span><br><span class=\"line\"><span class=\"meta\">@RequestPath(&quot;user&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserController</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestPath(value = &quot;string&quot;, type = ResponseTypeEnum.TEXT)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">string</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">username</span> <span class=\"operator\">=</span> request.getParameter(<span class=\"string\">&quot;username&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> username;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestPath(value = &quot;text&quot;, type = ResponseTypeEnum.TEXT)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> User <span class=\"title function_\">text</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">User</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>();</span><br><span class=\"line\">        user.setUsername(<span class=\"string\">&quot;池总&quot;</span>);</span><br><span class=\"line\">        user.setPassword(<span class=\"string\">&quot;123456&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> user;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<ul>\n<li><p>JSON：该值会将方法返回值作为JSON格式解析。MyBean框架的JSON解析方式为MyBean框架自带的JSON解析工具，不依赖第三方JSON解析库，由于自带的JSON解析工具比较简单，目前JSON格式支持的类型有：</p>\n<ul>\n<li>Java八大基本数据类型以及对应的包装类型</li>\n<li>Date类型</li>\n<li>BigDecimal类型</li>\n<li>Map类型</li>\n<li>Collection类型</li>\n<li>遵循规范的JavaBean类型</li>\n</ul>\n</li>\n</ul>\n<p>例：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@MyBean</span></span><br><span class=\"line\"><span class=\"meta\">@RequestPath(&quot;user&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserController</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestPath(value = &quot;json&quot;, type = ResponseTypeEnum.JSON)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> User <span class=\"title function_\">json</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">User</span> <span class=\"variable\">user</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>(<span class=\"string\">&quot;池总&quot;</span>, <span class=\"string\">&quot;123456&quot;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> user;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestPath(value = &quot;map&quot;, type = ResponseTypeEnum.JSON)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Map&lt;String, Object&gt; <span class=\"title function_\">map</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response)</span> &#123;</span><br><span class=\"line\">        Map&lt;String, Object&gt; map = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;();</span><br><span class=\"line\">        map.put(<span class=\"string\">&quot;username&quot;</span>, <span class=\"string\">&quot;池总&quot;</span>);</span><br><span class=\"line\">        map.put(<span class=\"string\">&quot;password&quot;</span>, <span class=\"string\">&quot;123456&quot;</span>);</span><br><span class=\"line\">        map.put(<span class=\"string\">&quot;enabled&quot;</span>, <span class=\"literal\">true</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> map;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestPath(value = &quot;list&quot;, type = ResponseTypeEnum.JSON)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;User&gt; <span class=\"title function_\">list</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response)</span> &#123;</span><br><span class=\"line\">        List&lt;User&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">        list.add(<span class=\"keyword\">new</span> <span class=\"title class_\">User</span>(<span class=\"string\">&quot;池总&quot;</span>, <span class=\"string\">&quot;123456&quot;</span>));</span><br><span class=\"line\">        list.add(<span class=\"keyword\">new</span> <span class=\"title class_\">User</span>(<span class=\"string\">&quot;刘老板&quot;</span>, <span class=\"string\">&quot;111111&quot;</span>));</span><br><span class=\"line\">        list.add(<span class=\"keyword\">new</span> <span class=\"title class_\">User</span>(<span class=\"string\">&quot;波波&quot;</span>, <span class=\"string\">&quot;bbbbbb&quot;</span>));</span><br><span class=\"line\">        <span class=\"keyword\">return</span> list;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestPath(value = &quot;set&quot;, type = ResponseTypeEnum.JSON)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Set&lt;User&gt; <span class=\"title function_\">set</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response)</span> &#123;</span><br><span class=\"line\">        Set&lt;User&gt; Set = <span class=\"keyword\">new</span> <span class=\"title class_\">HashSet</span>&lt;&gt;();</span><br><span class=\"line\">        Set.add(<span class=\"keyword\">new</span> <span class=\"title class_\">User</span>(<span class=\"string\">&quot;池总&quot;</span>, <span class=\"string\">&quot;set:123456&quot;</span>));</span><br><span class=\"line\">        Set.add(<span class=\"keyword\">new</span> <span class=\"title class_\">User</span>(<span class=\"string\">&quot;刘老板&quot;</span>, <span class=\"string\">&quot;set:111111&quot;</span>));</span><br><span class=\"line\">        Set.add(<span class=\"keyword\">new</span> <span class=\"title class_\">User</span>(<span class=\"string\">&quot;波波&quot;</span>, <span class=\"string\">&quot;set:bbbbbb&quot;</span>));</span><br><span class=\"line\">        <span class=\"keyword\">return</span> Set;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestPath(value = &quot;listMap&quot;, type = ResponseTypeEnum.JSON)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;Map&lt;String, Object&gt;&gt; <span class=\"title function_\">listMap</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response)</span> &#123;</span><br><span class=\"line\">        List&lt;Map&lt;String, Object&gt;&gt; list = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">        Map&lt;String, Object&gt; map1 = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;();</span><br><span class=\"line\">        map1.put(<span class=\"string\">&quot;username&quot;</span>, <span class=\"string\">&quot;池总&quot;</span>);</span><br><span class=\"line\">        map1.put(<span class=\"string\">&quot;password&quot;</span>, <span class=\"string\">&quot;123456&quot;</span>);</span><br><span class=\"line\">        map1.put(<span class=\"string\">&quot;enabled&quot;</span>, <span class=\"literal\">true</span>);</span><br><span class=\"line\">        list.add(map1);</span><br><span class=\"line\">        Map&lt;String, Object&gt; map2 = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;();</span><br><span class=\"line\">        map2.put(<span class=\"string\">&quot;username&quot;</span>, <span class=\"string\">&quot;刘老板&quot;</span>);</span><br><span class=\"line\">        map2.put(<span class=\"string\">&quot;password&quot;</span>, <span class=\"string\">&quot;111111&quot;</span>);</span><br><span class=\"line\">        map2.put(<span class=\"string\">&quot;enabled&quot;</span>, <span class=\"literal\">false</span>);</span><br><span class=\"line\">        map2.put(<span class=\"string\">&quot;birthday&quot;</span>, <span class=\"keyword\">new</span> <span class=\"title class_\">Date</span>());</span><br><span class=\"line\">        list.add(map2);</span><br><span class=\"line\">        Map&lt;String, Object&gt; map3 = <span class=\"keyword\">new</span> <span class=\"title class_\">HashMap</span>&lt;&gt;();</span><br><span class=\"line\">        map3.put(<span class=\"string\">&quot;username&quot;</span>, <span class=\"string\">&quot;刘老板&quot;</span>);</span><br><span class=\"line\">        map3.put(<span class=\"string\">&quot;password&quot;</span>, <span class=\"string\">&quot;111111&quot;</span>);</span><br><span class=\"line\">        map3.put(<span class=\"string\">&quot;money&quot;</span>, <span class=\"keyword\">new</span> <span class=\"title class_\">BigDecimal</span>(<span class=\"number\">100000000</span>));</span><br><span class=\"line\">        map3.put(<span class=\"string\">&quot;enabled&quot;</span>, <span class=\"literal\">false</span>);</span><br><span class=\"line\">        map3.put(<span class=\"string\">&quot;person&quot;</span>, <span class=\"keyword\">new</span> <span class=\"title class_\">User</span>(<span class=\"string\">&quot;员工1&quot;</span>, <span class=\"string\">&quot;123456&quot;</span>));</span><br><span class=\"line\">        List&lt;User&gt; list2 = <span class=\"keyword\">new</span> <span class=\"title class_\">ArrayList</span>&lt;&gt;();</span><br><span class=\"line\">        list2.add(<span class=\"keyword\">new</span> <span class=\"title class_\">User</span>(<span class=\"string\">&quot;池总&quot;</span>, <span class=\"string\">&quot;123456&quot;</span>));</span><br><span class=\"line\">        list2.add(<span class=\"keyword\">new</span> <span class=\"title class_\">User</span>(<span class=\"string\">&quot;刘老板&quot;</span>, <span class=\"string\">&quot;111111&quot;</span>));</span><br><span class=\"line\">        list2.add(<span class=\"keyword\">new</span> <span class=\"title class_\">User</span>(<span class=\"string\">&quot;波波&quot;</span>, <span class=\"string\">&quot;bbbbbb&quot;</span>));</span><br><span class=\"line\">        map3.put(<span class=\"string\">&quot;list2&quot;</span>, list2);</span><br><span class=\"line\">        list.add(map3);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> list;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"mybean-common\"><a href=\"#mybean-common\" class=\"headerlink\" title=\"mybean-common\"></a>mybean-common</h1><h2 id=\"JsonUtils\"><a href=\"#JsonUtils\" class=\"headerlink\" title=\"JsonUtils\"></a>JsonUtils</h2><p>MyBean框架没有依赖于第三方的Json解析框架，而是MyBean框架自己实现了一个JsonUtils，用于解析Json数据。</p>\n<ul>\n<li><p>Json工具类可以对以下的Java类型进行解析：</p>\n<ul>\n<li>Java八大基本数据类型以及对应的包装类型</li>\n<li>Date类型</li>\n<li>BigDecimal类型</li>\n<li>Map类型</li>\n<li>Collection类型</li>\n<li>遵循规范的JavaBean类型</li>\n</ul>\n</li>\n<li><p>@JsonNullIgnore</p>\n<p>  @JsonNullIgnore可以注解在JavaBean的属性上，被注解的属性如果值为null，在格式化Json字符串的时候会自动忽略该属性。</p>\n</li>\n</ul>\n<p>例：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@JsonNullIgnore</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String password;</span><br><span class=\"line\">    <span class=\"comment\">// 省略get/set方法</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p>@JsonDateFormat</p>\n<p>  @JsonDateFormat可以注解在JavaBean的Date类型的属性上，被注解的属性会按照注解的value值的格式，对日期格式进行Json格式化，如果value属性值为null，则会使用默认的<code>yyyy-MM-dd HH:mm:ss</code>格式进行日期格式化。</p>\n</li>\n</ul>\n<p>例：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">User</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String username;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@JsonDateFormat</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Date birthday;</span><br><span class=\"line\">    <span class=\"comment\">// 省略get/set方法</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"StringUtils\"><a href=\"#StringUtils\" class=\"headerlink\" title=\"StringUtils\"></a>StringUtils</h2><p>StringUtils是MyBean框架封装的字符串工具类，包含了对于字符串的处理方法。</p>\n<h2 id=\"ObjectUtils\"><a href=\"#ObjectUtils\" class=\"headerlink\" title=\"ObjectUtils\"></a>ObjectUtils</h2><p>对象工具类</p>\n<h2 id=\"CollectionUtils\"><a href=\"#CollectionUtils\" class=\"headerlink\" title=\"CollectionUtils\"></a>CollectionUtils</h2><p>集合工具类</p>\n<h1 id=\"mybean-jdbc\"><a href=\"#mybean-jdbc\" class=\"headerlink\" title=\"mybean-jdbc\"></a>mybean-jdbc</h1><p>mybean-jdbc是MyBean框架的持久层部分，封装了MyBean框架对持久层的操作。<br>其中mybean-jdbc默认使用MySQL驱动，并内置了druid连接池。</p>\n<h2 id=\"DataSource\"><a href=\"#DataSource\" class=\"headerlink\" title=\"DataSource\"></a>DataSource</h2><p>在使用mybean-jdbc之前，需要在application.xml配置文件中配置数据源。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=<span class=\"string\">&quot;1.0&quot;</span> encoding=<span class=\"string\">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mybean</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">data-source</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">driver-name</span>&gt;</span>com.mysql.cj.jdbc.Driver<span class=\"tag\">&lt;/<span class=\"name\">driver-name</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">url</span>&gt;</span>jdbc:mysql://localhost:3306/mybean?serverTimezone=Asia/Shanghai<span class=\"symbol\">&amp;amp;</span>useSSL=false<span class=\"symbol\">&amp;amp;</span>characterEncoding=UTF-8<span class=\"tag\">&lt;/<span class=\"name\">url</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">username</span>&gt;</span>root<span class=\"tag\">&lt;/<span class=\"name\">username</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">password</span>&gt;</span>admin<span class=\"tag\">&lt;/<span class=\"name\">password</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">data-source</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mybean</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"JdbcTemplate\"><a href=\"#JdbcTemplate\" class=\"headerlink\" title=\"JdbcTemplate\"></a>JdbcTemplate</h2><p>1、在使用JdbcTemplate之前，需要在application.xml配置文件中配置该Bean实例。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=<span class=\"string\">&quot;1.0&quot;</span> encoding=<span class=\"string\">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mybean</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">beans</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">bean</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;jdbcTemplate&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;org.mybeanframework.jdbc.JdbcTemplate&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">bean</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">beans</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mybean</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>2、然后就直接在Java类中注入即可使用。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@MyBean</span></span><br><span class=\"line\"><span class=\"meta\">@RequestPath(&quot;user&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserController</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@SetBean</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> JdbcTemplate jdbcTemplate;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestPath(value = &quot;list&quot;, type = ResponseTypeEnum.JSON)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> List&lt;User&gt; <span class=\"title function_\">list</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        List&lt;User&gt; list = jdbcTemplate.selectList(<span class=\"string\">&quot;select * from sys_user&quot;</span>, User.class);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> list;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p>List<E> selectList(String sql, Object[] params, Class<E> clazz)</p>\n<pre><code>有参查询所有，并返回一个泛型对应的List集合</code></pre></li>\n<li><p>List<E> selectList(String sql, Class<E> clazz)</p>\n<pre><code>无参查询所有，并返回一个泛型对应的List集合</code></pre></li>\n<li><p>selectOne(String sql, Object[] params, Class<E> clazz)</p>\n<pre><code>有参查询一个泛型对象，多条记录时，默认返回第一条记录</code></pre></li>\n<li><p>selectOne(String sql, Class<E> clazz)</p>\n<pre><code>无参查询一个泛型对象，多条记录时，默认返回第一条记录</code></pre></li>\n<li><p>int update(String sql, Object[] params)</p>\n<pre><code>有参更新方法</code></pre></li>\n<li><p>delete(String sql, Object[] params)</p>\n<pre><code>有参删除方法</code></pre></li>\n<li><p>insert(String sql, Object[] params)</p>\n<pre><code>有参插入方法</code></pre></li>\n</ul>\n<h1 id=\"框架的使用\"><a href=\"#框架的使用\" class=\"headerlink\" title=\"框架的使用\"></a>框架的使用</h1><p>如果开发者想要在本地使用MyBean框架进行开发，需要进行如下几个步骤：</p>\n<p>1、将项目从github或者gitee上下载下来。</p>\n<blockquote>\n<p>github地址：<a href=\"https://github.com/herenpeng/mybean-framework.git\">https://github.com/herenpeng/mybean-framework.git</a><br>gitee地址：<a href=\"https://gitee.com/herenpeng/mybean-framework.git\">https://gitee.com/herenpeng/mybean-framework.git</a></p>\n</blockquote>\n<p>2、将项目设置为Maven项目，并使用Maven下载相关依赖。</p>\n<p>3、使用Maven将root项目<code>mybean-framework</code>安装到本地仓库。</p>\n<p>4、使用Maven创建一个新的工程，并在工程中引入mybean-framework的坐标依赖，其中myeban-mvc为MVC模块的依赖，mybean-jdbc为持久层jdbc模块的依赖，这两个依赖均已依赖于mybean-core模块，所以本地无需引入mybean-core模块。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--mvc模块的依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.mybeanframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybean-mvc<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.0.0-SNAPSHOT<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--jdbc模块的依赖--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.mybeanframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybean-jdbc<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.0.0-SNAPSHOT<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>5、使用Maven Tomcat插件运行项目。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- tomcat插件控制 --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.tomcat.maven<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>tomcat7-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.2<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!--端口控制--&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">port</span>&gt;</span>8080<span class=\"tag\">&lt;/<span class=\"name\">port</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!--项目路径控制意味着http://localhost:8080/abc--&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">path</span>&gt;</span>/<span class=\"tag\">&lt;/<span class=\"name\">path</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!--编码--&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">uriEncoding</span>&gt;</span>UTF-8<span class=\"tag\">&lt;/<span class=\"name\">uriEncoding</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- maven插件控制 --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.maven.plugins<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>maven-compiler-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.1<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">source</span>&gt;</span>1.8<span class=\"tag\">&lt;/<span class=\"name\">source</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">target</span>&gt;</span>1.8<span class=\"tag\">&lt;/<span class=\"name\">target</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">encoding</span>&gt;</span>utf-8<span class=\"tag\">&lt;/<span class=\"name\">encoding</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>6、在新项目中配置application.xml配置文件，并配置包扫描范围或者注册Bean实例。</p>\n<p>7、启动项目。</p>\n<blockquote>\n<p><strong>如果开发者不想自己搭建项目，也可以使用MyBean框架自带的一个mybean-demo项目。</strong></p>\n</blockquote>\n<p>1、将项目从github或者gitee上下载下来。</p>\n<p>2、将项目设置为Maven项目，并使用Maven下载相关依赖。</p>\n<p>3、使用Maven将root项目<code>mybean-framework</code>安装到本地仓库。</p>\n<p>4、使用Maven Tomcat插件运行<code>mybean-demo</code>项目即可。</p>\n<h1 id=\"结尾\"><a href=\"#结尾\" class=\"headerlink\" title=\"结尾\"></a>结尾</h1><p>MyBean框架目前虽然已经有了一些Web开发的基础功能，但是依然还有一些不足之处需待完善：</p>\n<ul>\n<li><p>mybean-jdbc项目，这个项目是作者用一个下午写出来，只能说是一个简单的JDBC的封装，后续作者希望在这个项目的基础上对Web开发的持久层进行优化，或者重新写一个类似于MyBatis的框架。</p>\n</li>\n<li><p>JsonUtils目前只支持将Java类转换为Json字符串，但是不支持Json字符串转换为Java对象，这是后续需要继续完善的。</p>\n</li>\n<li><p>Web控制层，目前实现了注解绑定参数，Map入参，但是没有实现Java对象入参，后续待完善。</p>\n</li>\n<li><p>除此之外，MyBean框架还有很多细节或者功能需要完善，也欢迎各位在博客下方或者github上提出问题。</p>\n</li>\n</ul>\n<blockquote>\n<p>最后，欢迎对这个项目有兴趣的同学，给<code>mybean-framework</code>这个项目点<code>star</code>，给作者一些支持和鼓励，谢谢！<br>github地址：<a href=\"https://github.com/herenpeng/mybean-framework.git\">https://github.com/herenpeng/mybean-framework.git</a><br>gitee地址：<a href=\"https://gitee.com/herenpeng/mybean-framework.git\">https://gitee.com/herenpeng/mybean-framework.git</a></p>\n</blockquote>\n","categories":["Java"],"tags":["Java"]},{"title":"Linux常用命令","url":"/2020/03/10/linux/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/","content":"<p>我们可以通过这篇博客来学习 Linux 的常用命令。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"显示文件\"><a href=\"#显示文件\" class=\"headerlink\" title=\"显示文件\"></a>显示文件</h2><table>\n<thead>\n<tr>\n<th>命令</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>ls</td>\n<td>显示当前目录下的文件</td>\n</tr>\n<tr>\n<td>ls –a</td>\n<td>显示所有文件或目录（包括隐藏文件）</td>\n</tr>\n<tr>\n<td>ls –l</td>\n<td>缩写为ll，显示当前目录下文件的详细内容</td>\n</tr>\n</tbody></table>\n<h2 id=\"切换目录\"><a href=\"#切换目录\" class=\"headerlink\" title=\"切换目录\"></a>切换目录</h2><table>\n<thead>\n<tr>\n<th>命令</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>cd [路径]</td>\n<td>进入或返回到该目录，可以使用tab键来补全目录的路径</td>\n</tr>\n<tr>\n<td>cd . .</td>\n<td>退回上一级目录</td>\n</tr>\n<tr>\n<td>cd /</td>\n<td>返回到根目录</td>\n</tr>\n<tr>\n<td>cd ~</td>\n<td>返回到root目录</td>\n</tr>\n<tr>\n<td>cd -</td>\n<td>返回到上一次所在的目录</td>\n</tr>\n<tr>\n<td>pwd</td>\n<td>显示当前所在目录的路径</td>\n</tr>\n</tbody></table>\n<h2 id=\"文件夹\"><a href=\"#文件夹\" class=\"headerlink\" title=\"文件夹\"></a>文件夹</h2><table>\n<thead>\n<tr>\n<th>命令</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>mkdir [文件夹名]</td>\n<td>在当前目录下创建指定文件夹（只能创建一级目录，即空文件夹）</td>\n</tr>\n<tr>\n<td>rmdir [文件夹名]</td>\n<td>在当前目录下删除指定文件夹（只能删除空文件夹）</td>\n</tr>\n<tr>\n<td>mkdir –help</td>\n<td>查看mkdir命令的帮助</td>\n</tr>\n<tr>\n<td>mkdir –p [文件夹/子文件夹]</td>\n<td>可以创建多级目录，如果没有父目录，会帮你创建父目录，有父目录，也不会报错</td>\n</tr>\n</tbody></table>\n<h2 id=\"文件\"><a href=\"#文件\" class=\"headerlink\" title=\"文件\"></a>文件</h2><p><strong>文件的权限表示：</strong> - — — —</p>\n<p>第一个位置表示文件类型。 </p>\n<ul>\n<li>-代表文件</li>\n<li>d代表目录</li>\n<li>l表示连接</li>\n</ul>\n<p>第二个位置表示当前用户所具有的文件的权限。<br>第三个位置表示组内其他用户具有的该文件的权限。<br>第四个位置表示其他组的用户具有该文件的权限。</p>\n<ul>\n<li>r：read读</li>\n<li>w：write写</li>\n<li>x：excute执行</li>\n</ul>\n<p><strong>变更文件或目录的权限</strong></p>\n<ul>\n<li>chmod u=rwx,g=rwx,o=rwx [文件或文件夹名]</li>\n<li>chmod 777 [文件或文件夹名]（r=4,w=2,x=1）</li>\n</ul>\n<p><strong>创建文件</strong></p>\n<ul>\n<li>touch [文件名]：创建一个空文件</li>\n</ul>\n<h2 id=\"浏览文件\"><a href=\"#浏览文件\" class=\"headerlink\" title=\"浏览文件\"></a>浏览文件</h2><p>cat [文件名]：浏览文件的所有内容</p>\n<p>more [文件名]：一屏幕一屏幕浏览文件内容</p>\n<ul>\n<li>按回车键一行一行浏览</li>\n<li>按空格键一屏幕一屏幕浏览</li>\n<li>按q退出浏览</li>\n<li>ctrl+c也可以退出</li>\n</ul>\n<p>Less [文件名]：和more命令类似</p>\n<ul>\n<li>按回车键一行一行浏览</li>\n<li>按空格键一屏幕一屏幕浏览</li>\n<li>可以使用上下键进行滚动浏览</li>\n<li>按q退出浏览</li>\n<li>ctrl+c也可以退出</li>\n</ul>\n<p>tail -10 [文件名]：直接浏览文件最后10行</p>\n<p>tail –f [文件名]：可以动态查看内容</p>\n<h2 id=\"编辑文件\"><a href=\"#编辑文件\" class=\"headerlink\" title=\"编辑文件\"></a>编辑文件</h2><p><strong>vim命令</strong></p>\n<table>\n<thead>\n<tr>\n<th>命令</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>vim [文件名]</td>\n<td>进入指定文件的编辑界面</td>\n</tr>\n</tbody></table>\n<ul>\n<li>vim 不仅可以编辑已存在的文件，不存在的文件只要正常编辑并保存退出，会自动创建</li>\n</ul>\n<p><strong>Linux文件的三种模式</strong></p>\n<p>命令模式：切换到命令行模式：按Esc键</p>\n<p>插入模式：切换到插入模式：按i、o、a键</p>\n<ul>\n<li>i在当前位置前插入</li>\n<li>a在当前位置后插入</li>\n<li>A在当前行尾插入</li>\n<li>o在当前行之后插入一行</li>\n<li>O在当前行之前插入一行</li>\n</ul>\n<p>底行模式：切换到底行模式：shitf+:</p>\n<ul>\n<li>底行模式下的wq（:wq）保存并退出</li>\n<li>底行模式下的q!（:q!）退出不保存</li>\n<li>底行模式下的/[字符串]（: /[字符串]）查找文件中的指定字符串</li>\n</ul>\n<p><strong>cat命令</strong></p>\n<table>\n<thead>\n<tr>\n<th>命令</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>cat [文件1] &gt; [文件2]</td>\n<td>将文件1的内容映射到文件2中去,如果文件2中已有内容，会覆盖文件2中的内容</td>\n</tr>\n<tr>\n<td>cat [文件1] &gt;&gt; [文件2]</td>\n<td>内容不会覆盖，直接追加</td>\n</tr>\n</tbody></table>\n<h2 id=\"文件的拷贝和剪切\"><a href=\"#文件的拷贝和剪切\" class=\"headerlink\" title=\"文件的拷贝和剪切\"></a>文件的拷贝和剪切</h2><p><strong>拷贝</strong><br>| 命令 | 描述 |<br>|–|–|<br>|cp [文件名] [目录] | 将文件拷贝到目录下 |<br>|cp [文件名] [目录/文件名]  |  将文件拷贝到目录下，并修改文件名 |</p>\n<p><strong>剪切</strong><br>| 命令 | 描述 |<br>|–|–|<br>|  mv [文件名] [目录]  |  将文件剪切到目录下|<br>|  mv [文件名] [目录/文件名]  |  将文件剪切到目录下，并修改文件名 |</p>\n<h2 id=\"删除文件或文件夹\"><a href=\"#删除文件或文件夹\" class=\"headerlink\" title=\"删除文件或文件夹\"></a>删除文件或文件夹</h2><table>\n<thead>\n<tr>\n<th>命令</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>rm [文件名]</td>\n<td>删除当前目录下的文件，并发出询问，输入y(yes)确认删除，输入n(no)不删除。不加参数的rm只能删除文件，不能删除文件夹</td>\n</tr>\n<tr>\n<td>rm –r [文件夹]</td>\n<td>递归删除文件夹，会发出询问</td>\n</tr>\n<tr>\n<td>rm –f [文件名]</td>\n<td>删除文件，不询问（慎用）</td>\n</tr>\n<tr>\n<td>rm –rf [文件夹]</td>\n<td>递归删除文件夹，不询问（慎用）</td>\n</tr>\n<tr>\n<td>rm –rf *</td>\n<td>删除所有文件（慎用！！！）</td>\n</tr>\n<tr>\n<td>rm –rf /*</td>\n<td><strong>如果在生产环境使用了该命令，尽早跑路吧！</strong></td>\n</tr>\n</tbody></table>\n<p><strong>参数</strong></p>\n<ul>\n<li>-r：参数r，增强命令，递归删除文件夹</li>\n<li>-f：参数f，增强命令，强制删除，不询问</li>\n</ul>\n<h2 id=\"查找文件\"><a href=\"#查找文件\" class=\"headerlink\" title=\"查找文件\"></a>查找文件</h2><table>\n<thead>\n<tr>\n<th>命令</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>find [目录] -name [文件名]</td>\n<td>通过名字查找目录下的指定文件</td>\n</tr>\n<tr>\n<td>grep [字符串] [文件]</td>\n<td>在指定文件中显示指定字符串</td>\n</tr>\n<tr>\n<td>grep [字符串] [文件] –color</td>\n<td>在指定文件中显示指定字符串，并高亮显示</td>\n</tr>\n<tr>\n<td>grep [字符串] [文件] –color –A4 –B2</td>\n<td>在指定文件中显示指定字符串，并高亮显示，显示后4行，前2行</td>\n</tr>\n</tbody></table>\n<h2 id=\"解压缩\"><a href=\"#解压缩\" class=\"headerlink\" title=\"解压缩\"></a>解压缩</h2><p><strong>Linux压缩文件</strong></p>\n<ul>\n<li>Linux的压缩文件后缀名为tar.gz，相关命令使用tar，使用参数增强命令，实现解压缩功能。</li>\n</ul>\n<p><strong>参数</strong></p>\n<table>\n<thead>\n<tr>\n<th>参数</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>-c</td>\n<td>创建一个新的tar文件</td>\n</tr>\n<tr>\n<td>-v</td>\n<td>显示运行过程的信息</td>\n</tr>\n<tr>\n<td>-f</td>\n<td>指定文件名</td>\n</tr>\n<tr>\n<td>-z</td>\n<td>调用gzip压缩命令进行压缩</td>\n</tr>\n<tr>\n<td>-x</td>\n<td>解开tar文件</td>\n</tr>\n</tbody></table>\n<p><strong>打包压缩</strong></p>\n<table>\n<thead>\n<tr>\n<th>命令</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>tar –cvf [文件名.tar] [文件夹或文件]</td>\n<td>将文件或文件打包为tar文件</td>\n</tr>\n<tr>\n<td>tar –zcvf [文件名.tar.gz] [文件夹或文件]</td>\n<td>将文件夹或文件打包并压缩为tar.gz文件</td>\n</tr>\n</tbody></table>\n<p><strong>解压缩</strong></p>\n<table>\n<thead>\n<tr>\n<th>命令</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>tar –xvf [文件名.tar]</td>\n<td>将tar文件解开</td>\n</tr>\n<tr>\n<td>tar –zxvf [文件名tar.gz]</td>\n<td>将tar.gz文件解压缩到当前目录</td>\n</tr>\n<tr>\n<td>tar –zxvf [文件名tar.gz] –C [文件目录]</td>\n<td>将tar.gz文件解压缩到指定目录下</td>\n</tr>\n</tbody></table>\n<h2 id=\"进程\"><a href=\"#进程\" class=\"headerlink\" title=\"进程\"></a>进程</h2><ul>\n<li>ps -a：查看所有</li>\n<li>ps -u：以用户的格式显示</li>\n<li>ps -x：显示后台进程运行参数</li>\n<li>ps -ef：以全格式显示进程所有信息，包括父进程Pid，创建人，创建时间，进程号等等</li>\n<li>ps –ef | grep [进程名]：搜索包含指定进程名的进程</li>\n<li>kill -9 [进程名称]：强制杀死指定进程名称的进程</li>\n</ul>\n<h2 id=\"管道\"><a href=\"#管道\" class=\"headerlink\" title=\"管道\"></a>管道</h2><ul>\n<li>命令1 | 命令2：将命令1的输出（结果）作为命令2的输入（参数）</li>\n</ul>\n<h2 id=\"sftp传输\"><a href=\"#sftp传输\" class=\"headerlink\" title=\"sftp传输\"></a>sftp传输</h2><table>\n<thead>\n<tr>\n<th>命令</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>alt+p快捷键</td>\n<td>进入sftp传输</td>\n</tr>\n<tr>\n<td>put [文件路径名]</td>\n<td>上传至root目录</td>\n</tr>\n<tr>\n<td>get [文件名]</td>\n<td>从root目录下载</td>\n</tr>\n</tbody></table>\n<h2 id=\"主机配置\"><a href=\"#主机配置\" class=\"headerlink\" title=\"主机配置\"></a>主机配置</h2><table>\n<thead>\n<tr>\n<th>命令</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>hostname</td>\n<td>查看主机名配置</td>\n</tr>\n<tr>\n<td>hostname [临时主机名]</td>\n<td>将主机名临时修改临时主机名</td>\n</tr>\n</tbody></table>\n<ul>\n<li>持久化修改主机名，需要修改/etc/sysconfig/network文件</li>\n</ul>\n<h2 id=\"网络\"><a href=\"#网络\" class=\"headerlink\" title=\"网络\"></a>网络</h2><table>\n<thead>\n<tr>\n<th>命令</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>ifconfig</td>\n<td>显示当前网络ip</td>\n</tr>\n<tr>\n<td>service network restart</td>\n<td>重启网络服务</td>\n</tr>\n<tr>\n<td>ifconfig eth0 192.168.12.22</td>\n<td>临时修改ip地址为192.168.12.22</td>\n</tr>\n</tbody></table>\n<ul>\n<li>持久化修改ip地址，需要修改/etc/sysconfig/network-scripts/ifcfg-eth0文件</li>\n</ul>\n<h2 id=\"系统服务\"><a href=\"#系统服务\" class=\"headerlink\" title=\"系统服务\"></a>系统服务</h2><p><strong>网络</strong></p>\n<table>\n<thead>\n<tr>\n<th>命令</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>service network status</td>\n<td>查看网络服务的状态</td>\n</tr>\n<tr>\n<td>service network stop</td>\n<td>停止网络服务</td>\n</tr>\n<tr>\n<td>service network start</td>\n<td>启动网络服务</td>\n</tr>\n<tr>\n<td>service network restart</td>\n<td>重启网络服务</td>\n</tr>\n</tbody></table>\n<p><strong>防火墙</strong></p>\n<table>\n<thead>\n<tr>\n<th>命令</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>service iptables status</td>\n<td>查看防火墙状态</td>\n</tr>\n<tr>\n<td>service iptables stop</td>\n<td>关闭防火墙</td>\n</tr>\n<tr>\n<td>service iptables start</td>\n<td>启动防火墙</td>\n</tr>\n<tr>\n<td>cservice iptables off</td>\n<td>禁止防火墙开机自启</td>\n</tr>\n</tbody></table>\n<p><strong>其他</strong></p>\n<table>\n<thead>\n<tr>\n<th>命令</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>service –-status-all</td>\n<td>查看系统中所有后台服务</td>\n</tr>\n<tr>\n<td>service –nltp</td>\n<td>查看系统中网络进程的端口监听情况</td>\n</tr>\n</tbody></table>\n<h2 id=\"其他命令\"><a href=\"#其他命令\" class=\"headerlink\" title=\"其他命令\"></a>其他命令</h2><table>\n<thead>\n<tr>\n<th>命令</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>clear</td>\n<td>清屏（ctrl+l键也可以显示清屏）</td>\n</tr>\n</tbody></table>\n<h2 id=\"思维导图\"><a href=\"#思维导图\" class=\"headerlink\" title=\"思维导图\"></a>思维导图</h2><p><img src=\"/images/2020/03/20200310224122937.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["Linux"],"tags":["Linux"]},{"title":"Linux环境邮件服务报错：Couldn‘t connect to host, port: smtp.qq.com, 25； timeout -1；","url":"/2021/01/19/linux/Linux%E7%8E%AF%E5%A2%83%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1%E6%8A%A5%E9%94%99/","content":"<p>在Windows环境下邮件服务能够正常使用，但是在Linux环境下，邮件服务报错，无法发送邮件。</p>\n<span id=\"more\"></span>\n<p>具体报错信息如下：</p>\n<blockquote>\n<p>com.sun.mail.util.MailConnectException: Couldn’t connect to host, port: smtp.qq.com, 25; timeout -1;</p>\n</blockquote>\n<p>这个报错的原因是因为阿里云服务器出于安全策略的考虑，主动屏蔽了服务器25端口，导致邮件服务无法正常使用。</p>\n<p>解决该报错的方法有两种：</p>\n<p><strong>第一：开放25端口。</strong></p>\n<blockquote>\n<p>阿里云服务25端口的屏蔽策略和普通的安全策略不同，无法通过配置安全组规则的方式来进行开放，如果需要开放25端口，需要向阿里云进行申诉，这是一种比较麻烦的处理方法。</p>\n<p>具体的阿里云25端口申诉方法，可以参考：<a href=\"https://help.aliyun.com/knowledge_detail/56130.html\">https://help.aliyun.com/knowledge_detail/56130.html</a></p>\n</blockquote>\n<p><strong>第二：邮件服务不使用25端口，而是使用465端口。</strong></p>\n<blockquote>\n<p>具体方法为：进行SpringBoot配置文件配置。</p>\n</blockquote>\n<figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"comment\"># SpringMail发送邮件相关配置</span></span><br><span class=\"line\">  <span class=\"attr\">mail:</span></span><br><span class=\"line\">    <span class=\"comment\"># 发送邮件的账号名</span></span><br><span class=\"line\">    <span class=\"attr\">username:</span> <span class=\"string\">xxxxxxxxxxxx@qq.com</span></span><br><span class=\"line\">    <span class=\"comment\"># 授权码</span></span><br><span class=\"line\">    <span class=\"attr\">password:</span> <span class=\"string\">xxxxxxxxxxxx</span></span><br><span class=\"line\">    <span class=\"comment\"># smtp服务主机  qq邮箱的服务主机为smtp.qq.com</span></span><br><span class=\"line\">    <span class=\"attr\">host:</span> <span class=\"string\">smtp.qq.com</span></span><br><span class=\"line\">    <span class=\"comment\"># 服务协议</span></span><br><span class=\"line\">    <span class=\"attr\">protocol:</span> <span class=\"string\">smtp</span></span><br><span class=\"line\">    <span class=\"comment\"># 编码集</span></span><br><span class=\"line\">    <span class=\"attr\">default-encoding:</span> <span class=\"string\">UTF-8</span></span><br><span class=\"line\">    <span class=\"comment\"># 服务端口</span></span><br><span class=\"line\">    <span class=\"attr\">port:</span> <span class=\"number\">465</span></span><br><span class=\"line\">    <span class=\"attr\">properties:</span></span><br><span class=\"line\">      <span class=\"attr\">mail:</span></span><br><span class=\"line\">        <span class=\"attr\">smtp:</span></span><br><span class=\"line\">          <span class=\"attr\">auth:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">          <span class=\"attr\">socketFactory:</span></span><br><span class=\"line\">            <span class=\"attr\">port:</span> <span class=\"number\">465</span></span><br><span class=\"line\">            <span class=\"attr\">class:</span> <span class=\"string\">javax.net.ssl.SSLSocketFactory</span></span><br><span class=\"line\">            <span class=\"attr\">fallback:</span> <span class=\"literal\">false</span></span><br><span class=\"line\">          <span class=\"attr\">starttls:</span></span><br><span class=\"line\">            <span class=\"attr\">enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">            <span class=\"attr\">required:</span> <span class=\"literal\">true</span></span><br></pre></td></tr></table></figure>\n\n\n","categories":["Linux"],"tags":["Linux"]},{"title":"Linux系统安装JDK环境","url":"/2020/03/15/linux/Linux%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85JDK%E7%8E%AF%E5%A2%83/","content":"<p>我们可以通过这篇博客来学习 Linux 的常用命令。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"Linux版本的JDK下载\"><a href=\"#Linux版本的JDK下载\" class=\"headerlink\" title=\"Linux版本的JDK下载\"></a>Linux版本的JDK下载</h2><p>JDK下载官网：<a href=\"https://www.oracle.com/java/technologies/javase/javase-jdk8-downloads.html\">https://www.oracle.com/java/technologies/javase/javase-jdk8-downloads.html</a></p>\n<p><img src=\"/images/2020/03/20200315230304868.png\" alt=\"在这里插入图片描述\"></p>\n<p>我们可以直接访问JDK的官方网站，去下载Linux版本对应的JDK安装包。<br>Linux系统直接下载tar.gz的压缩包即可。</p>\n<h2 id=\"Linux环境安装JDK\"><a href=\"#Linux环境安装JDK\" class=\"headerlink\" title=\"Linux环境安装JDK\"></a>Linux环境安装JDK</h2><p>alt+p快捷键进入sftp传输方式，使用put命令将JDK上传至Linux的root目录下。</p>\n<ul>\n<li>Liunx环境下的sftp传输命令可以参考上一篇博客：<a href=\"/2020/03/10/linux/Linux常用命令/\">Linux常用命令</a>的sftp传输。</li>\n</ul>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">mv</span> jdk<span class=\"literal\">-8u241-linux-x64</span>.tar.gz /usr/local/</span><br></pre></td></tr></table></figure>\n<p>使用mv剪切命令，将root目录下的JDK安装包剪切到<code>/usr/local/</code>目录下。</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">tar –zxvf jdk<span class=\"literal\">-8u241-linux-x64</span>.tar.gz</span><br></pre></td></tr></table></figure>\n<p>使用tar命令，将tar.gz压缩包解压缩在<code>/usr/local/</code>目录下。</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">rpm <span class=\"literal\">-qa</span> | grep java</span><br></pre></td></tr></table></figure>\n<p>查询安装的jdk的信息。</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">rm</span> <span class=\"literal\">-rf</span> jdk<span class=\"literal\">-8u241-linux-x64</span>.tar.gz</span><br></pre></td></tr></table></figure>\n<p>删除JDK的压缩包。</p>\n<h2 id=\"配置JDK\"><a href=\"#配置JDK\" class=\"headerlink\" title=\"配置JDK\"></a>配置JDK</h2><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">vi /etc/profile</span><br></pre></td></tr></table></figure>\n<p>编辑/etc/下的profile文件。</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#set java environment</span></span><br><span class=\"line\">JAVA_HOME=/usr/local/jdk1.<span class=\"number\">8.0</span>_241</span><br><span class=\"line\">CLASSPATH=.:<span class=\"variable\">$JAVA_HOME</span>/lib/tools.jar</span><br><span class=\"line\">PATH=<span class=\"variable\">$JAVA_HOME</span>/bin:<span class=\"variable\">$PATH</span></span><br><span class=\"line\">export JAVA_HOME CLASSPATH PATH</span><br></pre></td></tr></table></figure>\n<p>在profile文件中添加上面的配置，保存并退出。</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">source /etc/profile</span><br></pre></td></tr></table></figure>\n<p>加载文件，使配置生效。</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">java –version</span><br></pre></td></tr></table></figure>\n<p>查看JDK版本。</p>\n<h2 id=\"卸载JDK\"><a href=\"#卸载JDK\" class=\"headerlink\" title=\"卸载JDK\"></a>卸载JDK</h2><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">rpm <span class=\"literal\">-e</span> <span class=\"literal\">--nodeps</span> jdk1.<span class=\"number\">8.0</span>_241</span><br></pre></td></tr></table></figure>\n<p>卸载JDK。</p>\n","categories":["Linux"],"tags":["JDK","Linux"]},{"title":"Linux虚拟机挂起后重启，Navicat无法连接Docker MySQL容器","url":"/2023/06/04/linux/Linux%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%8C%82%E8%B5%B7%E5%90%8E%E9%87%8D%E5%90%AF%EF%BC%8CNavicat%E6%97%A0%E6%B3%95%E8%BF%9E%E6%8E%A5Docker%20MySQL%E5%AE%B9%E5%99%A8/","content":"<h1 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h1><p>将虚拟机挂起后再次重启，但是 Navicat 工具却无法连接 Docker MySQL 容器。</p>\n<span id=\"more\"></span>\n\n<h1 id=\"情况\"><a href=\"#情况\" class=\"headerlink\" title=\"情况\"></a>情况</h1><p>1、Linux 虚拟机防火墙已关闭<br>2、使用 XShell 工具可以连接并登录 Linux 虚拟机<br>3、Docker 服务启动无问题，并且 Linux 本地可以使用 Docker 命令登录 MySQL 容器<br>4、Linux 虚拟机网络无问题，Linux 虚拟机可以访问外部网络，Windows 也可以 ping 通 Linux 虚拟机</p>\n<h1 id=\"解决方法\"><a href=\"#解决方法\" class=\"headerlink\" title=\"解决方法\"></a>解决方法</h1><h2 id=\"临时解决方法\"><a href=\"#临时解决方法\" class=\"headerlink\" title=\"临时解决方法\"></a>临时解决方法</h2><p>重启网络和 Docker 服务，重启 Docker MySQL 容器，这种方法只对本次 Linux 运行期间有效，如果重新将 Linux 虚拟机挂起，那么依然会有这种问题，需要再次执行以下命令才能 Dokcer 容器的网络为。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">systemctl restart NetworkManager docker</span><br><span class=\"line\">docker start mysql</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"彻底解决方法\"><a href=\"#彻底解决方法\" class=\"headerlink\" title=\"彻底解决方法\"></a>彻底解决方法</h2><p>创建并编辑文件 <code>/etc/NetworkManager/conf.d/10-unmanage-docker-interfaces.conf</code> ，文件内容如下：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">[keyfile]</span><br><span class=\"line\">unmanaged-devices=interface-name:docker*;interface-name:veth*;interface-name:br-*;interface-name:vmnet*;interface-name:vboxnet*</span><br></pre></td></tr></table></figure>\n\n<p>然后重新启动 <code>NetworkManager</code> 服务 和 <code>Docker</code> 服务。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">systemctl restart NetworkManager docker</span><br><span class=\"line\">docker start mysql</span><br></pre></td></tr></table></figure>\n<p>这种解决方法，即便以后再将 Linux 虚拟机挂起，依然不会出现无法连接 <code>Docker</code> 容器网络的问题。</p>\n","categories":["Linux"],"tags":["MySQL","Linux","Docker"]},{"title":"Liunx系统安装JDK环境（yum安装）","url":"/2020/12/10/linux/Liunx%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85JDK%E7%8E%AF%E5%A2%83%EF%BC%88yum%E5%AE%89%E8%A3%85%EF%BC%89/","content":"<blockquote>\n<p>在之前我曾经写过一篇<a href=\"/2020/03/15/linux/Linux系统安装JDK环境/\">Linux系统安装JDK环境</a>，这篇博客是使用JDK安装包的方式，由自己手动安装并配置JDK的环境变量。<br>而今天使用的是yum来进行JDK自动化安装，卸载。这种方式比起手动安装更加方便，快捷。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h1 id=\"安装JDK\"><a href=\"#安装JDK\" class=\"headerlink\" title=\"安装JDK\"></a>安装JDK</h1><h2 id=\"1、检查Linux系统是否已经拥有JDK环境。\"><a href=\"#1、检查Linux系统是否已经拥有JDK环境。\" class=\"headerlink\" title=\"1、检查Linux系统是否已经拥有JDK环境。\"></a>1、检查Linux系统是否已经拥有JDK环境。</h2><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">rpm <span class=\"literal\">-qa</span> | grep java</span><br><span class=\"line\">yum list installed | grep java</span><br><span class=\"line\">以上两个命令都可以检测Linux系统是否安装有JDK环境，选择其一即可</span><br></pre></td></tr></table></figure>\n<h2 id=\"2、检索JDK\"><a href=\"#2、检索JDK\" class=\"headerlink\" title=\"2、检索JDK\"></a>2、检索JDK</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">yum search java | grep -i --color jdk</span><br></pre></td></tr></table></figure>\n<h2 id=\"3、安装JDK\"><a href=\"#3、安装JDK\" class=\"headerlink\" title=\"3、安装JDK\"></a>3、安装JDK</h2><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">yum install <span class=\"literal\">-y</span> java<span class=\"literal\">-1</span>.<span class=\"number\">8.0</span><span class=\"literal\">-openjdk</span>*</span><br></pre></td></tr></table></figure>\n\n<p>只需要极其简单的三步，JDK环境就已经安装完毕了。<br>我们可以通过<code>java -version</code>命令来查看JDK版本，如果显示JDK版本信息，则说明JDK安装成功。</p>\n<p><strong>如图所示：</strong><br><img src=\"/images/2020/12/20201210214030991.png\" alt=\"在这里插入图片描述\"></p>\n<h1 id=\"卸载JDK\"><a href=\"#卸载JDK\" class=\"headerlink\" title=\"卸载JDK\"></a>卸载JDK</h1><h2 id=\"1、卸载JDK\"><a href=\"#1、卸载JDK\" class=\"headerlink\" title=\"1、卸载JDK\"></a>1、卸载JDK</h2><p> 如果在安装之前，Linux系统已经有了JDK的环境，但是想要重新安装，则可以使用卸载命令卸载JDK环境。</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">yum <span class=\"literal\">-y</span> remove java<span class=\"literal\">-1</span>.<span class=\"number\">8.0</span><span class=\"literal\">-openjdk</span>*</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"补充说明\"><a href=\"#补充说明\" class=\"headerlink\" title=\"补充说明\"></a>补充说明</h1><h2 id=\"1、yum安装JDK的路径\"><a href=\"#1、yum安装JDK的路径\" class=\"headerlink\" title=\"1、yum安装JDK的路径\"></a>1、yum安装JDK的路径</h2><p>使用yum安装JDK，默认的JDK安装路径在<code>/usr/lib/jvm</code>目录下。</p>\n<p><img src=\"/images/2020/12/20201210215253623.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ1MTkzMzA0,size_16,color_FFFFFF,t_70\" alt=\"在这里插入图片描述\"></p>\n","categories":["Linux"],"tags":["JDK","Linux"]},{"title":"Shell报错syntax error: unexpected end of file","url":"/2021/01/01/linux/Shell%E6%8A%A5%E9%94%99/","content":"<p>执行shell脚本文件，报错<code>syntax error: unexpected end of file</code>。</p>\n<p>使用vim工具打开脚本文件，却并没有发现有什么问题。</p>\n<span id=\"more\"></span>\n\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">vim hello.sh</span><br></pre></td></tr></table></figure>\n<p><img src=\"/images/2021/01/20210101190743117.png\" alt=\"在这里插入图片描述\"></p>\n<p>但是只需要使用vim+参数的方式打开该文件，就会发现一些端倪。</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">vim <span class=\"literal\">-b</span> hello.sh</span><br></pre></td></tr></table></figure>\n<p><img src=\"/images/2021/01/20210101190806488.png\" alt=\"在这里插入图片描述\"></p>\n<p>在每一个<code>shell</code>语句的末尾，都多了一个<code>^M</code>的标志，这其实是因为该文件是在<code>windows</code>环境下编写，然后传输到<code>Linux</code>环境来的，但是因为<code>windows</code>环境的文本有<code>\\r</code>的回车标识，在<code>Linux</code>环境下就会出现不兼容的问题。</p>\n<p><strong>解决方法：</strong></p>\n<p>1、只需要把<code>^M</code>的标志符删除，该脚本文件即可正常执行。不过这种方法只适用于少量文本，如果是大量的脚本代码，这显然是不适用的。</p>\n<p>2、通过命令的方式，将shell文件的格式改为unix。</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">vim hello.sh</span><br><span class=\"line\">:<span class=\"built_in\">set</span> fileformat=unix</span><br><span class=\"line\">:x</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>使用<code>vim</code>编辑文本的时候，不要使用<code>-b</code>参数，否则是无法将<code>shell</code>文件的文件格式修改为<code>unix</code>的。</p>\n</blockquote>\n","categories":["Linux"],"tags":["Linux","Shell"]},{"title":"一篇博客教会你怎么使用Docker安装RabbitMQ","url":"/2023/06/30/linux/%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2%E6%95%99%E4%BC%9A%E4%BD%A0%E6%80%8E%E4%B9%88%E4%BD%BF%E7%94%A8Docker%E5%AE%89%E8%A3%85RabbitMQ/","content":"<p>今天我们学习使用 Docker 安装 RabbitMQ。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"1、搜索镜像\"><a href=\"#1、搜索镜像\" class=\"headerlink\" title=\"1、搜索镜像\"></a>1、搜索镜像</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker search rabbitmq</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2、拉取镜像\"><a href=\"#2、拉取镜像\" class=\"headerlink\" title=\"2、拉取镜像\"></a>2、拉取镜像</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker pull rabbitmq</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3、运行容器\"><a href=\"#3、运行容器\" class=\"headerlink\" title=\"3、运行容器\"></a>3、运行容器</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker run --name rabbitmq -d -p 15672:15672 -p 5672:5672 --privileged rabbitmq</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4、启用Web管理\"><a href=\"#4、启用Web管理\" class=\"headerlink\" title=\"4、启用Web管理\"></a>4、启用Web管理</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker exec -it rabbitmq bash</span><br><span class=\"line\"></span><br><span class=\"line\">rabbitmq-plugins enable rabbitmq_management</span><br></pre></td></tr></table></figure>\n\n<p>最后，我们使用浏览器访问对应的 IP 地址 + <code>15672</code> 端口即可访问 <code>rabbitmq</code>的 Web 管理页面，默认账号密码为 <code>guest/guest</code> 。</p>\n","categories":["Linux"],"tags":["Linux","Docker","RabbitMQ"]},{"title":"一篇博客教会你怎么使用Docker安装并配置Nginx","url":"/2023/03/16/linux/%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2%E6%95%99%E4%BC%9A%E4%BD%A0%E6%80%8E%E4%B9%88%E4%BD%BF%E7%94%A8Docker%E5%AE%89%E8%A3%85%E5%B9%B6%E9%85%8D%E7%BD%AENginx/","content":"<blockquote>\n<p>首先我们需要安装Docker，如果没有安装Docker的朋友，可以参考我以前的博客<a href=\"/2020/04/16/tool/一篇博客教会你怎么安装Docker/\">一篇博客教会你怎么安装Docker</a>进行Docker的安装。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h2 id=\"启动-Docker\"><a href=\"#启动-Docker\" class=\"headerlink\" title=\"启动 Docker\"></a>启动 Docker</h2><p>在使用 Docker 安装 Nginx 之前，我们先要启动 Dokcer，我们可以使用启动命令启动 Docker 服务。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">systemctl start docker</span><br></pre></td></tr></table></figure>\n\n<p>启动成功之后，我们可以使用命令查询 Docker 服务是否启动成功。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">systemctl status docker</span><br></pre></td></tr></table></figure>\n\n<p>执行命令后出现如下的内容输出，即表示 Docker 服务已启动成功。</p>\n<p><img src=\"/images/2023/03/image-20230316232046075.png\" alt=\"image-20230316232046075\"></p>\n<h2 id=\"创建-Nginx-容器\"><a href=\"#创建-Nginx-容器\" class=\"headerlink\" title=\"创建 Nginx 容器\"></a>创建 Nginx 容器</h2><p>在创建 Nginx 容器之前，需要从云端拉取一个 Nginx 的镜像，我们可以使用 Docker 的查询命令来查看 Nginx 的镜像。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker search nginx</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/images/2023/03/image-20230316232349874.png\" alt=\"image-20230316232349874\"></p>\n<p>其中第一个就是官方提供的镜像，我们使用 Docker 的拉取命令获取镜像。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker pull nginx</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/images/2023/03/image-20230316232701344.png\" alt=\"image-20230316232701344\"></p>\n<p>拉取镜像成功之后，我们可以查看本地拥有的镜像。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker images</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/images/2023/03/image-20230316232630591.png\" alt=\"image-20230316232630591\"></p>\n<p>将 Nginx 镜像下载到本地之后，我们可以通过该镜像创建一个本地容器。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker run -d -p 80:80 --name nginx -v /usr/app/zero-admin:/usr/app/zero-admin/ nginx</span><br></pre></td></tr></table></figure>\n\n<p>创建容器之后，使用启动容器的命令启动 Nginx 容器。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker start nginx</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/images/2023/03/image-20230316233135645.png\" alt=\"image-20230316233135645\"></p>\n<p>通过 <code>docker ps -a</code> 命令，我们可以看到 Nginx 容器已经启动成功了。</p>\n<h2 id=\"配置-Nginx\"><a href=\"#配置-Nginx\" class=\"headerlink\" title=\"配置 Nginx\"></a>配置 Nginx</h2><p>经过以上的步骤，Nginx 已经启动成功了，然后我们需要对 Nginx 进行配置。</p>\n<p>使用 <code>docker cp</code> 命令，将 Nginx 容器内的配置文件 <code>nginx.conf</code> 复制到本地的临时文件目录下。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker cp nginx:/etc/nginx/nginx.conf /tmp/nginx.conf</span><br></pre></td></tr></table></figure>\n\n<p>使用 <code>vim</code> 对配置文件 <code>nginx.conf</code> 进行编辑。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">vim /tmp/nginx.conf</span><br></pre></td></tr></table></figure>\n\n<p>修改之后的配置文件 <code>nginx.conf</code> 如下：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">user  nginx;</span><br><span class=\"line\">worker_processes  1;</span><br><span class=\"line\"></span><br><span class=\"line\">error_log  /var/log/nginx/error.log warn;</span><br><span class=\"line\">pid        /var/run/nginx.pid;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">events &#123;</span><br><span class=\"line\">    worker_connections  1024;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">http &#123;</span><br><span class=\"line\">    include       /etc/nginx/mime.types;</span><br><span class=\"line\">    default_type  application/octet-stream;</span><br><span class=\"line\"></span><br><span class=\"line\">    log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span><br><span class=\"line\">                      &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span><br><span class=\"line\">                      &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span><br><span class=\"line\"></span><br><span class=\"line\">    access_log  /var/log/nginx/access.log  main;</span><br><span class=\"line\"></span><br><span class=\"line\">    sendfile        on;</span><br><span class=\"line\">    #tcp_nopush     on;</span><br><span class=\"line\"></span><br><span class=\"line\">    keepalive_timeout  65;</span><br><span class=\"line\"></span><br><span class=\"line\">    #gzip  on;</span><br><span class=\"line\"></span><br><span class=\"line\">    #include /etc/nginx/conf.d/*.conf;</span><br><span class=\"line\">    server &#123;</span><br><span class=\"line\">        listen 80;</span><br><span class=\"line\">        server_name zero-admin;</span><br><span class=\"line\">        location / &#123;</span><br><span class=\"line\">            root   /usr/app/zero-admin/dist;</span><br><span class=\"line\">            index  index.html;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        location /api/ &#123;</span><br><span class=\"line\">            proxy_pass http://127.0.0.1:10000/;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>修改后的配置文件 <code>nginx.conf</code> 与原文件相比，改动了两处：<br>1、将 <code>include /etc/nginx/conf.d/*.conf;</code> 这一行进行了注释。<br>2、在 http 内添加了一个 server。</p>\n</blockquote>\n<p>将修改后的配置文件 <code>nginx.conf</code> 复制回容器 Nginx 内。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker cp /tmp/nginx.conf nginx:/etc/nginx/nginx.conf</span><br></pre></td></tr></table></figure>\n\n<p>重新启动 Nginx 容器。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker stop nginx</span><br><span class=\"line\">docker start nginx</span><br></pre></td></tr></table></figure>\n\n\n\n<p>至此，使用 Docker 安装并配置 Nginx 的步骤就全部完成了，使用浏览器访问服务器的 <code>ip</code> 地址，就能访问到代理目录下的文件了。</p>\n","categories":["Linux"],"tags":["Linux","Docker"]},{"title":"一篇博客教会你怎么安装CentOS系统","url":"/2020/04/19/linux/%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2%E6%95%99%E4%BC%9A%E4%BD%A0%E6%80%8E%E4%B9%88%E5%AE%89%E8%A3%85CentOS%E7%B3%BB%E7%BB%9F/","content":"<blockquote>\n<p>这篇博客我们来学习怎样通过VMware虚拟机软件来安装CentOS系统。<br>这篇博客是在VMware虚拟机的基础上安装CentOS系统，所以如果不知道怎么安装VMware虚拟机的同学，可以参考我之前的博客：<a href=\"/2020/04/19/一篇博客教会你怎么安装VMware虚拟机\">一篇博客教会你怎么安装VMware虚拟机</a></p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h1 id=\"一、下载CentOS系统镜像文件\"><a href=\"#一、下载CentOS系统镜像文件\" class=\"headerlink\" title=\"一、下载CentOS系统镜像文件\"></a>一、下载CentOS系统镜像文件</h1><p>CentOS系统的Linux系统比较流行的一个发行版本，CentOS系统是免费，所有人都可以从CentOS系统的官方网站中获取CentOS系统的镜像文件。<br>CentOS下载官网：<a href=\"http://isoredirect.centos.org/centos/8/isos/x86_64/CentOS-8.1.1911-x86_64-dvd1.iso\">http://isoredirect.centos.org/centos/8/isos/x86_64/CentOS-8.1.1911-x86_64-dvd1.iso</a><br>在CentOS的官网中，我们可以看到很多个镜像网站下载地址，我们可以选择国内的镜像来进行下载，这样的话下载速度会非常可观。<br>国内的镜像推荐<code>华为</code>或者<code>阿里云</code>的镜像。<br><img src=\"/images/2020/04/20200415185900442.png\" alt=\"在这里插入图片描述\"></p>\n<h1 id=\"二、在VMware中创建虚拟机\"><a href=\"#二、在VMware中创建虚拟机\" class=\"headerlink\" title=\"二、在VMware中创建虚拟机\"></a>二、在VMware中创建虚拟机</h1><p><strong>1、我们<code>以管理员身份运行VMware</code>，打开VMware虚拟机，点击创建新的虚拟机</strong><br><img src=\"/images/2020/04/20200415190905720.png\" alt=\"在这里插入图片描述\"><br><strong>2、开始创建虚拟机</strong><br><img src=\"/images/2020/04/20200415191542142.png\" alt=\"在这里插入图片描述\"><br><strong>3、安装客户机操作系统</strong><br><img src=\"/images/2020/04/20200415191722271.png\" alt=\"在这里插入图片描述\"><br><strong>4、选择客户机操作系统</strong><br><img src=\"/images/2020/04/20200415191925827.png\" alt=\"在这里插入图片描述\"><br><strong>5、命名虚拟机</strong><br><img src=\"/images/2020/04/20200415193411410.png\" alt=\"在这里插入图片描述\"><br><strong>6、指定磁盘容量</strong><br><img src=\"/images/2020/04/20200415192700707.png\" alt=\"在这里插入图片描述\"><br><strong>7、自定义配置</strong><br><img src=\"/images/2020/04/20200415193812791.png\" alt=\"在这里插入图片描述\"><br><strong>8、指定虚拟机内存</strong><br><img src=\"/images/2020/04/20200415194153507.png\" alt=\"在这里插入图片描述\"><br><strong>9、指定ISO映像文件路径</strong><br><img src=\"/images/2020/04/20200415194547766.png\" alt=\"在这里插入图片描述\"><br><strong>10、移除打印机</strong><br><img src=\"/images/2020/04/20200415194757891.png\" alt=\"在这里插入图片描述\"><br><strong>11、点击完成</strong><br><img src=\"/images/2020/04/20200415194908763.png\" alt=\"在这里插入图片描述\"><br><strong>12、虚拟机创建完成</strong><br><img src=\"/images/2020/04/20200415201407502.png\" alt=\"在这里插入图片描述\"></p>\n<h1 id=\"三、安装CentOS系统\"><a href=\"#三、安装CentOS系统\" class=\"headerlink\" title=\"三、安装CentOS系统\"></a>三、安装CentOS系统</h1><p><strong>1、我们创建好虚拟机之后，就可以开始安装操作系统了，我们首先开启之前创建的虚拟机</strong><br><img src=\"/images/2020/04/2020041520181421.png\" alt=\"在这里插入图片描述\"><br><strong>2、选择检测安装</strong><br><img src=\"/images/2020/04/2020041520243732.png\" alt=\"在这里插入图片描述\"><br><img src=\"/images/2020/04/20200415202447999.png\" alt=\"在这里插入图片描述\"><br>选择检测安装之后，虚拟机会自动帮我们开始检测，这个过程大概<code>30-60秒</code>左右，等待即可。<br>完成之后出现如下界面：<br><img src=\"/images/2020/04/20200415202856283.png\" alt=\"在这里插入图片描述\"><br><strong>3、选择简体中文</strong><br><img src=\"/images/2020/04/20200415202958121.png\" alt=\"在这里插入图片描述\"><br><strong>4、调整系统时间</strong><br><img src=\"/images/2020/04/20200415203707220.png\" alt=\"在这里插入图片描述\"><br><img src=\"/images/2020/04/20200415203901353.png\" alt=\"在这里插入图片描述\"><br><strong>5、选择服务器类型</strong><br><img src=\"/images/2020/04/20200415204209197.png\" alt=\"在这里插入图片描述\"><br><strong>6、选择系统的安装目的地</strong><br><img src=\"/images/2020/04/20200415204351669.png\" alt=\"在这里插入图片描述\"><br><img src=\"/images/2020/04/20200415204930116.png\" alt=\"在这里插入图片描述\"><br><strong>7、开启虚拟机网络和指定主机名</strong><br><img src=\"/images/2020/04/20200415204953923.png\" alt=\"在这里插入图片描述\"><br><img src=\"/images/2020/04/20200415205835878.png\" alt=\"在这里插入图片描述\"><br><strong>8、开始安装</strong><br><img src=\"/images/2020/04/20200415210151647.png\" alt=\"在这里插入图片描述\"><br><strong>9、设置Root用户密码</strong><br><img src=\"/images/2020/04/20200415210335244.png\" alt=\"在这里插入图片描述\"><br><img src=\"/images/2020/04/20200415210844650.png\" alt=\"在这里插入图片描述\"><br><strong>10、等待安装</strong><br><img src=\"/images/2020/04/20200415211013781.png\" alt=\"在这里插入图片描述\"><br>等待安装需要一小段时间，耐心等待即可。</p>\n<p><strong>11、重启系统</strong><br><img src=\"/images/2020/04/20200415211949410.png\" alt=\"在这里插入图片描述\"><br><strong>12、初始设置</strong><br><img src=\"/images/2020/04/20200415212211287.png\" alt=\"在这里插入图片描述\"><br><img src=\"/images/2020/04/20200415212327812.png\" alt=\"在这里插入图片描述\"><br><strong>13、结束配置</strong><br><img src=\"/images/2020/04/20200415212511711.png\" alt=\"在这里插入图片描述\"><br><strong>14、安装成功，欢迎界面</strong><br><img src=\"/images/2020/04/20200415212923944.png\" alt=\"在这里插入图片描述\"><br><img src=\"/images/2020/04/20200415213112150.png\" alt=\"在这里插入图片描述\"><br><img src=\"/images/2020/04/20200415213157314.png\" alt=\"在这里插入图片描述\"><br><strong>15、设置全名和用户名</strong><br><img src=\"/images/2020/04/20200415213425330.png\" alt=\"在这里插入图片描述\"><br><strong>16、设置密码</strong><br><img src=\"/images/2020/04/20200415213638959.png\" alt=\"在这里插入图片描述\"><br><strong>17、一切就绪，开始用吧</strong><br><img src=\"/images/2020/04/20200415213739774.png\" alt=\"在这里插入图片描述\"><br><strong>18、登录系统</strong><br><img src=\"/images/2020/04/20200415213942326.png\" alt=\"在这里插入图片描述\"><br><img src=\"/images/2020/04/20200415214001655.png\" alt=\"在这里插入图片描述\"><br><img src=\"/images/2020/04/20200415214020269.png\" alt=\"在这里插入图片描述\"><br><strong>19、开始使用</strong><br><img src=\"/images/2020/04/20200415214440688.png\" alt=\"在这里插入图片描述\"></p>\n<p><strong>历经千难万险，终于把CentOS系统安装成功了，可以开始来上手试试CentOS系统了。</strong></p>\n<blockquote>\n<p><strong>最后提醒一下，如果不需要使用虚拟机了，不要直接关闭虚拟机，如果直接关闭虚拟机，下一次开机的时候会出现很多的问题，所以我们不要使用虚拟机之后，直接将虚拟机<code>挂起</code>，这样下次需要使用的时候，直接继续运行即可！</strong></p>\n</blockquote>\n","categories":["Linux"],"tags":["Linux","CentOS"]},{"title":"一篇博客教会你怎么安装VMware虚拟机","url":"/2020/04/19/linux/%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2%E6%95%99%E4%BC%9A%E4%BD%A0%E6%80%8E%E4%B9%88%E5%AE%89%E8%A3%85VMware%E8%99%9A%E6%8B%9F%E6%9C%BA/","content":"<blockquote>\n<p>这篇博客我们来学习VMware虚拟机的安装</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h1 id=\"1、下载VMware虚拟机\"><a href=\"#1、下载VMware虚拟机\" class=\"headerlink\" title=\"1、下载VMware虚拟机\"></a>1、下载VMware虚拟机</h1><p>获取VMware虚拟机安装包的方法有两个：</p>\n<p><strong>1、VMware官网：</strong><a href=\"https://www.vmware.com/cn/products/workstation-pro/workstation-pro-evaluation.html\">https://www.vmware.com/cn/products/workstation-pro/workstation-pro-evaluation.html</a></p>\n<p><img src=\"/images/2020/04/20200415174651464.png\" alt=\"在这里插入图片描述\">当然，VMware是一款商业软件，是收费的。</p>\n<p><strong>2、除了官网下载之外，我还在自己的百度网盘中上传了VMware安装软件。</strong><br>链接：<a href=\"https://pan.baidu.com/s/1QON5-U4joSboW4Xb3N0Bgg\">https://pan.baidu.com/s/1QON5-U4joSboW4Xb3N0Bgg</a><br>提取码：92xr</p>\n<h1 id=\"2、安装VMware虚拟机\"><a href=\"#2、安装VMware虚拟机\" class=\"headerlink\" title=\"2、安装VMware虚拟机\"></a>2、安装VMware虚拟机</h1><p>我们直接运行VMware虚拟机安装包的exe文件，开始安装。</p>\n<p><strong>1、释放文件</strong><br><img src=\"/images/2020/04/2020041517511543.png\" alt=\"在这里插入图片描述\"></p>\n<p><strong>2、VMware安装开始界面</strong><br><img src=\"/images/2020/04/2020041517525792.png\" alt=\"在这里插入图片描述\"></p>\n<p><strong>3、接受许可协议</strong><br><img src=\"/images/2020/04/20200415175421150.png\" alt=\"在这里插入图片描述\"></p>\n<p><strong>4、选择安装磁盘位置</strong><br><img src=\"/images/2020/04/20200415180809522.png\" alt=\"在这里插入图片描述\"></p>\n<p><img src=\"/images/2020/04/20200415180916743.png\" alt=\"在这里插入图片描述\"></p>\n<p><strong>5、自定义安装</strong><br><img src=\"/images/2020/04/2020041518102297.png\" alt=\"在这里插入图片描述\"></p>\n<p><strong>6、快捷方式</strong><br><img src=\"/images/2020/04/20200415175746169.png\" alt=\"在这里插入图片描述\"></p>\n<p><strong>7、安装</strong><br><img src=\"/images/2020/04/20200415175810600.png\" alt=\"在这里插入图片描述\"></p>\n<p><strong>8、安装过程</strong><br><img src=\"/images/2020/04/20200415175846361.png\" alt=\"在这里插入图片描述\"></p>\n<blockquote>\n<p><strong>备注：如果是使用我百度网盘中的安装包，安装完了之后会跳出一个破解界面，点击许可证——输入——完成即可。</strong></p>\n</blockquote>\n<h1 id=\"3、开启VMware虚拟机\"><a href=\"#3、开启VMware虚拟机\" class=\"headerlink\" title=\"3、开启VMware虚拟机\"></a>3、开启VMware虚拟机</h1><p><strong>当安装完成之后，电脑桌面会出现一个VMware虚拟机的图标：</strong><br><img src=\"/images/2020/04/20200415181445981.png\" alt=\"在这里插入图片描述\"></p>\n<p><strong>双击开启VMware虚拟机，虚拟机界面如下：</strong><br><img src=\"/images/2020/04/20200415181640707.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["Linux"],"tags":["Linux","CentOS","VMware"]},{"title":"MySQL数据库常用SQL","url":"/2020/03/14/mysql/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B8%B8%E7%94%A8SQL/","content":"<h1 id=\"什么是SQL？\"><a href=\"#什么是SQL？\" class=\"headerlink\" title=\"什么是SQL？\"></a>什么是SQL？</h1><p>结构化查询语言(Structured Query Language)简称SQL，是一种特殊目的的编程语言，是一种数据库查询和程序设计语言，用于存取数据以及查询、更新和管理关系数据库系统。</p>\n<span id=\"more\"></span>\n<p><strong>SQL的分类</strong></p>\n<ul>\n<li>DDL: 数据库的定义, 与数据库/表结构: create, drop, alter</li>\n<li>DCL: 数据控制语言: 设置用户的访问权限  安全</li>\n<li>DML: 数据操纵语言: 操作表数据 insert update delete</li>\n<li>DQL: 数据查询语言: select  from where</li>\n</ul>\n<h1 id=\"数据库操作\"><a href=\"#数据库操作\" class=\"headerlink\" title=\"数据库操作\"></a>数据库操作</h1><table>\n<thead>\n<tr>\n<th>操作</th>\n<th>SQL</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>创建数据库</td>\n<td>create database 数据库的名字</td>\n</tr>\n<tr>\n<td>删除数据库</td>\n<td>drop database 数据库名字</td>\n</tr>\n<tr>\n<td>修改数据库</td>\n<td>alter database character set 字符集</td>\n</tr>\n<tr>\n<td>查看所有数据库</td>\n<td>show databases</td>\n</tr>\n<tr>\n<td>查看数据库定义</td>\n<td>show create database 数据库名字</td>\n</tr>\n<tr>\n<td>查看当前正在使用的数据库</td>\n<td>select database()</td>\n</tr>\n<tr>\n<td>选中数据库</td>\n<td>use 数据库的名字</td>\n</tr>\n</tbody></table>\n<h1 id=\"表结构操作\"><a href=\"#表结构操作\" class=\"headerlink\" title=\"表结构操作\"></a>表结构操作</h1><h2 id=\"创建表\"><a href=\"#创建表\" class=\"headerlink\" title=\"创建表\"></a>创建表</h2><p>create table 表名(<br>  列名 列的类型(长度) 约束,<br>  列名2 列的类型(长度) 约束<br>);</p>\n<p><strong>列的约束</strong></p>\n<ul>\n<li>主键约束: primary key</li>\n<li>唯一约束: unique</li>\n<li>非空约束: not null</li>\n</ul>\n<h2 id=\"删除表\"><a href=\"#删除表\" class=\"headerlink\" title=\"删除表\"></a>删除表</h2><p>drop table 表名</p>\n<h2 id=\"修改表\"><a href=\"#修改表\" class=\"headerlink\" title=\"修改表\"></a>修改表</h2><table>\n<thead>\n<tr>\n<th>操作</th>\n<th>SQL</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>添加列</td>\n<td>alter table 表名 add 列名 列的类型 列的约束</td>\n</tr>\n<tr>\n<td>修改列</td>\n<td>alter table 表名 modify 列名 列的类型 列的约束</td>\n</tr>\n<tr>\n<td>修改列名</td>\n<td>alter table 表名 change 旧列名 新列名 列的类型 列的约束</td>\n</tr>\n<tr>\n<td>删除列</td>\n<td>alter table 表名 drop 列名</td>\n</tr>\n<tr>\n<td>修改表的字符集</td>\n<td>alter table 表名 character set 字符集</td>\n</tr>\n<tr>\n<td>修改表名</td>\n<td>rename table  旧表名 to 新的表名</td>\n</tr>\n</tbody></table>\n<h2 id=\"查看表\"><a href=\"#查看表\" class=\"headerlink\" title=\"查看表\"></a>查看表</h2><table>\n<thead>\n<tr>\n<th>操作</th>\n<th>SQL</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>查看当前数据库中所有的表名</td>\n<td>show tables</td>\n</tr>\n<tr>\n<td>查看表的定义结构/创建语句</td>\n<td>show create table 表名</td>\n</tr>\n<tr>\n<td>查看表的结构</td>\n<td>desc 表名</td>\n</tr>\n</tbody></table>\n<h1 id=\"表中数据的CRUD操作\"><a href=\"#表中数据的CRUD操作\" class=\"headerlink\" title=\"表中数据的CRUD操作\"></a>表中数据的CRUD操作</h1><h2 id=\"插入数据\"><a href=\"#插入数据\" class=\"headerlink\" title=\"插入数据\"></a>插入数据</h2><ul>\n<li>insert into 表名(列名1,列名2)values(值1,值2);</li>\n<li>insert into 表名 values(值1,值2);</li>\n<li>批量插入：insert into 表名values(值1,值2),(值1,值2),(值1,值2);</li>\n</ul>\n<h2 id=\"删除数据\"><a href=\"#删除数据\" class=\"headerlink\" title=\"删除数据\"></a>删除数据</h2><ul>\n<li>delete from 表名 [where 条件];</li>\n<li>先删除表,再重建表：truncate table 表名;</li>\n</ul>\n<h2 id=\"更新数据\"><a href=\"#更新数据\" class=\"headerlink\" title=\"更新数据\"></a>更新数据</h2><ul>\n<li>update 表名 set 列名=值, 列名=值 [where 条件];</li>\n</ul>\n<h2 id=\"查询数据\"><a href=\"#查询数据\" class=\"headerlink\" title=\"查询数据\"></a>查询数据</h2><p><strong>通用格式</strong><br>select [distinct] [*] [列名1,列名2] from 表名 where 条件 group by [列名] having 条件过滤 order by 排序1 asc,排序2 desc;</p>\n<p><strong>关系运算符</strong></p>\n<ul>\n<li>&lt;&gt; 不等于</li>\n<li>!= 不等于</li>\n</ul>\n<p><strong>逻辑运算符</strong></p>\n<ul>\n<li>and or not</li>\n</ul>\n<p><strong>在范围中</strong></p>\n<ul>\n<li>in</li>\n</ul>\n<p><strong>模糊查询</strong></p>\n<ul>\n<li>like</li>\n<li>_  表示的单个字符</li>\n<li>% 表示的是多个字符</li>\n</ul>\n<p><strong>别名查询</strong></p>\n<ul>\n<li>as</li>\n</ul>\n<p><strong>聚合函数</strong></p>\n<ul>\n<li>sum : 求和</li>\n<li>avg()  : 平均值</li>\n<li>count() : 统计数量</li>\n<li>max() : 最大值</li>\n<li>min() : 最小值</li>\n</ul>\n<p><strong>排序</strong> </p>\n<ul>\n<li>order by [列名] asc：升序排序 </li>\n<li>order by [列名] desc：降序排序 </li>\n</ul>\n<p><strong>分组</strong> </p>\n<ul>\n<li>group by [列名]</li>\n</ul>\n<h1 id=\"思维导图\"><a href=\"#思维导图\" class=\"headerlink\" title=\"思维导图\"></a>思维导图</h1><p><img src=\"/images/2020/03/2020031409202382.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["MySQL"],"tags":["MySQL"]},{"title":"MySQL数据库逻辑架构与存储引擎","url":"/2020/04/04/mysql/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E9%80%BB%E8%BE%91%E6%9E%B6%E6%9E%84%E4%B8%8E%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/","content":"<blockquote>\n<p>MySQL是目前市场是非常流行的关系型数据库，很多企业都使用MySQL作为服务器数据库。</p>\n</blockquote>\n<span id=\"more\"></span>\n<h1 id=\"MySQL数据库的特点\"><a href=\"#MySQL数据库的特点\" class=\"headerlink\" title=\"MySQL数据库的特点\"></a>MySQL数据库的特点</h1><ul>\n<li>MySQL数据库是一款开源的关系型数据库，性能突出。</li>\n<li>MySQL支持多种存储引擎，可以自由选择。</li>\n<li>MySQL支持事务和数据恢复（依赖存储引擎）。</li>\n</ul>\n<h1 id=\"MySQL数据库的架构\"><a href=\"#MySQL数据库的架构\" class=\"headerlink\" title=\"MySQL数据库的架构\"></a>MySQL数据库的架构</h1><h2 id=\"MySQL的客户端\"><a href=\"#MySQL的客户端\" class=\"headerlink\" title=\"MySQL的客户端\"></a>MySQL的客户端</h2><p>MySQL数据库是一个C/S架构的数据库，其中MySQL的服务端只有一个，但是客户端可以有多个，比如使用Java，Python等语言操作数据库，那么这些语言所编写的程序，就算是一个MySQL数据库的客户端，除此之外，比如Windows系统下的cmd命令提示窗口，也可以算是一种客户端。</p>\n<h2 id=\"MySQL的服务器端\"><a href=\"#MySQL的服务器端\" class=\"headerlink\" title=\"MySQL的服务器端\"></a>MySQL的服务器端</h2><p>MySQL的服务器端是重点，是MySQL数据库能够保存大量数据的原因，我们首先来看一看MySQL服务器端的各个组件以及组件的作用。</p>\n<p><strong>连接管理：</strong> 这是MySQL数据库的客户端和服务器端建立连接的一个管理工具，客户端通过IP地址，端口号，用户名和密码等信息连接MySQL数据库，然后由数据库的连接管理工具进行连接验证，确认用户名和密码的权限，是否能够访问数据库，能够访问哪些数据库。</p>\n<p><strong>缓存查询：</strong> MySQL为了优化访问数据的效率，会将一些SQL查询的数据放入缓存中，当有其他SELECT语句的SQL查询数据库的时候，会先查看缓存中是否有对应数据，如果有则直接返回，没有才会去解析SQL。但是因为缓存命中需要满足很多条件，比如SQL相同，上下文环境相同等等，导致MySQL的缓存命中率非常低下，所以在MySQL8.0的版本中，已经将缓存查询移除了。</p>\n<p><strong>解析器：</strong> MySQL的解析器的作用是用来解析SQL语句的，分析SQL语句的语法和语义。</p>\n<p><strong>优化器：</strong> MySQL的优化器，顾名思义，就是用来优化SQL的执行效率的，MySQL的优化器，可以分析SQL使用哪种方式执行效率最高，比如查询语句是使用全盘扫描的方式还是索引查询，MySQL的优化器是决定SQL执行性能的关键组件。不过优化器也并不是万能的，因为优化器判断使用哪种执行方式，使用的是基于数据库数据的抽样统计分析，抽样统计分析有时候可能会导致数据具有倾向性，从而导致优化器使用了错误的执行方法。</p>\n<h2 id=\"MySQL的逻辑架构\"><a href=\"#MySQL的逻辑架构\" class=\"headerlink\" title=\"MySQL的逻辑架构\"></a>MySQL的逻辑架构</h2><p> <strong>MySQL的架构分为三层，分别是客户端，服务器层，存储引擎层。</strong></p>\n<p><img src=\"/images/2020/04/20200404225751911.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"MySQL的SQL执行流程\"><a href=\"#MySQL的SQL执行流程\" class=\"headerlink\" title=\"MySQL的SQL执行流程\"></a>MySQL的SQL执行流程</h2><ul>\n<li>一条SQL通过连接管理工具的权限验证之后，会首先使用MySQL的缓存查询，如果缓存命中，直接返回SQL执行结果，如果缓存未命中，则由SQL解析器进行SQL语法语义解析。<strong>MySQL8.0由于缓存命中率太低，已经移除了缓存查询这一组件。</strong></li>\n<li>SQL通过解析器解析了语法和语义之后，将解析出来的内容交给MySQL优化器，由MySQL优化器做进一步的优化分析。</li>\n<li>最终MySQL将优化器分析出来的结果交给MySQL的存储引擎执行。</li>\n</ul>\n<h1 id=\"MySQL的存储引擎\"><a href=\"#MySQL的存储引擎\" class=\"headerlink\" title=\"MySQL的存储引擎\"></a>MySQL的存储引擎</h1><ul>\n<li>MySQL的存储引擎是对底层物理数据执行实际操作的组件，为服务器层提供各种操作数据的 API。MySQL 支持插件式的存储引擎，包括 InnoDB、MyISAM、Memory 等等。</li>\n<li>插件式存储引擎是 MySQL 的一大特点体系结构，每个存储引擎都提供了各自的功能，用户可以根据业务或者应用场景为数据表选择不同的存储引擎。也就是说，存储引擎的设置是在表级别的；因此也被称为表类型（table type）.</li>\n</ul>\n<h2 id=\"InnoDB\"><a href=\"#InnoDB\" class=\"headerlink\" title=\"InnoDB\"></a>InnoDB</h2><p>MySQL数据库在5.5的版本之后，默认使用InnoDB存储引擎。</p>\n<ul>\n<li>InnoDB存储引擎是一个支持事务，支持表级锁和行级锁，支持高并发的存储引擎。</li>\n<li>InnoDB是事务安全型的存储引擎，可以保证数据安全，更加注重数据的完整性和安全性。</li>\n<li>InnoDB存储引擎，在插入数据的时候，会按照主键顺序进行排序，所以插入数据的效率较低一些。</li>\n<li>InnoDB在5.6版本之后支持全文检索功能。</li>\n</ul>\n<h2 id=\"MyISAM\"><a href=\"#MyISAM\" class=\"headerlink\" title=\"MyISAM\"></a>MyISAM</h2><p>在MySQL5.5之前的版本，默认使用的存储引擎都是MyISAM，后来因为InnoDB的功能和性能逐渐完善和强大，才被InnoDB取代。</p>\n<ul>\n<li>MyISAM不支持事务，也不支持行级锁，只支持表级锁，不支持高并发。</li>\n<li>MyISAM擅长高速读写，在插入数据的时候不进行排序，所以插入数据的速度优于InnoDB。</li>\n<li>MyISAM支持数据压缩，但是数据压缩之后表变为只读表，只允许读操作，如果要进行写操作，需要解压数据。</li>\n<li>MyISAM支持全文检索功能。</li>\n</ul>\n<h2 id=\"InnoDB和MyISAM的区别\"><a href=\"#InnoDB和MyISAM的区别\" class=\"headerlink\" title=\"InnoDB和MyISAM的区别\"></a>InnoDB和MyISAM的区别</h2><table>\n<thead>\n<tr>\n<th></th>\n<th>InnoDB</th>\n<th>MyISAM</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>事务</td>\n<td>支持事务</td>\n<td>不支持事务</td>\n</tr>\n<tr>\n<td>全文检索</td>\n<td>5.6之后支持</td>\n<td>支持</td>\n</tr>\n<tr>\n<td>锁粒度</td>\n<td>支持表级锁，行级锁</td>\n<td>支持表级锁，不支持行级锁</td>\n</tr>\n<tr>\n<td>高并发</td>\n<td>支持</td>\n<td>不支持</td>\n</tr>\n<tr>\n<td>效率</td>\n<td>更新、删除快，插入较慢</td>\n<td>高速插入和查找</td>\n</tr>\n<tr>\n<td>数据安全</td>\n<td>注重数据完整性、安全性</td>\n<td>较差</td>\n</tr>\n</tbody></table>\n","categories":["MySQL"],"tags":["MySQL"]},{"title":"MySQL警告信息：不建议在没有服务器身份验证的情况下建立SSL连接","url":"/2020/06/26/mysql/MySQL%E8%AD%A6%E5%91%8A%E4%BF%A1%E6%81%AF%EF%BC%9A%E4%B8%8D%E5%BB%BA%E8%AE%AE%E5%9C%A8%E6%B2%A1%E6%9C%89%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E7%9A%84%E6%83%85%E5%86%B5%E4%B8%8B%E5%BB%BA%E7%AB%8BSSL%E8%BF%9E%E6%8E%A5/","content":"<p>前段时间重装了MySQL数据库，将原本的MySQL5.5版本换成了5.7版本，今天在运行以前的项目的时候，突然爆出了如下的错误信息：</p>\n<span id=\"more\"></span>\n\n<p><font color=\"#FF0000\">Establishing SSL connection without server’s identity verification is not recommended. According to MySQL 5.5.45+, 5.6.26+ and 5.7.6+ requirements SSL connection must be established by default if explicit option isn’t set. For compliance with existing applications not using SSL the verifyServerCertificate property is set to ‘false’. You need either to explicitly disable SSL by setting useSSL=false, or set useSSL=true and provide truststore for server certificate verification.</font ></p>\n<p>不建议在没有服务器身份验证的情况下建立SSL连接。 根据MySQL 5.5.45 +，5.6.26 +和5.7.6+的要求，如果未设置显式选项，则默认情况下必须建立SSL连接。 为了与不使用SSL的现有应用程序兼容，将verifyServerCertificate属性设置为’false’。 您需要通过设置useSSL = false显式禁用SSL，或者设置useSSL = true并提供信任库以进行服务器证书验证。</p>\n<p><strong>这个报错信息比较容易理解，我们直接在MySQL的url连接中添加一个参数<code>useSSL=false</code>，即可解决该报错问题。</strong></p>\n<p>例如：<code>jdbc:mysql://localhost:3306/myshop?useSSL=false</code></p>\n","categories":["MySQL"],"tags":["Java","MySQL"]},{"title":"一篇博客教会你怎么使用Docker安装MySQL5.7","url":"/2020/05/07/mysql/%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2%E6%95%99%E4%BC%9A%E4%BD%A0%E6%80%8E%E4%B9%88%E4%BD%BF%E7%94%A8Docker%E5%AE%89%E8%A3%85MySQL5.7/","content":"<blockquote>\n<p>首先我们需要安装Docker，如果没有安装Docker的朋友，可以参考我以前的博客<a href=\"/2020/04/16/tool/一篇博客教会你怎么安装Docker/\">一篇博客教会你怎么安装Docker</a>进行Docker的安装。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h1 id=\"一、我们直接使用Docker来拉取MySQL5-7的镜像文件\"><a href=\"#一、我们直接使用Docker来拉取MySQL5-7的镜像文件\" class=\"headerlink\" title=\"一、我们直接使用Docker来拉取MySQL5.7的镜像文件\"></a>一、我们直接使用Docker来拉取MySQL5.7的镜像文件</h1><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker pull mysql:<span class=\"number\">5.7</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"二、我们使用这个镜像创建一个MySQL容器\"><a href=\"#二、我们使用这个镜像创建一个MySQL容器\" class=\"headerlink\" title=\"二、我们使用这个镜像创建一个MySQL容器\"></a>二、我们使用这个镜像创建一个MySQL容器</h1><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker run <span class=\"literal\">-p</span> <span class=\"number\">3306</span>:<span class=\"number\">3306</span> <span class=\"literal\">--name</span> mysql <span class=\"literal\">-e</span> TZ=Asia/Shanghai <span class=\"literal\">-e</span> MYSQL_ROOT_PASSWORD=admin <span class=\"literal\">-d</span> mysql:<span class=\"number\">5.7</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"三、我们运行这个MySQL容器\"><a href=\"#三、我们运行这个MySQL容器\" class=\"headerlink\" title=\"三、我们运行这个MySQL容器\"></a>三、我们运行这个MySQL容器</h1><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker <span class=\"built_in\">start</span> mysql</span><br></pre></td></tr></table></figure>\n<p>运行成功之后，我们可以通过命令<code>docker ps -a</code>来查看当前容器的状态。<br><img src=\"/images/2020/05/20200507132547373.png\" alt=\"在这里插入图片描述\"></p>\n<h1 id=\"四、我们进入MySQL容器内部\"><a href=\"#四、我们进入MySQL容器内部\" class=\"headerlink\" title=\"四、我们进入MySQL容器内部\"></a>四、我们进入MySQL容器内部</h1><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker exec <span class=\"literal\">-it</span> mysql bash</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"五、输入MySQL的账户名和密码，进入MySQL命令提示行\"><a href=\"#五、输入MySQL的账户名和密码，进入MySQL命令提示行\" class=\"headerlink\" title=\"五、输入MySQL的账户名和密码，进入MySQL命令提示行\"></a>五、输入MySQL的账户名和密码，进入MySQL命令提示行</h1><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">mysql <span class=\"literal\">-uroot</span> <span class=\"literal\">-p</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"六、退出MySQL命令提示行\"><a href=\"#六、退出MySQL命令提示行\" class=\"headerlink\" title=\"六、退出MySQL命令提示行\"></a>六、退出MySQL命令提示行</h1><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">exit</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"七、退出容器\"><a href=\"#七、退出容器\" class=\"headerlink\" title=\"七、退出容器\"></a>七、退出容器</h1><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">exit</span></span><br></pre></td></tr></table></figure>\n\n","categories":["MySQL"],"tags":["MySQL","Docker"]},{"title":"一篇博客教会你怎么安装MySQL5.7","url":"/2020/05/18/mysql/%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2%E6%95%99%E4%BC%9A%E4%BD%A0%E6%80%8E%E4%B9%88%E5%AE%89%E8%A3%85MySQL5.7/","content":"<blockquote>\n<p>上一次我们学习了在Linux系统环境下，使用docker来进行安装MySQL5.7，具体可以参考博客<a href=\"/2020/05/07/mysql/一篇博客教会你怎么使用Docker安装MySQL5.7/\">一篇博客教会你怎么使用Docker安装MySQL5.7</a>，今天我们来学习在Windows环境下安装MySQL5.7。</p>\n</blockquote>\n<span id=\"more\"></span>\n<h1 id=\"一、MySQL的下载\"><a href=\"#一、MySQL的下载\" class=\"headerlink\" title=\"一、MySQL的下载\"></a>一、MySQL的下载</h1><p>MySQL5.7版本是免费版本，我们可以直接去MySQL的官网进行安装包下载。<br>MySQL官网：<a href=\"https://dev.mysql.com/downloads/windows/installer/5.7.html\">https://dev.mysql.com/downloads/windows/installer/5.7.html</a></p>\n<p>我们打开官网链接，可以看到如下的界面：<br><img src=\"/images/2020/05/20200517135416867.png\" alt=\"在这里插入图片描述\"><br><img src=\"/images/2020/05/20200517135416980.png\" alt=\"在这里插入图片描述\"></p>\n<h1 id=\"二、MySQL的安装\"><a href=\"#二、MySQL的安装\" class=\"headerlink\" title=\"二、MySQL的安装\"></a>二、MySQL的安装</h1><p>1、我们下载完成之后，双击运行MySQL的安装包。<br><img src=\"/images/2020/05/20200518130626463.png\" alt=\"在这里插入图片描述\"></p>\n<p>2、打开如下界面，我们选择运行。<br><img src=\"/images/2020/05/20200518130702776.png\" alt=\"在这里插入图片描述\"></p>\n<p>3、电脑会为我们进行一些配置，画面如下，我们等待即可。<br><img src=\"/images/2020/05/20200518130830279.png\" alt=\"在这里插入图片描述\"></p>\n<p>4、出现如下界面，表示我们已经进入了MySQL的安装界面，可以正式开始安装MySQL了。<br><img src=\"/images/2020/05/2020051813085633.png\" alt=\"在这里插入图片描述\"></p>\n<p>5、我们选择自定义配置，然后Next。<br><img src=\"/images/2020/05/20200518131221599.png\" alt=\"在这里插入图片描述\"></p>\n<p>6、选择32位或者64位的MySQL。<br><img src=\"/images/2020/05/20200518131643386.png\" alt=\"在这里插入图片描述\"></p>\n<p>7、选择MySQL的安装位置。<br><img src=\"/images/2020/05/20200518131918389.png\" alt=\"在这里插入图片描述\"><br><img src=\"/images/2020/05/20200518132028908.png\" alt=\"在这里插入图片描述\"></p>\n<p>8、检查MySQL5.7的安装环境。<br><img src=\"/images/2020/05/20200518132331645.png\" alt=\"在这里插入图片描述\"></p>\n<p>9、默认配置，直接Next即可。<br><img src=\"/images/2020/05/20200518132555765.png\" alt=\"在这里插入图片描述\"></p>\n<p>10、选择默认，点击Next即可。<br><img src=\"/images/2020/05/20200518132712641.png\" alt=\"在这里插入图片描述\"></p>\n<p>11、选择默认，点击Next即可。<br><img src=\"/images/2020/05/2020051813285345.png\" alt=\"在这里插入图片描述\"></p>\n<p>12、设置密码。<br><img src=\"/images/2020/05/20200518133124969.png\" alt=\"在这里插入图片描述\"></p>\n<p>13、MySQL服务配置，点击Next即可。<br><img src=\"/images/2020/05/20200518133410292.png\" alt=\"在这里插入图片描述\"></p>\n<p>14、点击Execute。<br><img src=\"/images/2020/05/20200518133602347.png\" alt=\"在这里插入图片描述\"></p>\n<p>15、点击Finish。<br><img src=\"/images/2020/05/20200518133712331.png\" alt=\"在这里插入图片描述\"></p>\n<p>16、点击Next。<br><img src=\"/images/2020/05/20200518133807610.png\" alt=\"在这里插入图片描述\"></p>\n<p>17、点击Finish，完成安装。<br><img src=\"/images/2020/05/20200518133934256.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["MySQL"],"tags":["MySQL"]},{"title":"像MySql一样在控制台输出打印漂亮的表格","url":"/2022/09/14/other/%E5%83%8FMySql%E4%B8%80%E6%A0%B7%E5%9C%A8%E6%8E%A7%E5%88%B6%E5%8F%B0%E8%BE%93%E5%87%BA%E6%89%93%E5%8D%B0%E6%BC%82%E4%BA%AE%E7%9A%84%E8%A1%A8%E6%A0%BC/","content":"<blockquote>\n<p>还记得大学期间第一次学习MySql数据，对于初学者而言，MySql没有漂亮的UI界面，只有那种黑乎乎的控制台界面，所有数据的展示都在控制台上输出和打印。<br>那个时候还是觉得MySql有一点Low，相比较之前学习的Sqlserver，Sqlserver好歹还有一个可以让初学者点击操作的UI界面。<br>但是伴随着在计算机领域的不断深入，编程知识的积累，反而却觉得MySql的控制台界面更加地优雅简洁，尤其记得MySql输出打印表格数据的时候，控制台界面上那个标准整齐的字符表格。<br>今天我就用一些空余时间，自己实现了一个类似表格输出打印程序。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h2 id=\"实现效果\"><a href=\"#实现效果\" class=\"headerlink\" title=\"实现效果\"></a>实现效果</h2><p>在这里，先贴一张实现的最终效果图。<br><img src=\"/images/2022/09/9a26811cfa4e4d4299101e2df062fc13.png\" alt=\"效果图\"></p>\n<h2 id=\"控制台打印表格的难点\"><a href=\"#控制台打印表格的难点\" class=\"headerlink\" title=\"控制台打印表格的难点\"></a>控制台打印表格的难点</h2><p>对于控制台而言，打印表格的难点有这些。</p>\n<ul>\n<li>难点一，因为输出字符的多样性，不同的字符占位不同，有的字符占1个位置，有的字符占2个位置，而这些字符又组成不同的字符串，复杂难度加大。</li>\n<li>难点二，控制台并没有集成的UI框架，表格是无法自适应宽度的，所以需要我们自己计算表格的宽度。</li>\n<li>难点三，表格同一列内的数据长度不同，需要对字符串长度不够的表格进行空白文本填充，以保证表格边框的整齐。</li>\n</ul>\n<h2 id=\"难点解决\"><a href=\"#难点解决\" class=\"headerlink\" title=\"难点解决\"></a>难点解决</h2><h3 id=\"难点一\"><a href=\"#难点一\" class=\"headerlink\" title=\"难点一\"></a>难点一</h3><p>因为输出字符的多样性，不同的字符占位长度不同，有的字符占1个位置，有的字符占2个位置，而这些字符又组成不同的字符串，复杂难度加大。<br>关于这个问题，我们可以通过Unicode编码来进行区分，对于Unicode值在0-127为英文字符，占1个位置，其余字符占2个位置。</p>\n<h3 id=\"难点二\"><a href=\"#难点二\" class=\"headerlink\" title=\"难点二\"></a>难点二</h3><p>控制台并没有集成的UI框架，表格是无法自适应宽度的，所以需要我们自己计算表格的宽度。<br>表格每一列的宽度应该以表格这一列数据中长度最长的数据为标准，这样表格的宽度才能够展示所有内容。<br>所以这个问题可以通过计算每一列的字符串的最大的占位数来作为表格的宽度。</p>\n<h3 id=\"难点三\"><a href=\"#难点三\" class=\"headerlink\" title=\"难点三\"></a>难点三</h3><p>表格同一列内的数据长度不同，需要对字符串长度不够的表格进行空白文本填充，以保证表格边框的整齐。<br>这个问题在于填充空白文本补齐长度不够的字符串，只需要使用表格列最大占位长度-文本占位长度即可计算出需要填充的空白文本。</p>\n<h2 id=\"代码实现\"><a href=\"#代码实现\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h2><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">NODE = <span class=\"string\">&#x27;+&#x27;</span></span><br><span class=\"line\">EDGE = <span class=\"string\">&#x27;-&#x27;</span></span><br><span class=\"line\">HIGH = <span class=\"string\">&#x27;|&#x27;</span></span><br><span class=\"line\">SPACE = <span class=\"string\">&#x27; &#x27;</span></span><br><span class=\"line\">EMPTY = <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 获取字符串的占位长度</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">get_string_width</span>(<span class=\"params\">string</span>):</span><br><span class=\"line\">    width = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> char <span class=\"keyword\">in</span> string:</span><br><span class=\"line\">        width += <span class=\"number\">1</span> <span class=\"keyword\">if</span> <span class=\"built_in\">ord</span>(char) &lt; <span class=\"number\">128</span> <span class=\"keyword\">and</span> <span class=\"built_in\">ord</span>(char) &gt;= <span class=\"number\">0</span> <span class=\"keyword\">else</span> <span class=\"number\">2</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> width</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 打印边框</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">print_edge</span>(<span class=\"params\">widths</span>):</span><br><span class=\"line\">    col_num = <span class=\"built_in\">len</span>(widths)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> col <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(col_num):</span><br><span class=\"line\">        width = widths[col]</span><br><span class=\"line\">        <span class=\"comment\"># 获取宽度</span></span><br><span class=\"line\">        <span class=\"built_in\">print</span>(NODE + EDGE * (width + <span class=\"number\">2</span>), end=NODE + <span class=\"string\">&#x27;\\n&#x27;</span> <span class=\"keyword\">if</span> col == col_num - <span class=\"number\">1</span> <span class=\"keyword\">else</span> EMPTY)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 打印数据</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">pritn_data</span>(<span class=\"params\">widths, data</span>):</span><br><span class=\"line\">    col_num = <span class=\"built_in\">len</span>(widths)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> col <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(col_num):</span><br><span class=\"line\">        width = widths[col]</span><br><span class=\"line\">        col_data = data[col] <span class=\"keyword\">if</span> <span class=\"built_in\">len</span>(data) &gt; col <span class=\"keyword\">else</span> <span class=\"literal\">None</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> <span class=\"built_in\">type</span>(col_data) == <span class=\"built_in\">int</span>:</span><br><span class=\"line\">            content = SPACE * (width - get_string_width(<span class=\"built_in\">str</span>(col_data)) + <span class=\"number\">1</span>) + <span class=\"built_in\">str</span>(col_data) + SPACE</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            content = SPACE + <span class=\"built_in\">str</span>(col_data) + SPACE * (width - get_string_width(<span class=\"built_in\">str</span>(col_data)) + <span class=\"number\">1</span>)</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(HIGH + content, end=HIGH + <span class=\"string\">&#x27;\\n&#x27;</span> <span class=\"keyword\">if</span> col == col_num - <span class=\"number\">1</span> <span class=\"keyword\">else</span> EMPTY)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 获取数据的最大占位长度</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">get_max_widths</span>(<span class=\"params\">data</span>):</span><br><span class=\"line\">    max_widths = [<span class=\"number\">0</span> <span class=\"keyword\">for</span> _ <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(data[<span class=\"number\">0</span>]))] <span class=\"keyword\">if</span> data <span class=\"keyword\">else</span> []</span><br><span class=\"line\">    <span class=\"keyword\">for</span> row_data <span class=\"keyword\">in</span> data:</span><br><span class=\"line\">        <span class=\"keyword\">for</span> col_index <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(row_data)):</span><br><span class=\"line\">            width = get_string_width(<span class=\"built_in\">str</span>(row_data[col_index]))</span><br><span class=\"line\">            max_widths[col_index] = <span class=\"built_in\">max</span>(width, max_widths[col_index])</span><br><span class=\"line\">    <span class=\"keyword\">return</span> max_widths</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 打印表格通用方法</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">print_table</span>(<span class=\"params\">data</span>):</span><br><span class=\"line\">    row_num = <span class=\"built_in\">len</span>(data)</span><br><span class=\"line\">    max_widths = get_max_widths(data)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> row <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(row_num):</span><br><span class=\"line\">        <span class=\"keyword\">if</span> row &lt;= <span class=\"number\">1</span>:</span><br><span class=\"line\">            print_edge(max_widths)</span><br><span class=\"line\">        pritn_data(max_widths, data[row])</span><br><span class=\"line\">        <span class=\"keyword\">if</span> row == row_num - <span class=\"number\">1</span>:</span><br><span class=\"line\">            print_edge(max_widths)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">data = []</span><br><span class=\"line\">data.append([<span class=\"string\">&#x27;序号&#x27;</span>, <span class=\"string\">&#x27;昵称&#x27;</span>, <span class=\"string\">&#x27;性别（1:男0:女）&#x27;</span>, <span class=\"string\">&#x27;手机号码&#x27;</span>, <span class=\"string\">&#x27;地址&#x27;</span>])</span><br><span class=\"line\">data.append([<span class=\"number\">1</span>, <span class=\"string\">&#x27;归零者&#x27;</span>, <span class=\"number\">1</span>, <span class=\"string\">&#x27;17854265423&#x27;</span>, <span class=\"string\">&#x27;xx省xx市xx区xx东路x号&#x27;</span>])</span><br><span class=\"line\">data.append([<span class=\"number\">2</span>, <span class=\"string\">&#x27;歌者&#x27;</span>, <span class=\"number\">1</span>, <span class=\"string\">&#x27;17854521114&#x27;</span>, <span class=\"string\">&#x27;xx省xx市xx区xx路xxx-x号&#x27;</span>])</span><br><span class=\"line\">data.append([<span class=\"number\">3</span>, <span class=\"string\">&#x27;叶文洁&#x27;</span>, <span class=\"number\">0</span>, <span class=\"string\">&#x27;18945411454&#x27;</span>, <span class=\"string\">&#x27;xx省xx市xx区xx东路xx号&#x27;</span>])</span><br><span class=\"line\">data.append([<span class=\"number\">4</span>, <span class=\"string\">&#x27;罗辑&#x27;</span>, <span class=\"number\">1</span>, <span class=\"string\">&#x27;18945414154&#x27;</span>, <span class=\"string\">&#x27;xx省xx市xx区xx路xxx号xx花园x栋x单元xxx室&#x27;</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">print_table(data)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"表格优化\"><a href=\"#表格优化\" class=\"headerlink\" title=\"表格优化\"></a>表格优化</h2><p>除了具体的表格输出打印逻辑之外，这份代码实现里面还有一部分表格展示的优化逻辑，比如在输出的文本内容前后空格，使得文本展示效果更加美观，比如字符串居左，数字居右显示等等，尽最大可能还原了MySql的表格输出逻辑。</p>\n","categories":["其他"],"tags":["Python","MySQL"]},{"title":"再见，2020；你好，2021！","url":"/2021/01/01/other/%E5%86%8D%E8%A7%81%EF%BC%8C2020%EF%BC%9B%E4%BD%A0%E5%A5%BD%EF%BC%8C2021%EF%BC%81/","content":"<blockquote>\n<p>当我敲下<code>再见，2020；你好，2021！</code>这个标题的时候，我其实早已经有了和2020年说一声再见，已崭新的面貌迎接2021的思想觉悟，但是真的到了这个时候，我依然还是感觉内心有些不平静。2020年初的光景仿佛还在眼前，但是回首望去，时光早已经把一切冲刷的支零破碎，留给自己的印象，仿佛就只有此刻眼前的景象。</p>\n</blockquote>\n<span id=\"more\"></span>\n<p><strong>2020年回顾</strong></p>\n<p>2020年是一个很特殊的一年，2020年发生了太多令人沉痛的事情，希望伴随着2020年的逝去，在2020年所发生的一切不好的事情，也随之一同随风而去。</p>\n<p>2020年无疑是我成长巨大的一年，我大学毕业了，开始步入社会，开始了第一份工作。作为一名程序员，我在技术层面的成长也是最让我感到自豪的一面。</p>\n<p>在2020年这一年中，我在CSDN上发布了160+篇博客文章，在github上提交了上百次代码，在github上创建了两个开源项目，注册了自己的专属域名，并在互联网上部署了其中一个开源项目。</p>\n<p>在这里，也把我希望在2021年做到的事情列出来，希望自己在2021年能够不负期望。</p>\n<p><strong>2021年的flag</strong></p>\n<ul>\n<li>博客数量达到300+。</li>\n<li>继续完善开源项目，希望可以获得20+的<code>start</code>。</li>\n<li>复习数据结构和算法知识。</li>\n<li>阅读一个框架的源码（首选自然是<code>Spring</code>）。</li>\n<li>除Java语言外，学习一门语言作为第二语言。</li>\n</ul>\n<p><strong>结束语</strong></p>\n<blockquote>\n<p>希望2021年来回来看这篇博客的时候，我能够不负自己2020年所托，完成自己对未来的期望。<br>祝各位在2021年“牛”转乾坤，牛气冲天！<br>愿诸君：所求皆如愿，所行皆坦途。</p>\n</blockquote>\n","categories":["其他"],"tags":["其他"]},{"title":"Python基本数据类型","url":"/2021/11/21/python/Python%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/","content":"<blockquote>\n<p>Python 有多种基本数据类型，用来存储内存中的数据。Python 一共提供了三种基本数据类型，其中分为是：数值型、字符型、布尔型。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h2 id=\"数值型\"><a href=\"#数值型\" class=\"headerlink\" title=\"数值型\"></a>数值型</h2><blockquote>\n<p>数值型就是用来存储数字的类型，例如一个人的年龄，身高，体重，一家公司的年度营收，员工总数等等。</p>\n</blockquote>\n<p>在 Python 中，提供了数字类型来保存这些数据，并且这些数值类型是不可改变的数据类型。如果需要修改数字类型变量的值，那么会先把该值放入内存中，然后修改变量让其指向新的内存地址。</p>\n<p>例如：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">a = <span class=\"number\">10</span></span><br><span class=\"line\">b = <span class=\"number\">10</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">id</span>(a))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">id</span>(b))</span><br><span class=\"line\">a = <span class=\"number\">12</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">id</span>(a))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">id</span>(b))</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">140718916818880</span></span><br><span class=\"line\"><span class=\"number\">140718916818880</span></span><br><span class=\"line\"><span class=\"number\">140718916818944</span></span><br><span class=\"line\"><span class=\"number\">140718916818880</span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>说明：在 Python 语言中，可以使用内置的函数 <code>id()</code> 来获取变量所指向的内存地址。</p>\n</blockquote>\n<p>a 与 b 虽然是不同的变量，但是他们的值都是相同的，所以它们在内存中的地址也是相同的，而当改变变量 a 的值的时候，并不是直接改变变量 a 的值，而是改变了变量 a 所指向的内存地址。</p>\n<p>在 Python 语言中，数值类型主要包括整数、浮点数和复数。</p>\n<h3 id=\"整数\"><a href=\"#整数\" class=\"headerlink\" title=\"整数\"></a>整数</h3><blockquote>\n<p>整数就是整数数值，是没有小数部分的数值，例如：0、3、10、-1 等等。整数包括正整数、负数和0。Python 中的整数会自动转换高精度计算，所以 Python 中的整数类型的位数是任意的。</p>\n</blockquote>\n<p>例如：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">a = <span class=\"number\">123456</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(a)</span><br><span class=\"line\">b = <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(b)</span><br><span class=\"line\">c = -<span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(c)</span><br><span class=\"line\">d = <span class=\"number\">25465486413516513542315452153423134654134531</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(d)</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">123456</span></span><br><span class=\"line\"><span class=\"number\">0</span></span><br><span class=\"line\">-<span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"number\">25465486413516513542315452153423134654134531</span></span><br></pre></td></tr></table></figure>\n\n\n\n<p>值得一提的是，Python 中的整数类型，如果是十进制整数，除了0之外，其他数值不能以0作为开头。</p>\n<p>例如：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">e = <span class=\"number\">000000000</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(e)</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">0</span></span><br></pre></td></tr></table></figure>\n\n<p>例如：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">f = 000023</span><br><span class=\"line\"><span class=\"built_in\">print</span>(f)</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：报错</p>\n<p>Python 中的整数除了十进制类型外，还有八进制、十六进制、二进制等等，在这里不过多讲解。</p>\n<h3 id=\"浮点数\"><a href=\"#浮点数\" class=\"headerlink\" title=\"浮点数\"></a>浮点数</h3><blockquote>\n<p>浮点数主要由整数部分和小数部分组成，主要用于处理包括小数的数值。例如：3.1415926、-152.01、0.0001 等。</p>\n</blockquote>\n<p>在使用浮点数计算的时候，可能会出现小数位数不确定的情况。</p>\n<p>例如：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">a = <span class=\"number\">0.1</span> + <span class=\"number\">0.1</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(a)</span><br><span class=\"line\">b = <span class=\"number\">0.1</span> + <span class=\"number\">0.2</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(b)</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">0.2</span></span><br><span class=\"line\"><span class=\"number\">0.30000000000000004</span></span><br></pre></td></tr></table></figure>\n\n<p>这是因为浮点数值在内存中保存方法导致的，基本上所有的计算机语言都存在这个问题，我们这里直接忽略多余的小数位即可。</p>\n<h3 id=\"复数\"><a href=\"#复数\" class=\"headerlink\" title=\"复数\"></a>复数</h3><blockquote>\n<p>Python 中的复数与数学中的复数的表现形式完全一致，都是有实数和虚数构成，并且使用 <code>j</code> 或 <code>J</code> 表示虚部。</p>\n</blockquote>\n<p>例如：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">a = <span class=\"number\">6.54</span> + <span class=\"number\">32.01j</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(a)</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">(<span class=\"number\">6.54</span>+<span class=\"number\">32.01j</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"字符串类型\"><a href=\"#字符串类型\" class=\"headerlink\" title=\"字符串类型\"></a>字符串类型</h2><blockquote>\n<p>字符串就是连续的字符组成的，通常使用 单引号<code>&#39;&#39;</code>、双引号<code>&quot;&quot;</code>、三引号<code>&#39;&#39;&#39;&#39;&#39;&#39;</code>或者 <code>&quot;&quot;&quot;&quot;&quot;&quot;</code>包裹起来。</p>\n</blockquote>\n<p>这三种类在 Python 中，字符串和整数一样，也属于不可变序列。</p>\n<p>例如：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">a = <span class=\"string\">&quot;字符串类型&quot;</span></span><br><span class=\"line\">b = <span class=\"string\">&quot;字符串类型&quot;</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">id</span>(a))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">id</span>(b))</span><br><span class=\"line\">a = <span class=\"string\">&quot;字符串类型2&quot;</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">id</span>(a))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">id</span>(b))</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">1357027606320</span></span><br><span class=\"line\"><span class=\"number\">1357027606320</span></span><br><span class=\"line\"><span class=\"number\">1357027224800</span></span><br><span class=\"line\"><span class=\"number\">1357027606320</span></span><br></pre></td></tr></table></figure>\n\n\n\n<p>在 Python 中，单引号和双引号的字符串都只能在同一行，而三引号的字符串可以多行书写。</p>\n<p>例如：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">a = <span class=\"string\">&#x27;单引号字符串&#x27;</span></span><br><span class=\"line\">b = <span class=\"string\">&quot;双引号字符串&quot;</span></span><br><span class=\"line\">c = <span class=\"string\">&#x27;&#x27;&#x27;三引号字符串</span></span><br><span class=\"line\"><span class=\"string\">    可以多行展示</span></span><br><span class=\"line\"><span class=\"string\">    |————————|</span></span><br><span class=\"line\"><span class=\"string\">    |        |</span></span><br><span class=\"line\"><span class=\"string\">    |--------|</span></span><br><span class=\"line\"><span class=\"string\">    结束&#x27;&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(a)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(b)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(c)</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">单引号字符串</span><br><span class=\"line\">双引号字符串</span><br><span class=\"line\">三引号字符串</span><br><span class=\"line\">    可以多行展示</span><br><span class=\"line\">    |————————|</span><br><span class=\"line\">    |        |</span><br><span class=\"line\">    |--------|</span><br><span class=\"line\">    结束</span><br></pre></td></tr></table></figure>\n\n\n\n<p>在 Python 中，存在转义字符，所谓转义字符，是指使用反斜杠 <code>\\</code> 对一些特殊字符进行转义。</p>\n<p>例如：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># \\n 换行符</span></span><br><span class=\"line\">a = <span class=\"string\">&quot;Python\\n字符串a&quot;</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(a)</span><br><span class=\"line\"><span class=\"comment\"># \\0 空</span></span><br><span class=\"line\">b = <span class=\"string\">&quot;Python\\0字符串b&quot;</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(b)</span><br><span class=\"line\"><span class=\"comment\"># \\t 水平制表符</span></span><br><span class=\"line\">c = <span class=\"string\">&quot;Python\\t字符串c&quot;</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(c)</span><br><span class=\"line\"><span class=\"comment\"># \\&quot; 双引号</span></span><br><span class=\"line\">d = <span class=\"string\">&quot;Python\\&quot;字符串d&quot;</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(d)</span><br><span class=\"line\"><span class=\"comment\"># \\&#x27; 单引号</span></span><br><span class=\"line\">e = <span class=\"string\">&#x27;Python\\&#x27;字符串e&#x27;</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(e)</span><br><span class=\"line\"><span class=\"comment\"># \\\\ 反斜杠</span></span><br><span class=\"line\">f = <span class=\"string\">&quot;Python\\\\字符串f&quot;</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(f)</span><br><span class=\"line\"><span class=\"comment\"># \\f 换页</span></span><br><span class=\"line\">j = <span class=\"string\">&quot;Python\\f字符串j&quot;</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(j)</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">Python</span><br><span class=\"line\">字符串a</span><br><span class=\"line\">Python 字符串b</span><br><span class=\"line\">Python\t字符串c</span><br><span class=\"line\">Python<span class=\"string\">&quot;字符串d</span></span><br><span class=\"line\"><span class=\"string\">Python&#x27;字符串e</span></span><br><span class=\"line\"><span class=\"string\">Python\\字符串f</span></span><br><span class=\"line\"><span class=\"string\">Python\f字符串j</span></span><br></pre></td></tr></table></figure>\n\n\n\n<p>除了这些转义字符外，还有其他一些不常用的转义字符，在这里不过多讲述。</p>\n<p>值得一提的是，在 Python 中，在字符串定界符引前加上字母<code>r</code>（或者R），即可原样输出字符串。</p>\n<p>例如：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">a = <span class=\"string\">r&quot;Python\\n字符串a&quot;</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(a)</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">Python\\n字符串a</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h2 id=\"布尔类型\"><a href=\"#布尔类型\" class=\"headerlink\" title=\"布尔类型\"></a>布尔类型</h2><blockquote>\n<p>布尔类型主要表示为真值或者假值，在 Python 中，<code>Treu</code> 和 <code>False</code> 都解释为布尔类型。</p>\n</blockquote>\n<p>Python 中的布尔类型可以解释为数值类型进行计算，<code>True</code> 解释为 1，<code>False</code> 解释为 0。</p>\n<p>例如：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">a = <span class=\"literal\">True</span> +  <span class=\"number\">1</span></span><br><span class=\"line\">b = <span class=\"literal\">False</span> + <span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(a)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(b)</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">2</span></span><br><span class=\"line\"><span class=\"number\">1</span></span><br></pre></td></tr></table></figure>\n\n\n\n<p>在 Python 中，所有的对象都可以真值测试，其中，以下几种情况可以被判定为 <code>False</code>，其他情况则为 <code>True</code>。</p>\n<ul>\n<li><code>False</code> 或 <code>None</code>。</li>\n<li>数值中的0，包括0、0.0、虚数0。</li>\n<li>空序列，包括空字符串、空元组、空列表、空字典。</li>\n<li>自定义的对象，该对象的<code>__bool__</code>  方法返回 <code>False</code>，或者 <code>__len__</code> 方法返回0。</li>\n</ul>\n<h2 id=\"类型转换\"><a href=\"#类型转换\" class=\"headerlink\" title=\"类型转换\"></a>类型转换</h2><p>在 Python 中，可以使用 Python 的内置函数，将一些类型的数据转换为另外一种类型。</p>\n<p>例如：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">a = <span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">type</span>(a))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">type</span>(<span class=\"built_in\">str</span>(a)))</span><br><span class=\"line\"></span><br><span class=\"line\">b = <span class=\"string\">&quot;100&quot;</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">type</span>(b))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">type</span>(<span class=\"built_in\">int</span>(b)))</span><br></pre></td></tr></table></figure>\n\n\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">&lt;<span class=\"keyword\">class</span> <span class=\"string\">&#x27;int&#x27;</span>&gt;</span><br><span class=\"line\">&lt;<span class=\"keyword\">class</span> <span class=\"string\">&#x27;str&#x27;</span>&gt;</span><br><span class=\"line\">&lt;<span class=\"keyword\">class</span> <span class=\"string\">&#x27;str&#x27;</span>&gt;</span><br><span class=\"line\">&lt;<span class=\"keyword\">class</span> <span class=\"string\">&#x27;int&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>常用的类型转换函数有：</p>\n<table>\n<thead>\n<tr>\n<th>函数</th>\n<th>作用</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>int(x)</td>\n<td>将x转换为整数类型</td>\n</tr>\n<tr>\n<td>float(x)</td>\n<td>将x转换为浮点数类型</td>\n</tr>\n<tr>\n<td>complex(real [,imag])</td>\n<td>创建一个复数</td>\n</tr>\n<tr>\n<td>str(x)</td>\n<td>将x转换为字符串类型</td>\n</tr>\n<tr>\n<td>repr(x)</td>\n<td>将x转换为表达式字符串</td>\n</tr>\n<tr>\n<td>eval(x)</td>\n<td>计算在字符串中的有效 Python 表达式，并返回一个对象</td>\n</tr>\n<tr>\n<td>chr(x)</td>\n<td>将整数x转换为一个字符</td>\n</tr>\n</tbody></table>\n","categories":["Python"],"tags":["Python"]},{"title":"Python序列","url":"/2021/11/29/python/Python%E5%BA%8F%E5%88%97/","content":"<blockquote>\n<p>序列是一块用于存放多个值的连续的内存空间，并按照一定的顺序排列，每一个值（称为元素）都分配一个数字（称为索引或者位置）。通过索引可以取出对应位置的值。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h1 id=\"序列的通用操作\"><a href=\"#序列的通用操作\" class=\"headerlink\" title=\"序列的通用操作\"></a>序列的通用操作</h1><p>在 Python 中，序列的主要结构有列表、元组、集合、字典和字符串。对于这些序列有一些通用操作，例如索引，切片，相加，相乘，序列长度，是否包含某个元素，序列最大值，序列最小值等等，其中集合和字典不支持索引、切片、相加、相乘操作。</p>\n<h2 id=\"索引\"><a href=\"#索引\" class=\"headerlink\" title=\"索引\"></a>索引</h2><p> 序列中的每一个元素都有一个编号，也称之为索引。序列从左往右开始数，第一个元素的索引是0，第二个元素的索引是1，以此类推。</p>\n<p>值得一提的是，Python 的索引可以是负数，从右往左数，第一个元素的索引是-1，第二个元素的索引是-2，以此类推。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">arr = [<span class=\"string\">&quot;第一个元素&quot;</span>, <span class=\"string\">&quot;第二个元素&quot;</span>, <span class=\"string\">&quot;第三个元素&quot;</span>, <span class=\"string\">&quot;第四个元素&quot;</span>]</span><br><span class=\"line\"><span class=\"built_in\">print</span>(arr[<span class=\"number\">0</span>])</span><br><span class=\"line\"><span class=\"built_in\">print</span>(arr[<span class=\"number\">1</span>])</span><br><span class=\"line\"><span class=\"built_in\">print</span>(arr[-<span class=\"number\">1</span>])</span><br><span class=\"line\"><span class=\"built_in\">print</span>(arr[-<span class=\"number\">2</span>])</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">第一个元素</span><br><span class=\"line\">第二个元素</span><br><span class=\"line\">第四个元素</span><br><span class=\"line\">第三个元素</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"切片\"><a href=\"#切片\" class=\"headerlink\" title=\"切片\"></a>切片</h2><p>切片操作是访问序列中元素的一种方法，可以用于访问序列中指定范围的元素，通过切片操作生成一个新的序列。</p>\n<p>切片操作的语法为：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">name[start : end : step]</span><br></pre></td></tr></table></figure>\n\n\n\n<ul>\n<li>name 为序列名称</li>\n<li>start 为切片开始的索引，如果不指定，默认为0</li>\n<li>end 为切片结束的索引 + 1，如果不指定，默认为序列的长度</li>\n<li>step 为切片的步长，如果不指定，默认为1</li>\n</ul>\n<figure class=\"highlight stylus\"><table><tr><td class=\"code\"><pre><span class=\"line\">arr = <span class=\"selector-attr\">[<span class=\"string\">&quot;第一个元素&quot;</span>, <span class=\"string\">&quot;第二个元素&quot;</span>, <span class=\"string\">&quot;第三个元素&quot;</span>, <span class=\"string\">&quot;第四个元素&quot;</span>]</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">print</span><span class=\"params\">(arr[<span class=\"number\">1</span>:<span class=\"number\">4</span>])</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">print</span><span class=\"params\">(arr[<span class=\"number\">0</span>:<span class=\"number\">2</span>])</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">print</span><span class=\"params\">(arr[<span class=\"number\">1</span>:<span class=\"number\">4</span>:<span class=\"number\">2</span>])</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">print</span><span class=\"params\">(arr[:])</span></span></span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">[<span class=\"string\">&#x27;第二个元素&#x27;</span>, <span class=\"string\">&#x27;第三个元素&#x27;</span>, <span class=\"string\">&#x27;第四个元素&#x27;</span>]</span><br><span class=\"line\">[<span class=\"string\">&#x27;第一个元素&#x27;</span>, <span class=\"string\">&#x27;第二个元素&#x27;</span>]</span><br><span class=\"line\">[<span class=\"string\">&#x27;第二个元素&#x27;</span>, <span class=\"string\">&#x27;第四个元素&#x27;</span>]</span><br><span class=\"line\">[<span class=\"string\">&#x27;第一个元素&#x27;</span>, <span class=\"string\">&#x27;第二个元素&#x27;</span>, <span class=\"string\">&#x27;第三个元素&#x27;</span>, <span class=\"string\">&#x27;第四个元素&#x27;</span>]</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h2 id=\"序列相加\"><a href=\"#序列相加\" class=\"headerlink\" title=\"序列相加\"></a>序列相加</h2><p>在 Python 中，同类型的序列支持相加操作，相加之后的序列元素是原来两个序列的元素组合在一起，重复的元素不会去重，可以直接使用 + 运算符实现。</p>\n<p>Python相加只支持同类型的序列，比如列表+列表，不支持列表+元组的操作。</p>\n<figure class=\"highlight stylus\"><table><tr><td class=\"code\"><pre><span class=\"line\">arr1 = <span class=\"selector-attr\">[<span class=\"string\">&quot;第一个元素&quot;</span>, <span class=\"string\">&quot;第二个元素&quot;</span>]</span></span><br><span class=\"line\">arr2 = <span class=\"selector-attr\">[<span class=\"string\">&quot;第三个元素&quot;</span>, <span class=\"string\">&quot;第四个元素&quot;</span>]</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">print</span><span class=\"params\">(arr1 + arr2)</span></span></span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">[<span class=\"string\">&#x27;第一个元素&#x27;</span>, <span class=\"string\">&#x27;第二个元素&#x27;</span>, <span class=\"string\">&#x27;第三个元素&#x27;</span>, <span class=\"string\">&#x27;第四个元素&#x27;</span>]</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h2 id=\"序列相乘\"><a href=\"#序列相乘\" class=\"headerlink\" title=\"序列相乘\"></a>序列相乘</h2><p>序列相乘的操作和序列相加的操作结果类似，相乘是将原来的序列元素乘以倍数，相当于倍数个序列相加。</p>\n<figure class=\"highlight stylus\"><table><tr><td class=\"code\"><pre><span class=\"line\">arr = <span class=\"selector-attr\">[<span class=\"string\">&quot;第一个元素&quot;</span>, <span class=\"string\">&quot;第二个元素&quot;</span>]</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">print</span><span class=\"params\">(arr * <span class=\"number\">3</span>)</span></span></span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">[<span class=\"string\">&#x27;第一个元素&#x27;</span>, <span class=\"string\">&#x27;第二个元素&#x27;</span>, <span class=\"string\">&#x27;第一个元素&#x27;</span>, <span class=\"string\">&#x27;第二个元素&#x27;</span>, <span class=\"string\">&#x27;第一个元素&#x27;</span>, <span class=\"string\">&#x27;第二个元素&#x27;</span>]</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"序列长度\"><a href=\"#序列长度\" class=\"headerlink\" title=\"序列长度\"></a>序列长度</h2><p>Python 提供了内置的函数计算序列的长度。</p>\n<figure class=\"highlight stylus\"><table><tr><td class=\"code\"><pre><span class=\"line\">arr = <span class=\"selector-attr\">[<span class=\"string\">&quot;第一个元素&quot;</span>, <span class=\"string\">&quot;第二个元素&quot;</span>, <span class=\"string\">&quot;第三个元素&quot;</span>, <span class=\"string\">&quot;第四个元素&quot;</span>]</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">print</span><span class=\"params\">(<span class=\"string\">&quot;序列长度：&quot;</span>, len(arr)</span></span>)</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">序列长度： <span class=\"number\">4</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"是否包含某个元素\"><a href=\"#是否包含某个元素\" class=\"headerlink\" title=\"是否包含某个元素\"></a>是否包含某个元素</h2><p>在 Python 中，可以使用 in 关键字，判断某个元素是否是序列的成员。</p>\n<figure class=\"highlight stylus\"><table><tr><td class=\"code\"><pre><span class=\"line\">arr = <span class=\"selector-attr\">[<span class=\"string\">&quot;第一个元素&quot;</span>, <span class=\"string\">&quot;第二个元素&quot;</span>, <span class=\"string\">&quot;第三个元素&quot;</span>, <span class=\"string\">&quot;第四个元素&quot;</span>]</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">print</span><span class=\"params\">(<span class=\"string\">&quot;第二个元素&quot;</span> in arr)</span></span></span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"literal\">True</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"序列最大最小值\"><a href=\"#序列最大最小值\" class=\"headerlink\" title=\"序列最大最小值\"></a>序列最大最小值</h2><p>Python 同样提供了内置函数来计算序列中的最大元素和最小元素。</p>\n<figure class=\"highlight stylus\"><table><tr><td class=\"code\"><pre><span class=\"line\">arr = <span class=\"selector-attr\">[23, 234, 324, 1, 34, 23, 6, 34]</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">print</span><span class=\"params\">(min(arr)</span></span>)</span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">print</span><span class=\"params\">(max(arr)</span></span>)</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"number\">324</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"内置函数\"><a href=\"#内置函数\" class=\"headerlink\" title=\"内置函数\"></a>内置函数</h2><p>Python 提供了大量的内置函数，用于操作序列。</p>\n<table>\n<thead>\n<tr>\n<th>内置函数</th>\n<th>作用</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>list()</td>\n<td>将序列转换为列表</td>\n</tr>\n<tr>\n<td>str()</td>\n<td>将序列转换为字符串</td>\n</tr>\n<tr>\n<td>sum()</td>\n<td>计算元素和（元素为数字类型）</td>\n</tr>\n<tr>\n<td>sorted()</td>\n<td>对元素进行排序</td>\n</tr>\n<tr>\n<td>reversed()</td>\n<td>反向序列中的元素</td>\n</tr>\n<tr>\n<td>enumerate()</td>\n<td>将序列组合为一个索引序列，多用在for循环中</td>\n</tr>\n</tbody></table>\n<h1 id=\"列表\"><a href=\"#列表\" class=\"headerlink\" title=\"列表\"></a>列表</h1><ul>\n<li>可变序列。</li>\n<li>所有元素放在一对中括号 <code>[]</code> 中，每个元素之间使用英文逗号 <code>,</code> 分割开来。</li>\n<li>元素可以是任意类型。</li>\n<li>同一列表的元素类型可以不同。</li>\n<li>元素可重复。</li>\n</ul>\n<h2 id=\"创建空列表\"><a href=\"#创建空列表\" class=\"headerlink\" title=\"创建空列表\"></a>创建空列表</h2><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">emptylist = []</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"创建列表\"><a href=\"#创建列表\" class=\"headerlink\" title=\"创建列表\"></a>创建列表</h2><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">list</span> = [<span class=\"string\">&quot;第一个元素&quot;</span>, <span class=\"string\">&quot;第二个元素&quot;</span>, <span class=\"string\">&quot;第三个元素&quot;</span>, <span class=\"string\">&quot;第四个元素&quot;</span>]</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"list-函数\"><a href=\"#list-函数\" class=\"headerlink\" title=\"list() 函数\"></a>list() 函数</h2><figure class=\"highlight stylus\"><table><tr><td class=\"code\"><pre><span class=\"line\">arr = <span class=\"built_in\">list</span>(<span class=\"built_in\">range</span>(<span class=\"number\">10</span>, <span class=\"number\">20</span>, <span class=\"number\">2</span>))</span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">print</span><span class=\"params\">(arr)</span></span></span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">[<span class=\"number\">10</span>, <span class=\"number\">12</span>, <span class=\"number\">14</span>, <span class=\"number\">16</span>, <span class=\"number\">18</span>]</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"删除列表\"><a href=\"#删除列表\" class=\"headerlink\" title=\"删除列表\"></a>删除列表</h2><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">list</span> = [<span class=\"string\">&quot;第一个元素&quot;</span>, <span class=\"string\">&quot;第二个元素&quot;</span>, <span class=\"string\">&quot;第三个元素&quot;</span>, <span class=\"string\">&quot;第四个元素&quot;</span>]</span><br><span class=\"line\"><span class=\"keyword\">del</span> <span class=\"built_in\">list</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"遍历列表\"><a href=\"#遍历列表\" class=\"headerlink\" title=\"遍历列表\"></a>遍历列表</h2><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">list</span> = [<span class=\"string\">&quot;第一个元素&quot;</span>, <span class=\"string\">&quot;第二个元素&quot;</span>, <span class=\"string\">&quot;第三个元素&quot;</span>, <span class=\"string\">&quot;第四个元素&quot;</span>]</span><br><span class=\"line\"><span class=\"keyword\">for</span> item <span class=\"keyword\">in</span> <span class=\"built_in\">list</span>:</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(item)</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\"># 内置函数 enumerate()</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> index, item <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(<span class=\"built_in\">list</span>):</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(index, item)</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"访问元素\"><a href=\"#访问元素\" class=\"headerlink\" title=\"访问元素\"></a>访问元素</h2><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">list</span> = [<span class=\"string\">&quot;第一个元素&quot;</span>, <span class=\"string\">&quot;第二个元素&quot;</span>, <span class=\"string\">&quot;第三个元素&quot;</span>, <span class=\"string\">&quot;第四个元素&quot;</span>]</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">list</span>[<span class=\"number\">1</span>])</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"添加元素\"><a href=\"#添加元素\" class=\"headerlink\" title=\"添加元素\"></a>添加元素</h2><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">list</span> = [<span class=\"string\">&quot;第一个元素&quot;</span>, <span class=\"string\">&quot;第二个元素&quot;</span>, <span class=\"string\">&quot;第三个元素&quot;</span>, <span class=\"string\">&quot;第四个元素&quot;</span>]</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">list</span>)</span><br><span class=\"line\"><span class=\"built_in\">list</span>.append(<span class=\"string\">&quot;第五元素&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">list</span>)</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">[<span class=\"string\">&#x27;第一个元素&#x27;</span>, <span class=\"string\">&#x27;第二个元素&#x27;</span>, <span class=\"string\">&#x27;第三个元素&#x27;</span>, <span class=\"string\">&#x27;第四个元素&#x27;</span>]</span><br><span class=\"line\">[<span class=\"string\">&#x27;第一个元素&#x27;</span>, <span class=\"string\">&#x27;第二个元素&#x27;</span>, <span class=\"string\">&#x27;第三个元素&#x27;</span>, <span class=\"string\">&#x27;第四个元素&#x27;</span>, <span class=\"string\">&#x27;第五元素&#x27;</span>]</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"修改元素\"><a href=\"#修改元素\" class=\"headerlink\" title=\"修改元素\"></a>修改元素</h2><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">list</span> = [<span class=\"string\">&quot;第一个元素&quot;</span>, <span class=\"string\">&quot;第二个元素&quot;</span>, <span class=\"string\">&quot;第三个元素&quot;</span>, <span class=\"string\">&quot;第四个元素&quot;</span>]</span><br><span class=\"line\"><span class=\"built_in\">list</span>[<span class=\"number\">0</span>] = <span class=\"string\">&quot;修改后的第一个元素&quot;</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">list</span>)</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">[<span class=\"string\">&#x27;修改后的第一个元素&#x27;</span>, <span class=\"string\">&#x27;第二个元素&#x27;</span>, <span class=\"string\">&#x27;第三个元素&#x27;</span>, <span class=\"string\">&#x27;第四个元素&#x27;</span>]</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"删除元素\"><a href=\"#删除元素\" class=\"headerlink\" title=\"删除元素\"></a>删除元素</h2><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">list</span> = [<span class=\"string\">&quot;第一个元素&quot;</span>, <span class=\"string\">&quot;第二个元素&quot;</span>, <span class=\"string\">&quot;第三个元素&quot;</span>, <span class=\"string\">&quot;第四个元素&quot;</span>]</span><br><span class=\"line\"><span class=\"keyword\">del</span> <span class=\"built_in\">list</span>[<span class=\"number\">1</span>]</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">list</span>)</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">[<span class=\"string\">&#x27;第一个元素&#x27;</span>, <span class=\"string\">&#x27;第三个元素&#x27;</span>, <span class=\"string\">&#x27;第四个元素&#x27;</span>]</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"列表计算\"><a href=\"#列表计算\" class=\"headerlink\" title=\"列表计算\"></a>列表计算</h2><p>使用列表对象的 <code>count()</code> 方法，可以统计列表中包含的某个元素出现的次数，<code>index()</code> 方法，可以获取该对象在列表中首次出现的索引位置。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">list</span> = [<span class=\"string\">&quot;第一个元素&quot;</span>, <span class=\"string\">&quot;第二个元素&quot;</span>, <span class=\"string\">&quot;第三个元素&quot;</span>, <span class=\"string\">&quot;第四个元素&quot;</span>, <span class=\"string\">&quot;第二个元素&quot;</span>]</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">list</span>.count(<span class=\"string\">&quot;第二个元素&quot;</span>))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">list</span>.index(<span class=\"string\">&quot;第二个元素&quot;</span>))</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">2</span></span><br><span class=\"line\"><span class=\"number\">1</span></span><br></pre></td></tr></table></figure>\n\n\n\n<p>Python 的内置函数 <code>sum()</code> 可以对列表的元素进行统计。（列表的元素必须是数字类型）</p>\n<figure class=\"highlight stylus\"><table><tr><td class=\"code\"><pre><span class=\"line\">list = <span class=\"selector-attr\">[1, 3, 34, 451, 3]</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">print</span><span class=\"params\">(sum(list)</span></span>)</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">492</span></span><br></pre></td></tr></table></figure>\n\n\n\n<p>可以使用列表对象的方法 <code>sort()</code> 或者 Python 的内置函数对列表进行排序。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">list</span> = [<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">34</span>, <span class=\"number\">451</span>, <span class=\"number\">3</span>]</span><br><span class=\"line\"><span class=\"built_in\">list</span>.sort()</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">list</span>)</span><br><span class=\"line\"><span class=\"built_in\">list</span>.sort(reverse=<span class=\"literal\">True</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">list</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">sorted</span>(<span class=\"built_in\">list</span>))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">sorted</span>(<span class=\"built_in\">list</span>, reverse=<span class=\"literal\">True</span>))</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">[<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">3</span>, <span class=\"number\">34</span>, <span class=\"number\">451</span>]</span><br><span class=\"line\">[<span class=\"number\">451</span>, <span class=\"number\">34</span>, <span class=\"number\">3</span>, <span class=\"number\">3</span>, <span class=\"number\">1</span>]</span><br><span class=\"line\">[<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">3</span>, <span class=\"number\">34</span>, <span class=\"number\">451</span>]</span><br><span class=\"line\">[<span class=\"number\">451</span>, <span class=\"number\">34</span>, <span class=\"number\">3</span>, <span class=\"number\">3</span>, <span class=\"number\">1</span>]</span><br></pre></td></tr></table></figure>\n\n\n\n<p>值得一提的是，列表对象的 <code>sort()</code> 方法，是在原列表的基础上对列表元素进行排序，而内置函数 <code>sorted()</code>是建立了一个副本，对该副本的元素进行排序。</p>\n<h2 id=\"列表推导式\"><a href=\"#列表推导式\" class=\"headerlink\" title=\"列表推导式\"></a>列表推导式</h2><p>使用列表推导式，可以快速生成一个列表。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> random</span><br><span class=\"line\"></span><br><span class=\"line\">list1 = [random.randint(<span class=\"number\">10</span>, <span class=\"number\">100</span>) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">10</span>)]</span><br><span class=\"line\"><span class=\"built_in\">print</span>(list1)</span><br><span class=\"line\"></span><br><span class=\"line\">list2 = [x * <span class=\"number\">2</span> <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> list1]</span><br><span class=\"line\"><span class=\"built_in\">print</span>(list2)</span><br><span class=\"line\"></span><br><span class=\"line\">list3 = [x <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> list1 <span class=\"keyword\">if</span> x &gt; <span class=\"number\">50</span>]</span><br><span class=\"line\"><span class=\"built_in\">print</span>(list3)</span><br></pre></td></tr></table></figure>\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">[<span class=\"number\">25</span>, <span class=\"number\">98</span>, <span class=\"number\">73</span>, <span class=\"number\">70</span>, <span class=\"number\">95</span>, <span class=\"number\">30</span>, <span class=\"number\">62</span>, <span class=\"number\">15</span>, <span class=\"number\">23</span>, <span class=\"number\">69</span>]</span><br><span class=\"line\">[<span class=\"number\">50</span>, <span class=\"number\">196</span>, <span class=\"number\">146</span>, <span class=\"number\">140</span>, <span class=\"number\">190</span>, <span class=\"number\">60</span>, <span class=\"number\">124</span>, <span class=\"number\">30</span>, <span class=\"number\">46</span>, <span class=\"number\">138</span>]</span><br><span class=\"line\">[<span class=\"number\">98</span>, <span class=\"number\">73</span>, <span class=\"number\">70</span>, <span class=\"number\">95</span>, <span class=\"number\">62</span>, <span class=\"number\">69</span>]</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h1 id=\"元组\"><a href=\"#元组\" class=\"headerlink\" title=\"元组\"></a>元组</h1><ul>\n<li>元组与列表唯一的不同是，元组是不可变序列，不能单独对元组的某一个元素进行修改。</li>\n</ul>\n<h2 id=\"创建空元组\"><a href=\"#创建空元组\" class=\"headerlink\" title=\"创建空元组\"></a>创建空元组</h2><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">emptytuple = ()</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建元组\"><a href=\"#创建元组\" class=\"headerlink\" title=\"创建元组\"></a>创建元组</h2><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">tuplearr = (<span class=\"string\">&quot;第一个元素&quot;</span>, <span class=\"string\">&quot;第二个元素&quot;</span>, <span class=\"string\">&quot;第三个元素&quot;</span>, <span class=\"string\">&quot;第四个元素&quot;</span>)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"tuple-函数\"><a href=\"#tuple-函数\" class=\"headerlink\" title=\"tuple() 函数\"></a>tuple() 函数</h2><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">tuple</span>(<span class=\"built_in\">range</span>(<span class=\"number\">5</span>, <span class=\"number\">20</span>)))</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"删除元组\"><a href=\"#删除元组\" class=\"headerlink\" title=\"删除元组\"></a>删除元组</h2><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">tuplearr = (<span class=\"string\">&quot;第一个元素&quot;</span>, <span class=\"string\">&quot;第二个元素&quot;</span>, <span class=\"string\">&quot;第三个元素&quot;</span>, <span class=\"string\">&quot;第四个元素&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">del</span> tuplearr</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"遍历元组\"><a href=\"#遍历元组\" class=\"headerlink\" title=\"遍历元组\"></a>遍历元组</h2><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">tuplearr = (<span class=\"string\">&quot;第一个元素&quot;</span>, <span class=\"string\">&quot;第二个元素&quot;</span>, <span class=\"string\">&quot;第三个元素&quot;</span>, <span class=\"string\">&quot;第四个元素&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">for</span> item <span class=\"keyword\">in</span> tuplearr:</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(item)</span><br><span class=\"line\"><span class=\"keyword\">for</span> index, item <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(tuplearr):</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(index, item)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"访问元素-1\"><a href=\"#访问元素-1\" class=\"headerlink\" title=\"访问元素\"></a>访问元素</h2><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">tuplearr = (<span class=\"string\">&quot;第一个元素&quot;</span>, <span class=\"string\">&quot;第二个元素&quot;</span>, <span class=\"string\">&quot;第三个元素&quot;</span>, <span class=\"string\">&quot;第四个元素&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(tuplearr[<span class=\"number\">2</span>])</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">第三个元素</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"修改元素-1\"><a href=\"#修改元素-1\" class=\"headerlink\" title=\"修改元素\"></a>修改元素</h2><blockquote>\n<p>元组和列表最大的不同，就在于元组是不可变序列，元组内的元组不可以被修改。</p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">tuplearr = (<span class=\"string\">&quot;第一个元素&quot;</span>, <span class=\"string\">&quot;第二个元素&quot;</span>, <span class=\"string\">&quot;第三个元素&quot;</span>, <span class=\"string\">&quot;第四个元素&quot;</span>)</span><br><span class=\"line\">tuplearr[<span class=\"number\">1</span>] = <span class=\"string\">&quot;第五个元素&quot;</span></span><br></pre></td></tr></table></figure>\n\n<p>运行结果：报错</p>\n<blockquote>\n<p>如果想要修改元组的元素，必须将整个元组全部重新赋值。</p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">tuplearr = (<span class=\"string\">&quot;第一个元素&quot;</span>, <span class=\"string\">&quot;第二个元素&quot;</span>, <span class=\"string\">&quot;第三个元素&quot;</span>, <span class=\"string\">&quot;第四个元素&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(tuplearr)</span><br><span class=\"line\">tuplearr = (<span class=\"string\">&quot;第一个元素&quot;</span>, <span class=\"string\">&quot;第五个元素&quot;</span>, <span class=\"string\">&quot;第三个元素&quot;</span>, <span class=\"string\">&quot;第四个元素&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(tuplearr)</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">(<span class=\"string\">&#x27;第一个元素&#x27;</span>, <span class=\"string\">&#x27;第二个元素&#x27;</span>, <span class=\"string\">&#x27;第三个元素&#x27;</span>, <span class=\"string\">&#x27;第四个元素&#x27;</span>)</span><br><span class=\"line\">(<span class=\"string\">&#x27;第一个元素&#x27;</span>, <span class=\"string\">&#x27;第五个元素&#x27;</span>, <span class=\"string\">&#x27;第三个元素&#x27;</span>, <span class=\"string\">&#x27;第四个元素&#x27;</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h2 id=\"元组推导式\"><a href=\"#元组推导式\" class=\"headerlink\" title=\"元组推导式\"></a>元组推导式</h2><blockquote>\n<p>元组推导式和列表推导式不同的地方在于，列表推导式生成的是一个列表对象，而元组推导式生成的是一个生成器对象，我们需要使用 <code>tuple()</code> 函数将其转换为元组。</p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">randomtuple1 = (random.randint(<span class=\"number\">10</span>, <span class=\"number\">20</span>) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">5</span>))</span><br><span class=\"line\">randomtuple1 = <span class=\"built_in\">tuple</span>(randomtuple1)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(randomtuple1)</span><br><span class=\"line\"></span><br><span class=\"line\">randomtuple2 = (x * <span class=\"number\">2</span> <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> randomtuple1)</span><br><span class=\"line\">randomtuple2 = <span class=\"built_in\">tuple</span>(randomtuple2)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(randomtuple2)</span><br><span class=\"line\"></span><br><span class=\"line\">randomtuple3 = (x <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> randomtuple1 <span class=\"keyword\">if</span> x &gt; <span class=\"number\">15</span>)</span><br><span class=\"line\">randomtuple3 = <span class=\"built_in\">tuple</span>(randomtuple3)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(randomtuple3)</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">(<span class=\"number\">18</span>, <span class=\"number\">10</span>, <span class=\"number\">13</span>, <span class=\"number\">17</span>, <span class=\"number\">16</span>)</span><br><span class=\"line\">(<span class=\"number\">36</span>, <span class=\"number\">20</span>, <span class=\"number\">26</span>, <span class=\"number\">34</span>, <span class=\"number\">32</span>)</span><br><span class=\"line\">(<span class=\"number\">18</span>, <span class=\"number\">17</span>, <span class=\"number\">16</span>)</span><br></pre></td></tr></table></figure>\n\n\n\n<h1 id=\"列表与元组的区别\"><a href=\"#列表与元组的区别\" class=\"headerlink\" title=\"列表与元组的区别\"></a>列表与元组的区别</h1><ul>\n<li>列表是可变序列，列表元素可以修改；元组是不可变序列，元组元素不可以修改。</li>\n<li>列表可以使用 <code>append()</code> 、<code>extend()</code> 、<code>insert()</code> 、<code>remove()</code> 、<code>pop()</code> 等方法对列表进行修改，元组没有这些方法修改元素，同时元组也无法删除元素。</li>\n<li>列表支持用切片修改元素，元组不支持切片修改元素。</li>\n<li>元组的访问速度比列表快。</li>\n<li>列表不能作为字典的键，元组可以。</li>\n</ul>\n<h1 id=\"字典\"><a href=\"#字典\" class=\"headerlink\" title=\"字典\"></a>字典</h1><ul>\n<li>字典通过键值获取字典中保存的数据，不通过索引获取。</li>\n<li>字典是无序的。</li>\n<li>字典是可变序列的。</li>\n<li>字典的键值是唯一的，如果有相同键值，后面的会覆盖前面的。</li>\n<li>字典是键必须不可变。</li>\n</ul>\n<h2 id=\"创建空字典\"><a href=\"#创建空字典\" class=\"headerlink\" title=\"创建空字典\"></a>创建空字典</h2><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">dictionary = &#123;&#125;</span><br><span class=\"line\">dictionary = <span class=\"built_in\">dict</span>()</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"创建字典\"><a href=\"#创建字典\" class=\"headerlink\" title=\"创建字典\"></a>创建字典</h2><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">dictionary = &#123;<span class=\"string\">&quot;name&quot;</span>: <span class=\"string\">&quot;肖总&quot;</span>, <span class=\"string\">&quot;age&quot;</span>: <span class=\"number\">18</span>&#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(dictionary)</span><br><span class=\"line\"></span><br><span class=\"line\">keylist = [<span class=\"string\">&quot;key1&quot;</span>, <span class=\"string\">&quot;key2&quot;</span>, <span class=\"string\">&quot;key3&quot;</span>]</span><br><span class=\"line\">valuelist = [<span class=\"string\">&quot;value1&quot;</span>, <span class=\"string\">&quot;value2&quot;</span>, <span class=\"string\">&quot;value3&quot;</span>, <span class=\"string\">&quot;value4&quot;</span>]</span><br><span class=\"line\">dictionary = <span class=\"built_in\">dict</span>(<span class=\"built_in\">zip</span>(keylist, valuelist))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(dictionary)</span><br><span class=\"line\"></span><br><span class=\"line\">dictionary = <span class=\"built_in\">dict</span>(key1=<span class=\"string\">&quot;value1&quot;</span>, key2=<span class=\"string\">&quot;value2&quot;</span>, key3=<span class=\"string\">&quot;value3&quot;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(dictionary)</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#123;<span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;肖总&#x27;</span>, <span class=\"string\">&#x27;age&#x27;</span>: <span class=\"number\">18</span>&#125;</span><br><span class=\"line\">&#123;<span class=\"string\">&#x27;key1&#x27;</span>: <span class=\"string\">&#x27;value1&#x27;</span>, <span class=\"string\">&#x27;key2&#x27;</span>: <span class=\"string\">&#x27;value2&#x27;</span>, <span class=\"string\">&#x27;key3&#x27;</span>: <span class=\"string\">&#x27;value3&#x27;</span>&#125;</span><br><span class=\"line\">&#123;<span class=\"string\">&#x27;key1&#x27;</span>: <span class=\"string\">&#x27;value1&#x27;</span>, <span class=\"string\">&#x27;key2&#x27;</span>: <span class=\"string\">&#x27;value2&#x27;</span>, <span class=\"string\">&#x27;key3&#x27;</span>: <span class=\"string\">&#x27;value3&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>使用 <code>zip()</code> 函数创建字典，字典元素个数取两个列表长度较短的那个。</p>\n</blockquote>\n<h2 id=\"删除字典\"><a href=\"#删除字典\" class=\"headerlink\" title=\"删除字典\"></a>删除字典</h2><figure class=\"highlight angelscript\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">dictionary</span>.clear()</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">del</span> dictionary</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"访问字典\"><a href=\"#访问字典\" class=\"headerlink\" title=\"访问字典\"></a>访问字典</h2><p>字典只能通过键值去访问内部的元素。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">dictionary = &#123;<span class=\"string\">&quot;name&quot;</span>: <span class=\"string\">&quot;肖总&quot;</span>, <span class=\"string\">&quot;age&quot;</span>: <span class=\"number\">18</span>&#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(dictionary[<span class=\"string\">&quot;name&quot;</span>])</span><br><span class=\"line\"><span class=\"built_in\">print</span>(dictionary.get(<span class=\"string\">&quot;name&quot;</span>))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(dictionary[<span class=\"string\">&quot;age&quot;</span>])</span><br><span class=\"line\"><span class=\"built_in\">print</span>(dictionary.get(<span class=\"string\">&quot;age&quot;</span>))</span><br></pre></td></tr></table></figure>\n\n<p>执行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">肖总</span><br><span class=\"line\">肖总</span><br><span class=\"line\"><span class=\"number\">18</span></span><br><span class=\"line\"><span class=\"number\">18</span></span><br></pre></td></tr></table></figure>\n\n<p>值得一提的是，如果直接使用 <code>[键值]</code>获得的时候，字典中不存在该键值，会直接爆错。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">dictionary = &#123;<span class=\"string\">&quot;name&quot;</span>: <span class=\"string\">&quot;肖总&quot;</span>, <span class=\"string\">&quot;age&quot;</span>: <span class=\"number\">18</span>&#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(dictionary[<span class=\"string\">&quot;sex&quot;</span>])</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：报错</p>\n<p>使用 <code>get()</code>方法如果没有该键值会返回 <code>None</code>值，而且可以设置第二个参数为默认值。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">dictionary = &#123;<span class=\"string\">&quot;name&quot;</span>: <span class=\"string\">&quot;肖总&quot;</span>, <span class=\"string\">&quot;age&quot;</span>: <span class=\"number\">18</span>&#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(dictionary.get(<span class=\"string\">&quot;sex&quot;</span>))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(dictionary.get(<span class=\"string\">&quot;sex&quot;</span>, <span class=\"string\">&quot;未知&quot;</span>))</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"literal\">None</span></span><br><span class=\"line\">未知</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"遍历字典\"><a href=\"#遍历字典\" class=\"headerlink\" title=\"遍历字典\"></a>遍历字典</h2><p>可以使用字典的 <code>items()</code> 方法遍历字典。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">dictionary = &#123;<span class=\"string\">&quot;name&quot;</span>: <span class=\"string\">&quot;肖总&quot;</span>, <span class=\"string\">&quot;age&quot;</span>: <span class=\"number\">18</span>&#125;</span><br><span class=\"line\"><span class=\"keyword\">for</span> item <span class=\"keyword\">in</span> dictionary.items():</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(item)</span><br><span class=\"line\"><span class=\"keyword\">for</span> key, value <span class=\"keyword\">in</span> dictionary.items():</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(key, value)</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">(<span class=\"string\">&#x27;name&#x27;</span>, <span class=\"string\">&#x27;肖总&#x27;</span>)</span><br><span class=\"line\">(<span class=\"string\">&#x27;age&#x27;</span>, <span class=\"number\">18</span>)</span><br><span class=\"line\">name 肖总</span><br><span class=\"line\">age <span class=\"number\">18</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"修改元素-2\"><a href=\"#修改元素-2\" class=\"headerlink\" title=\"修改元素\"></a>修改元素</h2><p>字典可以直接通过添加键值的方式，对字典中的元素进行添加，修改等操作。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">dictionary = &#123;<span class=\"string\">&quot;name&quot;</span>: <span class=\"string\">&quot;肖总&quot;</span>, <span class=\"string\">&quot;age&quot;</span>: <span class=\"number\">18</span>&#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(dictionary)</span><br><span class=\"line\">dictionary[<span class=\"string\">&quot;sex&quot;</span>] = <span class=\"string\">&quot;男&quot;</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(dictionary)</span><br><span class=\"line\">dictionary[<span class=\"string\">&quot;sex&quot;</span>] = <span class=\"string\">&quot;女&quot;</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(dictionary)</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#123;<span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;肖总&#x27;</span>, <span class=\"string\">&#x27;age&#x27;</span>: <span class=\"number\">18</span>&#125;</span><br><span class=\"line\">&#123;<span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;肖总&#x27;</span>, <span class=\"string\">&#x27;age&#x27;</span>: <span class=\"number\">18</span>, <span class=\"string\">&#x27;sex&#x27;</span>: <span class=\"string\">&#x27;男&#x27;</span>&#125;</span><br><span class=\"line\">&#123;<span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;肖总&#x27;</span>, <span class=\"string\">&#x27;age&#x27;</span>: <span class=\"number\">18</span>, <span class=\"string\">&#x27;sex&#x27;</span>: <span class=\"string\">&#x27;女&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<p>字典可以通过 <code>del</code>命令删除字典元素。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">dictionary = &#123;<span class=\"string\">&quot;name&quot;</span>: <span class=\"string\">&quot;肖总&quot;</span>, <span class=\"string\">&quot;age&quot;</span>: <span class=\"number\">18</span>&#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(dictionary)</span><br><span class=\"line\"><span class=\"keyword\">del</span> dictionary[<span class=\"string\">&quot;age&quot;</span>]</span><br><span class=\"line\"><span class=\"built_in\">print</span>(dictionary)</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#123;<span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;肖总&#x27;</span>, <span class=\"string\">&#x27;age&#x27;</span>: <span class=\"number\">18</span>&#125;</span><br><span class=\"line\">&#123;<span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;肖总&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>\n\n<p>如果删除一个不存在的键值，会直接报错。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">dictionary = &#123;<span class=\"string\">&quot;name&quot;</span>: <span class=\"string\">&quot;肖总&quot;</span>, <span class=\"string\">&quot;age&quot;</span>: <span class=\"number\">18</span>&#125;</span><br><span class=\"line\"><span class=\"keyword\">del</span> dictionary[<span class=\"string\">&quot;sex&quot;</span>]</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：报错</p>\n<p>正确的删除方式为：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">dictionary = &#123;<span class=\"string\">&quot;name&quot;</span>: <span class=\"string\">&quot;肖总&quot;</span>, <span class=\"string\">&quot;age&quot;</span>: <span class=\"number\">18</span>&#125;</span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"string\">&quot;sex&quot;</span> <span class=\"keyword\">in</span> dictionary:</span><br><span class=\"line\">    <span class=\"keyword\">del</span> dictionary[<span class=\"string\">&quot;sex&quot;</span>]</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"字典推导式\"><a href=\"#字典推导式\" class=\"headerlink\" title=\"字典推导式\"></a>字典推导式</h2><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">key = [<span class=\"string\">&quot;name&quot;</span>, <span class=\"string\">&quot;age&quot;</span>]</span><br><span class=\"line\">value = [<span class=\"string\">&quot;肖总&quot;</span>, <span class=\"string\">&quot;18&quot;</span>]</span><br><span class=\"line\">dictionary = &#123;i: j + <span class=\"string\">&quot;~&quot;</span> <span class=\"keyword\">for</span> i, j <span class=\"keyword\">in</span> <span class=\"built_in\">zip</span>(key, value)&#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(dictionary)</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#123;<span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;肖总~&#x27;</span>, <span class=\"string\">&#x27;age&#x27;</span>: <span class=\"string\">&#x27;18~&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h1 id=\"集合\"><a href=\"#集合\" class=\"headerlink\" title=\"集合\"></a>集合</h1><blockquote>\n<p>集合和列表一样，都是若干个元素的集合，不过集合和列表的区别在于，集合中如果有重复元素，只会保留一个。</p>\n</blockquote>\n<h2 id=\"创建集合\"><a href=\"#创建集合\" class=\"headerlink\" title=\"创建集合\"></a>创建集合</h2><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">setname = &#123;<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>&#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(setname)</span><br></pre></td></tr></table></figure>\n\n\n\n<p>可以使用 <code>set()</code>函数，将列表，元组转换为集合。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">list</span> = [<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">4</span>]</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">list</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">set</span>(<span class=\"built_in\">list</span>))</span><br><span class=\"line\"><span class=\"built_in\">tuple</span> = (<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">4</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">tuple</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">set</span>(<span class=\"built_in\">tuple</span>))</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">[<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">4</span>]</span><br><span class=\"line\">&#123;<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>&#125;</span><br><span class=\"line\">(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">4</span>)</span><br><span class=\"line\">&#123;<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"修改集合\"><a href=\"#修改集合\" class=\"headerlink\" title=\"修改集合\"></a>修改集合</h2><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">setname = &#123;<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>&#125;</span><br><span class=\"line\"><span class=\"built_in\">print</span>(setname)</span><br><span class=\"line\">setname.add(<span class=\"number\">5</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(setname)</span><br><span class=\"line\">setname.remove(<span class=\"number\">3</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(setname)</span><br></pre></td></tr></table></figure>\n\n\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#123;<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>&#125;</span><br><span class=\"line\">&#123;<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>&#125;</span><br><span class=\"line\">&#123;<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"集合运算\"><a href=\"#集合运算\" class=\"headerlink\" title=\"集合运算\"></a>集合运算</h2><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">setname1 = &#123;<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>&#125;</span><br><span class=\"line\">setname2 = &#123;<span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>&#125;</span><br><span class=\"line\"><span class=\"comment\"># 交集</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(setname1 &amp; setname2)</span><br><span class=\"line\"><span class=\"comment\"># 并集</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(setname1 | setname2)</span><br><span class=\"line\"><span class=\"comment\"># 差集</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(setname1 - setname2)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(setname2 - setname1)</span><br></pre></td></tr></table></figure>\n\n<p>运行结果：</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#123;<span class=\"number\">3</span>, <span class=\"number\">4</span>&#125;</span><br><span class=\"line\">&#123;<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span>&#125;</span><br><span class=\"line\">&#123;<span class=\"number\">1</span>, <span class=\"number\">2</span>&#125;</span><br><span class=\"line\">&#123;<span class=\"number\">5</span>&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n\n\n<h1 id=\"序列之间的区别\"><a href=\"#序列之间的区别\" class=\"headerlink\" title=\"序列之间的区别\"></a>序列之间的区别</h1><table>\n<thead>\n<tr>\n<th>序列</th>\n<th>是否可变</th>\n<th>是否重复</th>\n<th>是否有序</th>\n<th>定义符号</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>列表(list）</td>\n<td>可变</td>\n<td>可重复</td>\n<td>有序</td>\n<td>[]</td>\n</tr>\n<tr>\n<td>元组(tuple）</td>\n<td>不可变</td>\n<td>可重复</td>\n<td>有序</td>\n<td>()</td>\n</tr>\n<tr>\n<td>字典(dictionary）</td>\n<td>可变</td>\n<td>不可重复</td>\n<td>无序</td>\n<td>{key:value}</td>\n</tr>\n<tr>\n<td>集合(set）</td>\n<td>可变</td>\n<td>不可重复</td>\n<td>无序</td>\n<td>{}</td>\n</tr>\n</tbody></table>\n","categories":["Python"],"tags":["Python"]},{"title":"Python环境安装","url":"/2020/04/10/python/Python%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85/","content":"<p>@[TOC]</p>\n<h1 id=\"Python简介\"><a href=\"#Python简介\" class=\"headerlink\" title=\"Python简介\"></a>Python简介</h1><p>Python是一种跨平台的计算机程序设计语言。 是一个高层次的结合了解释性、编译性、互动性和面向对象的脚本语言。最初被设计用于编写自动化脚本(shell)，随着版本的不断更新和语言新功能的添加，越多被用于独立的、大型项目的开发。</p>\n<span id=\"more\"></span>\n\n<h1 id=\"Python环境安装\"><a href=\"#Python环境安装\" class=\"headerlink\" title=\"Python环境安装\"></a>Python环境安装</h1><p><strong>Python下载官网：</strong><a href=\"https://www.python.org/downloads/release/python-382/\">https://www.python.org/downloads/release/python-382/</a><br><img src=\"/images/2020/04/20200409214852108.png\" alt=\"在这里插入图片描述\"></p>\n<p>下载Python之后，我们点击以管理员的身份运行。<br><img src=\"/images/2020/04/20200409215426272.png\" alt=\"在这里插入图片描述\"></p>\n<p>我们选择Customize installation进行自定义安装，同时勾选Add Python to PATH，安装的时候自动配置PATH路径。<br><img src=\"/images/2020/04/20200409215729229.png\" alt=\"在这里插入图片描述\"></p>\n<p>我们勾选所有的可选功能选项，点击Next进入下一步安装。<br><img src=\"/images/2020/04/20200409225449252.png\" alt=\"在这里插入图片描述\"></p>\n<p>选择Python的安装目录，点击Install进行安装。<br><img src=\"/images/2020/04/20200409225544819.png\" alt=\"在这里插入图片描述\"></p>\n<p>打开cmd命令提示窗口，输入<code>python</code>，显示python版本信息如上图所示，即表示python安装成功。</p>\n<h1 id=\"Python环境变量\"><a href=\"#Python环境变量\" class=\"headerlink\" title=\"Python环境变量\"></a>Python环境变量</h1><p>Python安装成功后，有两个PATH环境变量，分别是：</p>\n<ul>\n<li><code>C:\\Program Files\\Python\\Scripts\\</code></li>\n<li><code>C:\\Program Files\\Python\\</code></li>\n</ul>\n<p><strong>其中<code>C:\\Program Files\\Python\\</code>为我的Python安装目录。</strong><br>如果我们在安装Python的时候，已经勾选了<code>Add Python to PATH</code>，那么Python会自动帮我们配置这两个个环境变量，如果没有勾选，那么也可以选择自动手动配置环境变量。<br><strong>环境变量配置：此电脑（我的电脑）——右键属性——高级系统设置——环境变量</strong><br><img src=\"/images/2020/04/20200410080456199.png\" alt=\"在这里插入图片描述\"></p>\n<h1 id=\"Hello-World\"><a href=\"#Hello-World\" class=\"headerlink\" title=\"Hello World\"></a>Hello World</h1><p>在安装成功Python之后，会自动一个简单的IDE开发工具，名为IDLE，我们可以在开始菜单中找到这个IDE。<br><img src=\"/images/2020/04/20200409230339585.png\" alt=\"在这里插入图片描述\"></p>\n<p>我们在IDLE中输入<code>print(&quot;Hello World!&quot;)</code>，随后敲击回车，即可完成我们的第一句Python代码。<br><img src=\"/images/2020/04/20200409230433142.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["Python"],"tags":["Python"]},{"title":"使用Python写一个一键项目部署工具","url":"/2023/03/15/python/%E4%BD%BF%E7%94%A8Python%E5%86%99%E4%B8%80%E4%B8%AA%E4%B8%80%E9%94%AE%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E5%B7%A5%E5%85%B7/","content":"<p>最近在工作中总是需要在开发和测试环境频繁部署项目，之前使用的工具是 <code>filezilla</code> 和 <code>XShell</code>，分别用来上传文件和登录远程终端，这两个工具虽然功能强大，但是都需要手动执行操作。</p>\n<p>为了减少这些繁琐的工作，于是使用功能强大的 <code>Python</code> 编写了一个一键部署项目的脚本。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"paramiko\"><a href=\"#paramiko\" class=\"headerlink\" title=\"paramiko\"></a>paramiko</h2><p><code>Paramiko</code> 属于 <code>Python</code> 的一个第三方库，可以远程连接 <code>Linux</code> 服务器，进行通过 <code>Python</code> 进行对 <code>Linux</code> 进行操作，可以实现进行对远程服务器进行下载和上传文件操作。</p>\n<p>我们可以使用 <code>pip</code> 命令来安装 <code>Paramiko</code>。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">pip install paramiko</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"一键部署脚本\"><a href=\"#一键部署脚本\" class=\"headerlink\" title=\"一键部署脚本\"></a>一键部署脚本</h2><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># pip install paramiko</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> time</span><br><span class=\"line\"><span class=\"keyword\">import</span> paramiko</span><br><span class=\"line\"></span><br><span class=\"line\">remote_list = [</span><br><span class=\"line\">    &#123;<span class=\"string\">&#x27;host&#x27;</span>: <span class=\"string\">&#x27;127.0.0.1&#x27;</span>, <span class=\"string\">&#x27;username&#x27;</span>: <span class=\"string\">&#x27;root&#x27;</span>, <span class=\"string\">&#x27;password&#x27;</span>: <span class=\"string\">&#x27;111111&#x27;</span>&#125;</span><br><span class=\"line\">]</span><br><span class=\"line\"></span><br><span class=\"line\">local_jar_path = <span class=\"string\">&#x27;F:\\\\IdeaCode\\\\zero-admin\\\\&#x27;</span></span><br><span class=\"line\">remote_jar_path = <span class=\"string\">&#x27;/usr/app/zero-admin/&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> remote <span class=\"keyword\">in</span> remote_list:</span><br><span class=\"line\">    host = remote.get(<span class=\"string\">&#x27;host&#x27;</span>)</span><br><span class=\"line\">    username = remote.get(<span class=\"string\">&#x27;username&#x27;</span>)</span><br><span class=\"line\">    password = remote.get(<span class=\"string\">&#x27;password&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">print</span>(time.strftime(<span class=\"string\">&quot;%Y-%m-%d %H:%M:%S&quot;</span>, time.localtime()) + <span class=\"string\">&#x27;：&#x27;</span> + host  + <span class=\"string\">&#x27; 开始部署项目&#x27;</span>)</span><br><span class=\"line\">    transport = paramiko.Transport((host, <span class=\"number\">22</span>))</span><br><span class=\"line\">    transport.connect(username=username, password=password)</span><br><span class=\"line\">    sftp = paramiko.SFTPClient.from_transport(transport)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 上传文件</span></span><br><span class=\"line\">    <span class=\"built_in\">print</span>(time.strftime(<span class=\"string\">&quot;%Y-%m-%d %H:%M:%S&quot;</span>, time.localtime()) + <span class=\"string\">&#x27;：&#x27;</span> + host  + <span class=\"string\">&#x27; 正在上传文件&#x27;</span>)</span><br><span class=\"line\">    sftp.put(local_jar_path + <span class=\"string\">&#x27;zero-web-1.0-SNAPSHOT.jar&#x27;</span>, remote_jar_path + <span class=\"string\">&#x27;zero-web-1.0-SNAPSHOT.jar&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 执行命令</span></span><br><span class=\"line\">    <span class=\"built_in\">print</span>(time.strftime(<span class=\"string\">&quot;%Y-%m-%d %H:%M:%S&quot;</span>, time.localtime()) + <span class=\"string\">&#x27;：&#x27;</span> + host  + <span class=\"string\">&#x27; 开始执行命令&#x27;</span>)</span><br><span class=\"line\">    ssh = paramiko.SSHClient()</span><br><span class=\"line\">    <span class=\"comment\"># 允许将信任的主机自动加入到 host_allow 列表</span></span><br><span class=\"line\">    ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy)</span><br><span class=\"line\">    ssh._transport = transport</span><br><span class=\"line\">    stdin, stdout, stderr = ssh.exec_command(<span class=\"string\">&#x27;sh /usr/app/zero-admin/spring-boot.sh restart&#x27;</span>)</span><br><span class=\"line\">    result = stdout.read().decode(<span class=\"string\">&#x27;utf-8&#x27;</span>)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(time.strftime(<span class=\"string\">&quot;%Y-%m-%d %H:%M:%S&quot;</span>, time.localtime()) + <span class=\"string\">&#x27;：&#x27;</span> + host + <span class=\"string\">&#x27; 部署成功\\n&#x27;</span> + result)</span><br><span class=\"line\"></span><br><span class=\"line\">    ssh.close()</span><br><span class=\"line\">    sftp.close()</span><br><span class=\"line\">    transport.close()</span><br></pre></td></tr></table></figure>\n","categories":["Python"],"tags":["Python"]},{"title":"使用Python原生爬虫爬取博客文章的简单信息","url":"/2020/04/12/python/%E4%BD%BF%E7%94%A8Python%E5%8E%9F%E7%94%9F%E7%88%AC%E8%99%AB%E7%88%AC%E5%8F%96%E5%8D%9A%E5%AE%A2%E6%96%87%E7%AB%A0%E7%9A%84%E7%AE%80%E5%8D%95%E4%BF%A1%E6%81%AF/","content":"<blockquote>\n<p>今天我们使用Python的原生方式，来爬取我们自己的博客的一些简单信息。</p>\n</blockquote>\n<h1 id=\"准备\"><a href=\"#准备\" class=\"headerlink\" title=\"准备\"></a>准备</h1><p>在制作一个简单的Python爬虫之前，我们需要先分析一下我们需要使用爬虫来爬取什么信息，又该通过什么方式来解析出我们所需要的信息。</p>\n<span id=\"more\"></span>\n<p>因为今天制作的是一个简单的Python爬虫，所以我们想要爬取的信息也不是非常复杂。<br>我们需要爬取博客中的5个信息，分别是：<strong>文章URL，文章标题，文章上传时间，文章阅读数，文章评论数</strong>。<br>因为我们使用的是Python原生的方式来爬取信息，所以我们也直接使用正则表达式来解析爬取的数据，从数据中获取我们所需要的信息。</p>\n<h1 id=\"项目结构\"><a href=\"#项目结构\" class=\"headerlink\" title=\"项目结构\"></a>项目结构</h1><p><img src=\"/images/2020/04/20200411224221195.png\" alt=\"在这里插入图片描述\"></p>\n<h1 id=\"article-py模块（信息对象）\"><a href=\"#article-py模块（信息对象）\" class=\"headerlink\" title=\"article.py模块（信息对象）\"></a>article.py模块（信息对象）</h1><p>为了便于封装爬取的信息，我们在article.py模块下创建一个信息类，里面封装了我们需要爬取的信息。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Article</span>(<span class=\"title class_ inherited__\">object</span>):</span><br><span class=\"line\">    url = <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\">    title = <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\">    date = <span class=\"string\">&#x27;&#x27;</span></span><br><span class=\"line\">    read_num = <span class=\"number\">0</span></span><br><span class=\"line\">    comment_num = <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, url, title, date, read_num, comment_num</span>):</span><br><span class=\"line\">        self.url = url</span><br><span class=\"line\">        self.title = title</span><br><span class=\"line\">        self.date = date</span><br><span class=\"line\">        self.read_num = read_num</span><br><span class=\"line\">        self.comment_num = comment_num</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"spider-py模块（爬虫）\"><a href=\"#spider-py模块（爬虫）\" class=\"headerlink\" title=\"spider.py模块（爬虫）\"></a>spider.py模块（爬虫）</h1><p>我们在spider.py模块下创建一个爬虫类。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> re</span><br><span class=\"line\"><span class=\"keyword\">from</span> urllib <span class=\"keyword\">import</span> request</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> article <span class=\"keyword\">import</span> Article</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Spider</span>():</span><br><span class=\"line\">    <span class=\"comment\"># 博客路径</span></span><br><span class=\"line\">    url = <span class=\"string\">&#x27;https://blog.csdn.net/qq_45193304/article/list/&#x27;</span></span><br><span class=\"line\">    <span class=\"comment\"># 单个博客文章内容块的正则表达式</span></span><br><span class=\"line\">    article_pattern = <span class=\"string\">&#x27;&lt;div class=&quot;article-item-box csdn-tracking-statistics&quot; data-articleid=&quot;[\\d]*?&quot;&gt;[\\s\\S]*?&lt;/div&gt;[\\S\\s]*?&lt;/div&gt;&#x27;</span></span><br><span class=\"line\">    <span class=\"comment\"># 单个博客文章URL和标题的正则表达式</span></span><br><span class=\"line\">    title_pattern = <span class=\"string\">&#x27;&lt;a href=&quot;([\\s\\S]*?)&quot; target=&quot;_blank&quot;&gt;[\\S\\s]*?&lt;span class=&quot;article-type type-1 float-none&quot;&gt;原创&lt;/span&gt;([\\s\\S]*?)&lt;/a&gt;&#x27;</span></span><br><span class=\"line\">    <span class=\"comment\"># 单个博客文章上传时间的正则表达式</span></span><br><span class=\"line\">    date_pattern = <span class=\"string\">&#x27;&lt;span class=&quot;date&quot;&gt;([\\d\\D]*?)&lt;/span&gt;&#x27;</span></span><br><span class=\"line\">    <span class=\"comment\"># 单个博客文章阅读次数的正则表达式</span></span><br><span class=\"line\">    read_num_pattern = <span class=\"string\">&#x27;&lt;span class=&quot;read-num&quot;&gt;阅读数 &lt;span class=&quot;num&quot;&gt;([\\d]*?)&lt;/span&gt; &lt;/span&gt;&#x27;</span></span><br><span class=\"line\">    <span class=\"comment\"># 单个博客文章评论次数的正则表达式</span></span><br><span class=\"line\">    comment_num_pattern = <span class=\"string\">&#x27;&lt;span class=&quot;read-num&quot;&gt;评论数 &lt;span class=&quot;num&quot;&gt;([\\d]*?)&lt;/span&gt; &lt;/span&gt;&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 通过url获取html页面内容，并通过utf-8进行解码</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__fetch_content</span>(<span class=\"params\">self, url</span>):</span><br><span class=\"line\">        r = request.urlopen(url)</span><br><span class=\"line\">        html = r.read()</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"built_in\">str</span>(html, encoding=<span class=\"string\">&#x27;utf-8&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 通过html页面获取页面中的文章内容块</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__get_article</span>(<span class=\"params\">self, html</span>):</span><br><span class=\"line\">        article_html = re.findall(self.article_pattern, html)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> article_html</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 对每个文章内容块进行处理，获取博客的url和标题</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__get_url_and_title</span>(<span class=\"params\">self, article</span>):</span><br><span class=\"line\">        r = re.search(self.title_pattern, article)</span><br><span class=\"line\">        url = r.group(<span class=\"number\">1</span>).strip()</span><br><span class=\"line\">        title = r.group(<span class=\"number\">2</span>).strip()</span><br><span class=\"line\">        <span class=\"keyword\">return</span> url, title</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 对每个文章内容块进行处理，获取博客的上传时间</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__get_date</span>(<span class=\"params\">self, article</span>):</span><br><span class=\"line\">        r = re.search(self.date_pattern, article)</span><br><span class=\"line\">        date = r.group(<span class=\"number\">1</span>).strip()</span><br><span class=\"line\">        <span class=\"keyword\">return</span> date</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 对每个文章内容块进行处理，获取博客的阅读数</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__get_read_num</span>(<span class=\"params\">self, article</span>):</span><br><span class=\"line\">        r = re.search(self.read_num_pattern, article)</span><br><span class=\"line\">        read_num = <span class=\"built_in\">int</span>(r.group(<span class=\"number\">1</span>))</span><br><span class=\"line\">        <span class=\"keyword\">return</span> read_num</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 对每个文章内容块进行处理，获取博客的评论数</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__get_comment_num</span>(<span class=\"params\">self, article</span>):</span><br><span class=\"line\">        r = re.search(self.comment_num_pattern, article)</span><br><span class=\"line\">        comment_num = <span class=\"built_in\">int</span>(r.group(<span class=\"number\">1</span>))</span><br><span class=\"line\">        <span class=\"keyword\">return</span> comment_num</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 对博客文章列表进行遍历，然后分别处理每一个博客文章内容，进行封装处理</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__do_package</span>(<span class=\"params\">self, article_html, article_list</span>):</span><br><span class=\"line\">        <span class=\"keyword\">for</span> article <span class=\"keyword\">in</span> article_html:</span><br><span class=\"line\">            url, title = self.__get_url_and_title(article)</span><br><span class=\"line\">            date = self.__get_date(article)</span><br><span class=\"line\">            read_num = self.__get_read_num(article)</span><br><span class=\"line\">            comment_num = self.__get_comment_num(article)</span><br><span class=\"line\">            article = Article(url, title, date, read_num, comment_num)</span><br><span class=\"line\">            article_list.append(article)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 爬虫的入口函数</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">go</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        page = <span class=\"number\">1</span></span><br><span class=\"line\">        article_list = []</span><br><span class=\"line\">        <span class=\"keyword\">while</span> page:</span><br><span class=\"line\">            url = self.url + <span class=\"built_in\">str</span>(page)</span><br><span class=\"line\">            page += <span class=\"number\">1</span></span><br><span class=\"line\">            html = self.__fetch_content(url)</span><br><span class=\"line\">            article_html = self.__get_article(html)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> <span class=\"built_in\">len</span>(article_html) == <span class=\"number\">0</span>:</span><br><span class=\"line\">                <span class=\"keyword\">break</span></span><br><span class=\"line\">            self.__do_package(article_html,article_list)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> article_list</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 实例化一个Spider对象</span></span><br><span class=\"line\">spider = Spider()</span><br><span class=\"line\"><span class=\"comment\"># 调用spider的go()方法，获取一个article对象的列表</span></span><br><span class=\"line\">article_list = spider.go()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 一共爬取了多少条信息</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;爬虫一共爬取了&#x27;</span> + <span class=\"built_in\">str</span>(<span class=\"built_in\">len</span>(article_list)) + <span class=\"string\">&#x27;条博客文章信息&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 遍历列表，打印列表中的数据</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> article <span class=\"keyword\">in</span> article_list:</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(article.__dict__)</span><br></pre></td></tr></table></figure>\n<h1 id=\"结束\"><a href=\"#结束\" class=\"headerlink\" title=\"结束\"></a>结束</h1><p>通过上面的代码，我们使用Python原生的方式爬取的信息，就会直接在控制台打印出来。<br>如果我们需要爬取其他博客用户的信息，只需要修改<code>url</code>的值即可。</p>\n<p>最后需要说一句的是，CSDN没有对博客内容进行反爬虫，但是对于访问量等博客数据却有着反爬虫机制，可以防止用户通过爬虫来恶意刷访问量，所以那些想通过爬虫来刷访问量的同学可以洗洗睡了。</p>\n","categories":["Python"],"tags":["Python"]},{"title":"手把手教你用Python操作Excel","url":"/2023/01/09/python/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E7%94%A8Python%E6%93%8D%E4%BD%9CExcel/","content":"<blockquote>\n<p>工作之中经常要对一些数据进行分析或者整理，而且因为是和非技术人员进行对接，所以经常会使用Excel文件作为数据交接的工具，对于Excel的功能强大是毋庸置疑的，但是对于技术人员而言，使用Excel也有一些不方便的地方。<br>比如将原始数据整理为Excel文件，或者对Excel数据进行分析的时候，一些脚本语言读取Excel困难或者繁复，导致工作效率低下。<br>Python作为数据分析经常使用的脚本语言，自然也支持Excel的操作，今天就以本文来简单介绍几种简单操作Excel的工具。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h2 id=\"写入Excel文件\"><a href=\"#写入Excel文件\" class=\"headerlink\" title=\"写入Excel文件\"></a>写入Excel文件</h2><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 安装 xlsxwriter 用于读取excel文件</span></span><br><span class=\"line\"><span class=\"comment\"># pip install xlsxwriter</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> xlsxwriter <span class=\"keyword\">as</span> xw</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">write_excel</span>(<span class=\"params\">file_name, sheet_name, data</span>):</span><br><span class=\"line\">    <span class=\"comment\"># 创建工作簿</span></span><br><span class=\"line\">    workbook = xw.Workbook(file_name)</span><br><span class=\"line\">    <span class=\"comment\"># 创建子表</span></span><br><span class=\"line\">    sheet = workbook.add_worksheet(sheet_name)</span><br><span class=\"line\">    <span class=\"comment\"># 激活表</span></span><br><span class=\"line\">    sheet.activate()</span><br><span class=\"line\">    <span class=\"comment\"># 从A1单元格开始写入表头</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"built_in\">len</span>(data)):</span><br><span class=\"line\">        sheet.write_row(<span class=\"string\">&#x27;A&#x27;</span> + <span class=\"built_in\">str</span>(i + <span class=\"number\">1</span>), data[i])</span><br><span class=\"line\">    <span class=\"comment\"># 关闭表</span></span><br><span class=\"line\">    workbook.close()</span><br><span class=\"line\"></span><br><span class=\"line\">data = [</span><br><span class=\"line\">    [<span class=\"string\">&#x27;姓名&#x27;</span>,<span class=\"string\">&#x27;性别&#x27;</span>, <span class=\"string\">&#x27;联系方式&#x27;</span>],</span><br><span class=\"line\">    [<span class=\"string\">&#x27;小明&#x27;</span>,<span class=\"string\">&#x27;男&#x27;</span>, <span class=\"string\">&#x27;11111111111&#x27;</span>],</span><br><span class=\"line\">    [<span class=\"string\">&#x27;小红&#x27;</span>,<span class=\"string\">&#x27;女&#x27;</span>, <span class=\"string\">&#x27;22222222222&#x27;</span>],</span><br><span class=\"line\">    [<span class=\"string\">&#x27;小刚&#x27;</span>,<span class=\"string\">&#x27;男&#x27;</span>, <span class=\"string\">&#x27;33333333333&#x27;</span>],</span><br><span class=\"line\">]</span><br><span class=\"line\"></span><br><span class=\"line\">write_excel(<span class=\"string\">&#x27;D:\\\\private\\\\01.xlsx&#x27;</span>, <span class=\"string\">&#x27;用户数据&#x27;</span>, data)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"读取Excel文件\"><a href=\"#读取Excel文件\" class=\"headerlink\" title=\"读取Excel文件\"></a>读取Excel文件</h2><figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 安装 xlrd 1.2.0版本用于读取解析excel文件</span></span><br><span class=\"line\"><span class=\"comment\"># pip install xlrd==1.2.0</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> xlrd</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">read_excel</span>(<span class=\"params\">file_name, sheet_name</span>):</span><br><span class=\"line\">    workbook = xlrd.open_workbook(file_name)</span><br><span class=\"line\">    sheet = workbook.sheet_by_name(sheet_name)</span><br><span class=\"line\">    data = []</span><br><span class=\"line\">    <span class=\"keyword\">for</span> row_num <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(sheet.nrows):</span><br><span class=\"line\">        row_data = []</span><br><span class=\"line\">        <span class=\"keyword\">for</span> col_num <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(sheet.ncols):</span><br><span class=\"line\">            cell = sheet.cell(row_num, col_num)</span><br><span class=\"line\">            row_data.append(cell.value)</span><br><span class=\"line\">        data.append(row_data)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> data</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">data = read_excel(<span class=\"string\">&#x27;D:\\\\private\\\\01.xlsx&#x27;</span>, <span class=\"string\">&#x27;用户数据&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> row_data <span class=\"keyword\">in</span> data:</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(row_data)</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"尾声\"><a href=\"#尾声\" class=\"headerlink\" title=\"尾声\"></a>尾声</h2><p>以上两种读写Excel的方式都是比较简单的操作，将Excel数据转换为方便操作的集合对象，从而方便了专业的开发人员的操作。</p>\n","categories":["Python"],"tags":["Python"]},{"title":"Redis安装及常用命令","url":"/2020/02/22/redis/Redis%E5%AE%89%E8%A3%85%E5%8F%8A%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/","content":"<h2 id=\"Redis简介\"><a href=\"#Redis简介\" class=\"headerlink\" title=\"Redis简介\"></a>Redis简介</h2><p>Redis是一款开源的，高性能的，存储key-value数据结构的缓存数据库，相比较于其他缓存数据库而言，Redis有以下优势：</p>\n<span id=\"more\"></span>\n<ul>\n<li>Redis支持数据的持久化，可以将数据持久化到硬盘中，服务器重启后可以重新加载到Redis数据库中。</li>\n<li>Redis不仅仅支持String类型的数据，还支持Hash，List，Set，Zset等数据结构的存储。</li>\n<li>Redis支持数据备份。</li>\n<li>Redis读写性能极高，根据官方测试数据，Redis读速度为11万次/秒，写速度为8.1万次/秒。</li>\n<li>Redis的操作具有原子性，即要么命令执行成功，要么命令执行失败，即便是多组命令，也可以通过MULTI和EXEC指令包起来，实现原子性。</li>\n</ul>\n<h2 id=\"Redis安装\"><a href=\"#Redis安装\" class=\"headerlink\" title=\"Redis安装\"></a>Redis安装</h2><p>Redis官网：<a href=\"https://redis.io/\">https://redis.io/</a><br><img src=\"/images/2020/02/20200222100610306.png\" alt=\"在这里插入图片描述\"></p>\n<p>不过需要注意的是，Redis官网中只有tar.gz格式的安装包，如果你是Windows操作系统，那么你需要到github上下载Windows操作系统的安装包。</p>\n<p>github下载地址：<a href=\"https://github.com/microsoftarchive/redis/releases/tag/win-3.2.100\">https://github.com/microsoftarchive/redis/releases/tag/win-3.2.100</a></p>\n<p><img src=\"/images/2020/02/20200222101051950.png\" alt=\"在这里插入图片描述\"><br>安装包下载完成之后，直接在安装目录下解压缩即可。</p>\n<h2 id=\"Redis启动\"><a href=\"#Redis启动\" class=\"headerlink\" title=\"Redis启动\"></a>Redis启动</h2><p>我们先来看看Redis解压缩之后的目录结构，其中我们需要关注的有两个执行文件。<br><img src=\"/images/2020/02/2020022210141112.png\" alt=\"在这里插入图片描述\"><br>我们先双击redis-server.exe执行文件。<br><img src=\"/images/2020/02/20200222101610363.png\" alt=\"在这里插入图片描述\"><br><strong>记住，不要关闭这个命令窗口界面，因为关闭这个窗口就相当于关闭服务器，我们把这个窗口最小化即可。</strong></p>\n<p>然后我们再双击redis-cli.exe执行文件。<br><img src=\"/images/2020/02/20200222101948154.png\" alt=\"在这里插入图片描述\"><br>如此，Redis就已经启动成功了，如果我们使用其他Redis客户端或API来操作Redis，那么只需要启动Redis的服务器就可以了，Redis的客户端可以不需要启动。</p>\n<h2 id=\"Redis数据结构\"><a href=\"#Redis数据结构\" class=\"headerlink\" title=\"Redis数据结构\"></a>Redis数据结构</h2><p>Redis是一个key-value型数据库，所有的数据都是以key-value结构存储在内存中的。<br>Redis的key类型全部都是String类型，即字符串。<br>Redis的value类型可以支持5中不同的数据类型：</p>\n<ul>\n<li>String（字符串）：普通字符串</li>\n<li>Hash（哈希）：Map结构</li>\n<li>List（列表）：linkedList结构，支持重复元素</li>\n<li>Set（集合）：不允许重复元素</li>\n<li>Zset（有序集合）：sortedSet，支持重复元素，且元素有序</li>\n</ul>\n<h2 id=\"Redis常用命令\"><a href=\"#Redis常用命令\" class=\"headerlink\" title=\"Redis常用命令\"></a>Redis常用命令</h2><p><strong>通用命令</strong></p>\n<ul>\n<li>keys *        ： 显示所有的key值</li>\n<li>type key     ：显示key对应的value的类型</li>\n<li>del key         ：删除指定的key和value</li>\n</ul>\n<p><strong>字符串类型（String）命令</strong></p>\n<ul>\n<li>存储：set key value</li>\n<li>获取：get key</li>\n<li>删除：del key</li>\n</ul>\n<p><img src=\"/images/2020/02/20200222104449885.png\" alt=\"在这里插入图片描述\"></p>\n<p><strong>哈希类型（hash）命令</strong></p>\n<ul>\n<li>存储：hset key field value</li>\n<li>获取：<pre><code>hget key field：获取指定的field对应的值\nhgetall key：获取所有的field和value</code></pre></li>\n<li>删除：hdel key field</li>\n</ul>\n<p><img src=\"/images/2020/02/20200222105001183.png\" alt=\"在这里插入图片描述\"></p>\n<p><strong>列表类型（list）命令</strong></p>\n<ul>\n<li>添加：<br>  lpush key value ：将元素加入列表的左边<br>  rpush key value：将元素加入列表的右边</li>\n<li>获取：lrange key strart end：范围获取<br>【注意】lrange命令索引从0开始，返回[strart,end]闭区间，end取-1则获取从strart开始至结尾的全部元素。</li>\n<li>删除：<br>   lpop key：删除列表最左边的元素，并将元素返回<br>  rpop key：删除列表最右边的元素，并将元素返回</li>\n</ul>\n<p><img src=\"/images/2020/02/20200222105825424.png\" alt=\"在这里插入图片描述\"></p>\n<p><strong>集合类型（set）命令</strong></p>\n<ul>\n<li>存储：sadd key value：</li>\n<li>获取：smembers key ：获取set集合中的所有元素</li>\n<li>删除：srem key value：删除set集合中的某个元素</li>\n</ul>\n<p><img src=\"/images/2020/02/20200222110340277.png\" alt=\"在这里插入图片描述\"></p>\n<p><strong>有序集合类型（sortedset）命令</strong></p>\n<ul>\n<li>存储：zadd key score value：score为排序分数</li>\n<li>获取：zrange key start end：如果要显示score的值，就在后面加withscores</li>\n<li>删除：zrem key value</li>\n</ul>\n<p><img src=\"/images/2020/02/20200222111423909.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["Redis"],"tags":["Redis"]},{"title":"Redis实现商品秒杀","url":"/2020/03/19/redis/Redis%E5%AE%9E%E7%8E%B0%E5%95%86%E5%93%81%E7%A7%92%E6%9D%80/","content":"<blockquote>\n<p>商品秒杀是一个非常常见的场景，今天我们就使用Redis来实现商品秒杀功能。</p>\n</blockquote>\n<span id=\"more\"></span>\n<h1 id=\"为什么使用Redis？\"><a href=\"#为什么使用Redis？\" class=\"headerlink\" title=\"为什么使用Redis？\"></a>为什么使用Redis？</h1><ul>\n<li>Redis是一款非关系数据库，数据存储在内存中，存取数据速度非常快！</li>\n<li>Redis是单线程的，即使在同一时间有多条命令操作数据库，这些命令依然只能排队等候。</li>\n</ul>\n<h1 id=\"SpringDataRedis\"><a href=\"#SpringDataRedis\" class=\"headerlink\" title=\"SpringDataRedis\"></a>SpringDataRedis</h1><p>SpringDataRedis是一款Java语言实现的Redis数据库的操作API，它是SpringData系列的框架之一，专门用于操作Redis，而且可以和SpringBoot进行无缝整合。</p>\n<h1 id=\"怎么实现？\"><a href=\"#怎么实现？\" class=\"headerlink\" title=\"怎么实现？\"></a>怎么实现？</h1><p>Redis可以存储五种数据结构，我们使用列表数据来实现商品秒杀功能。</p>\n<ul>\n<li>我们将商品信息作为列表结构的key值，给列表push商品库存个数的value。</li>\n<li>当商品秒杀的时候，我们使用pop命令从列表中取出数据即可。</li>\n</ul>\n<h1 id=\"具体实现\"><a href=\"#具体实现\" class=\"headerlink\" title=\"具体实现\"></a>具体实现</h1><h2 id=\"搭建开发环境\"><a href=\"#搭建开发环境\" class=\"headerlink\" title=\"搭建开发环境\"></a>搭建开发环境</h2><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--SpringBoot为父项目--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.0.4.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--测试功能的启动器，用于整合junit测试功能--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-test<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>test<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--Spring-Data-Redis的启动器--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--lombox插件的依赖，SpringBoot内置，无须标注版本号--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.projectlombok<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>lombok<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"SpringBoot项目的启动类\"><a href=\"#SpringBoot项目的启动类\" class=\"headerlink\" title=\"SpringBoot项目的启动类\"></a>SpringBoot项目的启动类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyApplication</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        SpringApplication.run(MyApplication.class);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Dao层\"><a href=\"#Dao层\" class=\"headerlink\" title=\"Dao层\"></a>Dao层</h2><ul>\n<li><strong>Dao层接口</strong></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">CommodityDao</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 将商品加入库存</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> key</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> value</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">addStock</span><span class=\"params\">(String key,String value)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 秒杀商品</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> key</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    String <span class=\"title function_\">spike</span><span class=\"params\">(String key)</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><strong>Dao层实现</strong></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Repository</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">CommodityDaoImpl</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">CommodityDao</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> RedisTemplate redisTemplate;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">addStock</span><span class=\"params\">(String key,String value)</span> &#123;</span><br><span class=\"line\">        redisTemplate.boundListOps(key).leftPush(value);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">spike</span><span class=\"params\">(String key)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> (String) redisTemplate.boundListOps(key).leftPop();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Service层\"><a href=\"#Service层\" class=\"headerlink\" title=\"Service层\"></a>Service层</h2><ul>\n<li><strong>Service层接口</strong></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">CommodityService</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 将商品加入库存</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> stock</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">addStock</span><span class=\"params\">(<span class=\"type\">int</span> stock)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 秒杀商品</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    String <span class=\"title function_\">spike</span><span class=\"params\">()</span> ;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><strong>Service层实现</strong></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Service</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">CommodityServiceImpl</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">CommodityService</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> CommodityDao commodityDao;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"type\">String</span> <span class=\"variable\">KEY</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;commodity&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">addStock</span><span class=\"params\">(<span class=\"type\">int</span> stock)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; stock; i++) &#123;</span><br><span class=\"line\">            commodityDao.addStock(KEY,<span class=\"string\">&quot;智能手表&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> String <span class=\"title function_\">spike</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> commodityDao.spike(KEY);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"测试功能\"><a href=\"#测试功能\" class=\"headerlink\" title=\"测试功能\"></a>测试功能</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SpringBootTest</span></span><br><span class=\"line\"><span class=\"meta\">@RunWith(SpringRunner.class)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">RedisTest</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> CommodityService commodityService;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 执行商品秒杀前，将商品存入数据库中，已存入5件商品</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Before</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">addStock</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        commodityService.addStock(<span class=\"number\">5</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 商品秒杀测试，使用两个线程一起秒杀</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">spike</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">ExecutorService</span> <span class=\"variable\">es</span> <span class=\"operator\">=</span> Executors.newFixedThreadPool(<span class=\"number\">3</span>);</span><br><span class=\"line\">        <span class=\"type\">Object</span> <span class=\"variable\">obj</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Object</span>();</span><br><span class=\"line\">        es.submit(() -&gt; &#123;</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot;正在秒杀&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">                <span class=\"type\">String</span> <span class=\"variable\">commodity</span> <span class=\"operator\">=</span> commodityService.spike();</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (commodity != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                    System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot;抢到了商品&quot;</span> + commodity);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    System.out.println(<span class=\"string\">&quot;商品被抢完了&quot;</span>);</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        es.submit(() -&gt; &#123;</span><br><span class=\"line\">            System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot;正在秒杀&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">                <span class=\"type\">String</span> <span class=\"variable\">commodity</span> <span class=\"operator\">=</span> commodityService.spike();</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (commodity != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                    System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot;抢到了商品&quot;</span> + commodity);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    System.out.println(<span class=\"string\">&quot;商品被抢完了&quot;</span>);</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 单线程环境秒杀</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">del</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\">            <span class=\"type\">String</span> <span class=\"variable\">commodity</span> <span class=\"operator\">=</span> commodityService.spike();</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (commodity != <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">                System.out.println(Thread.currentThread().getName() + <span class=\"string\">&quot;抢到了商品&quot;</span> + commodity);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;商品被抢完了&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","categories":["Redis"],"tags":["Redis"]},{"title":"Redis实现排行榜","url":"/2020/03/19/redis/Redis%E5%AE%9E%E7%8E%B0%E6%8E%92%E8%A1%8C%E6%A6%9C/","content":"<blockquote>\n<p>Redis作为最为常用的非关系型数据库，具有十分优秀的性能，Redis的多种存储数据结构可以适应各种场景。</p>\n</blockquote>\n<span id=\"more\"></span>\n<h1 id=\"为什么使用Redis实现排行榜？\"><a href=\"#为什么使用Redis实现排行榜？\" class=\"headerlink\" title=\"为什么使用Redis实现排行榜？\"></a>为什么使用Redis实现排行榜？</h1><ul>\n<li>Redis作为一款缓存数据库，性能优异，使用Redis可以提升服务存取数据的性能。</li>\n<li>Redis的zset（有序集合）数据结构，天然具备作为排行榜的优势。<h1 id=\"怎么使用Redis实现排行榜？\"><a href=\"#怎么使用Redis实现排行榜？\" class=\"headerlink\" title=\"怎么使用Redis实现排行榜？\"></a>怎么使用Redis实现排行榜？</h1></li>\n<li>使用Redis的zset数据结构，其中key为固定值，value为排行榜名称，score为排行分数。</li>\n<li>我们记录点击数，每点击一次，排行榜所在的排名越高。</li>\n<li>Redis的zset数据结构，使用的是从小到大的排序方式，所以我们使用负数来作为排名分数，每点击一次，排行榜的分数-1。<h1 id=\"具体实现\"><a href=\"#具体实现\" class=\"headerlink\" title=\"具体实现\"></a>具体实现</h1></li>\n</ul>\n<h2 id=\"搭建开发环境\"><a href=\"#搭建开发环境\" class=\"headerlink\" title=\"搭建开发环境\"></a>搭建开发环境</h2><p>Redis实现排行榜的项目环境，与<a href=\"/2020/03/19/redis/Redis实现商品秒杀/\">Redis实现商品秒杀</a>完全一致，需要的可以到<a href=\"/2020/03/19/redis/Redis实现商品秒杀/\">Redis实现商品秒杀</a>中去查看项目环境。</p>\n<h2 id=\"Dao层\"><a href=\"#Dao层\" class=\"headerlink\" title=\"Dao层\"></a>Dao层</h2><ul>\n<li><strong>Dao层接口</strong></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Redis实现排名</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> hrp</span></span><br><span class=\"line\"><span class=\"comment\"> * 2020/3/19 16:56</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">SortDao</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 点击功能，修改排名,每点击一次，排名分数+1</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> key</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> name</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> score</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">onClick</span><span class=\"params\">(String key,String name,Double score)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取所有排名</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> key</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> start</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> end</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    Set&lt;String&gt; <span class=\"title function_\">getSort</span><span class=\"params\">(String key, Long start, Long end)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取单个的排名分数</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> key</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> name</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    Double <span class=\"title function_\">getScore</span><span class=\"params\">(String key,String name)</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li><strong>Dao层实现</strong></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Repository</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">SortDaoImpl</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">SortDao</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> RedisTemplate redisTemplate;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">onClick</span><span class=\"params\">(String key, String name, Double score)</span> &#123;</span><br><span class=\"line\">        redisTemplate.boundZSetOps(key).incrementScore(name,score);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Set&lt;String&gt; <span class=\"title function_\">getSort</span><span class=\"params\">(String key, Long start, Long end)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> redisTemplate.boundZSetOps(key).range(start, end);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Double <span class=\"title function_\">getScore</span><span class=\"params\">(String key, String name)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> redisTemplate.boundZSetOps(key).score(name);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Service层\"><a href=\"#Service层\" class=\"headerlink\" title=\"Service层\"></a>Service层</h2><ul>\n<li><strong>Service层接口</strong><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">interface</span> <span class=\"title class_\">SortService</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 点击功能，修改排名,每点击一次，排名分数+1</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> name</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> score</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> <span class=\"title function_\">onClick</span><span class=\"params\">(String name,Double score)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取所有排名</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    Set&lt;String&gt; <span class=\"title function_\">getSort</span><span class=\"params\">()</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 获取单个的排名分数</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> name</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    Double <span class=\"title function_\">getScore</span><span class=\"params\">(String name)</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n<li><strong>Service层实现</strong></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Service</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">SortServiceImpl</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">SortService</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> SortDao sortDao;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"type\">String</span> <span class=\"variable\">KEY</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;sort&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">onClick</span><span class=\"params\">(String name, Double score)</span> &#123;</span><br><span class=\"line\">        sortDao.onClick(KEY,name,score);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Set&lt;String&gt; <span class=\"title function_\">getSort</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> sortDao.getSort(KEY,<span class=\"number\">0L</span>,-<span class=\"number\">1L</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> Double <span class=\"title function_\">getScore</span><span class=\"params\">(String name)</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> sortDao.getScore(KEY,name);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"测试功能\"><a href=\"#测试功能\" class=\"headerlink\" title=\"测试功能\"></a>测试功能</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SpringBootTest</span></span><br><span class=\"line\"><span class=\"meta\">@RunWith(SpringRunner.class)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">SortTest</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> SortService sortService;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> String[] NAME = &#123;<span class=\"string\">&quot;张三&quot;</span>,<span class=\"string\">&quot;李四&quot;</span>,<span class=\"string\">&quot;王五&quot;</span>,<span class=\"string\">&quot;赵六&quot;</span>,<span class=\"string\">&quot;田七&quot;</span>,<span class=\"string\">&quot;孙八&quot;</span>&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Before</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">onClick</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">1000</span>; i++) &#123;</span><br><span class=\"line\">            <span class=\"type\">String</span> <span class=\"variable\">name</span> <span class=\"operator\">=</span> NAME[<span class=\"keyword\">new</span> <span class=\"title class_\">Random</span>().nextInt(<span class=\"number\">6</span>)];</span><br><span class=\"line\">            sortService.onClick(name,-<span class=\"number\">1.0</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        Set&lt;String&gt; set = sortService.getSort();</span><br><span class=\"line\">        <span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (String str : set) &#123;</span><br><span class=\"line\">            <span class=\"type\">Double</span> <span class=\"variable\">score</span> <span class=\"operator\">=</span> sortService.getScore(str);</span><br><span class=\"line\">            System.out.println(<span class=\"string\">&quot;第&quot;</span>+i+<span class=\"string\">&quot;名为：&quot;</span>+str+<span class=\"string\">&quot;排名分数为：&quot;</span>+score);</span><br><span class=\"line\">            i++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"测试结果\"><a href=\"#测试结果\" class=\"headerlink\" title=\"测试结果\"></a>测试结果</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">第<span class=\"number\">1</span>名为：孙八排名分数为：-<span class=\"number\">194.0</span></span><br><span class=\"line\">第<span class=\"number\">2</span>名为：张三排名分数为：-<span class=\"number\">184.0</span></span><br><span class=\"line\">第<span class=\"number\">3</span>名为：赵六排名分数为：-<span class=\"number\">170.0</span></span><br><span class=\"line\">第<span class=\"number\">4</span>名为：田七排名分数为：-<span class=\"number\">153.0</span></span><br><span class=\"line\">第<span class=\"number\">5</span>名为：王五排名分数为：-<span class=\"number\">151.0</span></span><br><span class=\"line\">第<span class=\"number\">6</span>名为：李四排名分数为：-<span class=\"number\">148.0</span></span><br></pre></td></tr></table></figure>\n\n","categories":["Redis"],"tags":["Redis"]},{"title":"Redis持久化","url":"/2020/03/16/redis/Redis%E6%8C%81%E4%B9%85%E5%8C%96/","content":"<h1 id=\"Redis的持久化机制\"><a href=\"#Redis的持久化机制\" class=\"headerlink\" title=\"Redis的持久化机制\"></a>Redis的持久化机制</h1><p>在<a href=\"/2020/02/22/redis/Redis安装及常用命令/\">Redis安装及常用命令</a>已经详细讲解了Redis这款菲关系型数据库，其中Redis比起其他非关系型数据库的优势之一，就是Redis支持数据的持久化机制。</p>\n<span id=\"more\"></span>\n<p>Redis是一个内存数据库，Redis数据库中的所有数据都是以缓存的形式存储在内存中的，当redis服务器重启，或者电脑重启，数据会丢失。<br>为了解决这个问题，我们可以将redis内存中的数据持久化到硬盘中。<br><strong>Redis持久化机制有两种，分别是RDB和AOF。</strong></p>\n<ul>\n<li>RDB：在指定的时间间隔内，如果数据库内的数据达到改变次数，就对数据库进行快照。</li>\n<li>AOF：记录每次对服务器的写操作，当服务器重启时会读取这些命令来恢复数据库的原始数据。<h2 id=\"RDB\"><a href=\"#RDB\" class=\"headerlink\" title=\"RDB\"></a>RDB</h2></li>\n</ul>\n<p><strong>默认方式，不需要进行配置，Redis默认就使用这种持久化机制</strong>，在一定的时间间隔中，检测key的变化情况，然后持久化数据。<br>Redis目录下有一个<code>redis.windows.conf</code>文件，其中有这么一段配置：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">save <span class=\"number\">900</span> <span class=\"number\">1</span>\t\t#<span class=\"number\">15</span>分钟内有<span class=\"number\">1</span>个key值被改变</span><br><span class=\"line\">save <span class=\"number\">300</span> <span class=\"number\">10</span>\t\t#<span class=\"number\">5</span>分钟内有<span class=\"number\">10</span>个key值被改变</span><br><span class=\"line\">save <span class=\"number\">60</span> <span class=\"number\">10000</span>\t#<span class=\"number\">1</span>分钟内有<span class=\"number\">10000</span>个key值被改变</span><br></pre></td></tr></table></figure>\n<p>当Redis数据库满足配置中的要求的时候，Redis服务器就会自动进行持久化，然后会在Redis的目录下生成一个名为<code>dump.rdb</code>的文件。<br>当服务器关闭，下一次重启服务器的时候，服务器就会自动读取<code>dump.rdb</code>中的内容，恢复数据库的原始数据。</p>\n<p><strong>RDB的优点</strong></p>\n<ul>\n<li>RDB 是一个非常紧凑（compact）的文件，它保存了 Redis 在某个时间点上的数据集。 </li>\n<li>这种文件非常适合用于进行备份，非常适用于灾难恢复。</li>\n<li>RDB 可以最大化 Redis 的性能：父进程在保存 RDB 文件时唯一要做的就是 fork 出一个子进程，然后这个子进程就会处理接下来的所有保存工作，父进程无须执行任何磁盘 I/O 操作。RDB 在恢复大数据集时的速度比 AOF 的恢复速度要快。</li>\n</ul>\n<p><strong>RDB的缺点</strong></p>\n<ul>\n<li>RDB操作的时间粒度比较大，如果服务器发生故障，同时Redis的数据非常巨大，那么即便是1秒钟也可能会丢失大量的数据。</li>\n</ul>\n<h2 id=\"AOF\"><a href=\"#AOF\" class=\"headerlink\" title=\"AOF\"></a>AOF</h2><p>日志记录的方式，可以记录每一条命令的操作，可以每一次命令操作后，持久化数据（消耗性能）。<br>在<code>redis.windows.conf</code>文件中，有一个<code>appendonly</code>属性，默认配置为no，如果需要使用AOF持久化机制，那么将<code>appendonly</code>修改为yes即可。<br>同时还应该修改appendfsync属性，设置AOF持久化策略。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">appendonly no\t\t#关闭AOF</span><br><span class=\"line\">#appendonly yes\t\t#开启AOF</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"># appendfsync always\t\t#每一次操作都进行持久化</span><br><span class=\"line\">appendfsync everysec\t\t#每隔一秒进行一次持久化</span><br><span class=\"line\"># appendfsync no\t\t\t#不进行持久化</span><br></pre></td></tr></table></figure>\n<p>如果AOF持久化成功，那么会在Redis目录下生成一个<code>appendonly.aof</code>的文件。该文件作用与<code>dump.rdb</code>相似。</p>\n<p><strong>AOF的优点</strong></p>\n<ul>\n<li>AOF 的默认策略为每秒钟 fsync 一次，在这种配置下，Redis 仍然可以保持良好的性能，并且就算发生故障停机，也最多只会丢失一秒钟的数据（ fsync 会在后台线程执行，所以主线程可以继续努力地处理命令请求）。</li>\n</ul>\n<p><strong>AOF的缺点</strong></p>\n<ul>\n<li>对于相同的数据集来说，AOF 文件的体积通常要大于 RDB 文件的体积。</li>\n</ul>\n<h2 id=\"开启持久化的方式\"><a href=\"#开启持久化的方式\" class=\"headerlink\" title=\"开启持久化的方式\"></a>开启持久化的方式</h2><p>打开cmd命令提示符窗口，进入Redis目录下。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">cd E:\\Program Files\\Redis-x64-<span class=\"number\">3.2</span><span class=\"number\">.100</span></span><br></pre></td></tr></table></figure>\n<p>启动Redis服务器，并<strong>加载配置文件</strong>。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">redis-server.exe redis.windows.conf</span><br></pre></td></tr></table></figure>\n","categories":["Redis"],"tags":["Redis"]},{"title":"SpringBoot使用Redis实现消息订阅","url":"/2020/03/31/redis/SpringBoot%E4%BD%BF%E7%94%A8Redis%E5%AE%9E%E7%8E%B0%E6%B6%88%E6%81%AF%E8%AE%A2%E9%98%85/","content":"<blockquote>\n<p>Redis不仅仅是一个优秀的非关系型缓存数据库，更是内置了一套消息机制。</p>\n</blockquote>\n<span id=\"more\"></span>\n<h2 id=\"关联知识\"><a href=\"#关联知识\" class=\"headerlink\" title=\"关联知识\"></a>关联知识</h2><ul>\n<li><a href=\"/2020/02/22/redis/Redis安装及常用命令/\">Redis安装及常用命令</a></li>\n<li><a href=\"/2020/03/16/redis/Redis持久化/\">Redis持久化</a></li>\n<li><a href=\"/2020/03/19/redis/Redis实现商品秒杀/\">Redis实现商品秒杀</a></li>\n<li><a href=\"/2020/03/19/redis/Redis实现排行榜/\">Redis实现排行榜</a></li>\n</ul>\n<h2 id=\"搭建项目环境\"><a href=\"#搭建项目环境\" class=\"headerlink\" title=\"搭建项目环境\"></a>搭建项目环境</h2><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--SpringBoot为父项目--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.0.4.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--测试功能的启动器，用于整合junit测试功能--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-test<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>test<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!--Spring-Data-Redis的启动器--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建监听者类\"><a href=\"#创建监听者类\" class=\"headerlink\" title=\"创建监听者类\"></a>创建监听者类</h2><p><strong>监听者1</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyListener1</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">MessageListener</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">onMessage</span><span class=\"params\">(Message message, <span class=\"type\">byte</span>[] pattern)</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;MyListener1收到消息：&quot;</span>+message);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;Mylistener1:&quot;</span>+<span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(pattern));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>监听者2</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">MyListener2</span> <span class=\"keyword\">implements</span> <span class=\"title class_\">MessageListener</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">onMessage</span><span class=\"params\">(Message message, <span class=\"type\">byte</span>[] pattern)</span> &#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;MyListener2收到消息：&quot;</span>+message);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;Mylistener2:&quot;</span>+<span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(pattern));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"配置类\"><a href=\"#配置类\" class=\"headerlink\" title=\"配置类\"></a>配置类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"meta\">@EnableCaching</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">CacheConfig</span> <span class=\"keyword\">extends</span> <span class=\"title class_\">CachingConfigurationSelector</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    RedisMessageListenerContainer <span class=\"title function_\">container</span><span class=\"params\">(RedisConnectionFactory connectionFactory,</span></span><br><span class=\"line\"><span class=\"params\">                                            MessageListenerAdapter MyListener1,</span></span><br><span class=\"line\"><span class=\"params\">                                            MessageListenerAdapter MyListener2)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">RedisMessageListenerContainer</span> <span class=\"variable\">container</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">RedisMessageListenerContainer</span>();</span><br><span class=\"line\">        container.setConnectionFactory(connectionFactory);</span><br><span class=\"line\">        <span class=\"comment\">//订阅了一个叫chanel01的通道，这个container可以添加多个messageListener</span></span><br><span class=\"line\">        container.addMessageListener(MyListener1, <span class=\"keyword\">new</span> <span class=\"title class_\">PatternTopic</span>(<span class=\"string\">&quot;Mylistener1&quot;</span>));</span><br><span class=\"line\">        <span class=\"comment\">//订阅了一个叫chanel02的通道</span></span><br><span class=\"line\">        container.addMessageListener(MyListener2, <span class=\"keyword\">new</span> <span class=\"title class_\">PatternTopic</span>(<span class=\"string\">&quot;Mylistener2&quot;</span>));</span><br><span class=\"line\">        <span class=\"keyword\">return</span> container;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    MessageListenerAdapter <span class=\"title function_\">MyListener1</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MessageListenerAdapter</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">MyListener1</span>());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    MessageListenerAdapter <span class=\"title function_\">MyListener2</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">MessageListenerAdapter</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">MyListener2</span>());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> RedisTemplate&lt;String, String&gt; <span class=\"title function_\">redisTemplate</span><span class=\"params\">(RedisConnectionFactory factory)</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">RedisTemplate</span> <span class=\"variable\">template</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">StringRedisTemplate</span>(factory);</span><br><span class=\"line\">        <span class=\"comment\">//定义value的序列化方式</span></span><br><span class=\"line\">        <span class=\"type\">Jackson2JsonRedisSerializer</span> <span class=\"variable\">jackson2JsonRedisSerializer</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Jackson2JsonRedisSerializer</span>(Object.class);</span><br><span class=\"line\">        <span class=\"type\">ObjectMapper</span> <span class=\"variable\">om</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ObjectMapper</span>();</span><br><span class=\"line\">        om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);</span><br><span class=\"line\">        om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);</span><br><span class=\"line\">        jackson2JsonRedisSerializer.setObjectMapper(om);</span><br><span class=\"line\"></span><br><span class=\"line\">        template.setValueSerializer(jackson2JsonRedisSerializer);</span><br><span class=\"line\">        template.setHashKeySerializer(jackson2JsonRedisSerializer);</span><br><span class=\"line\">        template.afterPropertiesSet();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> template;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"测试类发送消息\"><a href=\"#测试类发送消息\" class=\"headerlink\" title=\"测试类发送消息\"></a>测试类发送消息</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SpringBootTest</span></span><br><span class=\"line\"><span class=\"meta\">@RunWith(SpringRunner.class)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">PubSubTest</span> &#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> StringRedisTemplate stringRedisTemplate;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test01</span><span class=\"params\">()</span>&#123;</span><br><span class=\"line\">        stringRedisTemplate.convertAndSend(<span class=\"string\">&quot;Mylistener1&quot;</span>,<span class=\"string\">&quot;Redis发布的第一条消息&quot;</span>);</span><br><span class=\"line\">        stringRedisTemplate.convertAndSend(<span class=\"string\">&quot;Mylistener2&quot;</span>,<span class=\"string\">&quot;Redis发布的第二条消息&quot;</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"测试结果\"><a href=\"#测试结果\" class=\"headerlink\" title=\"测试结果\"></a>测试结果</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">MyListener2收到消息：Redis发布的第二条消息</span><br><span class=\"line\">Mylistener2:Mylistener2</span><br><span class=\"line\">MyListener1收到消息：Redis发布的第一条消息</span><br><span class=\"line\">Mylistener1:Mylistener1</span><br></pre></td></tr></table></figure>\n\n","categories":["Redis"],"tags":["Redis"]},{"title":"一篇博客教会你使用Docker部署Redis哨兵","url":"/2023/06/26/redis/%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2%E6%95%99%E4%BC%9A%E4%BD%A0%E4%BD%BF%E7%94%A8Docker%E9%83%A8%E7%BD%B2Redis%E5%93%A8%E5%85%B5/","content":"<p>今天我们学习使用 <code>Docker</code> 部署 <code>Redis</code> 的主从复制，并部署 <code>Redis</code> 哨兵，实现 <code>Redis</code> 数据库的高可用。</p>\n<span id=\"more\"></span>\n\n<h1 id=\"主数据库\"><a href=\"#主数据库\" class=\"headerlink\" title=\"主数据库\"></a>主数据库</h1><p>如何使用 <code>Docker</code> 下载并启动一个 <code>Redis</code> 实例，我们在以前的博客 <a href=\"/2023/06/05/redis/一篇博客教会你怎么使用Docker安装Redis/\">《一篇博客教会你怎么使用Docker安装Redis》</a> 学习过，在本篇博客中就不过多赘述，有兴趣的同学可以移步到之前的博客学习。</p>\n<h2 id=\"配置文件\"><a href=\"#配置文件\" class=\"headerlink\" title=\"配置文件\"></a>配置文件</h2><p>我们先将准备好的配置文件复制一份。</p>\n<figure class=\"highlight shell\"><figcaption><span>script</span></figcaption><table><tr><td class=\"code\"><pre><span class=\"line\">cp redis.conf redis-master.conf</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"启动实例\"><a href=\"#启动实例\" class=\"headerlink\" title=\"启动实例\"></a>启动实例</h2><p>然后使用 <code>Docker</code> 命令，启动一个 <code>Redis</code> 数据库实例作为主数据库。</p>\n<figure class=\"highlight shell\"><figcaption><span>script</span></figcaption><table><tr><td class=\"code\"><pre><span class=\"line\">docker run -p 6380:6379 --name redis-master -v /etc/redis/redis-master.conf:/etc/redis/redis.conf -d redis redis-server /etc/redis/redis.conf</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"容器虚拟IP\"><a href=\"#容器虚拟IP\" class=\"headerlink\" title=\"容器虚拟IP\"></a>容器虚拟IP</h2><p>使用 <code>Docker</code> 命令，获取 <code>Redis</code> 实例的虚拟 <code>ip</code> 地址</p>\n<figure class=\"highlight shell\"><figcaption><span>script</span></figcaption><table><tr><td class=\"code\"><pre><span class=\"line\">docker inspect --format=&#123;&#123;.NetworkSettings.IPAddress&#125;&#125; redis-master</span><br></pre></td></tr></table></figure>\n\n\n<h1 id=\"从数据库\"><a href=\"#从数据库\" class=\"headerlink\" title=\"从数据库\"></a>从数据库</h1><p>从数据相比较于主数据，需要配置从数据库对应的主数据的信息，即主数据的 <code>ip</code> 和端口，其中的 <code>ip</code> 即上述使用 <code>Docker</code> 命令获取的虚拟 <code>ip</code> 地址，而端口同样也是容器对应的虚拟端口，即为 <code>Docker</code> 容器内部对应的 <code>6379</code>，而不是容器外部的映射端口。</p>\n<h2 id=\"配置文件-1\"><a href=\"#配置文件-1\" class=\"headerlink\" title=\"配置文件\"></a>配置文件</h2><p>将配置文件复制一份，作为从数据库的配置文件。</p>\n<figure class=\"highlight shell\"><figcaption><span>script</span></figcaption><table><tr><td class=\"code\"><pre><span class=\"line\">cp redis.conf redis-slave.conf</span><br></pre></td></tr></table></figure>\n\n<p>在 <code>redis-slave.conf</code> 配置文件的末尾添加主数据库的信息配置。</p>\n<figure class=\"highlight shell\"><figcaption><span>script</span></figcaption><table><tr><td class=\"code\"><pre><span class=\"line\">REPLICAOF 172.17.0.2 6379</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"启动实例-1\"><a href=\"#启动实例-1\" class=\"headerlink\" title=\"启动实例\"></a>启动实例</h2><p>然后使用 <code>Docker</code> 命令，启动三个 <code>Redis</code> 数据库实例作为从数据库。</p>\n<figure class=\"highlight shell\"><figcaption><span>script</span></figcaption><table><tr><td class=\"code\"><pre><span class=\"line\">docker run -p 6381:6379 --name redis-slave1 -v /etc/redis/redis-slave.conf:/etc/redis/redis.conf -d redis redis-server /etc/redis/redis.conf</span><br><span class=\"line\"></span><br><span class=\"line\">docker run -p 6382:6379 --name redis-slave2 -v /etc/redis/redis-slave.conf:/etc/redis/redis.conf -d redis redis-server /etc/redis/redis.conf</span><br><span class=\"line\"></span><br><span class=\"line\">docker run -p 6383:6379 --name redis-slave3 -v /etc/redis/redis-slave.conf:/etc/redis/redis.conf -d redis redis-server /etc/redis/redis.conf</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"主从数据库\"><a href=\"#主从数据库\" class=\"headerlink\" title=\"主从数据库\"></a>主从数据库</h1><p>我们可以使用 <code>Docker</code> 命令进入 <code>Redis</code> 的四个实例中，查看主从关系是否生效。</p>\n<h2 id=\"查看主数据库\"><a href=\"#查看主数据库\" class=\"headerlink\" title=\"查看主数据库\"></a>查看主数据库</h2><p>使用命令查看主数据库的情况，从图中我们可以确认，该 <code>Redis</code> 实例为主数据库，共有三个从数据库。</p>\n<figure class=\"highlight shell\"><figcaption><span>script</span></figcaption><table><tr><td class=\"code\"><pre><span class=\"line\">docker exec -it redis-master bash</span><br><span class=\"line\"></span><br><span class=\"line\">redis-cli</span><br><span class=\"line\"></span><br><span class=\"line\">info Replication</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/images/2023/06/H9TFB97USW0JQQMTNXXTNB.png\" alt=\"主数据库\"></p>\n<h2 id=\"查看从数据库\"><a href=\"#查看从数据库\" class=\"headerlink\" title=\"查看从数据库\"></a>查看从数据库</h2><p>使用命令查看从数据库的情况，从图中我们可以确认，该 <code>Redis</code> 实例为从数据库及该从数据库对应的主数据库的具体信息。</p>\n<figure class=\"highlight shell\"><figcaption><span>script</span></figcaption><table><tr><td class=\"code\"><pre><span class=\"line\">docker exec -it redis-slave1 bash</span><br><span class=\"line\"></span><br><span class=\"line\">redis-cli</span><br><span class=\"line\"></span><br><span class=\"line\">info Replication</span><br></pre></td></tr></table></figure>\n<p><img src=\"/images/2023/06/9Y4K0L5O64_CDJQH72.png\" alt=\"从数据库\"></p>\n<h1 id=\"哨兵\"><a href=\"#哨兵\" class=\"headerlink\" title=\"哨兵\"></a>哨兵</h1><p>我们使用 <code>Docker</code> 启动 <code>Redis</code> 实例作为哨兵。</p>\n<h2 id=\"配置文件-2\"><a href=\"#配置文件-2\" class=\"headerlink\" title=\"配置文件\"></a>配置文件</h2><p>创建 <code>sentinel.conf</code> 文件，并在文件内编辑配置文件内容如下：</p>\n<figure class=\"highlight shell\"><figcaption><span>script</span></figcaption><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">哨兵sentinel实例运行的端口 默认26379</span> </span><br><span class=\"line\">port 26379 </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">哨兵sentinel的工作目录</span> </span><br><span class=\"line\">dir /tmp </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">哨兵sentinel监控的redis主节点的 ip port</span> </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">master-name 可以自己命名的主节点名字 只能由字母A-z、数字0-9 、这三个字符<span class=\"string\">&quot;.-_&quot;</span>组 成。</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">quorum 当这些quorum个数sentinel哨兵认为master主节点失联 那么这时 客观上认为主节点 失联了</span> </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">sentinel monitor &lt;master-name&gt; &lt;ip&gt; &lt;redis-port&gt; &lt;quorum&gt;</span> </span><br><span class=\"line\">sentinel monitor redis-master 172.17.0.2 6379 2</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">当在Redis实例中开启了requirepass foobared 授权密码 这样所有连接Redis实例的客户端都 要提供密码</span> </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">设置哨兵sentinel 连接主从的密码 注意必须为主从设置一样的验证密码</span> </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">sentinel auth-pass &lt;master-name&gt; &lt;password&gt;</span> </span><br><span class=\"line\">sentinel auth-pass redis-master &quot;&quot;</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">指定多少毫秒之后 主节点没有应答哨兵sentinel 此时 哨兵主观上认为主节点下线 默认30秒</span> </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">sentinel down-after-milliseconds &lt;master-name&gt; &lt;milliseconds&gt;</span> </span><br><span class=\"line\">sentinel down-after-milliseconds redis-master 30000 </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">这个配置项指定了在发生failover主备切换时最多可以有多少个slave同时对新的master进行同步</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">这个数字越小，完成failover所需的时间就越长，但是如果这个数字越大，就意味着越多的slave因为replication而不可用。</span> </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">可以通过将这个值设为 1 来保证每次只有一个slave 处于不能处理命令请求的状态。</span> </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">sentinel parallel-syncs &lt;master-name&gt; &lt;numslaves&gt;</span></span><br><span class=\"line\">sentinel parallel-syncs redis-master 1</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">故障转移的超时时间 failover-timeout 可以用在以下这些方面：</span> </span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">1. 同一个sentinel对同一个master两次failover之间的间隔时间。</span> </span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">2. 当一个slave从一个错误的master那里同步数据开始计算时间。直到slave被纠正为向正确的 master那里同步数据时。</span> </span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">3.当想要取消一个正在进行的failover所需要的时间。</span> </span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">4.当进行failover时，配置所有slaves指向新的master所需的最大时间。不过，即使过了这个超 时，slaves依然会被正确配置为指向master，但是就不按parallel-syncs所配置的规则来了</span> </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">默认三分钟</span> </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">sentinel failover-timeout &lt;master-name&gt; &lt;milliseconds&gt;</span> </span><br><span class=\"line\">sentinel failover-timeout redis-master 180000</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">SCRIPTS EXECUTION</span> </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">配置当某一事件发生时所需要执行的脚本，可以通过脚本来通知管理员，例如当系统运行不正常时发邮 件通知相关人员。</span> </span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">对于脚本的运行结果有以下规则：</span> </span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">若脚本执行后返回1，那么该脚本稍后将会被再次执行，重复次数目前默认为10</span> </span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">若脚本执行后返回2，或者比2更高的一个返回值，脚本将不会重复执行。</span> </span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">如果脚本在执行过程中由于收到系统中断信号被终止了，则同返回值为1时的行为相同。</span> </span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">一个脚本的最大执行时间为60s，如果超过这个时间，脚本将会被一个SIGKILL信号终止，之后重新执 行。</span></span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">通知型脚本:当sentinel有任何警告级别的事件发生时（比如说redis实例的主观失效和客观失效等 等），将会去调用这个脚本，</span></span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">这时这个脚本应该通过邮件，SMS等方式去通知系统管理员关于系统不正 常运行的信息。调用该脚本时，将传给脚本两个参数，一个是事件的类型，一个是事件的描述。</span> </span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">如果sentinel.conf配置文件中配置了这个脚本路径，那么必须保证这个脚本存在于这个路径，并且 是可执行的，否则sentinel无法正常启动成功。</span></span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">通知脚本</span> </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">sentinel notification-script &lt;master-name&gt; &lt;script-path&gt;</span> </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">sentinel notification-script mymaster /var/redis/notify.sh</span></span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">客户端重新配置主节点参数脚本</span> </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">当一个master由于failover而发生改变时，这个脚本将会被调用，通知相关的客户端关于master 地址已经发生改变的信息。</span> </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">以下参数将会在调用脚本时传给脚本:</span> </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">&lt;master-name&gt; &lt;role&gt; &lt;state&gt; &lt;from-ip&gt; &lt;from-port&gt; &lt;to-ip&gt; &lt;to-port&gt;</span> </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">目前&lt;state&gt;总是“failover”,</span> </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">&lt;role&gt;是“leader”或者“observer”中的一个。</span> </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">参数 from-ip, from-port, to-ip, to-port是用来和旧的master和新的master(即旧的 slave)通信的</span> </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">这个脚本应该是通用的，能被多次调用，不是针对性的。</span> </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">sentinel client-reconfig-script &lt;master-name&gt; &lt;script-path&gt;</span> </span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">sentinel client-reconfig-script mymaster /var/redis/reconfig.sh</span></span><br></pre></td></tr></table></figure>\n\n<p>哨兵的配置文件内容较多，需要注意以下几点：</p>\n<ul>\n<li><p>sentinel monitor redis-master 172.17.0.2 6379 2<br>该配置为 <code>Redis</code> 主数据库的 <code>ip</code> 和端口，需要将其修改为自己启动的 <code>Redis</code> 主数据库的 <code>ip</code> 和端口。<br>最后一个参数为哨兵投票成功的个数，不要大于哨兵的总实例个数。</p>\n</li>\n<li><p>sentinel auth-pass redis-master “”<br>该配置为 <code>Redis</code> 主数据库的密码，如果没有，使用空串即可；如果有，需要配置密码，注意必须为主从数据库设置一样的验证密码</p>\n</li>\n<li><p>sentinel down-after-milliseconds redis-master 30000<br>该配置为哨兵认为主数据库下线的时间，即主数据库下线或宕机之后 30000 毫秒，哨兵会主观认为主数据库真正下线。</p>\n</li>\n</ul>\n<h2 id=\"启动哨兵\"><a href=\"#启动哨兵\" class=\"headerlink\" title=\"启动哨兵\"></a>启动哨兵</h2><p>然后使用 <code>Docker</code> 命令，启动三个 <code>Redis</code> 数据库实例作为哨兵。</p>\n<figure class=\"highlight shell\"><figcaption><span>script</span></figcaption><table><tr><td class=\"code\"><pre><span class=\"line\">docker run -p 26379:26379 --name redis-sentinel1 -v /etc/redis/sentinel.conf:/etc/redis/sentinel.conf -d redis redis-sentinel /etc/redis/sentinel.conf</span><br><span class=\"line\"></span><br><span class=\"line\">docker run -p 26380:26379 --name redis-sentinel2 -v /etc/redis/sentinel.conf:/etc/redis/sentinel.conf -d redis redis-sentinel /etc/redis/sentinel.conf</span><br><span class=\"line\"></span><br><span class=\"line\">docker run -p 26381:26379 --name redis-sentinel3 -v /etc/redis/sentinel.conf:/etc/redis/sentinel.conf -d redis redis-sentinel /etc/redis/sentinel.conf</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"查看哨兵\"><a href=\"#查看哨兵\" class=\"headerlink\" title=\"查看哨兵\"></a>查看哨兵</h2><p>使用命令查看哨兵的情况，从图中我们可以确认，该 <code>Redis</code> 哨兵已经启动成功，并获取了主数据库，从数据库，其他哨兵的信息。</p>\n<figure class=\"highlight shell\"><figcaption><span>script</span></figcaption><table><tr><td class=\"code\"><pre><span class=\"line\">docker logs -f redis-sentinel1</span><br></pre></td></tr></table></figure>\n<p><img src=\"/images/2023/06/XI_XVW_3I0780HDMD9AU.png\" alt=\"哨兵\"></p>\n<p>或者我们可以使用其他命令，进入哨兵实例的内部，查看实例信息，从图中我们可以看出，该 <code>Redis</code> 哨兵启动状态成功，其中有主数据库地址为 <code>172.17.0.2:6379</code>，从数据库3个，哨兵3个。</p>\n<figure class=\"highlight shell\"><figcaption><span>script</span></figcaption><table><tr><td class=\"code\"><pre><span class=\"line\">docker exec -it redis-sentinel1 bash</span><br><span class=\"line\"></span><br><span class=\"line\">redis-cli -p 26379</span><br><span class=\"line\"></span><br><span class=\"line\">info Sentinel</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/images/2023/06/V34I65KSQDCG76IGCCO_C.png\" alt=\"哨兵1\"></p>\n<h1 id=\"哨兵机制\"><a href=\"#哨兵机制\" class=\"headerlink\" title=\"哨兵机制\"></a>哨兵机制</h1><h2 id=\"哨兵选举\"><a href=\"#哨兵选举\" class=\"headerlink\" title=\"哨兵选举\"></a>哨兵选举</h2><p>我们使用 <code>Docker</code> 将 <code>Redis</code> 主数据库实例停止运行，模拟出主数据库因为意外情况下线或者宕机的情况。</p>\n<figure class=\"highlight shell\"><figcaption><span>script</span></figcaption><table><tr><td class=\"code\"><pre><span class=\"line\">docker stop redis-master</span><br></pre></td></tr></table></figure>\n\n<p>等候大约 30000 毫秒左右的时间，我们重新查看哨兵的情况。</p>\n<figure class=\"highlight shell\"><figcaption><span>script</span></figcaption><table><tr><td class=\"code\"><pre><span class=\"line\">docker exec -it redis-sentinel1 bash</span><br><span class=\"line\"></span><br><span class=\"line\">redis-cli -p 26379</span><br><span class=\"line\"></span><br><span class=\"line\">info Sentinel</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/images/2023/06/EONIQZUG_ULJIQIVJ3.png\" alt=\"哨兵1\"></p>\n<p>第一个 <code>info Sentinel</code> 是因为时间还没有达到 30000 毫秒之后，哨兵还没有主观判断主数据库下线，而等候 30000 毫秒之后，数据库下线，于是哨兵自动从 3 个从数据库中选举了一个作为新的主数据库。</p>\n<h2 id=\"选举日志\"><a href=\"#选举日志\" class=\"headerlink\" title=\"选举日志\"></a>选举日志</h2><p>我们可以使用命令查看日志，查看哨兵的选举过程。</p>\n<figure class=\"highlight shell\"><figcaption><span>script</span></figcaption><table><tr><td class=\"code\"><pre><span class=\"line\">docker logs -f redis-sentinel1</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/images/2023/06/TL60LGK95OUSZFUWO9CH.png\" alt=\"哨兵1\"></p>\n<p>日志解读：</p>\n<figure class=\"highlight shell\"><figcaption><span>script</span></figcaption><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">主数据库 172.17.0.2 6379 下线了</span></span><br><span class=\"line\">1:X 26 Jun 2023 13:46:29.680 # +sdown master redis-master 172.17.0.2 6379</span><br><span class=\"line\">1:X 26 Jun 2023 13:46:29.823 # Could not rename tmp config file (Device or resource busy)</span><br><span class=\"line\">1:X 26 Jun 2023 13:46:29.823 # WARNING: Sentinel was not able to save the new configuration on disk!!!: Device or resource busy</span><br><span class=\"line\">1:X 26 Jun 2023 13:46:29.823 # +new-epoch 1</span><br><span class=\"line\">1:X 26 Jun 2023 13:46:29.825 # Could not rename tmp config file (Device or resource busy)</span><br><span class=\"line\">1:X 26 Jun 2023 13:46:29.825 # WARNING: Sentinel was not able to save the new configuration on disk!!!: Device or resource busy</span><br><span class=\"line\">1:X 26 Jun 2023 13:46:29.825 # +vote-for-leader 07a74f95d2f3284e2bcbd34bac98b29e527d5878 1</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">等待了 30000 毫秒之后（注意日志时间），3 个哨兵判断主数据库下线，超过了配置的 2 个哨兵，哨兵主观确定主数据库下线</span></span><br><span class=\"line\">1:X 26 Jun 2023 13:46:30.842 # +odown master redis-master 172.17.0.2 6379 #quorum 3/2</span><br><span class=\"line\">1:X 26 Jun 2023 13:46:30.842 # Next failover delay: I will not start a failover before Mon Jun 26 13:52:29 2023</span><br><span class=\"line\">1:X 26 Jun 2023 13:46:31.039 # +config-update-from sentinel 07a74f95d2f3284e2bcbd34bac98b29e527d5878 172.17.0.8 26379 @ redis-master 172.17.0.2 6379</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">切换已下线的主数据库 172.17.0.2 6379，选举 172.17.0.5 6379 为新的主数据库</span></span><br><span class=\"line\">1:X 26 Jun 2023 13:46:31.039 # +switch-master redis-master 172.17.0.2 6379 172.17.0.5 6379</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">重新构建主从关系</span></span><br><span class=\"line\">1:X 26 Jun 2023 13:46:31.040 * +slave slave 172.17.0.4:6379 172.17.0.4 6379 @ redis-master 172.17.0.5 6379</span><br><span class=\"line\">1:X 26 Jun 2023 13:46:31.040 * +slave slave 172.17.0.3:6379 172.17.0.3 6379 @ redis-master 172.17.0.5 6379</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">重新构建主从关系，原本的主数据库 172.17.0.2 6379 被降为从数据库</span></span><br><span class=\"line\">1:X 26 Jun 2023 13:46:31.040 * +slave slave 172.17.0.2:6379 172.17.0.2 6379 @ redis-master 172.17.0.5 6379</span><br><span class=\"line\">1:X 26 Jun 2023 13:46:31.044 # Could not rename tmp config file (Device or resource busy)</span><br><span class=\"line\">1:X 26 Jun 2023 13:46:31.044 # WARNING: Sentinel was not able to save the new configuration on disk!!!: Device or resource busy</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">从库 172.17.0.2 6379 下线（但是不影响主库和其他从库和哨兵）</span></span><br><span class=\"line\">1:X 26 Jun 2023 13:47:01.083 # +sdown slave 172.17.0.2:6379 172.17.0.2 6379 @ redis-master 172.17.0.5 6379</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"重启主数据库\"><a href=\"#重启主数据库\" class=\"headerlink\" title=\"重启主数据库\"></a>重启主数据库</h2><p>重新启动原本的主数据库</p>\n<figure class=\"highlight shell\"><figcaption><span>script</span></figcaption><table><tr><td class=\"code\"><pre><span class=\"line\">docker start redis-master</span><br></pre></td></tr></table></figure>\n\n<p>查看原本的主数据的信息：</p>\n<figure class=\"highlight shell\"><figcaption><span>script</span></figcaption><table><tr><td class=\"code\"><pre><span class=\"line\">docker exec -it redis-master bash</span><br><span class=\"line\"></span><br><span class=\"line\">redis-cli</span><br><span class=\"line\"></span><br><span class=\"line\">info Replication</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/images/2023/06/8F2HYQ8OLSIBY6YU5R31.png\" alt=\"主数据库重启\"></p>\n<p>我们可以看到原本的主数据在宕机后重新启动，已经彻底变成了从数据库。</p>\n","categories":["Redis"],"tags":["Redis","Linux","Docker"]},{"title":"一篇博客教会你怎么使用Docker安装Redis","url":"/2023/06/05/redis/%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2%E6%95%99%E4%BC%9A%E4%BD%A0%E6%80%8E%E4%B9%88%E4%BD%BF%E7%94%A8Docker%E5%AE%89%E8%A3%85Redis/","content":"<p>今天我们学习使用 <code>Docker</code> 安装 <code>Redis</code>。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"1、搜索镜像\"><a href=\"#1、搜索镜像\" class=\"headerlink\" title=\"1、搜索镜像\"></a>1、搜索镜像</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker search redis</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2、拉取镜像\"><a href=\"#2、拉取镜像\" class=\"headerlink\" title=\"2、拉取镜像\"></a>2、拉取镜像</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker pull redis</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3、下载配置文件\"><a href=\"#3、下载配置文件\" class=\"headerlink\" title=\"3、下载配置文件\"></a>3、下载配置文件</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">wget http://download.redis.io/redis-stable/redis.conf</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>下载的配置文件必须要和拉取的 redis 镜像版本一致，这样才能避免 Docker 容器启动的时候出现意外的错误，导致容器启动失败。</p>\n<p>可以使用 <code>docker image inspect redis:latest</code> 命令，查询 redis 镜像对应的 redis 版本号。</p>\n<p>从下图可以看出拉取的 redis 版本为 <code>7.0.11</code>。</p>\n</blockquote>\n<p><img src=\"/images/2023/06/image-20230605222824456.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"4、修改配置文件\"><a href=\"#4、修改配置文件\" class=\"headerlink\" title=\"4、修改配置文件\"></a>4、修改配置文件</h2><ul>\n<li>注释bind 127.0.0.1 -::1</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\"><span class=\"built_in\">bind</span> 127.0.0.1 -::1</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>关闭保护模式</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">protected-mode no</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>开启持久化</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">appendonly yes</span><br></pre></td></tr></table></figure>\n\n\n\n<h2 id=\"5、启动容器\"><a href=\"#5、启动容器\" class=\"headerlink\" title=\"5、启动容器\"></a>5、启动容器</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker run -p 6379:6379 --name redis -v /etc/redis/redis.conf:/etc/redis/redis.conf -d redis redis-server /etc/redis/redis.conf</span><br></pre></td></tr></table></figure>\n\n","categories":["Redis"],"tags":["Redis","Linux","Docker"]},{"title":"Git的安装&IDEA整合Git","url":"/2020/02/16/tool/Git%E7%9A%84%E5%AE%89%E8%A3%85&IDEA%E6%95%B4%E5%90%88Git/","content":"<p>Git是一个开源的分布式版本控制系统，可以有效、高速地处理从很小到非常大的项目版本管理。<br>也是Linus Torvalds为了帮助管理Linux内核开发而开发的一个开放源码的版本控制软件。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"1、下载与安装Git\"><a href=\"#1、下载与安装Git\" class=\"headerlink\" title=\"1、下载与安装Git\"></a>1、下载与安装Git</h2><h3 id=\"第一种方法\"><a href=\"#第一种方法\" class=\"headerlink\" title=\"第一种方法\"></a>第一种方法</h3><p>官网：<a href=\"https://git-scm.com/downloads\">https://git-scm.com/downloads</a><br><img src=\"/images/2020/02/20200216200615234.png\" alt=\"在这里插入图片描述\">但是官网的下载速度非常慢，我试了几次都下载失败。</p>\n<h3 id=\"第二种方法\"><a href=\"#第二种方法\" class=\"headerlink\" title=\"第二种方法\"></a>第二种方法</h3><p>电脑管家，没错，就是腾讯电脑管家，无意中发现在电脑管家的软件市场里面竟然有Git这个软件，而且——<strong>下载速度非常快</strong>【重点】<br><img src=\"/images/2020/02/20200216200924932.png\" alt=\"在这里插入图片描述\"></p>\n<h3 id=\"第三种方法\"><a href=\"#第三种方法\" class=\"headerlink\" title=\"第三种方法\"></a>第三种方法</h3><p>我在自己的百度网盘中上传了Git的软件安装包，需要的可以去下载。<br><strong>链接</strong>：<a href=\"https://pan.baidu.com/s/1nBZHt0mBhFZadLSm2PYsXQ\">https://pan.baidu.com/s/1nBZHt0mBhFZadLSm2PYsXQ</a><br><strong>提取码</strong>：enhm </p>\n<h3 id=\"Git的安装\"><a href=\"#Git的安装\" class=\"headerlink\" title=\"Git的安装\"></a>Git的安装</h3><p>Git的安装非常简单，直接一路<strong>next</strong>就可以了，傻瓜式安装。<br>如果安装成功，打开cmd命令控制台，输入<strong>git –version</strong>即可查看到安装的git的版本。<br><img src=\"/images/2020/02/20200216201557805.png\" alt=\"在这里插入图片描述\"></p>\n<p>如上图，说明安装成功！</p>\n<h2 id=\"2、Git的配置\"><a href=\"#2、Git的配置\" class=\"headerlink\" title=\"2、Git的配置\"></a>2、Git的配置</h2><h3 id=\"配置全局用户名和密码\"><a href=\"#配置全局用户名和密码\" class=\"headerlink\" title=\"配置全局用户名和密码\"></a>配置全局用户名和密码</h3><p>安装成功后，随便在任何目录中点击鼠标右键，发现右键目录栏中多出了两栏。<br><img src=\"/images/2020/02/20200216202052724.png\" alt=\"在这里插入图片描述\"></p>\n<p>点击<strong>Git Bash Here</strong>，就会进入Git的命令窗口，如下图：<br><img src=\"/images/2020/02/20200216202402590.png\" alt=\"在这里插入图片描述\"></p>\n<p>我们在这个命令窗口中先配置一下全局用户名和邮箱，可以直接使用GitHub注册的账号的用户名和邮箱，命令如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">git config --global user.name <span class=\"string\">&quot;your_name&quot;</span>  </span><br><span class=\"line\">git config --global user.email <span class=\"string\">&quot;your_email@youremail.com&quot;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"配置秘钥\"><a href=\"#配置秘钥\" class=\"headerlink\" title=\"配置秘钥\"></a>配置秘钥</h3><p>配置完全局用户名和邮箱，应该在生成一下Git的秘钥。<br>说到秘钥，就需要解释一下秘钥的作用了。</p>\n<p>Git是一个远程仓库托管工具，可以远程链接云仓库上传自己的代码或资料，而像github，码云这些托管平台，一般使用两种协议进行数据传输，分别是https和ssh，其中使用https协议提交代码需要用户名和密码，而使用ssh协议则不需要用户名和密码，但是需要秘钥。<br>总的来说，秘钥主要就是用于ssh协议传输的时候使用的授权工具。</p>\n<p>在Git命令窗口输入命令。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">ssh-keygen -t rsa -C <span class=\"string\">&quot;your_email@youremail.com&quot;</span></span><br></pre></td></tr></table></figure>\n<p>输入完整命令，秘钥会自动生成在电脑用户目录下的.ssh文件中。<br><img src=\"/images/2020/02/20200216203921810.png\" alt=\"在这里插入图片描述\"></p>\n<h3 id=\"github配置公钥\"><a href=\"#github配置公钥\" class=\"headerlink\" title=\"github配置公钥\"></a>github配置公钥</h3><p>我们先打开github网站，登录自己的账号，点击右上角的头像，就会有选项栏下拉，选择<strong>Settings</strong>。<br><img src=\"/images/2020/02/20200216204649687.png\" alt=\"在这里插入图片描述\"><br><img src=\"/images/2020/02/20200216205209368.png\" alt=\"在这里插入图片描述\"><br><img src=\"/images/2020/02/20200216205647937.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"3、IDEA整合Git及使用\"><a href=\"#3、IDEA整合Git及使用\" class=\"headerlink\" title=\"3、IDEA整合Git及使用\"></a>3、IDEA整合Git及使用</h2><h3 id=\"IDEA整合Git\"><a href=\"#IDEA整合Git\" class=\"headerlink\" title=\"IDEA整合Git\"></a>IDEA整合Git</h3><p><img src=\"/images/2020/02/20200216210721164.png\" alt=\"在这里插入图片描述\"></p>\n<h3 id=\"在IDEA中使用Git并上传文件\"><a href=\"#在IDEA中使用Git并上传文件\" class=\"headerlink\" title=\"在IDEA中使用Git并上传文件\"></a>在IDEA中使用Git并上传文件</h3><p>第一步，先创建一个Git本地仓库。<br><img src=\"/images/2020/02/2020021621132882.png\" alt=\"在这里插入图片描述\"><br><img src=\"/images/2020/02/20200216211335883.png\" alt=\"在这里插入图片描述\"></p>\n<p>在选择仓库目录的时候，选择项目所在的目录，点击OK。同时在该目录下生成.git文件，说明仓库创建成功。<br><img src=\"/images/2020/02/20200216211536120.png\" alt=\"在这里插入图片描述\"></p>\n<p>同时在IDEA的右上角会出现几个和Git相关的图标。<br><img src=\"/images/2020/02/20200216211722395.png\" alt=\"在这里插入图片描述\"><br><img src=\"/images/2020/02/20200216212352242.png\" alt=\"在这里插入图片描述\"></p>\n<h3 id=\"上传文件\"><a href=\"#上传文件\" class=\"headerlink\" title=\"上传文件\"></a>上传文件</h3><p>点击COMMIT后，Git会将文件提交到本地仓库中，我们还需要远程将文件推送到远程仓库中。<br><img src=\"/images/2020/04/2020040411452756.png\" alt=\"在这里插入图片描述\"></p>\n<p>创建仓库之后，VCS的目录也发生了变化，我们点击Git-&gt;Push。<br>如果是第一次和远程仓库建立链接，那么需要输入远程仓库的地址。<br><img src=\"/images/2020/02/20200216213318728.png\" alt=\"在这里插入图片描述\"></p>\n<p>最后，我们点击最下面的PUSH，就可以将之前添加到本地仓库中的所有文件推送到远程仓库中去了。</p>\n","categories":["开发工具"],"tags":["IDEA","Git"]},{"title":"IDEA 插件 Alibaba Cloud Toolkit，一键部署前后端项目","url":"/2021/05/31/tool/IDEA%20%E6%8F%92%E4%BB%B6%20Alibaba%20Cloud%20Toolkit%EF%BC%8C%E4%B8%80%E9%94%AE%E9%83%A8%E7%BD%B2%E5%89%8D%E5%90%8E%E7%AB%AF%E9%A1%B9%E7%9B%AE/","content":"<h1 id=\"Alibaba-Cloud-Toolkit\"><a href=\"#Alibaba-Cloud-Toolkit\" class=\"headerlink\" title=\"Alibaba Cloud Toolkit\"></a>Alibaba Cloud Toolkit</h1><p>Alibaba Cloud Toolkit，顾名思义，这是一个由阿里开发的，用于快速部署云服务项目的 IDEA 插件工具。<br>使用该插件，可以在本地直接一键部署项目到云端服务器。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"下载-IDEA-插件\"><a href=\"#下载-IDEA-插件\" class=\"headerlink\" title=\"下载 IDEA 插件\"></a>下载 IDEA 插件</h2><p>File -&gt; Settings -&gt; Plugins</p>\n<p>在插件的搜索栏输入 <code>Alibaba Cloud Toolkit</code>，下载、安装、重启 IDEA 即可。</p>\n<p><img src=\"/images/2021/05/20210531231020147.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"配置云端服务器\"><a href=\"#配置云端服务器\" class=\"headerlink\" title=\"配置云端服务器\"></a>配置云端服务器</h2><p>这里的云端服务器，可以是真正的云端服务器，比如阿里云服务器，腾讯云服务器等等，也可以是自己本地上的虚拟机服务器。</p>\n<p>在 IDEA 的侧边或者底部的标签上可以找到一个 <code>Alibaba Cloud View</code> 的标签，打开该标签即可。</p>\n<p><img src=\"/images/2021/05/20210531232711449.png\" alt=\"在这里插入图片描述\"></p>\n<p>在该标签栏中点击右上角的 <code>Add Host</code> 按钮，按照自己的配置信息进行配置即可。</p>\n<p><img src=\"/images/2021/05/20210531233029430.png\" alt=\"在这里插入图片描述\"><br>配置完主机信息，就会在标签页面形成一条主机记录，点击记录的 <code>Upload</code>  按钮，配置上传文件的属性。</p>\n<p><img src=\"/images/2021/05/20210531233204440.png\" alt=\"在这里插入图片描述\"></p>\n<p><img src=\"/images/2021/05/20210531233526517.png\" alt=\"在这里插入图片描述\"><br>在后续的开发过程中，只要更新了新的 <code>jar</code> 包之后，直接使用 <code>Upload</code> 按钮，即可直接一键部署项目到云端服务器。<br>前端项目也是同样的步骤和原理。</p>\n<p>到此为止，使用 Alibaba Cloud Toolkit 插件工具来一键部署项目就完成了，在文章末尾，附带前后端项目部署的 <code>sh</code> 脚本文件。</p>\n<h2 id=\"sh-脚本文件\"><a href=\"#sh-脚本文件\" class=\"headerlink\" title=\"sh 脚本文件\"></a>sh 脚本文件</h2><h3 id=\"后端项目部署脚本\"><a href=\"#后端项目部署脚本\" class=\"headerlink\" title=\"后端项目部署脚本\"></a>后端项目部署脚本</h3><ul>\n<li>spring-boot.sh<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">服务名称</span></span><br><span class=\"line\">SERVICE_NAME=zero-admin</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">项目路径</span></span><br><span class=\"line\">SERVICE_DIR=/usr/web-project/zero-admin</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">日志文件</span></span><br><span class=\"line\">LOG_FILE=$&#123;SERVICE_DIR&#125;/log.log</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">jar名称</span></span><br><span class=\"line\">JAR_NAME=zero-web-1\\.0-SNAPSHOT\\.jar</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">进程文件名称</span></span><br><span class=\"line\">PID_FILE=$&#123;SERVICE_NAME&#125;\\.pid</span><br><span class=\"line\"></span><br><span class=\"line\">help()&#123;</span><br><span class=\"line\">  echo &quot;=== spring-boot shell help start ===&quot;</span><br><span class=\"line\">  echo &quot;start 启动服务&quot;</span><br><span class=\"line\">  echo &quot;stop 停止服务&quot;</span><br><span class=\"line\">  echo &quot;restart 重启服务&quot;</span><br><span class=\"line\">  echo &quot;===  spring-boot shell help end  ===&quot;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">start()&#123;</span><br><span class=\"line\">  if [ ! -x $&#123;JAR_NAME&#125; ]</span><br><span class=\"line\">  then</span><br><span class=\"line\">    echo &quot;=== $&#123;JAR_NAME&#125;添加可执行权限 ===&quot;</span><br><span class=\"line\">    chmod +x $&#123;JAR_NAME&#125;</span><br><span class=\"line\">  fi</span><br><span class=\"line\">  nohup java -Dfile.encoding=UTF-8 -jar $&#123;JAR_NAME&#125; --spring.profiles.active=prod &gt;$&#123;LOG_FILE&#125; 2&gt;&amp;1 &amp;</span><br><span class=\"line\">  echo $! &gt; $&#123;SERVICE_DIR&#125;/$&#123;PID_FILE&#125;</span><br><span class=\"line\">\techo &quot;=== 服务$&#123;SERVICE_NAME&#125;已启动 ===&quot;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">stop()&#123;</span><br><span class=\"line\">  P_ID=$(cat $&#123;SERVICE_DIR&#125;/$&#123;PID_FILE&#125;)</span><br><span class=\"line\">  if [ &quot;$&#123;P_ID&#125;&quot; == &quot;&quot; ]</span><br><span class=\"line\">  then</span><br><span class=\"line\">    echo &quot;=== 服务$&#123;SERVICE_NAME&#125;不存在或者已停止 ===&quot;</span><br><span class=\"line\">  else</span><br><span class=\"line\">    kill &quot;$&#123;P_ID&#125;&quot;</span><br><span class=\"line\">    rm -rf $&#123;SERVICE_DIR&#125;/$&#123;PID_FILE&#125;</span><br><span class=\"line\">    echo &quot;=== 服务$&#123;SERVICE_NAME&#125;已停止 ===&quot;</span><br><span class=\"line\">  fi</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">restart()&#123;</span><br><span class=\"line\">  stop</span><br><span class=\"line\">  sleep 2</span><br><span class=\"line\">  start</span><br><span class=\"line\">  echo &quot;=== 服务$&#123;SERVICE_NAME&#125;已重启 ===&quot;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">cd $&#123;SERVICE_DIR&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">case $&#123;1&#125; in</span><br><span class=\"line\">    &quot;&quot;)</span><br><span class=\"line\">      echo &quot;=== 参数错误 ===&quot;</span><br><span class=\"line\">        ;;</span><br><span class=\"line\">    help)</span><br><span class=\"line\">      help</span><br><span class=\"line\">        ;;</span><br><span class=\"line\">    start)</span><br><span class=\"line\">      start</span><br><span class=\"line\">        ;;</span><br><span class=\"line\">    stop)</span><br><span class=\"line\">     \tstop</span><br><span class=\"line\">        ;;</span><br><span class=\"line\">    restart)</span><br><span class=\"line\">      restart</span><br><span class=\"line\">        ;;</span><br><span class=\"line\">    *)</span><br><span class=\"line\">      help</span><br><span class=\"line\">        ;;</span><br><span class=\"line\">esac</span><br><span class=\"line\"></span><br><span class=\"line\">exit 0</span><br></pre></td></tr></table></figure>\n\n\n</li>\n</ul>\n<h3 id=\"前端项目部署脚本\"><a href=\"#前端项目部署脚本\" class=\"headerlink\" title=\"前端项目部署脚本\"></a>前端项目部署脚本</h3><ul>\n<li>vue-app.sh</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">VueApp的项目目录</span></span><br><span class=\"line\">VUE_APP_DIR=/usr/web-project/zero-admin/dist</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">Docker 停止 nginx 服务</span></span><br><span class=\"line\">docker stop nginx</span><br><span class=\"line\">sleep 2</span><br><span class=\"line\">docker cp $&#123;VUE_APP_DIR&#125; nginx:$&#123;VIE_APP_DIR&#125;</span><br><span class=\"line\">docker start nginx</span><br><span class=\"line\">exit 0</span><br></pre></td></tr></table></figure>\n\n","categories":["开发工具"],"tags":["IDEA","Alibaba"]},{"title":"IDEA数据库集成管理工具Database的使用","url":"/2020/07/23/tool/IDEA%E6%95%B0%E6%8D%AE%E5%BA%93%E9%9B%86%E6%88%90%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7Database%E7%9A%84%E4%BD%BF%E7%94%A8/","content":"<blockquote>\n<p>最近重新安装了一个新的IDEA，新的开发工具，自然带给人新的生活和心情，今天我们来学习使用IDEA自带的数据库集成管理工具Database的使用。</p>\n</blockquote>\n<span id=\"more\"></span>\n\n<h2 id=\"一、打开Database\"><a href=\"#一、打开Database\" class=\"headerlink\" title=\"一、打开Database\"></a>一、打开Database</h2><p><img src=\"/images/2020/07/20200723215200316.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"二、配置Database\"><a href=\"#二、配置Database\" class=\"headerlink\" title=\"二、配置Database\"></a>二、配置Database</h2><p>首先，我们需要根据我们所使用的数据库类型来选择数据源，因为作者常用的数据库为MySQL，所以在博客中就以MySQL作为例子来进行配置。</p>\n<h3 id=\"2-1、选择数据库\"><a href=\"#2-1、选择数据库\" class=\"headerlink\" title=\"2.1、选择数据库\"></a>2.1、选择数据库</h3><p><img src=\"/images/2020/07/20200723215358424.png\" alt=\"在这里插入图片描述\"></p>\n<h3 id=\"2-2、配置数据库连接信息\"><a href=\"#2-2、配置数据库连接信息\" class=\"headerlink\" title=\"2.2、配置数据库连接信息\"></a>2.2、配置数据库连接信息</h3><p><img src=\"/images/2020/07/20200723220359941.png\" alt=\"在这里插入图片描述\"></p>\n<h3 id=\"2-3、下载数据库驱动\"><a href=\"#2-3、下载数据库驱动\" class=\"headerlink\" title=\"2.3、下载数据库驱动\"></a>2.3、下载数据库驱动</h3><p><img src=\"/images/2020/07/20200723220359876.png\" alt=\"在这里插入图片描述\"></p>\n<h3 id=\"2-4、下载中……\"><a href=\"#2-4、下载中……\" class=\"headerlink\" title=\"2.4、下载中……\"></a>2.4、下载中……</h3><p><img src=\"/images/2020/07/20200723220359308.png\" alt=\"在这里插入图片描述\"></p>\n<h3 id=\"2-5、报错\"><a href=\"#2-5、报错\" class=\"headerlink\" title=\"2.5、报错\"></a>2.5、报错</h3><p>下载驱动成功后，我们点击测试按钮，结果爆出一个错误：</p>\n<blockquote>\n<p>Server returns invalid timezone. Need to set ‘serverTimezone’ property.</p>\n</blockquote>\n<p><img src=\"/images/2020/07/20200723221047682.png\" alt=\"在这里插入图片描述\"></p>\n<h3 id=\"2-6、解决爆错\"><a href=\"#2-6、解决爆错\" class=\"headerlink\" title=\"2.6、解决爆错\"></a>2.6、解决爆错</h3><p><img src=\"/images/2020/07/20200723221653493.png\" alt=\"在这里插入图片描述\"></p>\n<p><img src=\"/images/2020/07/20200723221451412.png\" alt=\"在这里插入图片描述\"><br><img src=\"/images/2020/07/20200723221451393.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"三、使用Database\"><a href=\"#三、使用Database\" class=\"headerlink\" title=\"三、使用Database\"></a>三、使用Database</h2><p><img src=\"/images/2020/07/20200723222003723.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["开发工具"],"tags":["IDEA","Database"]},{"title":"Maven 编译速度慢？使用一个小技巧提升 Maven 编译速度！","url":"/2023/12/16/tool/Maven%20%E7%BC%96%E8%AF%91%E9%80%9F%E5%BA%A6%E6%85%A2%EF%BC%9F%E4%BD%BF%E7%94%A8%E4%B8%80%E4%B8%AA%E5%B0%8F%E6%8A%80%E5%B7%A7%E6%8F%90%E5%8D%87%20Maven%20%E7%BC%96%E8%AF%91%E9%80%9F%E5%BA%A6%EF%BC%81/","content":"<p>最近在工作中使用 Maven 编译 Java 项目，但是使用 Maven 编译并安装，平均耗时 6 分钟以上。</p>\n<p>为了提升工作效率，我们可以通过设置 Maven 编译参数来提升 Maven 的编译速度。</p>\n<span id=\"more\"></span>\n<p>打开 IDEA Maven 界面，设置参数 <code>Thread count</code> 为 <code>2C</code>，参数含义为使用 2 个 CPU 核心进行编译。</p>\n<p>这个设置要求编译电脑的硬件 CPU 核心数大于等于2。</p>\n<p>修改参数后，Maven 的编译速度有了显著提升，设置为 <code>2C</code> 的情况下，编译速度大约为 2分30秒。</p>\n<p><img src=\"/images/2023/12/2eb59c845ab1481a88dc382d10fbc96c.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["开发工具"],"tags":["IDEA","Maven"]},{"title":"Maven安装与配置&IDEA整合Maven","url":"/2020/01/26/tool/Maven%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE&IDEA%E6%95%B4%E5%90%88Maven/","content":"<p>Maven是一个项目管理工具，它包含了一个项目对象模型 (Project Object Model)，一组标准集合，一个项目生命周期(Project Lifecycle)，一个依赖管理系统(Dependency Management System)，和用来运行定义在生命周期阶段(phase)中插件(plugin)目标(goal)的逻辑。当你使用Maven的时候，你用一个明确定义的项目对象模型来描述你的项目，然后Maven可以应用横切的逻辑，这些逻辑来自一组共享的（或者自定义的）插件。<br>现在，我们就来配置一个Maven，并将Maven工具和IDEA进行整合，让我们可以通过IDEA来创建Maven项目。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"下载Maven。\"><a href=\"#下载Maven。\" class=\"headerlink\" title=\"下载Maven。\"></a>下载Maven。</h2><p>Maven官网地址为：<a href=\"https://maven.apache.org/download.cgi\">https://maven.apache.org/download.cgi</a></p>\n<p><img src=\"/images/2020/01/2020012619064198.png\" alt=\"在这里插入图片描述\"></p>\n<p><strong>从Maven官网上下载Maven的压缩包之后，直接在安装目录下解压缩即可。</strong></p>\n<h2 id=\"配置Maven环境\"><a href=\"#配置Maven环境\" class=\"headerlink\" title=\"配置Maven环境\"></a>配置Maven环境</h2><p>将Maven解压缩之后，Maven还不可以直接使用，需要对Maven进行相关的配置。</p>\n<h3 id=\"配置Maven系统环境变量\"><a href=\"#配置Maven系统环境变量\" class=\"headerlink\" title=\"配置Maven系统环境变量\"></a>配置Maven系统环境变量</h3><p>按照顺序打开：此电脑（右键）-&gt;属性-&gt;高级系统设置-&gt;高级-&gt;环境变量</p>\n<p><img src=\"/images/2020/01/20200126191808702.png\" alt=\"在这里插入图片描述\"></p>\n<p>在环境变量中点击新建，配置一个新的系统变量：</p>\n<p>变量名：MAVEN_HOME<br>变量值：E:\\Program Files\\apache-maven-3.6.1 <strong>（变量值的属性是你放置Maven解压缩包的路径）</strong></p>\n<h3 id=\"配置Path属性\"><a href=\"#配置Path属性\" class=\"headerlink\" title=\"配置Path属性\"></a>配置Path属性</h3><p><img src=\"/images/2020/01/20200126192130313.png\" alt=\"在这里插入图片描述\"></p>\n<p>编辑系统变量中的path变量，并在path中新建一个变量值</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">%MAVEN_HOME%\\bin</span><br></pre></td></tr></table></figure>\n<p>配置好了之后，点击确定，保存配置。</p>\n<h3 id=\"验证是否成功\"><a href=\"#验证是否成功\" class=\"headerlink\" title=\"验证是否成功\"></a>验证是否成功</h3><p>然后就可以打开cmd创建，输入mvn -v，如果出现你的Maven版本号，就说明已经配置成功了。<br><img src=\"/images/2020/01/20200126192741414.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"修改Maven配置\"><a href=\"#修改Maven配置\" class=\"headerlink\" title=\"修改Maven配置\"></a>修改Maven配置</h2><p>以上说明你已经安装好了Maven，但是我们需要使用，还需要修改maven的配置文件。</p>\n<p>打开Maven的安装目录，找到conf文件下的settings.xml文件，使用编辑软件打开它。<br><img src=\"/images/2020/01/20200126192950315.png\" alt=\"在这里插入图片描述\"></p>\n<h3 id=\"修改Maven仓库目录\"><a href=\"#修改Maven仓库目录\" class=\"headerlink\" title=\"修改Maven仓库目录\"></a>修改Maven仓库目录</h3><p>首先我们先配置Maven的本地仓库：<br><img src=\"/images/2020/01/20200126193234677.png\" alt=\"在这里插入图片描述\"></p>\n<p>如果这个本地库不配置，那么Maven默认是在C盘用户目录下的.m2目录下，在这里，我将本地库的目录放到了<strong>F:\\Maven\\repository</strong>目录下，如果没有这个目录，可以直接手动创建目录。</p>\n<h3 id=\"修改Maven中央仓库的访问路径\"><a href=\"#修改Maven中央仓库的访问路径\" class=\"headerlink\" title=\"修改Maven中央仓库的访问路径\"></a>修改Maven中央仓库的访问路径</h3><p>其次，我们需要配置Maven中央仓库的访问路径：<br><img src=\"/images/2020/01/2020012619361683.png\" alt=\"在这里插入图片描述\"></p>\n<p>我配置的是国内的阿里云镜像仓库，如果不配置，那么默认使用的是国外的Maven中央仓库，如果网不好，可能会使得Maven在使用的时候jar下载速度慢。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">mirror</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>alimaven<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>aliyun maven<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public/<span class=\"tag\">&lt;/<span class=\"name\">url</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">mirrorOf</span>&gt;</span>central<span class=\"tag\">&lt;/<span class=\"name\">mirrorOf</span>&gt;</span>        </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">mirror</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"修改Maven的JDK编译版本\"><a href=\"#修改Maven的JDK编译版本\" class=\"headerlink\" title=\"修改Maven的JDK编译版本\"></a>修改Maven的JDK编译版本</h3><p>最后，我们需要配置Maven的JDK编译版本：<br><img src=\"/images/2020/01/20200126194003435.png\" alt=\"在这里插入图片描述\">Maven默认的JDK编译版本很低，有1.4的，也有1.5的，但是普遍不高，所以我直接配置了一个JDK1.8的默认编译版本。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">profile</span>&gt;</span>     </span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>jdk<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span>   </span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">activation</span>&gt;</span>        </span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">activeByDefault</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">activeByDefault</span>&gt;</span>    </span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">jdk</span>&gt;</span>1.8<span class=\"tag\">&lt;/<span class=\"name\">jdk</span>&gt;</span>      </span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">activation</span>&gt;</span>  </span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span>  </span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">maven.compiler.source</span>&gt;</span>1.8<span class=\"tag\">&lt;/<span class=\"name\">maven.compiler.source</span>&gt;</span> </span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">maven.compiler.target</span>&gt;</span>1.8<span class=\"tag\">&lt;/<span class=\"name\">maven.compiler.target</span>&gt;</span> </span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">maven.compiler.compilerVersion</span>&gt;</span>1.8<span class=\"tag\">&lt;/<span class=\"name\">maven.compiler.compilerVersion</span>&gt;</span>   </span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">profile</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>到此为止，Maven的配置就结束了，我们就可以使用IDEA来整合Maven，并创建Maven项目了。</p>\n<p><strong>打开IDEA，按照下图进行配置：</strong><br><img src=\"/images/2020/01/20200126194801751.png\" alt=\"在这里插入图片描述\"><br>除此之外，为了解决Maven项目在创建骨架时太慢的问题，我们需要修改运行参数：</p>\n<p>在下图红框选中的地方，填入如下参数：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">-DarchetypeCatalog=internal</span><br></pre></td></tr></table></figure>\n<p><img src=\"/images/2020/01/20200126195329470.png\" alt=\"在这里插入图片描述\"></p>\n<p>到此为止，Maven的配置和IDEA整合Maven工具就完成了。</p>\n","categories":["开发工具"],"tags":["Java","IDEA","Maven"]},{"title":"Maven本地仓库删除.lastUpdated结尾的文件","url":"/2020/03/13/tool/Maven%E6%9C%AC%E5%9C%B0%E4%BB%93%E5%BA%93%E5%88%A0%E9%99%A4.lastUpdated%E7%BB%93%E5%B0%BE%E7%9A%84%E6%96%87%E4%BB%B6/","content":"<p>Maven 中有很多下载失败的，以.lastUpdated结尾的错误文件，我们可以直接将这些文件删除</p>\n<span id=\"more\"></span>\n\n<h2 id=\"cmd命令删除\"><a href=\"#cmd命令删除\" class=\"headerlink\" title=\"cmd命令删除\"></a>cmd命令删除</h2><p>打开cmd命令窗口，进入Maven本地仓库，执行如下命令：</p>\n<p><strong>第一步：进入本地仓库：</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">cd F:\\Maven\\repository</span><br></pre></td></tr></table></figure>\n<p><strong>第二步：执行以下命令：</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> /r %i <span class=\"title function_\">in</span> <span class=\"params\">(*.lastUpdated)</span> <span class=\"keyword\">do</span> del %i</span><br></pre></td></tr></table></figure>\n\n\n<h2 id=\"Java代码删除\"><a href=\"#Java代码删除\" class=\"headerlink\" title=\"Java代码删除\"></a>Java代码删除</h2><p>使用的是cmd命令窗口的方式，没有学习过这种命令的同学可能无法看懂，而这里使用的是Java代码的实现方式。<br>只需要运行下面代码的main方法，就可以递归删除Maven本地仓库下的所有以.lastUpdated为后缀的错误文件。</p>\n<ul>\n<li>运行前记得将常量<code>FILE_PATH</code>修改为自己的Maven本地仓库。<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">DeleteErrorFile</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * FILE_NAME为Maven仓库的路径</span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"type\">String</span> <span class=\"variable\">FILE_PATH</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;F:\\\\Maven\\\\repository&quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"type\">String</span> <span class=\"variable\">suffix</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;.lastUpdated&quot;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"type\">int</span> <span class=\"variable\">count</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">\t\tdeleteErrorFile(<span class=\"keyword\">new</span> <span class=\"title class_\">File</span>(FILE_PATH));</span><br><span class=\"line\">\t\tSystem.out.println(<span class=\"string\">&quot;一共在Maven仓库中删除了&quot;</span> + count + <span class=\"string\">&quot;个错误文件&quot;</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">deleteErrorFile</span><span class=\"params\">(File file)</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(file.isDirectory()) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(String childrenFile : file.list()) &#123;</span><br><span class=\"line\">                deleteErrorFile(<span class=\"keyword\">new</span> <span class=\"title class_\">File</span>(file,childrenFile));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(file.getName().endsWith(suffix)) &#123;</span><br><span class=\"line\">                file.delete();</span><br><span class=\"line\">                count++;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n</li>\n</ul>\n","categories":["开发工具"],"tags":["Maven"]},{"title":"Maven项目pom.xml project标签爆红解决方法","url":"/2020/08/19/tool/Maven%E9%A1%B9%E7%9B%AEpom.xml%20project%E6%A0%87%E7%AD%BE%E7%88%86%E7%BA%A2%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/","content":"<p>今天在打开项目的时候，发现了一个Maven项目的问题，在Maven项目的pom.xml文件中，project标签爆出了一个错误。</p>\n<span id=\"more\"></span>\n<p><img src=\"/images/2020/020200819081650697.png\" alt=\"在这里插入图片描述\"></p>\n<blockquote>\n<p>‘parent.relativePath’ of POM com.hrp:springboot_jpa:1.0-SNAPSHOT (F:\\IdeaCode\\java-web\\springboot_jpa\\pom.xml) points at com.hrp:java-web instead of org.springframework.boot:spring-boot-starter-parent, please verify your project structure</p>\n</blockquote>\n<blockquote>\n<p>POM com.hrp：springboot_jpa：1.0-SNAPSHOT（F：\\ IdeaCode \\ java-web \\ springboot_jpa \\ pom.xml）的’parent.relativePath’指向com.hrp：java-web而不是org.springframework.boot：spring -boot-starter-parent，请验证您的项目结构</p>\n</blockquote>\n<p>总而言之，这个问题是说在project标签下的parent.relativePath标签指向的路径出现了错误，所以导致报错。</p>\n<p><strong>要解决这个问题的方法也很简单，在parent标签下添加一个<code>&lt;relativePath/&gt;</code>标签即可。</strong></p>\n<p><img src=\"/images/2020/020200819082030419.png\" alt=\"在这里插入图片描述\"></p>\n<p><strong>添加该标签之后，我们重新更新Maven项目，爆错就会消失了</strong></p>\n<p><img src=\"/images/2020/020200819082324299.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["开发工具"],"tags":["Maven"]},{"title":"Postman发送POST请求及日期格式的参数","url":"/2020/03/20/tool/Postman%E5%8F%91%E9%80%81POST%E8%AF%B7%E6%B1%82%E5%8F%8A%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8F%E7%9A%84%E5%8F%82%E6%95%B0/","content":"<p>Postman在发送POST请求的时候，所有参数写在Request Body（请求体）中，如果需要的参数类型的日期格式的，只需要将日期格式写为<code>2000/01/01</code>即可，Postman会自动识别为日期格式的数据。</p>\n<span id=\"more\"></span>\n\n<ul>\n<li>如果是2000-01-01格式，Postman无法识别为日期，而是当做普通字符串处理。</li>\n</ul>\n<p><img src=\"/images/2020/03/20200320164729364.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["开发工具"],"tags":["Java","Postman"]},{"title":"Postman的下载、安装与使用","url":"/2020/02/23/tool/Postman%E7%9A%84%E4%B8%8B%E8%BD%BD%E3%80%81%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/","content":"<h2 id=\"什么是Postman\"><a href=\"#什么是Postman\" class=\"headerlink\" title=\"什么是Postman\"></a>什么是Postman</h2><p>Postman是一款接口测试工具，可以模仿浏览器发出各种类型的HTTP请求，用来测试API是否可用。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"为什么要用Postman\"><a href=\"#为什么要用Postman\" class=\"headerlink\" title=\"为什么要用Postman\"></a>为什么要用Postman</h2><p>有一些小白可能会问，我可以直接在浏览器上访问应用程序的API不可以吗？为什么还需要多此一举使用Postman这么一个工具呢？<br>其实原因很简单，在没有html页面的情况下，我们直接在浏览器地址栏中输入的请求路径，请求类型全部都是Get方式的。<br>而对于RestFul开发风格而言，这很显然是不能满足的。</p>\n<p><strong>举个栗子</strong><br>我们就以上一篇博文<a href=\"/2020/02/23/java/SpringBoot+SpringDataJPA/\">SpringBoot+SpringDataJPA</a>搭建的项目环境为例子。<br>在这个项目的web层中，有这么一个接口<strong>Get请求</strong>的接口：<code>/user/page/&#123;pageNum&#125;</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping(&quot;user&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">UserController</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> UserService userService;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping(&quot;page/&#123;pageNum&#125;&quot;)</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> ResponseEntity&lt;Page&lt;User&gt;&gt; <span class=\"title function_\">findByPage</span><span class=\"params\">(</span></span><br><span class=\"line\"><span class=\"params\">            <span class=\"meta\">@PathVariable(&quot;pageNum&quot;)</span> Integer pageNum,</span></span><br><span class=\"line\"><span class=\"params\">            <span class=\"meta\">@RequestParam(defaultValue = &quot;5&quot;)</span> Integer pageSize)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> ResponseEntity.ok(userService.findByPage(pageNum,pageSize));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>我们直接启动项目，访问一下这个接口。<br><img src=\"/images/2020/01/20200223113154298.png\" alt=\"在这里插入图片描述\"><br>我们发现使用浏览器访问这个API没有任何问题，那么我们现在把这个API的请求方式改为POST，看看会发生什么？</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@PostMapping(&quot;page/&#123;pageNum&#125;&quot;)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> ResponseEntity&lt;Page&lt;User&gt;&gt; <span class=\"title function_\">findByPage</span><span class=\"params\">(</span></span><br><span class=\"line\"><span class=\"params\">        <span class=\"meta\">@PathVariable(&quot;pageNum&quot;)</span> Integer pageNum,</span></span><br><span class=\"line\"><span class=\"params\">        <span class=\"meta\">@RequestParam(defaultValue = &quot;5&quot;)</span> Integer pageSize)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ResponseEntity.ok(userService.findByPage(pageNum,pageSize));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>我们重启这个项目，再次使用浏览器访问这个API。<br><img src=\"/images/2020/01/20200223113638247.png\" alt=\"在这里插入图片描述\"></p>\n<p><img src=\"/images/2020/01/20200223113835412.png\" alt=\"在这里插入图片描述\"></p>\n<p>无论是页面，还是程序控制台，都爆出了不支持GET请求的错误，这个时候，我们使用浏览器就无法测试这个POST请求的API是否能够正常工作了。</p>\n<ul>\n<li><strong>而Postman这个工具，就能够解决这个问题。</strong></li>\n</ul>\n<h2 id=\"Postman的下载、安装与使用\"><a href=\"#Postman的下载、安装与使用\" class=\"headerlink\" title=\"Postman的下载、安装与使用\"></a>Postman的下载、安装与使用</h2><p>Postman下载官网地址：<a href=\"https://www.postman.com/downloads/\">https://www.postman.com/downloads/</a></p>\n<p><img src=\"/images/2020/01/20200223114315178.png\" alt=\"在这里插入图片描述\"></p>\n<p>我们根据上图选择合适的版本进行下载，下载完整之后，直接点击运行，就可以安装完成。<br>我们运行Postman后，就会打开下面的界面，我们可以通过Postman来模拟发送其他各种类型的请求。</p>\n<p><img src=\"/images/2020/01/202002231147543.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["开发工具"],"tags":["Postman","HTTP"]},{"title":"RabbitMQ爆出com.rabbitmq.client.ShutdownSignalException异常及解决办法","url":"/2020/03/24/tool/RabbitMQ%E7%88%86%E5%87%BAcom.rabbitmq.client.ShutdownSignalException%E5%BC%82%E5%B8%B8%E5%8F%8A%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/","content":"<p>RabbitMQ爆出com.rabbitmq.client.ShutdownSignalException异常。</p>\n<span id=\"more\"></span>\n\n<p>异常具体信息如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">Exception in thread <span class=\"string\">&quot;main&quot;</span> java.io.IOException</span><br><span class=\"line\">\tat com.rabbitmq.client.impl.AMQChannel.wrap(AMQChannel.java:<span class=\"number\">126</span>)</span><br><span class=\"line\">\tat com.rabbitmq.client.impl.AMQChannel.wrap(AMQChannel.java:<span class=\"number\">122</span>)</span><br><span class=\"line\">\tat com.rabbitmq.client.impl.AMQChannel.exnWrappingRpc(AMQChannel.java:<span class=\"number\">144</span>)</span><br><span class=\"line\">\tat com.rabbitmq.client.impl.ChannelN.exchangeDeclare(ChannelN.java:<span class=\"number\">762</span>)</span><br><span class=\"line\">\tat com.rabbitmq.client.impl.recovery.AutorecoveringChannel.exchangeDeclare(AutorecoveringChannel.java:<span class=\"number\">237</span>)</span><br><span class=\"line\">\tat com.rabbitmq.client.impl.recovery.AutorecoveringChannel.exchangeDeclare(AutorecoveringChannel.java:<span class=\"number\">227</span>)</span><br><span class=\"line\">\tat com.rabbitmq.client.impl.recovery.AutorecoveringChannel.exchangeDeclare(AutorecoveringChannel.java:<span class=\"number\">207</span>)</span><br><span class=\"line\">\tat com.rabbitmq.client.impl.recovery.AutorecoveringChannel.exchangeDeclare(AutorecoveringChannel.java:<span class=\"number\">212</span>)</span><br><span class=\"line\">\tat com.amqp.fanout.Send.main(Send.java:<span class=\"number\">22</span>)</span><br><span class=\"line\">Caused by: com.rabbitmq.client.ShutdownSignalException: channel error; protocol method: #method&lt;channel.close&gt;(reply-code=<span class=\"number\">406</span>, reply-text=PRECONDITION_FAILED - inequivalent arg <span class=\"string\">&#x27;durable&#x27;</span> <span class=\"keyword\">for</span> exchange <span class=\"string\">&#x27;amq.fanout&#x27;</span> in vhost <span class=\"string\">&#x27;/mymq&#x27;</span>: received <span class=\"string\">&#x27;false&#x27;</span> but current is <span class=\"string\">&#x27;true&#x27;</span>, class-id=<span class=\"number\">40</span>, method-id=<span class=\"number\">10</span>)</span><br><span class=\"line\">\tat com.rabbitmq.utility.ValueOrException.getValue(ValueOrException.java:<span class=\"number\">66</span>)</span><br><span class=\"line\">\tat com.rabbitmq.utility.BlockingValueOrException.uninterruptibleGetValue(BlockingValueOrException.java:<span class=\"number\">36</span>)</span><br><span class=\"line\">\tat com.rabbitmq.client.impl.AMQChannel$BlockingRpcContinuation.getReply(AMQChannel.java:<span class=\"number\">494</span>)</span><br><span class=\"line\">\tat com.rabbitmq.client.impl.AMQChannel.privateRpc(AMQChannel.java:<span class=\"number\">288</span>)</span><br><span class=\"line\">\tat com.rabbitmq.client.impl.AMQChannel.exnWrappingRpc(AMQChannel.java:<span class=\"number\">138</span>)</span><br><span class=\"line\">\t... <span class=\"number\">6</span> more</span><br></pre></td></tr></table></figure>\n\n<p>通过异常我们可以发现以下几点：</p>\n<ul>\n<li>异常出现在代码的第22行。</li>\n<li>异常原因是因为在<code>/mymq</code>虚拟主机下的<code>amq.fanout</code>交换机是持久化的，但是代码在声明交换机的时候，并没有声明该交换机的持久化属性。<br><img src=\"/images/2020/03/20200324101342219.png\" alt=\"在这里插入图片描述\"><br><img src=\"/images/2020/03/20200324100926386.png\" alt=\"在这里插入图片描述\"></li>\n</ul>\n<p>通过源码我们可以发现，通过声明交换机有重载方法：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">Exchange.DeclareOk <span class=\"title function_\">exchangeDeclare</span><span class=\"params\">(String exchange, BuiltinExchangeType type)</span> <span class=\"keyword\">throws</span> IOException;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">Exchange.DeclareOk <span class=\"title function_\">exchangeDeclare</span><span class=\"params\">(String exchange, BuiltinExchangeType type, <span class=\"type\">boolean</span> durable)</span> <span class=\"keyword\">throws</span> IOException;</span><br></pre></td></tr></table></figure>\n\n<p>其中第二个重载方法比第一个重载方法多出了一个持久化的boolean属性，所以该异常的解决方法就是增加该参数，并且参数属性为<code>true</code>。<br><img src=\"/images/2020/03/2020032410122415.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["消息队列"],"tags":["RabbitMQ","消息队列"]},{"title":"一篇博客教会你怎么安装Docker","url":"/2020/04/16/tool/%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2%E6%95%99%E4%BC%9A%E4%BD%A0%E6%80%8E%E4%B9%88%E5%AE%89%E8%A3%85Docker/","content":"<h1 id=\"一、什么是Docker\"><a href=\"#一、什么是Docker\" class=\"headerlink\" title=\"一、什么是Docker?\"></a>一、什么是Docker?</h1><p>Docker 是一个开源的应用容器引擎，让开发者可以打包他们的应用以及依赖包到一个可移植的镜像中，然后发布到任何流行的 Linux或Windows 机器上，也可以实现虚拟化。容器是完全使用沙箱机制，相互之间不会有任何接口。</p>\n<span id=\"more\"></span>\n<p>Docker是基于Linux 64bit的，无法在32bit的linux/Windows/unix环境下使用，所以今天我们在CentOS系统上安装Docker。</p>\n<h1 id=\"二、安装Docker\"><a href=\"#二、安装Docker\" class=\"headerlink\" title=\"二、安装Docker\"></a>二、安装Docker</h1><p>本次的安装在CentOS8的系统环境下安装，如果不会安装CentOS系统的，可以参考我的博客：<br><a href=\"/2020/04/19/linux/一篇博客教会你怎么安装CentOS系统/\">一篇博客教会你怎么安装CentOS系统</a></p>\n<h2 id=\"1、更新yum源为最新\"><a href=\"#1、更新yum源为最新\" class=\"headerlink\" title=\"1、更新yum源为最新\"></a>1、更新yum源为最新</h2><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo yum update</span><br></pre></td></tr></table></figure>\n<h2 id=\"2、安装需要的软件包\"><a href=\"#2、安装需要的软件包\" class=\"headerlink\" title=\"2、安装需要的软件包\"></a>2、安装需要的软件包</h2><p>yum-utils提供yum-config-manager功能，另外两个是devicemapper驱动依赖</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo yum install <span class=\"literal\">-y</span> yum<span class=\"literal\">-utils</span> device<span class=\"literal\">-mapper-persistent-data</span> lvm2</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3、设置yum源为阿里云\"><a href=\"#3、设置yum源为阿里云\" class=\"headerlink\" title=\"3、设置yum源为阿里云\"></a>3、设置yum源为阿里云</h2><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo yum<span class=\"literal\">-config-manager</span> <span class=\"literal\">--add-repo</span> http://mirrors.aliyun.com/docker<span class=\"literal\">-ce</span>/linux/centos/docker<span class=\"literal\">-ce</span>.repo</span><br></pre></td></tr></table></figure>\n<p>可以通过 <code>yum repolist</code>命令查看是否已有<code>docker-ce-stable</code>仓库。</p>\n<h2 id=\"4、安装docker\"><a href=\"#4、安装docker\" class=\"headerlink\" title=\"4、安装docker\"></a>4、安装docker</h2><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo yum install docker<span class=\"literal\">-ce</span> <span class=\"literal\">--nobest</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"5、查看安装版本\"><a href=\"#5、查看安装版本\" class=\"headerlink\" title=\"5、查看安装版本\"></a>5、查看安装版本</h2><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">dovker <span class=\"literal\">-v</span></span><br></pre></td></tr></table></figure>\n<p>安装成功后，可以使用<code>docker -v</code>命令来查看docker版本。</p>\n<h1 id=\"三、设置Docker的国内镜像\"><a href=\"#三、设置Docker的国内镜像\" class=\"headerlink\" title=\"三、设置Docker的国内镜像\"></a>三、设置Docker的国内镜像</h1><p>如果使用Docker提供的国外镜像，下载或者说拉取文件的时候速度会非常慢，所以我们直接修改Docker的镜像为国内镜像，这样拉取文件的速度就会非常快。</p>\n<h2 id=\"1、编辑文件\"><a href=\"#1、编辑文件\" class=\"headerlink\" title=\"1、编辑文件\"></a>1、编辑文件</h2><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">vi /etc/docker/daemon.json</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2、在该文件中输入如下内容\"><a href=\"#2、在该文件中输入如下内容\" class=\"headerlink\" title=\"2、在该文件中输入如下内容\"></a>2、在该文件中输入如下内容</h2><figure class=\"highlight json\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span><span class=\"attr\">&quot;registry-mirrors&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"string\">&quot;https://docker.mirrors.ustc.edu.cn&quot;</span><span class=\"punctuation\">]</span><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n<h1 id=\"四、启动Docker服务\"><a href=\"#四、启动Docker服务\" class=\"headerlink\" title=\"四、启动Docker服务\"></a>四、启动Docker服务</h1><h2 id=\"1、启动Docker服务\"><a href=\"#1、启动Docker服务\" class=\"headerlink\" title=\"1、启动Docker服务\"></a>1、启动Docker服务</h2><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">systemctl <span class=\"built_in\">start</span> docker</span><br></pre></td></tr></table></figure>\n<h2 id=\"2、查看Docker服务状态\"><a href=\"#2、查看Docker服务状态\" class=\"headerlink\" title=\"2、查看Docker服务状态\"></a>2、查看Docker服务状态</h2><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">systemctl status docker</span><br></pre></td></tr></table></figure>\n<h2 id=\"3、停止Docker服务\"><a href=\"#3、停止Docker服务\" class=\"headerlink\" title=\"3、停止Docker服务\"></a>3、停止Docker服务</h2><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">systemctl stop docker</span><br></pre></td></tr></table></figure>\n<h2 id=\"4、重启Docker服务\"><a href=\"#4、重启Docker服务\" class=\"headerlink\" title=\"4、重启Docker服务\"></a>4、重启Docker服务</h2><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">systemctl restart docker</span><br></pre></td></tr></table></figure>\n<h2 id=\"5、设置Docker服务开机自启\"><a href=\"#5、设置Docker服务开机自启\" class=\"headerlink\" title=\"5、设置Docker服务开机自启\"></a>5、设置Docker服务开机自启</h2><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">systemctl enable docker</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"五、Docker常用命令\"><a href=\"#五、Docker常用命令\" class=\"headerlink\" title=\"五、Docker常用命令\"></a>五、Docker常用命令</h1><h2 id=\"1、Docker在线帮助文档\"><a href=\"#1、Docker在线帮助文档\" class=\"headerlink\" title=\"1、Docker在线帮助文档\"></a>1、Docker在线帮助文档</h2><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker <span class=\"literal\">--help</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"2、查看Docker概要信息\"><a href=\"#2、查看Docker概要信息\" class=\"headerlink\" title=\"2、查看Docker概要信息\"></a>2、查看Docker概要信息</h2><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker info</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"3、镜像相关命令\"><a href=\"#3、镜像相关命令\" class=\"headerlink\" title=\"3、镜像相关命令\"></a>3、镜像相关命令</h2><h3 id=\"3-1、查看本地已有镜像\"><a href=\"#3-1、查看本地已有镜像\" class=\"headerlink\" title=\"3.1、查看本地已有镜像\"></a>3.1、查看本地已有镜像</h3><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker images</span><br></pre></td></tr></table></figure>\n<table>\n<thead>\n<tr>\n<th>REPOSITORY</th>\n<th>TAG</th>\n<th>IMAGE ID</th>\n<th>CREATED</th>\n<th>SIZE</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>镜像名称</td>\n<td>标签</td>\n<td>镜像ID（唯一）</td>\n<td>镜像创建时间</td>\n<td>镜像占用大小</td>\n</tr>\n</tbody></table>\n<h3 id=\"3-2、搜索镜像\"><a href=\"#3-2、搜索镜像\" class=\"headerlink\" title=\"3.2、搜索镜像\"></a>3.2、搜索镜像</h3><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker search [镜像名称]</span><br></pre></td></tr></table></figure>\n<table>\n<thead>\n<tr>\n<th>NAME</th>\n<th>DESCRIPTION</th>\n<th>STARS</th>\n<th>OFFICIAL</th>\n<th>AUTOMATED</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>镜像名称</td>\n<td>描述</td>\n<td>星（代表好评）</td>\n<td>是否官方提供</td>\n<td>是否由DockerHub自动构建</td>\n</tr>\n</tbody></table>\n<h3 id=\"3-3、拉取镜像\"><a href=\"#3-3、拉取镜像\" class=\"headerlink\" title=\"3.3、拉取镜像\"></a>3.3、拉取镜像</h3><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker pull [镜像名称]</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-4、删除镜像\"><a href=\"#3-4、删除镜像\" class=\"headerlink\" title=\"3.4、删除镜像\"></a>3.4、删除镜像</h3><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#按镜像名称删除镜像</span></span><br><span class=\"line\">docker rmi [镜像名称]</span><br><span class=\"line\"><span class=\"comment\">#按镜像ID删除镜像</span></span><br><span class=\"line\">docker rmi [镜像<span class=\"type\">ID</span>]</span><br><span class=\"line\"><span class=\"comment\">#删除所有镜像</span></span><br><span class=\"line\">docker rmi `docker images <span class=\"literal\">-q</span>`</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4、容器相关命令\"><a href=\"#4、容器相关命令\" class=\"headerlink\" title=\"4、容器相关命令\"></a>4、容器相关命令</h2><h3 id=\"4-1、查看运行中容器\"><a href=\"#4-1、查看运行中容器\" class=\"headerlink\" title=\"4.1、查看运行中容器\"></a>4.1、查看运行中容器</h3><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#查看容器</span></span><br><span class=\"line\">docker <span class=\"built_in\">ps</span></span><br><span class=\"line\"><span class=\"comment\">#查看所有容器</span></span><br><span class=\"line\">docker <span class=\"built_in\">ps</span> <span class=\"literal\">-a</span></span><br><span class=\"line\"><span class=\"comment\">#查看最后一次运行的容器</span></span><br><span class=\"line\">docker <span class=\"built_in\">ps</span> <span class=\"literal\">-l</span></span><br><span class=\"line\"><span class=\"comment\">#查看停止的容器</span></span><br><span class=\"line\">docker <span class=\"built_in\">ps</span> <span class=\"operator\">-f</span> status=exited</span><br></pre></td></tr></table></figure>\n<table>\n<thead>\n<tr>\n<th>CONTAINER ID</th>\n<th>IMAGE</th>\n<th>COMMAND</th>\n<th>CREATED</th>\n<th>STATUS</th>\n<th>PORTS</th>\n<th>NAMES</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>容器ID</td>\n<td>镜像名称</td>\n<td>运行命令</td>\n<td>创建时间</td>\n<td>状态</td>\n<td>端口映射关系</td>\n<td>容器名称</td>\n</tr>\n</tbody></table>\n<h3 id=\"4-2、创建容器\"><a href=\"#4-2、创建容器\" class=\"headerlink\" title=\"4.2、创建容器\"></a>4.2、创建容器</h3><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker run</span><br><span class=\"line\"><span class=\"comment\">#表示运行容器</span></span><br><span class=\"line\"><span class=\"literal\">-i</span></span><br><span class=\"line\"><span class=\"comment\">#表示运行容器后进入其命令行</span></span><br><span class=\"line\"><span class=\"literal\">-t</span></span><br><span class=\"line\"><span class=\"comment\">#表示为创建容器命名</span></span><br><span class=\"line\"><span class=\"literal\">--name</span></span><br><span class=\"line\"><span class=\"comment\">#表示目录映射关系</span></span><br><span class=\"line\"><span class=\"literal\">-v</span></span><br><span class=\"line\"><span class=\"comment\">#表示创建一个守护式容器在后台运行</span></span><br><span class=\"line\"><span class=\"literal\">-d</span></span><br><span class=\"line\"><span class=\"comment\">#表示端口映射，前者是宿主机端口，后者是容器内映射端口</span></span><br><span class=\"line\"><span class=\"literal\">-p</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-3、退出容器\"><a href=\"#4-3、退出容器\" class=\"headerlink\" title=\"4.3、退出容器\"></a>4.3、退出容器</h3><p>在容器内执行命令</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">exit</span></span><br></pre></td></tr></table></figure>\n\n\n<h3 id=\"4-4、停止容器\"><a href=\"#4-4、停止容器\" class=\"headerlink\" title=\"4.4、停止容器\"></a>4.4、停止容器</h3><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#按容器名称停止容器</span></span><br><span class=\"line\">docker stop [容器名称]</span><br><span class=\"line\"><span class=\"comment\">#按容器ID停止容器</span></span><br><span class=\"line\">docker stop [容器<span class=\"type\">ID</span>]</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-5、运行容器\"><a href=\"#4-5、运行容器\" class=\"headerlink\" title=\"4.5、运行容器\"></a>4.5、运行容器</h3><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#按容器名称启动容器</span></span><br><span class=\"line\">docker <span class=\"built_in\">start</span> [容器名称]</span><br><span class=\"line\"><span class=\"comment\">#按容器ID启动容器</span></span><br><span class=\"line\">docker <span class=\"built_in\">start</span> [容器<span class=\"type\">ID</span>]</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-6、文件拷贝\"><a href=\"#4-6、文件拷贝\" class=\"headerlink\" title=\"4.6、文件拷贝\"></a>4.6、文件拷贝</h3><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#把宿主机文件拷贝到容器内</span></span><br><span class=\"line\">docker <span class=\"built_in\">cp</span> [文件名称] [容器名称]:/[目录<span class=\"number\">1</span>]/[目录<span class=\"number\">2</span>]</span><br><span class=\"line\"><span class=\"comment\">#把容器内文件拷贝到宿主机中</span></span><br><span class=\"line\">docker <span class=\"built_in\">cp</span> [容器名称]:/[目录<span class=\"number\">1</span>]/[文件名称] /[目录<span class=\"number\">1</span>]/[目录<span class=\"number\">2</span>]</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-7、目录挂载\"><a href=\"#4-7、目录挂载\" class=\"headerlink\" title=\"4.7、目录挂载\"></a>4.7、目录挂载</h3><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#把宿主机文件拷贝到容器内</span></span><br><span class=\"line\">docker run <span class=\"literal\">-di</span> <span class=\"literal\">-v</span> /[目录]/[文件名称]:/[目录]/[文件名称] <span class=\"literal\">--name</span>=[容器名称]</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-8、查看容器IP地址\"><a href=\"#4-8、查看容器IP地址\" class=\"headerlink\" title=\"4.8、查看容器IP地址\"></a>4.8、查看容器IP地址</h3><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker inspect <span class=\"literal\">--format</span>=<span class=\"string\">&#x27;&#123;&#123;.NetworkSetings.IpAddress&#125;&#125;&#x27;</span> [容器名称]</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"4-9、删除容器\"><a href=\"#4-9、删除容器\" class=\"headerlink\" title=\"4.9、删除容器\"></a>4.9、删除容器</h3><figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker <span class=\"built_in\">rm</span> [容器名称]</span><br></pre></td></tr></table></figure>\n","categories":["开发工具"],"tags":["Docker"]},{"title":"消息队列RabbitMQ之Spring-AMQP","url":"/2020/03/24/tool/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97RabbitMQ%E4%B9%8BSpring-AMQP/","content":"<h1 id=\"Spring-AMQP\"><a href=\"#Spring-AMQP\" class=\"headerlink\" title=\"Spring-AMQP\"></a>Spring-AMQP</h1><h2 id=\"什么是Spring-AMQP？\"><a href=\"#什么是Spring-AMQP？\" class=\"headerlink\" title=\"什么是Spring-AMQP？\"></a>什么是Spring-AMQP？</h2><p>Spring-AMQP官网：<a href=\"http://spring.io/projects/spring-amqp\">http://spring.io/projects/spring-amqp</a></p>\n<ul>\n<li>Spring-AMQP是Spring的一个子项目，是对<code>amqp协议</code>的抽象实现。<span id=\"more\"></span>\n\n</li>\n</ul>\n<h2 id=\"什么是SpringBoot-AMQP？\"><a href=\"#什么是SpringBoot-AMQP？\" class=\"headerlink\" title=\"什么是SpringBoot-AMQP？\"></a>什么是SpringBoot-AMQP？</h2><p>我们先来看一下SpringBoot-AMQP的依赖。<code>（不知道为什么，官网打开太慢了，截不了图，直接看依赖吧）</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-boot-starter-amqp&lt;/artifactId&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>\n<p>SpringBoot-AMQP是一个SpringBoot项目，可以直接使用SpringBoot为我们提供的启动器，快速的搭建一个Spring-AMQP的环境。<br>我们来看一下<code>spring-boot-starter-amqp</code>都依赖了哪些依赖。</p>\n<p><img src=\"/images/2020/03/20200324155512916.png\" alt=\"在这里插入图片描述\"></p>\n<p>从上图我们可以看到，<code>spring-boot-starter-amqp</code>是SpringBoot为我们封装的一个启动器，而<code>spring-amqp</code>则是Spring对amqp协议的抽象实现，而<code>spring-rabbit</code>则是具体实现，使用的正是RabbitMQ。</p>\n<h2 id=\"Spring-AMQP、Spring-Rabbit、SpringBoot-AMQP\"><a href=\"#Spring-AMQP、Spring-Rabbit、SpringBoot-AMQP\" class=\"headerlink\" title=\"Spring-AMQP、Spring-Rabbit、SpringBoot-AMQP\"></a>Spring-AMQP、Spring-Rabbit、SpringBoot-AMQP</h2><p><img src=\"/images/2020/03/20200324164832972.png\" alt=\"在这里插入图片描述\"></p>\n<h1 id=\"SpringBoot-AMQP\"><a href=\"#SpringBoot-AMQP\" class=\"headerlink\" title=\"SpringBoot-AMQP\"></a>SpringBoot-AMQP</h1><h2 id=\"搭建项目环境\"><a href=\"#搭建项目环境\" class=\"headerlink\" title=\"搭建项目环境\"></a>搭建项目环境</h2><figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.0.4.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-test<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"SpringBoot项目启动类\"><a href=\"#SpringBoot项目启动类\" class=\"headerlink\" title=\"SpringBoot项目启动类\"></a>SpringBoot项目启动类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">AmqpApplication</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> &#123;</span><br><span class=\"line\">        SpringApplication.run(AmqpApplication.class);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"application-yml配置文件\"><a href=\"#application-yml配置文件\" class=\"headerlink\" title=\"application.yml配置文件\"></a>application.yml配置文件</h2><figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">spring:</span></span><br><span class=\"line\">  <span class=\"attr\">rabbitmq:</span></span><br><span class=\"line\">    <span class=\"attr\">host:</span> <span class=\"number\">192.168</span><span class=\"number\">.177</span><span class=\"number\">.128</span></span><br><span class=\"line\">    <span class=\"attr\">port:</span> <span class=\"number\">5672</span>    <span class=\"comment\">#端口默认就是5672，如果没有RabbitMQ没有修改默认端口的话，可以不配置</span></span><br><span class=\"line\">    <span class=\"attr\">virtual-host:</span> <span class=\"string\">/mymq</span></span><br><span class=\"line\">    <span class=\"attr\">username:</span> <span class=\"string\">admin</span></span><br><span class=\"line\">    <span class=\"attr\">password:</span> <span class=\"string\">admin</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建监听者（消费者）\"><a href=\"#创建监听者（消费者）\" class=\"headerlink\" title=\"创建监听者（消费者）\"></a>创建监听者（消费者）</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Listener</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RabbitListener(bindings = @QueueBinding(</span></span><br><span class=\"line\"><span class=\"meta\">            value = @Queue(value = &quot;topic_exchange_queue_1&quot;, durable = &quot;false&quot;),</span></span><br><span class=\"line\"><span class=\"meta\">            exchange = @Exchange(</span></span><br><span class=\"line\"><span class=\"meta\">                    value = &quot;amq.topic&quot;,</span></span><br><span class=\"line\"><span class=\"meta\">                    ignoreDeclarationExceptions = &quot;true&quot;,</span></span><br><span class=\"line\"><span class=\"meta\">                    durable = &quot;true&quot;,</span></span><br><span class=\"line\"><span class=\"meta\">                    type = ExchangeTypes.TOPIC</span></span><br><span class=\"line\"><span class=\"meta\">            ),</span></span><br><span class=\"line\"><span class=\"meta\">            key = &#123;&quot;insert&quot;&#125;))</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">listen</span><span class=\"params\">(String message)</span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">&quot;接收到消息：&quot;</span> + message);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建生产者\"><a href=\"#创建生产者\" class=\"headerlink\" title=\"创建生产者\"></a>创建生产者</h2><ul>\n<li>在这里，我们使用测试类代替生产者，在真正的项目环境中，生产者应该也是一个被Spring管理的类中的方法。</li>\n<li>AmqpTemplate类中有很多重载方法，可以视具体情况而选择具体方法。<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SpringBootTest</span></span><br><span class=\"line\"><span class=\"meta\">@RunWith(SpringRunner.class)</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">AmqpTest</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> AmqpTemplate amqpTemplate;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Test</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">test</span><span class=\"params\">()</span> &#123;</span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">message</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;Hello World!&quot;</span>;</span><br><span class=\"line\">        amqpTemplate.convertAndSend(<span class=\"string\">&quot;amq.topic&quot;</span>,<span class=\"string\">&quot;insert&quot;</span>,message);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n</li>\n</ul>\n","categories":["消息队列"],"tags":["RabbitMQ","消息队列"]},{"title":"消息队列RabbitMQ之Work队列消息模型","url":"/2020/03/24/tool/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97RabbitMQ%E4%B9%8BWork%E9%98%9F%E5%88%97%E6%B6%88%E6%81%AF%E6%A8%A1%E5%9E%8B/","content":"<h1 id=\"Work队列消息模型\"><a href=\"#Work队列消息模型\" class=\"headerlink\" title=\"Work队列消息模型\"></a>Work队列消息模型</h1><p>Work队列消息模型，也被称作工作队列消息模型，或者竞争消费模型。</p>\n<span id=\"more\"></span>\n<p><img src=\"/images/2020/03/20200323221216371.png\" alt=\"在这里插入图片描述\"></p>\n<p>Work队列消息模型与基本消息队列模型的区别就在于，Work队列消息模型让多个消费者绑定一个队列，这样就可以快速处理消息队列中的消息，<strong>从而避免了队列中消息堆积的问题</strong>。</p>\n<h1 id=\"JavaAPI实现Work队列消息模型\"><a href=\"#JavaAPI实现Work队列消息模型\" class=\"headerlink\" title=\"JavaAPI实现Work队列消息模型\"></a>JavaAPI实现Work队列消息模型</h1><h2 id=\"准备工作\"><a href=\"#准备工作\" class=\"headerlink\" title=\"准备工作\"></a>准备工作</h2><p>使用JavaAPI实现消息队列模型，需要先做一些准备工作，这些准备工作包括搭建项目环境和准备工具类，这些工作在<a href=\"/2020/03/23/tool/消息队列RabbitMQ之基本消息模型/\">消息队列RabbitMQ之基本消息模型</a>已经准备好了，就不重复准备了。</p>\n<h2 id=\"创建生产者\"><a href=\"#创建生产者\" class=\"headerlink\" title=\"创建生产者\"></a>创建生产者</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Send</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//RabbitMQ的队列名称</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"type\">String</span> <span class=\"variable\">QUEUE_NAME</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;work_queue&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException, TimeoutException &#123;</span><br><span class=\"line\">        <span class=\"comment\">//使用工具类，获取RabbitMQ的连接</span></span><br><span class=\"line\">        <span class=\"type\">Connection</span> <span class=\"variable\">connection</span> <span class=\"operator\">=</span> ConnectionUtils.getConnection();</span><br><span class=\"line\">        <span class=\"comment\">//使用连接创建通道</span></span><br><span class=\"line\">        <span class=\"type\">Channel</span> <span class=\"variable\">channel</span> <span class=\"operator\">=</span> connection.createChannel();</span><br><span class=\"line\">        <span class=\"comment\">//使用通道声明一个队列，参数分别为：队列名称，是否持久化，是否为排他队列，是否自动删除，其他属性</span></span><br><span class=\"line\">        channel.queueDeclare(QUEUE_NAME,<span class=\"literal\">false</span>,<span class=\"literal\">false</span>,<span class=\"literal\">false</span>,<span class=\"literal\">null</span>);</span><br><span class=\"line\">        <span class=\"comment\">//循环发送50条消息到消息队列中</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"type\">int</span> <span class=\"variable\">i</span> <span class=\"operator\">=</span> <span class=\"number\">0</span>; i &lt; <span class=\"number\">50</span>; i++)&#123;</span><br><span class=\"line\">            <span class=\"comment\">//需要发送的消息</span></span><br><span class=\"line\">            <span class=\"type\">String</span> <span class=\"variable\">message</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;Hello World!&quot;</span> + i;</span><br><span class=\"line\">            <span class=\"comment\">//使用通道发送消息，参数分别为：交换机名称，路由Key，其他属性，消息正文</span></span><br><span class=\"line\">            channel.basicPublish(<span class=\"string\">&quot;&quot;</span>,QUEUE_NAME,<span class=\"literal\">null</span>,message.getBytes());</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">//关闭通道</span></span><br><span class=\"line\">        channel.close();</span><br><span class=\"line\">        <span class=\"comment\">//关闭连接</span></span><br><span class=\"line\">        connection.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建消费者1\"><a href=\"#创建消费者1\" class=\"headerlink\" title=\"创建消费者1\"></a>创建消费者1</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Recv1</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//RabbitMQ的队列名称</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"type\">String</span> <span class=\"variable\">QUEUE_NAME</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;work_queue&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException, TimeoutException &#123;</span><br><span class=\"line\">        <span class=\"comment\">//使用工具类，获取RabbitMQ的连接</span></span><br><span class=\"line\">        <span class=\"type\">Connection</span> <span class=\"variable\">connection</span> <span class=\"operator\">=</span> ConnectionUtils.getConnection();</span><br><span class=\"line\">        <span class=\"comment\">//使用连接创建通道</span></span><br><span class=\"line\">        <span class=\"type\">Channel</span> <span class=\"variable\">channel</span> <span class=\"operator\">=</span> connection.createChannel();</span><br><span class=\"line\">        <span class=\"comment\">//使用通道声明一个队列，参数分别为：队列名称，是否持久化，是否为排他队列，是否自动删除，其他属性</span></span><br><span class=\"line\">        channel.queueDeclare(QUEUE_NAME,<span class=\"literal\">false</span>,<span class=\"literal\">false</span>,<span class=\"literal\">false</span>,<span class=\"literal\">null</span>);</span><br><span class=\"line\">        <span class=\"comment\">//设置每个消费者每次只消费一条数据</span></span><br><span class=\"line\">        channel.basicQos(<span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"comment\">//定义队列的消费者</span></span><br><span class=\"line\">        <span class=\"type\">DefaultConsumer</span> <span class=\"variable\">consumer</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">DefaultConsumer</span>(channel)&#123;</span><br><span class=\"line\">            <span class=\"comment\">//覆写该方法，该方法类似于监听器，当队列中有消息的时候，就会被调用执行</span></span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">handleDelivery</span><span class=\"params\">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class=\"type\">byte</span>[] body)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">                <span class=\"comment\">//byte[] body参数即为消息体，当该消息体被使用，即认为该消息已被消费</span></span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;[消费者1]&quot;</span>+<span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(body));</span><br><span class=\"line\">                <span class=\"comment\">//手动Ack</span></span><br><span class=\"line\">                channel.basicAck(envelope.getDeliveryTag(),<span class=\"literal\">false</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"comment\">//监听队列，参数分别为：队列名称，是否自动确认消息已被消费，队列消费者</span></span><br><span class=\"line\">        channel.basicConsume(QUEUE_NAME,<span class=\"literal\">false</span>,consumer);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建消费者2\"><a href=\"#创建消费者2\" class=\"headerlink\" title=\"创建消费者2\"></a>创建消费者2</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Recv2</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//RabbitMQ的队列名称</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"type\">String</span> <span class=\"variable\">QUEUE_NAME</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;work_queue&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException, TimeoutException &#123;</span><br><span class=\"line\">        <span class=\"comment\">//使用工具类，获取RabbitMQ的连接</span></span><br><span class=\"line\">        <span class=\"type\">Connection</span> <span class=\"variable\">connection</span> <span class=\"operator\">=</span> ConnectionUtils.getConnection();</span><br><span class=\"line\">        <span class=\"comment\">//使用连接创建通道</span></span><br><span class=\"line\">        <span class=\"type\">Channel</span> <span class=\"variable\">channel</span> <span class=\"operator\">=</span> connection.createChannel();</span><br><span class=\"line\">        <span class=\"comment\">//使用通道声明一个队列，参数分别为：队列名称，是否持久化，是否为排他队列，是否自动删除，其他属性</span></span><br><span class=\"line\">        channel.queueDeclare(QUEUE_NAME,<span class=\"literal\">false</span>,<span class=\"literal\">false</span>,<span class=\"literal\">false</span>,<span class=\"literal\">null</span>);</span><br><span class=\"line\">        <span class=\"comment\">//设置每个消费者每次只消费一条数据</span></span><br><span class=\"line\">        channel.basicQos(<span class=\"number\">1</span>);</span><br><span class=\"line\">        <span class=\"comment\">//定义队列的消费者</span></span><br><span class=\"line\">        <span class=\"type\">DefaultConsumer</span> <span class=\"variable\">consumer</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">DefaultConsumer</span>(channel)&#123;</span><br><span class=\"line\">            <span class=\"comment\">//覆写该方法，该方法类似于监听器，当队列中有消息的时候，就会被调用执行</span></span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">handleDelivery</span><span class=\"params\">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class=\"type\">byte</span>[] body)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">                <span class=\"comment\">//byte[] body参数即为消息体，当该消息体被使用，即认为该消息已被消费</span></span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot;[消费者2]&quot;</span>+<span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(body));</span><br><span class=\"line\">                <span class=\"comment\">//第二个消费者处理消息较慢</span></span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                channel.basicAck(envelope.getDeliveryTag(),<span class=\"literal\">false</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"comment\">//监听队列，参数分别为：队列名称，是否自动确认消息已被消费，队列消费者</span></span><br><span class=\"line\">        channel.basicConsume(QUEUE_NAME,<span class=\"literal\">false</span>,consumer);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"Work队列消息模型代码实现的注意点\"><a href=\"#Work队列消息模型代码实现的注意点\" class=\"headerlink\" title=\"Work队列消息模型代码实现的注意点\"></a>Work队列消息模型代码实现的注意点</h1><p>与基本消息模型的实现相比，Work队列消息模型在代码实现上多了这么一行代码：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//设置每个消费者每次只消费一条数据</span></span><br><span class=\"line\">channel.basicQos(<span class=\"number\">1</span>);</span><br></pre></td></tr></table></figure>\n<p>这是将消费者设置为每次只消费一条数据，如果不设置这个值，那么在一开始，每个消费者都是默认平均消费的，即每个消费者各消费25条消息。<br>但是在消费者2中，消息的处理速度非常慢（每处理一条消息，线程休眠一秒钟），所以为了能够最大化利用资源，所以设置每个消费者每次只消费一条消息，这样消费消息更快的消费者就可以消费更多的消息。</p>\n<p><strong>【注意】在Work队列消息模型中，应该采用手动Ack的方式，因为如果是自动Ack，那么每次已使用body的消息体，消费者就自动Ack告诉RabbitMQ消息已被消费，那么RabbitMQ就会立刻将下一条消息发送给该消费者，这样消费者的线程休眠问题就体现不出来。</strong></p>\n","categories":["消息队列"],"tags":["RabbitMQ","消息队列"]},{"title":"消息队列RabbitMQ之五种消息模型","url":"/2020/03/23/tool/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97RabbitMQ%E4%B9%8B%E4%BA%94%E7%A7%8D%E6%B6%88%E6%81%AF%E6%A8%A1%E5%9E%8B/","content":"<h1 id=\"RabbitMQ的消息模型\"><a href=\"#RabbitMQ的消息模型\" class=\"headerlink\" title=\"RabbitMQ的消息模型\"></a>RabbitMQ的消息模型</h1><p>在RabbitMQ的<a href=\"https://www.rabbitmq.com/getstarted.html\">官方教程</a>中，RabbitMQ为我们提供了6中消息模型，不过第6种是RPC（远程调用），不是MQ（消息队列），所以RabbitMQ真正的消息模型只有5种。</p>\n<span id=\"more\"></span>\n<p><img src=\"/images/2020/03/20200323164120787.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"RabbitMQ消息模型——基本消息模型\"><a href=\"#RabbitMQ消息模型——基本消息模型\" class=\"headerlink\" title=\"RabbitMQ消息模型——基本消息模型\"></a>RabbitMQ消息模型——基本消息模型</h2><p><img src=\"/images/2020/03/20200323164409664.png\" alt=\"在这里插入图片描述\"></p>\n<ul>\n<li>P（producer/ publisher）：生产者，一个发送消息的用户应用程序。</li>\n<li>C（consumer）：消费者，消费和接收有类似的意思，消费者是一个主要用来等待接收消息的用户应用程序</li>\n<li>队列（红色区域）：rabbitmq内部类似于邮箱的一个概念。虽然消息流经rabbitmq和你的应用程序，但是它们只能存储在队列中。队列只受主机的内存和磁盘限制，实质上是一个大的消息缓冲区。许多生产者可以发送消息到一个队列，许多消费者可以尝试从一个队列接收数据。</li>\n<li>生产者将消息发送到队列，消费者从队列中获取消息，队列是存储消息的缓冲区。</li>\n</ul>\n<h2 id=\"RabbitMQ消息模型——work队列消息模型\"><a href=\"#RabbitMQ消息模型——work队列消息模型\" class=\"headerlink\" title=\"RabbitMQ消息模型——work队列消息模型\"></a>RabbitMQ消息模型——work队列消息模型</h2><p><img src=\"/images/2020/03/20200323164538601.png\" alt=\"在这里插入图片描述\"></p>\n<ul>\n<li>work队列模型是为了弥补基本消息模型的缺陷而诞生的，是通过一个队列绑定多个消费者，以达到避免消息在队列中堆积的情况。</li>\n</ul>\n<h2 id=\"RabbitMQ消息模型——订阅模型Fanout\"><a href=\"#RabbitMQ消息模型——订阅模型Fanout\" class=\"headerlink\" title=\"RabbitMQ消息模型——订阅模型Fanout\"></a>RabbitMQ消息模型——订阅模型Fanout</h2><p><img src=\"/images/2020/03/20200323164629309.png\" alt=\"在这里插入图片描述\"></p>\n<ul>\n<li>RabbitMQ的第三、四、五种消息模型其实都是订阅模型，分别是订阅模型的三种不同的类型。</li>\n<li>订阅模型比基本消息模型和work队列消息模型，多出了一个交换机，每个队列都要绑定交换机。</li>\n<li>生产者不再直接将消息发送到队列中，而是发送到交换机中，然后由交换机根据不同的策略，发送到不同的队列中。订阅模型的三种不同类型，其实就是采用了不同的交换机分发策略。</li>\n<li>Fanout（扇出）模型，交换机直接将所有消息以广播的形式，发送给所有队列。即生产者生产的一条消息，会被交换机发给所有的队列，所有和队列绑定的消费者均会消费这一条消息。</li>\n</ul>\n<h2 id=\"RabbitMQ消息模型——订阅模型Direct\"><a href=\"#RabbitMQ消息模型——订阅模型Direct\" class=\"headerlink\" title=\"RabbitMQ消息模型——订阅模型Direct\"></a>RabbitMQ消息模型——订阅模型Direct</h2><p><img src=\"/images/2020/03/20200323164811911.png\" alt=\"在这里插入图片描述\"></p>\n<ul>\n<li>Direct（选择性发送），交换机不会将消息发送给所有队列，而是通过队列绑定到交换机上的RoutingKey（路由Key）发送到指定的队列中。</li>\n<li>生产者在生产消息的时候，需要指定RoutingKey，这样交换机才知道该将该条消息发送给指定队列。</li>\n</ul>\n<h2 id=\"RabbitMQ消息模型——订阅模型Topic\"><a href=\"#RabbitMQ消息模型——订阅模型Topic\" class=\"headerlink\" title=\"RabbitMQ消息模型——订阅模型Topic\"></a>RabbitMQ消息模型——订阅模型Topic</h2><p><img src=\"/images/2020/03/20200323164825921.png\" alt=\"在这里插入图片描述\"></p>\n<ul>\n<li>Topic（模糊选择发送），Topic模型和Direct模型基本类似，不过Topic模型的交换机可以让队列在绑定的时候，使用通配符的方式进行模糊匹配。</li>\n<li><code>*</code>表示正好匹配一个单词，<code>#</code>表示匹配一个或多个单词。</li>\n</ul>\n","categories":["消息队列"],"tags":["RabbitMQ","消息队列"]},{"title":"消息队列RabbitMQ之初学者","url":"/2020/03/23/tool/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97RabbitMQ%E4%B9%8B%E5%88%9D%E5%AD%A6%E8%80%85/","content":"<h1 id=\"消息队列\"><a href=\"#消息队列\" class=\"headerlink\" title=\"消息队列\"></a>消息队列</h1><h2 id=\"什么是消息队列\"><a href=\"#什么是消息队列\" class=\"headerlink\" title=\"什么是消息队列\"></a>什么是消息队列</h2><p>消息队列，即Message Queue（MQ）。消息队列是一种应用程序对应用程序的通信方法，应用程序通过读写出入队列的消息来进行通信，而无需专用连接来链接它们，消息传递是指程序之间通过在消息中发送数据进行通信，而不是通过直接调用彼此来通信。<br>排队是指通过应用程序通过队列来通信，队列的使用除去了接收和发送应用程序同时执行的要求，其中RabbitMQ就是一款较为成熟的MQ产品。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"生产者和消费者\"><a href=\"#生产者和消费者\" class=\"headerlink\" title=\"生产者和消费者\"></a>生产者和消费者</h2><p>消息队列是典型的生产者消费者模型，生产者不断向消息队列中生产消息，消费者不断地从队列中获取消息，因为消息的生产和消费都是异步的，而且只关心消息的发送和接收，没有业务逻辑的侵入，这样就实现了生产者和消费者的解耦。</p>\n<h2 id=\"AMQP和JMS\"><a href=\"#AMQP和JMS\" class=\"headerlink\" title=\"AMQP和JMS\"></a>AMQP和JMS</h2><p>MQ是消息通信的模型，并不是具体的实现，现在实现MQ有两种主流方式：AMQP和JMS。</p>\n<p><strong>AMQP</strong></p>\n<p>AMQP，即Advanced Message Queuing Protocot，是一个提供统一消息服务的应用层标准高级消息队列协议，是应用层协议的一个开放标准，为面向消息的中间件设计，基于此协议的客户端与消息中间件可传递消息，并不受客户端中间件不同产品，不同开发语言等条件的限制，Erlang语言的实现有RabbitMQ等。</p>\n<p><strong>JMS</strong></p>\n<p>JMS，即Java Message Service，实际上是指JMS API。JMS由Sun公司早起提出的消息标准，旨在为Java应用程序提供统一的消息操作，包括create、send、receive等，JMS已经成为了Java EE的一部分，从使用角度来看，JMS和JDBC担任差不多的角色，用户都是根据相应的接口可以和实现了JMS的服务器进行通信，进行相关操作。</p>\n<h2 id=\"AMQP和JMS的区别\"><a href=\"#AMQP和JMS的区别\" class=\"headerlink\" title=\"AMQP和JMS的区别\"></a>AMQP和JMS的区别</h2><table>\n<thead>\n<tr>\n<th>AMQP</th>\n<th>JMS</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>AMQP是通过规定协议来统一数据交互的格式</td>\n<td>JMS是定义了统一的接口，来对消息操作进行统一</td>\n</tr>\n<tr>\n<td>AMQP只是协议，不规定实现方式，因此是跨语言的</td>\n<td>JMS限定了必须使用Java语言</td>\n</tr>\n<tr>\n<td>AMQP的消息模型更加丰富</td>\n<td>JMS规定了两种常见的消息模型</td>\n</tr>\n</tbody></table>\n<h2 id=\"常见的MQ产品\"><a href=\"#常见的MQ产品\" class=\"headerlink\" title=\"常见的MQ产品\"></a>常见的MQ产品</h2><ul>\n<li>ActiveMQ：基于JMS。</li>\n<li>RabbitMQ：基于AMQP协议，erlang语言开发，稳定性好。</li>\n<li>RocketMQ：基于JMS，阿里巴巴产品，目前交由Apache基金会管理。</li>\n<li>Kafka：分布式消息系统，高吞吐量。</li>\n</ul>\n<h1 id=\"RabbitMQ\"><a href=\"#RabbitMQ\" class=\"headerlink\" title=\"RabbitMQ\"></a>RabbitMQ</h1><p><strong>RabbitMQ是一款基于AMQP的消息队列产品。</strong></p>\n<ul>\n<li>RabbitMQ是一个开源的，在AMQP基础上完整的，可复用的企业消息系统。</li>\n<li>支持主流的操作系统，Linux、Windows、MacOX等。</li>\n<li>多种开发语言支持，Java、Python、Ruby、.NET、PHP、C/C++、node.js等等。</li>\n</ul>\n<h2 id=\"Erlang语言\"><a href=\"#Erlang语言\" class=\"headerlink\" title=\"Erlang语言\"></a>Erlang语言</h2><p>Erlang是一种面向并发的编程语言，RabbitMQ就是基于Erlang语言而进行编写的，所以如果想要安装RabbitMQ，那么就需要先按照Erlang语言的环境。</p>\n<p><strong>Erlang环境安装</strong></p>\n<p>Erlang语言Windows版安装包：</p>\n<p><a href=\"http://www.erlang.org/download/otp_win64_17.3.exe\">http://www.erlang.org/download/otp_win64_17.3.exe</a></p>\n<p>Linux环境在线安装：</p>\n<figure class=\"highlight powershell\"><table><tr><td class=\"code\"><pre><span class=\"line\">yum install esl<span class=\"literal\">-erlang_17</span>.<span class=\"number\">3</span><span class=\"literal\">-1</span>~centos~<span class=\"number\">6</span>_amd64.rpm</span><br><span class=\"line\">yum install esl<span class=\"literal\">-erlang-compat-R14B-1</span>.el6.noarch.rpm</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"RabbitMQ下载\"><a href=\"#RabbitMQ下载\" class=\"headerlink\" title=\"RabbitMQ下载\"></a>RabbitMQ下载</h2><p>官网： <a href=\"http://www.rabbitmq.com/\">http://www.rabbitmq.com/</a></p>\n<p><img src=\"/images/2020/03/2020032316274412.png\" alt=\"在这里插入图片描述\"></p>\n<p>官方教程：<a href=\"http://www.rabbitmq.com/getstarted.html\">http://www.rabbitmq.com/getstarted.html</a></p>\n<p><img src=\"/images/2020/03/20200323162907391.png\" alt=\"在这里插入图片描述\"></p>\n","categories":["消息队列"],"tags":["RabbitMQ","消息队列"]},{"title":"消息队列RabbitMQ之基本消息模型","url":"/2020/03/23/tool/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97RabbitMQ%E4%B9%8B%E5%9F%BA%E6%9C%AC%E6%B6%88%E6%81%AF%E6%A8%A1%E5%9E%8B/","content":"<h1 id=\"基本消息模型\"><a href=\"#基本消息模型\" class=\"headerlink\" title=\"基本消息模型\"></a>基本消息模型</h1><p>RabbitMQ的基本消息模型，是RabbitMQ五种消息模型中最为基础的一种，该模型简单直接，容易理解。</p>\n<span id=\"more\"></span>\n\n<p><img src=\"/images/2020/03/20200323203309200.png\" alt=\"在这里插入图片描述\"></p>\n<ul>\n<li>P为消息生产者，P本质上就是一个发送消息的应用程序，P每生产一条消息，就会将消息放入消息队列中。</li>\n<li>红色部分就是消息队列，顾名思义，它本质上就是一个队列，只不过这个队列是用来存取消息的，它同样遵循队列的基本特点，<strong>先进先出，后进后出</strong>。</li>\n<li>C为消息消费者，C本质上同样是一个接收消息的应用程序，C会不断监听队列中的消息，每当队列中出现新的消息，C就会开始消费队列中的消息。</li>\n</ul>\n<h1 id=\"JavaAPI实现基本消息模型\"><a href=\"#JavaAPI实现基本消息模型\" class=\"headerlink\" title=\"JavaAPI实现基本消息模型\"></a>JavaAPI实现基本消息模型</h1><p><a href=\"/2020/03/23/tool/消息队列RabbitMQ之初学者/\">消息队列RabbitMQ之初学者</a>中已经描述过了，RabbitMQ是一款基于AMQP协议的消息队列产品，它不受客户端和中间件使用不同语言开发条件的限制，同时在<a href=\"http://www.rabbitmq.com/getstarted.html\">官方教程</a>中也表明了，RabbitMQ可以接受Java，Python等语言的客户端API。</p>\n<p>我们这里就使用JavaAPI来实现RabbitMQ基本消息模型。</p>\n<h2 id=\"搭建项目环境\"><a href=\"#搭建项目环境\" class=\"headerlink\" title=\"搭建项目环境\"></a>搭建项目环境</h2><p>SpringBoot中有一个amqp的启动器，是SpringBoot为我们封装好的amqp消息队列的操作API。当然，我们不会直接使用SpringBoot的API来实现基本数据模型，而是使用被封装的RabbitMQ Client来实现基本数据模型。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.0.4.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"准备工具类\"><a href=\"#准备工具类\" class=\"headerlink\" title=\"准备工具类\"></a>准备工具类</h2><p>因为我们使用JavaAPI来操作RabbitMQ，自然需要通过IP和端口号，以及RabbitMQ的账号密码，来获取Java程序与RabbitMQ之间的连接，这是一繁琐的操作，我们直接将这些操作封装成一个独立的工具类，方便我们使用。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">ConnectionUtils</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Connection <span class=\"title function_\">getConnection</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> IOException, TimeoutException &#123;</span><br><span class=\"line\">        <span class=\"comment\">//创建连接工厂</span></span><br><span class=\"line\">        <span class=\"type\">ConnectionFactory</span> <span class=\"variable\">factory</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">ConnectionFactory</span>();</span><br><span class=\"line\">        <span class=\"comment\">//设置连接IP地址</span></span><br><span class=\"line\">        factory.setHost(<span class=\"string\">&quot;192.168.177.128&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//设置连接端口号</span></span><br><span class=\"line\">        factory.setPort(<span class=\"number\">5672</span>);</span><br><span class=\"line\">        <span class=\"comment\">//设置RabbitMQ连接的虚拟主机</span></span><br><span class=\"line\">        factory.setVirtualHost(<span class=\"string\">&quot;/mymq&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//设置RabbitMQ的用户名</span></span><br><span class=\"line\">        factory.setUsername(<span class=\"string\">&quot;admin&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//设置RabbitMQ的密码</span></span><br><span class=\"line\">        factory.setPassword(<span class=\"string\">&quot;admin&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//使用连接工厂获取连接</span></span><br><span class=\"line\">        <span class=\"type\">Connection</span> <span class=\"variable\">connection</span> <span class=\"operator\">=</span> factory.newConnection();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> connection;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建生产者\"><a href=\"#创建生产者\" class=\"headerlink\" title=\"创建生产者\"></a>创建生产者</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Send</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//RabbitMQ的队列名称</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"type\">String</span> <span class=\"variable\">QUEUE_NAME</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;simple_queue&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException, TimeoutException &#123;</span><br><span class=\"line\">        <span class=\"comment\">//使用工具类，获取RabbitMQ的连接</span></span><br><span class=\"line\">        <span class=\"type\">Connection</span> <span class=\"variable\">connection</span> <span class=\"operator\">=</span> ConnectionUtils.getConnection();</span><br><span class=\"line\">        <span class=\"comment\">//使用连接创建通道</span></span><br><span class=\"line\">        <span class=\"type\">Channel</span> <span class=\"variable\">channel</span> <span class=\"operator\">=</span> connection.createChannel();</span><br><span class=\"line\">        <span class=\"comment\">//使用通道声明一个队列，参数分别为：队列名称，是否持久化，是否为排他队列，是否自动删除，其他属性</span></span><br><span class=\"line\">        channel.queueDeclare(QUEUE_NAME,<span class=\"literal\">false</span>,<span class=\"literal\">false</span>,<span class=\"literal\">false</span>,<span class=\"literal\">null</span>);</span><br><span class=\"line\">        <span class=\"comment\">//需要发送的消息</span></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">message</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;Hello World!&quot;</span>;</span><br><span class=\"line\">        <span class=\"comment\">//使用通道发送消息，参数分别为：交换机名称，路由Key，其他属性，消息正文</span></span><br><span class=\"line\">        channel.basicPublish(<span class=\"string\">&quot;&quot;</span>,QUEUE_NAME,<span class=\"literal\">null</span>,message.getBytes());</span><br><span class=\"line\">        <span class=\"comment\">//关闭通道</span></span><br><span class=\"line\">        channel.close();</span><br><span class=\"line\">        <span class=\"comment\">//关闭连接</span></span><br><span class=\"line\">        connection.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"创建消费者\"><a href=\"#创建消费者\" class=\"headerlink\" title=\"创建消费者\"></a>创建消费者</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Recv</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//RabbitMQ的队列名称</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"type\">String</span> <span class=\"variable\">QUEUE_NAME</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;simple_queue&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException, TimeoutException &#123;</span><br><span class=\"line\">        <span class=\"comment\">//使用工具类，获取RabbitMQ的连接</span></span><br><span class=\"line\">        <span class=\"type\">Connection</span> <span class=\"variable\">connection</span> <span class=\"operator\">=</span> ConnectionUtils.getConnection();</span><br><span class=\"line\">        <span class=\"comment\">//使用连接创建通道</span></span><br><span class=\"line\">        <span class=\"type\">Channel</span> <span class=\"variable\">channel</span> <span class=\"operator\">=</span> connection.createChannel();</span><br><span class=\"line\">        <span class=\"comment\">//使用通道声明一个队列，参数分别为：队列名称，是否持久化，是否为排他队列，是否自动删除，其他属性</span></span><br><span class=\"line\">        channel.queueDeclare(QUEUE_NAME,<span class=\"literal\">false</span>,<span class=\"literal\">false</span>,<span class=\"literal\">false</span>,<span class=\"literal\">null</span>);</span><br><span class=\"line\">        <span class=\"comment\">//定义队列的消费者</span></span><br><span class=\"line\">        <span class=\"type\">DefaultConsumer</span> <span class=\"variable\">consumer</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">DefaultConsumer</span>(channel)&#123;</span><br><span class=\"line\">            <span class=\"comment\">//覆写该方法，该方法类似于监听器，当队列中有消息的时候，就会被调用执行</span></span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">handleDelivery</span><span class=\"params\">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class=\"type\">byte</span>[] body)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">                <span class=\"comment\">//byte[] body参数即为消息体，当该消息体被使用，即认为该消息已被消费</span></span><br><span class=\"line\">                System.out.println(<span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(body));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"comment\">//监听队列，参数分别为：队列名称，是否自动确认消息已被消费，队列消费者</span></span><br><span class=\"line\">        channel.basicConsume(QUEUE_NAME,<span class=\"literal\">true</span>,consumer);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"消息确认机制\"><a href=\"#消息确认机制\" class=\"headerlink\" title=\"消息确认机制\"></a>消息确认机制</h1><p><img src=\"/images/2020/03/20200323211128238.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"消息自动确认-Ack-机制的问题\"><a href=\"#消息自动确认-Ack-机制的问题\" class=\"headerlink\" title=\"消息自动确认(Ack)机制的问题\"></a>消息自动确认(Ack)机制的问题</h2><p>由于消费者中的消息体是byte类型的数组结构，但是我们在实际使用的使用的时候，可能会先对byte类型的数组进行一些字符串的处理，然后才会真正消费该数据。<br>消息被自动确认之后，消息就会从消息队列中移除，但是如果又因为其他意外原因，导致消息未能被真正消费，那么这条消息就直接丢失了。</p>\n<p><strong>所以消息自动确认机制可能会导致消息的丢失。</strong><br><img src=\"/images/2020/03/20200323211943426.png\" alt=\"在这里插入图片描述\"></p>\n<h2 id=\"消息手动确认-Ack-机制\"><a href=\"#消息手动确认-Ack-机制\" class=\"headerlink\" title=\"消息手动确认(Ack)机制\"></a>消息手动确认(Ack)机制</h2><ul>\n<li>消息自动Ack：消息一旦被接收，消费者立刻自动发送Ack。</li>\n<li>消息手动Ack：消息接收后，不会自动发送Ack，需要程序手动Ack，确认消息已被接收。</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Recv</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//RabbitMQ的队列名称</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"type\">String</span> <span class=\"variable\">QUEUE_NAME</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;simple_queue&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException, TimeoutException &#123;</span><br><span class=\"line\">        <span class=\"comment\">//使用工具类，获取RabbitMQ的连接</span></span><br><span class=\"line\">        <span class=\"type\">Connection</span> <span class=\"variable\">connection</span> <span class=\"operator\">=</span> ConnectionUtils.getConnection();</span><br><span class=\"line\">        <span class=\"comment\">//使用连接创建通道</span></span><br><span class=\"line\">        <span class=\"type\">Channel</span> <span class=\"variable\">channel</span> <span class=\"operator\">=</span> connection.createChannel();</span><br><span class=\"line\">        <span class=\"comment\">//使用通道声明一个队列，参数分别为：队列名称，是否持久化，是否为排他队列，是否自动删除，其他属性</span></span><br><span class=\"line\">        channel.queueDeclare(QUEUE_NAME,<span class=\"literal\">false</span>,<span class=\"literal\">false</span>,<span class=\"literal\">false</span>,<span class=\"literal\">null</span>);</span><br><span class=\"line\">        <span class=\"comment\">//定义队列的消费者</span></span><br><span class=\"line\">        <span class=\"type\">DefaultConsumer</span> <span class=\"variable\">consumer</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">DefaultConsumer</span>(channel)&#123;</span><br><span class=\"line\">            <span class=\"comment\">//覆写该方法，该方法类似于监听器，当队列中有消息的时候，就会被调用执行</span></span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">handleDelivery</span><span class=\"params\">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class=\"type\">byte</span>[] body)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">                <span class=\"comment\">//byte[] body参数即为消息体，当该消息体被使用，即认为该消息已被消费</span></span><br><span class=\"line\">                System.out.println(<span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(body));</span><br><span class=\"line\">                <span class=\"comment\">//手动Ack，确认消息已被消费</span></span><br><span class=\"line\">                channel.basicAck(envelope.getDeliveryTag(),<span class=\"literal\">false</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"comment\">//监听队列，参数分别为：队列名称，是否自动确认消息已被消费，队列消费者</span></span><br><span class=\"line\">        <span class=\"comment\">//第二个参数为false，即不自动Ack，而是改用手动Ack</span></span><br><span class=\"line\">        channel.basicConsume(QUEUE_NAME,<span class=\"literal\">false</span>,consumer);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"自动Ack和手动Ack的选择\"><a href=\"#自动Ack和手动Ack的选择\" class=\"headerlink\" title=\"自动Ack和手动Ack的选择\"></a>自动Ack和手动Ack的选择</h2><p>自动Ack和手动Ack各有优势，那么我们应该什么时候使用自动Ack，什么时候使用手动Ack呢？</p>\n<p><strong>我们应该根据消息的重要性来进行选择。</strong></p>\n<ul>\n<li>如果一个消息不是很重要，即使丢失也不会对系统造成影响，那么我们使用自动Ack会比较方便。</li>\n<li>如果一个消息非常重要，不允许该消息发生丢失的情况，那么我们就应该使用手动Ack来进行消息确认，防止消息丢失。</li>\n</ul>\n","categories":["消息队列"],"tags":["RabbitMQ","消息队列"]},{"title":"消息队列RabbitMQ之消息持久化","url":"/2020/03/24/tool/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97RabbitMQ%E4%B9%8B%E6%B6%88%E6%81%AF%E6%8C%81%E4%B9%85%E5%8C%96/","content":"<h1 id=\"RabbitMQ消息持久化\"><a href=\"#RabbitMQ消息持久化\" class=\"headerlink\" title=\"RabbitMQ消息持久化\"></a>RabbitMQ消息持久化</h1><h2 id=\"为什么需要消息持久化？\"><a href=\"#为什么需要消息持久化？\" class=\"headerlink\" title=\"为什么需要消息持久化？\"></a>为什么需要消息持久化？</h2><p>之前在<a href=\"/2020/03/23/tool/消息队列RabbitMQ之基本消息模型/\">消息队列RabbitMQ之基本消息模型</a>中曾经谈过RabbitMQ的手动Ack机制，手动Ack机制可以很好的保证消息被正常消费，即使程序发生异常，消息依然可以保存在消息队列中。</p>\n<span id=\"more\"></span>\n<p>但是如果是消费者还没有消费数据，但是消息队列发生了宕机，导致消息队列中的消息丢失，那又该怎么办呢？<br>于是就衍生出来了RabbitMQ的持久化机制。</p>\n<h2 id=\"怎么设置消息持久化？\"><a href=\"#怎么设置消息持久化？\" class=\"headerlink\" title=\"怎么设置消息持久化？\"></a>怎么设置消息持久化？</h2><p>消息队列进行持久化，前提是交换机和队列都需要进行持久化设置。</p>\n<h1 id=\"JavaAPI设置持久化属性\"><a href=\"#JavaAPI设置持久化属性\" class=\"headerlink\" title=\"JavaAPI设置持久化属性\"></a>JavaAPI设置持久化属性</h1><ul>\n<li><p>通道声明交换机的时候，最后一个属性为是否持久化，属性值为<code>true</code>即可设置交换机持久化。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//声明交换机exchange，指定类型为fanout，BuiltinExchangeType是一个枚举类，最后一个参数为指定交换机的持久化属性</span></span><br><span class=\"line\">channel.exchangeDeclare(EXCHANGE_NAME, BuiltinExchangeType.TOPIC,<span class=\"literal\">true</span>);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>通道声明队列的时候，第二个属性为是否持久化，属性值为<code>true</code>即可设置队列持久化。</p>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"> <span class=\"comment\">//使用通道声明一个队列，参数分别为：队列名称，是否持久化，是否为排他队列，是否自动删除，其他属性</span></span><br><span class=\"line\">channel.queueDeclare(QUEUE_NAME, <span class=\"literal\">true</span>, <span class=\"literal\">false</span>, <span class=\"literal\">false</span>, <span class=\"literal\">null</span>);</span><br></pre></td></tr></table></figure>\n<ul>\n<li>生产者发送消息的时候，第三个属性为其他属性，可以选择值<code>MessageProperties.PERSISTENT_TEXT_PLAIN</code>来进行消息持久化。</li>\n<li><code>MessageProperties.PERSISTENT_TEXT_PLAIN</code>属性的意思是：<code>消息属性：普通持久化文本</code>。<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//使用通道发送消息到交换机，参数分别为：交换机名称，路由Key，其他属性，消息正文</span></span><br><span class=\"line\">channel.basicPublish(EXCHANGE_NAME, <span class=\"string\">&quot;insert.user.data&quot;</span>, MessageProperties.PERSISTENT_TEXT_PLAIN, insert_message.getBytes());</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n","categories":["消息队列"],"tags":["RabbitMQ","消息队列"]},{"title":"消息队列RabbitMQ之订阅模型Direct","url":"/2020/03/24/tool/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97RabbitMQ%E4%B9%8B%E8%AE%A2%E9%98%85%E6%A8%A1%E5%9E%8BDirect/","content":"<h1 id=\"订阅模型\"><a href=\"#订阅模型\" class=\"headerlink\" title=\"订阅模型\"></a>订阅模型</h1><p>关于RabbitMQ订阅模型的知识，可以参考前置知识中的<a href=\"/2020/03/24/tool/消息队列RabbitMQ之订阅模型Fanout/\">消息队列RabbitMQ之订阅模型Fanout</a>博客，该篇博客已经讲解了RabbitMQ的订阅模型。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"订阅模型Direct\"><a href=\"#订阅模型Direct\" class=\"headerlink\" title=\"订阅模型Direct\"></a>订阅模型Direct</h2><p><img src=\"/images/2020/03/2020032410371494.png\" alt=\"在这里插入图片描述\"><br>订阅模型Direct的消息发送过程，基本和订阅模型Fanout类似，不同的是交换机的发送策略。</p>\n<ul>\n<li>Direct交换机发送的消息，必须携带一个RoutingKey（路由Key），而每个绑定交换机的队列，也必须绑定一个RoutingKey（路由Key），交换机通过RoutingKey来进行选择，将消息发送至指定消息队列。</li>\n</ul>\n<h1 id=\"JavaAPI实现订阅模型Direct\"><a href=\"#JavaAPI实现订阅模型Direct\" class=\"headerlink\" title=\"JavaAPI实现订阅模型Direct\"></a>JavaAPI实现订阅模型Direct</h1><h2 id=\"准备工作\"><a href=\"#准备工作\" class=\"headerlink\" title=\"准备工作\"></a>准备工作</h2><p>使用JavaAPI实现消息队列模型，需要先做一些准备工作，这些准备工作包括搭建项目环境和准备工具类，这些工作在<a href=\"/2020/03/23/tool/消息队列RabbitMQ之基本消息模型/\">消息队列RabbitMQ之基本消息模型</a>已经准备好了，就不重复准备了。</p>\n<h2 id=\"创建生产者\"><a href=\"#创建生产者\" class=\"headerlink\" title=\"创建生产者\"></a>创建生产者</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Send</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//RabbitMQ的交换机名称</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"type\">String</span> <span class=\"variable\">EXCHANGE_NAME</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;amq.direct&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] argv)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"comment\">//使用工具类，获取RabbitMQ的连接</span></span><br><span class=\"line\">        <span class=\"type\">Connection</span> <span class=\"variable\">connection</span> <span class=\"operator\">=</span> ConnectionUtils.getConnection();</span><br><span class=\"line\">        <span class=\"comment\">//使用连接创建通道</span></span><br><span class=\"line\">        <span class=\"type\">Channel</span> <span class=\"variable\">channel</span> <span class=\"operator\">=</span> connection.createChannel();</span><br><span class=\"line\">        <span class=\"comment\">//声明交换机exchange，指定类型为fanout，BuiltinExchangeType是一个枚举类，最后一个参数为指定交换机的持久化属性</span></span><br><span class=\"line\">        channel.exchangeDeclare(EXCHANGE_NAME, BuiltinExchangeType.DIRECT,<span class=\"literal\">true</span>);</span><br><span class=\"line\">        <span class=\"comment\">//需要发送的消息</span></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">insert_message</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;插入数据&quot;</span>;</span><br><span class=\"line\">        <span class=\"comment\">//使用通道发送消息到交换机，参数分别为：交换机名称，路由Key，其他属性，消息正文</span></span><br><span class=\"line\">        channel.basicPublish(EXCHANGE_NAME, <span class=\"string\">&quot;insert&quot;</span>, <span class=\"literal\">null</span>, insert_message.getBytes());</span><br><span class=\"line\">        <span class=\"comment\">//需要发送的消息</span></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">delete_message</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;删除数据&quot;</span>;</span><br><span class=\"line\">        <span class=\"comment\">//使用通道发送消息到交换机，参数分别为：交换机名称，路由Key，其他属性，消息正文</span></span><br><span class=\"line\">        channel.basicPublish(EXCHANGE_NAME, <span class=\"string\">&quot;delete&quot;</span>, <span class=\"literal\">null</span>, delete_message.getBytes());</span><br><span class=\"line\">        <span class=\"comment\">//关闭通道</span></span><br><span class=\"line\">        channel.close();</span><br><span class=\"line\">        <span class=\"comment\">//关闭连接</span></span><br><span class=\"line\">        connection.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建消费者1\"><a href=\"#创建消费者1\" class=\"headerlink\" title=\"创建消费者1\"></a>创建消费者1</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Recv1</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//消费者的队列名称</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"type\">String</span> <span class=\"variable\">QUEUE_NAME</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;direct_exchange_queue_1&quot;</span>;</span><br><span class=\"line\">    <span class=\"comment\">//RabbitMQ的交换机名称</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"type\">String</span> <span class=\"variable\">EXCHANGE_NAME</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;amq.direct&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] argv)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"comment\">//使用工具类，获取RabbitMQ的连接</span></span><br><span class=\"line\">        <span class=\"type\">Connection</span> <span class=\"variable\">connection</span> <span class=\"operator\">=</span> ConnectionUtils.getConnection();</span><br><span class=\"line\">        <span class=\"comment\">//使用连接创建通道</span></span><br><span class=\"line\">        <span class=\"type\">Channel</span> <span class=\"variable\">channel</span> <span class=\"operator\">=</span> connection.createChannel();</span><br><span class=\"line\">        <span class=\"comment\">//使用通道声明一个队列，参数分别为：队列名称，是否持久化，是否为排他队列，是否自动删除，其他属性</span></span><br><span class=\"line\">        channel.queueDeclare(QUEUE_NAME, <span class=\"literal\">false</span>, <span class=\"literal\">false</span>, <span class=\"literal\">false</span>, <span class=\"literal\">null</span>);</span><br><span class=\"line\">        <span class=\"comment\">//绑定队列到交换机，路由key为insert和delete，接受路由Key为insert和delete的消息</span></span><br><span class=\"line\">        channel.queueBind(QUEUE_NAME, EXCHANGE_NAME, <span class=\"string\">&quot;insert&quot;</span>);</span><br><span class=\"line\">        channel.queueBind(QUEUE_NAME, EXCHANGE_NAME, <span class=\"string\">&quot;delete&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//定义队列的消费者</span></span><br><span class=\"line\">        <span class=\"type\">DefaultConsumer</span> <span class=\"variable\">consumer</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">DefaultConsumer</span>(channel) &#123;</span><br><span class=\"line\">            <span class=\"comment\">//覆写该方法，该方法类似于监听器，当队列中有消息的时候，就会被调用执行</span></span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">handleDelivery</span><span class=\"params\">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class=\"type\">byte</span>[] body)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">                <span class=\"comment\">//byte[] body参数即为消息体，当该消息体被使用，即认为该消息已被消费</span></span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot; [消费者1] received : &quot;</span> + <span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(body));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"comment\">//监听队列，参数分别为：队列名称，是否自动确认消息已被消费，队列消费者</span></span><br><span class=\"line\">        channel.basicConsume(QUEUE_NAME, <span class=\"literal\">true</span>, consumer);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建消费者2\"><a href=\"#创建消费者2\" class=\"headerlink\" title=\"创建消费者2\"></a>创建消费者2</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Recv2</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//消费者的队列名称</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"type\">String</span> <span class=\"variable\">QUEUE_NAME</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;direct_exchange_queue_2&quot;</span>;</span><br><span class=\"line\">    <span class=\"comment\">//RabbitMQ的交换机名称</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"type\">String</span> <span class=\"variable\">EXCHANGE_NAME</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;amq.direct&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] argv)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"comment\">//使用工具类，获取RabbitMQ的连接</span></span><br><span class=\"line\">        <span class=\"type\">Connection</span> <span class=\"variable\">connection</span> <span class=\"operator\">=</span> ConnectionUtils.getConnection();</span><br><span class=\"line\">        <span class=\"comment\">//使用连接创建通道</span></span><br><span class=\"line\">        <span class=\"type\">Channel</span> <span class=\"variable\">channel</span> <span class=\"operator\">=</span> connection.createChannel();</span><br><span class=\"line\">        <span class=\"comment\">//使用通道声明一个队列，参数分别为：队列名称，是否持久化，是否为排他队列，是否自动删除，其他属性</span></span><br><span class=\"line\">        channel.queueDeclare(QUEUE_NAME, <span class=\"literal\">false</span>, <span class=\"literal\">false</span>, <span class=\"literal\">false</span>, <span class=\"literal\">null</span>);</span><br><span class=\"line\">        <span class=\"comment\">//绑定队列到交换机，路由key为insert，只接收路由Key为delete的消息</span></span><br><span class=\"line\">        channel.queueBind(QUEUE_NAME, EXCHANGE_NAME, <span class=\"string\">&quot;delete&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//定义队列的消费者</span></span><br><span class=\"line\">        <span class=\"type\">DefaultConsumer</span> <span class=\"variable\">consumer</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">DefaultConsumer</span>(channel) &#123;</span><br><span class=\"line\">            <span class=\"comment\">//覆写该方法，该方法类似于监听器，当队列中有消息的时候，就会被调用执行</span></span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">handleDelivery</span><span class=\"params\">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class=\"type\">byte</span>[] body)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">                <span class=\"comment\">//byte[] body参数即为消息体，当该消息体被使用，即认为该消息已被消费</span></span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot; [消费者2] received : &quot;</span> + <span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(body));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"comment\">//监听队列，参数分别为：队列名称，是否自动确认消息已被消费，队列消费者</span></span><br><span class=\"line\">        channel.basicConsume(QUEUE_NAME, <span class=\"literal\">true</span>, consumer);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n","categories":["消息队列"],"tags":["RabbitMQ","消息队列"]},{"title":"消息队列RabbitMQ之订阅模型Fanout","url":"/2020/03/24/tool/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97RabbitMQ%E4%B9%8B%E8%AE%A2%E9%98%85%E6%A8%A1%E5%9E%8BFanout/","content":"<h1 id=\"订阅模型\"><a href=\"#订阅模型\" class=\"headerlink\" title=\"订阅模型\"></a>订阅模型</h1><blockquote>\n<p>订阅模型是RabbitMQ的消息模型之一，其中订阅模型又分为三种，分别是Fanout、Direct、Topic。</p>\n</blockquote>\n<span id=\"more\"></span>\n<p>订阅模型区分于基本消息模型和Work队列消息模型，在于订阅模型的生产者并不直接将消息发送到队列中，而是将消息发送到交换机中，然后由交换机选择合适的策略发送到合适的队列中，最后再由消费者接收消息。</p>\n<h2 id=\"订阅模型的特点\"><a href=\"#订阅模型的特点\" class=\"headerlink\" title=\"订阅模型的特点\"></a>订阅模型的特点</h2><ul>\n<li>订阅模型是一个生产者，多个消费者。</li>\n<li>订阅模型的每一个消费者都有自己的一个消息队列。</li>\n<li>订阅模型生产者并不将消息发送给消息队列，而是发送给交换机。</li>\n<li>订阅模型的每个消息队列，都要绑定到交换机上。</li>\n<li>订阅模型的消息，从生产者生产，发送非交换机，然后由交换机发送给消息队列，最后被消费者接收消费。</li>\n</ul>\n<h2 id=\"订阅模型交换机类型\"><a href=\"#订阅模型交换机类型\" class=\"headerlink\" title=\"订阅模型交换机类型\"></a>订阅模型交换机类型</h2><p>订阅模型之所以被分为三种，其实就是因为交换机的类型不同而划分的，交换机的类型不同，消息通过交换机发送给消息队列的策略也就不同。<br>交换机的类型主要分为三种，也就是订阅模型的三种类型。</p>\n<ul>\n<li>Fanout：扇出，消息进入交换机后，交换机以广播的形式发送给所有队列。</li>\n<li>Direct：定向发送，消息进入交换机后，交换机通过消息指定的RoutingKey（路由Key），发送到指定的队列中，在这种消息模型下，每个队列在绑定到交换机的时候，都需要指定RoutingKey（路由Key）。</li>\n<li>Topic：通配符模糊发送，消息的发送策略基本和Direct相似，但是不同的是，Topic交换机可以通过通配符的方式，模糊选择RoutingKey（路由Key），从而将消息发送到消息队列中。</li>\n</ul>\n<h2 id=\"订阅模型Fanout\"><a href=\"#订阅模型Fanout\" class=\"headerlink\" title=\"订阅模型Fanout\"></a>订阅模型Fanout</h2><p><img src=\"/images/2020/03/20200324094405737.png\" alt=\"在这里插入图片描述\"></p>\n<p>订阅模型Fanout，Fanout（扇出）是交换机类型，也是交换机发送消息给消息队列的策略。<br>Fanout即交换机以广播形式，将消息发送给所有的消息队列，每个和消息队列绑定的消费者都可以接收并消费该消息队列。</p>\n<h1 id=\"JavaAPI实现订阅模型Fanout\"><a href=\"#JavaAPI实现订阅模型Fanout\" class=\"headerlink\" title=\"JavaAPI实现订阅模型Fanout\"></a>JavaAPI实现订阅模型Fanout</h1><h2 id=\"准备工作\"><a href=\"#准备工作\" class=\"headerlink\" title=\"准备工作\"></a>准备工作</h2><p>使用JavaAPI实现消息队列模型，需要先做一些准备工作，这些准备工作包括搭建项目环境和准备工具类，这些工作在<a href=\"/2020/03/23/tool/消息队列RabbitMQ之基本消息模型/\">消息队列RabbitMQ之基本消息模型</a>已经准备好了，就不重复准备了。</p>\n<h2 id=\"创建生产者\"><a href=\"#创建生产者\" class=\"headerlink\" title=\"创建生产者\"></a>创建生产者</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Send</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//RabbitMQ的交换机名称</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"type\">String</span> <span class=\"variable\">EXCHANGE_NAME</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;amq.fanout&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] argv)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"comment\">//使用工具类，获取RabbitMQ的连接</span></span><br><span class=\"line\">        <span class=\"type\">Connection</span> <span class=\"variable\">connection</span> <span class=\"operator\">=</span> ConnectionUtils.getConnection();</span><br><span class=\"line\">        <span class=\"comment\">//使用连接创建通道</span></span><br><span class=\"line\">        <span class=\"type\">Channel</span> <span class=\"variable\">channel</span> <span class=\"operator\">=</span> connection.createChannel();</span><br><span class=\"line\">        <span class=\"comment\">//声明交换机exchange，指定类型为fanout，BuiltinExchangeType是一个枚举类，最后一个参数为指定交换机的持久化属性</span></span><br><span class=\"line\">        channel.exchangeDeclare(EXCHANGE_NAME, BuiltinExchangeType.FANOUT,<span class=\"literal\">true</span>);</span><br><span class=\"line\">        <span class=\"comment\">//需要发送的消息</span></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">message</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;Hello World!&quot;</span>;</span><br><span class=\"line\">        <span class=\"comment\">//使用通道发送消息到交换机，参数分别为：交换机名称，路由Key，其他属性，消息正文</span></span><br><span class=\"line\">        channel.basicPublish(EXCHANGE_NAME, <span class=\"string\">&quot;&quot;</span>, <span class=\"literal\">null</span>, message.getBytes());</span><br><span class=\"line\">        <span class=\"comment\">//关闭通道</span></span><br><span class=\"line\">        channel.close();</span><br><span class=\"line\">        <span class=\"comment\">//关闭连接</span></span><br><span class=\"line\">        connection.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建消费者1\"><a href=\"#创建消费者1\" class=\"headerlink\" title=\"创建消费者1\"></a>创建消费者1</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Recv1</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//消费者的队列名称</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"type\">String</span> <span class=\"variable\">QUEUE_NAME</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;fanout_exchange_queue_1&quot;</span>;</span><br><span class=\"line\">    <span class=\"comment\">//RabbitMQ的交换机名称</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"type\">String</span> <span class=\"variable\">EXCHANGE_NAME</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;amq.fanout&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] argv)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"comment\">//使用工具类，获取RabbitMQ的连接</span></span><br><span class=\"line\">        <span class=\"type\">Connection</span> <span class=\"variable\">connection</span> <span class=\"operator\">=</span> ConnectionUtils.getConnection();</span><br><span class=\"line\">        <span class=\"comment\">//使用连接创建通道</span></span><br><span class=\"line\">        <span class=\"type\">Channel</span> <span class=\"variable\">channel</span> <span class=\"operator\">=</span> connection.createChannel();</span><br><span class=\"line\">        <span class=\"comment\">//使用通道声明一个队列，参数分别为：队列名称，是否持久化，是否为排他队列，是否自动删除，其他属性</span></span><br><span class=\"line\">        channel.queueDeclare(QUEUE_NAME, <span class=\"literal\">false</span>, <span class=\"literal\">false</span>, <span class=\"literal\">false</span>, <span class=\"literal\">null</span>);</span><br><span class=\"line\">        <span class=\"comment\">//绑定队列到交换机</span></span><br><span class=\"line\">        channel.queueBind(QUEUE_NAME, EXCHANGE_NAME, <span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//定义队列的消费者</span></span><br><span class=\"line\">        <span class=\"type\">DefaultConsumer</span> <span class=\"variable\">consumer</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">DefaultConsumer</span>(channel) &#123;</span><br><span class=\"line\">            <span class=\"comment\">//覆写该方法，该方法类似于监听器，当队列中有消息的时候，就会被调用执行</span></span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">handleDelivery</span><span class=\"params\">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class=\"type\">byte</span>[] body)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">                <span class=\"comment\">//byte[] body参数即为消息体，当该消息体被使用，即认为该消息已被消费</span></span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot; [消费者1] received : &quot;</span> + <span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(body));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"comment\">//监听队列，参数分别为：队列名称，是否自动确认消息已被消费，队列消费者</span></span><br><span class=\"line\">        channel.basicConsume(QUEUE_NAME, <span class=\"literal\">true</span>, consumer);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建消费者2\"><a href=\"#创建消费者2\" class=\"headerlink\" title=\"创建消费者2\"></a>创建消费者2</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Recv2</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//消费者的队列名称</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"type\">String</span> <span class=\"variable\">QUEUE_NAME</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;fanout_exchange_queue_2&quot;</span>;</span><br><span class=\"line\">    <span class=\"comment\">//RabbitMQ的交换机名称</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"type\">String</span> <span class=\"variable\">EXCHANGE_NAME</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;amq.fanout&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] argv)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"comment\">//使用工具类，获取RabbitMQ的连接</span></span><br><span class=\"line\">        <span class=\"type\">Connection</span> <span class=\"variable\">connection</span> <span class=\"operator\">=</span> ConnectionUtils.getConnection();</span><br><span class=\"line\">        <span class=\"comment\">//使用连接创建通道</span></span><br><span class=\"line\">        <span class=\"type\">Channel</span> <span class=\"variable\">channel</span> <span class=\"operator\">=</span> connection.createChannel();</span><br><span class=\"line\">        <span class=\"comment\">//使用通道声明一个队列，参数分别为：队列名称，是否持久化，是否为排他队列，是否自动删除，其他属性</span></span><br><span class=\"line\">        channel.queueDeclare(QUEUE_NAME, <span class=\"literal\">false</span>, <span class=\"literal\">false</span>, <span class=\"literal\">false</span>, <span class=\"literal\">null</span>);</span><br><span class=\"line\">        <span class=\"comment\">//绑定队列到交换机</span></span><br><span class=\"line\">        channel.queueBind(QUEUE_NAME, EXCHANGE_NAME, <span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//定义队列的消费者</span></span><br><span class=\"line\">        <span class=\"type\">DefaultConsumer</span> <span class=\"variable\">consumer</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">DefaultConsumer</span>(channel) &#123;</span><br><span class=\"line\">            <span class=\"comment\">//覆写该方法，该方法类似于监听器，当队列中有消息的时候，就会被调用执行</span></span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">handleDelivery</span><span class=\"params\">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class=\"type\">byte</span>[] body)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">                <span class=\"comment\">//byte[] body参数即为消息体，当该消息体被使用，即认为该消息已被消费</span></span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot; [消费者2] received : &quot;</span> + <span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(body));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"comment\">//监听队列，参数分别为：队列名称，是否自动确认消息已被消费，队列消费者</span></span><br><span class=\"line\">        channel.basicConsume(QUEUE_NAME, <span class=\"literal\">true</span>, consumer);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n","categories":["消息队列"],"tags":["RabbitMQ","消息队列"]},{"title":"消息队列RabbitMQ之订阅模型Topic","url":"/2020/03/24/tool/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97RabbitMQ%E4%B9%8B%E8%AE%A2%E9%98%85%E6%A8%A1%E5%9E%8BTopic/","content":"<h1 id=\"订阅模型\"><a href=\"#订阅模型\" class=\"headerlink\" title=\"订阅模型\"></a>订阅模型</h1><p>关于RabbitMQ订阅模型的知识，可以参考前置知识中的<a href=\"/2020/03/24/tool/消息队列RabbitMQ之订阅模型Fanout/\">消息队列RabbitMQ之订阅模型Fanout</a>博客，该篇博客已经讲解了RabbitMQ的订阅模型。</p>\n<span id=\"more\"></span>\n<h2 id=\"订阅模型Topic\"><a href=\"#订阅模型Topic\" class=\"headerlink\" title=\"订阅模型Topic\"></a>订阅模型Topic</h2><p>订阅模型Topic的工作模式基本和Direct相似，不同之处在于，Topic的队列绑定交换机的路由Key可以使用通配符的写法，路由可以通过模糊匹配，发送到符合要求的队列中去。</p>\n<h2 id=\"Topic的路由Key通配符\"><a href=\"#Topic的路由Key通配符\" class=\"headerlink\" title=\"Topic的路由Key通配符\"></a>Topic的路由Key通配符</h2><ul>\n<li><code>#</code>代码一个或多个单词。</li>\n<li><code>*</code>代表一个单词。</li>\n</ul>\n<p>【注意】通配符是在队列绑定交换机的路由Key上使用的，如果是在消息的路由Key上，只会被识别为一个普通单词。<br>【注意】路由Key可以由多个单词组成，单词与单词之间，使用<code>.</code>号隔开。</p>\n<h1 id=\"JavaAPI实现订阅模型Topic\"><a href=\"#JavaAPI实现订阅模型Topic\" class=\"headerlink\" title=\"JavaAPI实现订阅模型Topic\"></a>JavaAPI实现订阅模型Topic</h1><h2 id=\"准备工作\"><a href=\"#准备工作\" class=\"headerlink\" title=\"准备工作\"></a>准备工作</h2><p>使用JavaAPI实现消息队列模型，需要先做一些准备工作，这些准备工作包括搭建项目环境和准备工具类，这些工作在<a href=\"/2020/03/23/tool/消息队列RabbitMQ之基本消息模型/\">消息队列RabbitMQ之基本消息模型</a>已经准备好了，就不重复准备了。</p>\n<h2 id=\"创建生产者\"><a href=\"#创建生产者\" class=\"headerlink\" title=\"创建生产者\"></a>创建生产者</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Send</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//RabbitMQ的交换机名称</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"type\">String</span> <span class=\"variable\">EXCHANGE_NAME</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;amq.topic&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] argv)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"comment\">//使用工具类，获取RabbitMQ的连接</span></span><br><span class=\"line\">        <span class=\"type\">Connection</span> <span class=\"variable\">connection</span> <span class=\"operator\">=</span> ConnectionUtils.getConnection();</span><br><span class=\"line\">        <span class=\"comment\">//使用连接创建通道</span></span><br><span class=\"line\">        <span class=\"type\">Channel</span> <span class=\"variable\">channel</span> <span class=\"operator\">=</span> connection.createChannel();</span><br><span class=\"line\">        <span class=\"comment\">//声明交换机exchange，指定类型为fanout，BuiltinExchangeType是一个枚举类，最后一个参数为指定交换机的持久化属性</span></span><br><span class=\"line\">        channel.exchangeDeclare(EXCHANGE_NAME, BuiltinExchangeType.TOPIC,<span class=\"literal\">true</span>);</span><br><span class=\"line\">        <span class=\"comment\">//需要发送的消息</span></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">insert_message</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;插入数据&quot;</span>;</span><br><span class=\"line\">        <span class=\"comment\">//使用通道发送消息到交换机，参数分别为：交换机名称，路由Key，其他属性，消息正文</span></span><br><span class=\"line\">        channel.basicPublish(EXCHANGE_NAME, <span class=\"string\">&quot;insert.user.data&quot;</span>, <span class=\"literal\">null</span>, insert_message.getBytes());</span><br><span class=\"line\">        <span class=\"comment\">//需要发送的消息</span></span><br><span class=\"line\">        <span class=\"type\">String</span> <span class=\"variable\">delete_message</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;删除数据&quot;</span>;</span><br><span class=\"line\">        <span class=\"comment\">//使用通道发送消息到交换机，参数分别为：交换机名称，路由Key，其他属性，消息正文</span></span><br><span class=\"line\">        channel.basicPublish(EXCHANGE_NAME, <span class=\"string\">&quot;delete.user.data&quot;</span>, <span class=\"literal\">null</span>, delete_message.getBytes());</span><br><span class=\"line\">        <span class=\"comment\">//关闭通道</span></span><br><span class=\"line\">        channel.close();</span><br><span class=\"line\">        <span class=\"comment\">//关闭连接</span></span><br><span class=\"line\">        connection.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"创建消费者1\"><a href=\"#创建消费者1\" class=\"headerlink\" title=\"创建消费者1\"></a>创建消费者1</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Recv1</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//消费者的队列名称</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"type\">String</span> <span class=\"variable\">QUEUE_NAME</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;topic_exchange_queue_1&quot;</span>;</span><br><span class=\"line\">    <span class=\"comment\">//RabbitMQ的交换机名称</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"type\">String</span> <span class=\"variable\">EXCHANGE_NAME</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;amq.topic&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] argv)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"comment\">//使用工具类，获取RabbitMQ的连接</span></span><br><span class=\"line\">        <span class=\"type\">Connection</span> <span class=\"variable\">connection</span> <span class=\"operator\">=</span> ConnectionUtils.getConnection();</span><br><span class=\"line\">        <span class=\"comment\">//使用连接创建通道</span></span><br><span class=\"line\">        <span class=\"type\">Channel</span> <span class=\"variable\">channel</span> <span class=\"operator\">=</span> connection.createChannel();</span><br><span class=\"line\">        <span class=\"comment\">//使用通道声明一个队列，参数分别为：队列名称，是否持久化，是否为排他队列，是否自动删除，其他属性</span></span><br><span class=\"line\">        channel.queueDeclare(QUEUE_NAME, <span class=\"literal\">false</span>, <span class=\"literal\">false</span>, <span class=\"literal\">false</span>, <span class=\"literal\">null</span>);</span><br><span class=\"line\">        <span class=\"comment\">//绑定队列到交换机，路由key为insert和delete，接受路由Key为insert和delete的消息</span></span><br><span class=\"line\">        channel.queueBind(QUEUE_NAME, EXCHANGE_NAME, <span class=\"string\">&quot;insert.#&quot;</span>);</span><br><span class=\"line\">        channel.queueBind(QUEUE_NAME, EXCHANGE_NAME, <span class=\"string\">&quot;delete.*&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//定义队列的消费者</span></span><br><span class=\"line\">        <span class=\"type\">DefaultConsumer</span> <span class=\"variable\">consumer</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">DefaultConsumer</span>(channel) &#123;</span><br><span class=\"line\">            <span class=\"comment\">//覆写该方法，该方法类似于监听器，当队列中有消息的时候，就会被调用执行</span></span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">handleDelivery</span><span class=\"params\">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class=\"type\">byte</span>[] body)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">                <span class=\"comment\">//byte[] body参数即为消息体，当该消息体被使用，即认为该消息已被消费</span></span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot; [消费者1] received : &quot;</span> + <span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(body));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"comment\">//监听队列，参数分别为：队列名称，是否自动确认消息已被消费，队列消费者</span></span><br><span class=\"line\">        channel.basicConsume(QUEUE_NAME, <span class=\"literal\">true</span>, consumer);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"创建消费者2\"><a href=\"#创建消费者2\" class=\"headerlink\" title=\"创建消费者2\"></a>创建消费者2</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title class_\">Recv2</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">//消费者的队列名称</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"type\">String</span> <span class=\"variable\">QUEUE_NAME</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;topic_exchange_queue_2&quot;</span>;</span><br><span class=\"line\">    <span class=\"comment\">//RabbitMQ的交换机名称</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"keyword\">static</span> <span class=\"type\">String</span> <span class=\"variable\">EXCHANGE_NAME</span> <span class=\"operator\">=</span> <span class=\"string\">&quot;amq.topic&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title function_\">main</span><span class=\"params\">(String[] argv)</span> <span class=\"keyword\">throws</span> Exception &#123;</span><br><span class=\"line\">        <span class=\"comment\">//使用工具类，获取RabbitMQ的连接</span></span><br><span class=\"line\">        <span class=\"type\">Connection</span> <span class=\"variable\">connection</span> <span class=\"operator\">=</span> ConnectionUtils.getConnection();</span><br><span class=\"line\">        <span class=\"comment\">//使用连接创建通道</span></span><br><span class=\"line\">        <span class=\"type\">Channel</span> <span class=\"variable\">channel</span> <span class=\"operator\">=</span> connection.createChannel();</span><br><span class=\"line\">        <span class=\"comment\">//使用通道声明一个队列，参数分别为：队列名称，是否持久化，是否为排他队列，是否自动删除，其他属性</span></span><br><span class=\"line\">        channel.queueDeclare(QUEUE_NAME, <span class=\"literal\">false</span>, <span class=\"literal\">false</span>, <span class=\"literal\">false</span>, <span class=\"literal\">null</span>);</span><br><span class=\"line\">        <span class=\"comment\">//绑定队列到交换机，路由key为insert，只接收路由Key为delete的消息</span></span><br><span class=\"line\">        channel.queueBind(QUEUE_NAME, EXCHANGE_NAME, <span class=\"string\">&quot;delete.#&quot;</span>);</span><br><span class=\"line\">        <span class=\"comment\">//定义队列的消费者</span></span><br><span class=\"line\">        <span class=\"type\">DefaultConsumer</span> <span class=\"variable\">consumer</span> <span class=\"operator\">=</span> <span class=\"keyword\">new</span> <span class=\"title class_\">DefaultConsumer</span>(channel) &#123;</span><br><span class=\"line\">            <span class=\"comment\">//覆写该方法，该方法类似于监听器，当队列中有消息的时候，就会被调用执行</span></span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title function_\">handleDelivery</span><span class=\"params\">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class=\"type\">byte</span>[] body)</span> <span class=\"keyword\">throws</span> IOException &#123;</span><br><span class=\"line\">                <span class=\"comment\">//byte[] body参数即为消息体，当该消息体被使用，即认为该消息已被消费</span></span><br><span class=\"line\">                System.out.println(<span class=\"string\">&quot; [消费者2] received : &quot;</span> + <span class=\"keyword\">new</span> <span class=\"title class_\">String</span>(body));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"comment\">//监听队列，参数分别为：队列名称，是否自动确认消息已被消费，队列消费者</span></span><br><span class=\"line\">        channel.basicConsume(QUEUE_NAME, <span class=\"literal\">true</span>, consumer);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n","categories":["消息队列"],"tags":["RabbitMQ","消息队列"]}]